<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN//2.0"><html><head><title>Kermit Security Reference</title></head>
<body bgcolor="#ffffff" text="#000000">
<h1><a name="top"><tt>Kermit Security Reference</tt></a></h1>

<dl><dt><i>Authors:</i></dt><dd><big>Jeffrey Altman, Frank da Cruz</big><br>
<a href="https://kermitproject.org">The Kermit Project</a>,
<a href="http://www.columbia.edu/">Columbia University</a>

<p>

</p></dd><dt><i>Applies To<b>:</b></i>
</dt><dd><a href="https://kermitproject.org/ck80.html">
C-Kermit 8.1.206</a>, 24 October 2002<br>
<a href="https://kermitproject.org/k95.html">Kermit 95 2.1.3</a>,
1 January 2003<br>
<a href="https://kermitproject.org/security70.html">An earlier
version of this document</a> covers
<a href="https://kermitproject.orgt/ck70.html">C-Kermit 7.0</a>
and K95 1.1.17-20.

<p>
</p></dd><dt><i>Most Recent Update:</i>
</dt><dd>Wed Jan  1 10:42:49 2003

<p>
</p></dd><dt><i>Abstract:</i>
</dt><dd>Security methods explained: Kerberos, SSL/TLS, SRP, SSH.  How to configure
and use them with C-Kermit and Kermit 95.

</dd></dl>
<p>

[ <a href="https://kermitproject.org/index.html">Kermit Home</a> ]
[ <a href="https://kermitproject.org/ckermit.html">C-Kermit</a> ]
[ <a href="https://kermitproject.org/k95.html">Kermit 95</a> ]

</p><h3><a name="contents"><hr>CONTENTS</a></h3>

<pre>   1. <a href="#x1"><b>INTRODUCTION</b></a>
   2. <a href="#x2"><b>DISCLAIMERS</b></a>
   3. <a href="#x3"><b>KERMIT SECURITY USER GUIDE</b></a>
   4. <a href="#x4"><b>INSTALLATION AND CONFIGURATION</b></a>
   5. <a href="#x5"><b>SCRIPTING AND AUTOMATION</b></a>
   I. <a href="#xa1"><b>WHERE TO FIND SECURE TELNET AND FTP SERVERS</b></a>
  II. <a href="#xa2"><b>MULTIHOMED HOSTS, FIREWALLS, NATS</b></a>
 III. <a href="#xa3"><b>INTRODUCTION TO CERTIFICATES</b></a>
  IV. <a href="#xa4"><b>USING OTHER SECURITY METHODS WITH KERMIT</b></a>
      <a href="#glossary"><b>GLOSSARY</b></a>   
      <a href="#references"><b>REFERENCES</b></a>   
      <a href="#trademarks"><b>TRADEMARKS</b></a>
</pre>

<h3><a name="x1"><hr>1. INTRODUCTION</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
[ <a href="#x2">Next</a> ]
<p>

CHAPTER CONTENTS
</p><p>
</p><pre>  1.1. <a href="#x1.1">Secure Connections</a>
  1.2. <a href="#x1.2">Internet Protocols</a>
  1.3. <a href="#x1.3">Authentication</a>
  1.4. <a href="#x1.4">Encryption</a>
  1.5. <a href="#x1.5">Integrity</a>
</pre>

<big><big>S</big></big>ECURITY is the hot topic on the Internet.  Security
systems and protocols abound.  But it was not always so.  In the early days,
the mere act of putting two computers in touch with each other was quite
amazing.  To connect multiple diverse computers to a common network, allowing
any pair of them to communicate, was almost inconceivable.  When the
<a href="#glossary">ARPANET</a> (precursor of the Internet) was first
operational on October 1, 1969, the eager task for many years afterwards was
to open up more and more sites to it.  The architecture of the network and its
protocols were developed in research laboratories in an atmosphere of trust.

<p>

Only later, when the ARPANET became the world-wide Internet and was opened up
to limitless numbers of people, did security become an issue: hackers,
crackers, script kiddies, terrorists, spies, hucksters, swindlers,
pornographers, saboteurs, blackmailers, pranksters, and pests of every sort
inundate the network and every computer on it with a constant barrage of
probes and attacks.  It is increasingly necessary to secure connections from
eavesdropping and malicious tampering.<!-- (not to mention spam, worms, viruses,
and denial-of-service attacks, but that's

<a href="http://www.columbia.edu/acis/security/safecomputing.html">another
story</a>).-->

</p><p>

<big><i>The network itself is not secure.</i></big> By its very nature and
fundamental design, it is entirely open<up><a href="#n01">*</a></up>.  While
it might be possible to insert security at the transport and/or network
layers, transparent to all applications, the approach until now has been to
layer security protocols over TCP and IP: some of them standard, some not so
standard.  Even among the standard ones, there are many to choose from.  This
approach requires one or more security methods to be programmed into each and
every client and server application that is to make or accept secure Internet
connections.  The situation should improve in the future as security becomes
part of the network itself through evolving standards such as 
<a href="http://www.ietf.org/html.charters/ipsec-charter.html">IPSec</a>,
<a href="http://www.ipv6.org/">IPv6</a>, and 
<a href="http://www.ietf.org/ids.by.wg/dnssec.html">DNSSEC</a>.

</p><p>

Meanwhile, <big><i>insecure connections</i></big> remain the norm, in which
passwords, credit-card information, private correspondence, and so on can be
captured and/or altered in transit by malicious persons.  Security remains
elusive because we have a 30+ year history of open networks, clients, and
servers, and because of the many competing security methods, the shifting
definitions of each one, various legal entanglements, and the overall
complexity of the entire topic.

</p><p>

<big><i>Why should I care about security?</i></big>

The reasons are obvious: to prevent fraud on your person, theft of your money
or identity, hijacking of your computer accounts, tampering with your research
results; any number of malicious acts aimed at you or performed by someone
masquerading <i>as</i> you.  Perhaps an even more compelling reason to care is
that more and more sites are <i>requiring</i> secure clients for access:
plain old dialup or insecure Telnet or FTP simply can't be used any more.

</p><p>

<big><i>Kermit software has offered secure connections since 1998.</i></big>
This document presents the security methods embodied in <a href="https://kermitproject.org/ckermit.html">C-Kermit</a>
8.0 and <a href="https://kermitproject.org/k95.html">Kermit 95</a>
2.0, which include:

</p><p>
</p><ul>
<li>Kerberos(<a href="#trademarks">TM</a>) IV and V
</li><li>Secure Remote Password(<a href="#trademarks">TM</a>)(SRP)
</li><li>Secure Sockets Layer(SSL)/Transport Layer Security(TLS)
</li><li>Secure Shell (SSH) v1 and v2 (built into K95, external in C-Kermit)
</li><li>Microsoft NT LAN Manager (NTLM, K95 Windows only)
</li></ul>
<p>

<small>
<a name="n01"><up>*</up></a> This is a slight exaggeration; an ever-increasing
amount of filtering occurs in routers; local networks are increasingly
switched rather than broadcast, etc.
</small>

</p><h3><a name="x1.1"><hr>1.1. Secure Connections</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

<big><i>What is a secure connection?</i></big>
A connection is secure if it provides:

</p><p>
</p><ul>

<li><i>Authentication of the user</i> to the host/service without the
transmission of the user's password;

</li><li><i>Authentication of the host</i> to the user;

</li><li><i>Privacy</i>, through a shared secret that can be used as an
end-to-end encryption key; and:

</li><li><i>Integrity:</i> the assurance that the data has not been altered in
transit.

</li></ul>
<p>

A secure connection requires two applications, one on each end, that support
(and can negotiate) a common security method; for example, a Telnet client on
your desktop and a Telnet server at the remote site, both equipped with
protocols such as Kerberos V.

</p><p>

Kermit software supports a variety of connection methods, including serial
ports, modems, and TCP/IP.  Presently, secure connections are supported
only over TCP/IP connections.  Since there are many security protocols to
consider (Kerberos, SRP, TLS, <tt>...</tt>) and several TCP/IP application
protocols where they can be used (Telnet, SSH, FTP, HTTP, <tt>...</tt>), and
different platforms for the clients and servers (Unix, VMS, Windows, OS/2,
<tt>...</tt>), the possibilities are many.

</p><p>

To complicate matters, every Kermit program can come with or without security.
Non-secure versions can be sent and used anywhere.  Deployment of secure
versions, however, is restricted USA export law.  Secure versions can be built
with any combination of the security methods listed above: Kerberos IV but not
Kerberos V, SRP and SSL/TLS but not Kerberos, etc.  Kermit 95 has either no
security methods built in or else all of them.  C-Kermit on Unix can have any
combination, depending on the libraries available on each platform and which
ones were selected by the builder.

</p><h3><a name="x1.2"><hr>1.2. Internet Protocols</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Let's begin by looking at the Internet protocols that Kermit supports
to see which security options are available for each:

</p><p>
</p><dl><dt><i>TELNET (Network Virtual Terminal Protocol)</i>

</dt>
<dd>The Telnet protocol can be used to establish the most secure connections
with a large choice of authentication and privacy methods.  Kermit's
Telnet implementation supports Kerberos 4, Kerberos 5, Secure Remote Password
(SRP), NTLM (K95 only), and <a href="#xa3">X.509 certificates</a> for client
and server authentication.  Privacy can be accomplished with the Secure
Sockets Layer (SSL) or Transport Layer Security (TLS) cipher suites, or DES,
CAST, or 3DES streaming ciphers.

<p>
</p></dd><dt><i>SSH (Secure Shell and Port Forwarding Protocol)</i>

</dt><dd>The SSH protocols (versions 1 and 2) can be used to establish secure
connections with a wide choice of authentication methods.  Kermit's SSH
implementation supports Kerberos 4, Kerberos 5, Secure Remote Password (SRP),
and Public Keys for client and server authentication.  Privacy is integrated
into the protocol through the use of secure public key or GSSAPI based key
exchange coupled with strong cipher suites.

<p>
</p></dd><dt><i>FTP (File Transfer Protocol)</i>

</dt><dd>An FTP client can make secure connections for both the command and
data channels as described in Internet
<a href="ftp://ftp.isi.edu/in-notes/rfc2228.txt">RFC 2228</a>.  Kermit's FTP
implementation supports Kerberos 4, GSSAPI Kerberos 5, SRP, and SSL/TLS.

<p>
</p></dd><dt><i>HTTP (Hyper Text Transfer Protocol)</i>

</dt><dd>HTTP can be used with SSL or TLS to submit requests and receive responses
in a secure manner as described in
<a href="ftp://ftp.isi.edu/in-notes/rfc2818.txt">RFC 2818</a>.

<p>
</p></dd><dt><i>RLOGIN (Remote Login)</i>

</dt><dd>The Remote Login protocol can be used with Kerberos 4 or 5 to make
authenticated connections.  After authentication the DES streaming cipher can
be used for privacy.

<p>
</p></dd><dt><i>SSL (Secure Socket Layer) / TLS (Transport Layer Security</i>

</dt><dd>The SSL and TLS protocols can be used by themselves to establish a private
connection to a host.  Authentication of the server (and perhaps the client)
is performed via exchange and verification of <a href="#xa3">X.509
certificates</a> or Kerberos 5 credentials.  Kermit also can make Telnet
connections over a secure SSL or TLS tunnel.

<p>
</p></dd><dt><i>Kerberos 5 User-to-User</i>

</dt><dd>The Kerberos 5 user-to-user protocol can make authenticated and private
connections between two end-user operated copies of Kermit.

</dd></dl>

The table below summarizes which security methods Kermit <i>can</i> support
for each Internet service <i>if</i> those security methods are built in to
Kermit.  If your copy of Kermit supports a particular security method for a
particular service, you can use it if the server supports the same method.
You see out which security methods your Kermit program supports by giving
it the SHOW FEATURES command.


<p>
</p><blockquote><table border="1">
<tbody><tr>
<th align="left">Protocol
</th><th align="left">Krb4
</th><th align="left">Krb5
</th><th align="left">SSL/TLS
</th><th align="left">SRP
</th><th align="left">SSH
</th><th align="left">NTLM
</th></tr><tr>
<td><b>Telnet</b>
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">K95
</td></tr><tr>
<td><b>Rlogin</b>
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">No
</td><td align="center">No
</td><td align="center">No
</td><td align="center">No
</td></tr><tr>
<td><b>SSL/TLS</b>
</td><td align="center">No
</td><td align="center">Yes
</td><td align="center">n/a
</td><td align="center">No
</td><td align="center">No
</td><td align="center">No
</td></tr><tr>
<td><b>K5 User-User</b>
</td><td align="center">No
</td><td align="center">Yes
</td><td align="center">No
</td><td align="center">No
</td><td align="center">No
</td><td align="center">No
</td></tr><tr>
<td><b>FTP</b>
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">No
</td><td align="center">No
</td></tr><tr>
<td><b>HTTP</b>
</td><td align="center">No
</td><td align="center">No
</td><td align="center">Yes
</td><td align="center">No
</td><td align="center">No
</td><td align="center">No
</td></tr><tr>
<td><b>Kermit</b>
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">Yes
</td><td align="center">No<sup>1</sup>
</td><td align="center">K95
</td></tr><tr>
<td><b>SSH</b>
</td><td align="center">No
</td><td align="center">Yes
</td><td align="center">No
</td><td align="center">Yes
</td><td align="center">n/a
</td><td align="center">No
</td></tr></tbody></table>
</blockquote>

<p>
<small>
<ol>
<li>Of course you can use Kermit protocol over SSH connections, and you
can even install C-Kermit as a file-transfer and -management service under
sshd, but Kermit itself does not yet accept <i>incoming</i> SSH connections.
</li></ol>
</small>

</p><h3><a name="x1.3"><hr>1.3. Authentication</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

SECTION CONTENTS
</p><pre>  1.3.1. <a href="#x1.3.1">Kerberos</a>
  1.3.2. <a href="#x1.3.2">SRP</a>
  1.3.3. <a href="#x1.3.3">NTLM</a>
  1.3.4. <a href="#x1.3.4">X.509 Certificates</a>
  1.3.5  <a href="#x1.3.5">Public Keys</a>
  1.3.6  <a href="#x1.3.6">Host based</a>
  1.3.7  <a href="#x1.3.7">Password based</a>
</pre>

<p>

AUTHENTICATION is the means by which one party proves its identity to to
another.  The most common authentication method is the familiar process of
logging in with a username and password.  When you do this on an insecure
network connection, your identity and password are transmitted in clear text
and can be "sniffed" by anybody who has access to any of the components of the
network path; for example, by anybody who has a PC on a (non-switched)
Ethernet network over which your information passes.

</p><p>

Furthermore, when you make (say) a Telnet connection to a network, you accept
the fact that you must authenticate yourself to it, but how do you know that
the host itself is genuine?  In the normal course of events, there is no
requirement that <i>it</i> authenticate itself to <i>you</i>.

</p><p>

Enter <i>secure authentication</i>.  Any secure authentication scheme requires
central management of identities, as in the Kerberos authentication system
(<a href="#x1.3.1">Section 1.3.1</a>), X.509 certificates
(<a href="#xa3">Appendix III</a>), or Secure Remote Password 
(<a href="#x1.3.2">Section 1.3.2</a>).  This type of security is best suited
for large organizations -- universities, government agencies, corporations,
hospitals -- that have a full-time professional network / security
administration staff.  The learning curve and startup time are significant,
but worth the effort.  Any security method can be breached, so the true
measure of its effectiveness is its manageability: can breaches be repaired,
can compromised identities be reclaimed?
It is for these reasons that Microsoft, Sun, Apple, HP, IBM, and many Linux or 
BSD vendors are increasingly distributing Kerberos 5 as a core part of their
operating systems.
</p><p>

<i>Unfortunately</i>, the startup costs of a secure authentication system are
sometimes so daunting that some organizations simply don't bother, and instead
let users fend for themselves with unsigned public/private key pair schemes,
such as SSH public key authentication (<a href="#x1.3.5">Section 1.3.5</a>)
and PGP.  The only administrative tasks required up front are the installation
and/or distribution of the required client and server software.  This is not a
secure authentication system; quite the opposite: it <i>bypasses</i> any
secure authentication / authorization system that might be in place.  And
keys, once compromised, can not be revoked by those responsible for the
security of the host: a serious consideration since so many security keys are
stored on insecure disks (e.g. in Windows 9x/ME) ripe for picking.

</p><h4><a name="x1.3.1">1.3.1. Kerberos</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Kerberos is a method, developed at Massachusetts Institute of Technology
(MIT), by which two parties communicating over a TCP/IP connection can
authenticate <i>each other</i> through a trusted, centrally managed third
party without sending passwords across the network.  The Kerberos protocols
are defined in Internet RFCs
<a href="ftp://ftp.isi.edu/in-notes/rfc1510.txt">1510</a>,
<a href="ftp://ftp.isi.edu/in-notes/rfc1964.txt">1964</a>, and others.
You can read more about Kerberos at the following websites:

</p><p>
</p><ul>

<li><a href="http://web.mit.edu/kerberos/www/">
<tt>http://web.mit.edu/kerberos/www/</tt></a>

</li><li><a href="http://nii.isi.edu/info/kerberos/">
<tt>http://nii.isi.edu/info/kerberos/</tt></a>

</li><li><a href="http://nii.isi.edu/publications/kerberos-neuman-tso.html">
<tt>http://nii.isi.edu/publications/kerberos-neuman-tso.html</tt></a>

</li></ul>
<p>

There are, in fact, two Kerberos protocols: Kerberos IV (4) and Kerberos V
(5), the latter being the more flexible and secure protocol.  The two are
totally separate and incompatible.  Any given site might support neither,
either one, or both.  One of the unique benefits associated with the use
of Kerberos 5 authentication is its Single Sign-On (SSO) capability.  This
allows a user to enter their password once on the local machine, establish a
secure connection to a second machine and from there establish additional 
connections without requiring the user to enter their password a second time.

</p><p>

When both the client and server support the same version of Kerberos (4 or 5),
Kerberos authentication with or without encryption can be negotiated.  A
"Kerberized" version of Kermit can make a connection to a non-Kerberized host,
and a non-Kerberized host can accept a connection from a Kerberized version of
Kermit, as long as neither side is configured to <i>require</i> Kerberos
authentication.

</p><p>

Kerberos authentication has been integrated into Telnet, Rlogin, FTP, and
SSL/TLS as well as many other protocols not supported by Kermit.  As part of
the authentication process a session key is shared by the client and server
that can be used to encrypt the current session.

</p><h4><a name="x1.3.2">1.3.2. SRP</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Stanford University's Secure Remote Password (SRP) protocol is a method by
which two parties can mutually authenticate each other in a secure manner
through a Zero Knowledge Identification system.  SRP is defined in Internet
<a href="ftp://ftp.isi.edu/in-notes/rfc2945.txt">RFC 2945</a>.  You can read
more about SRP at the following website:

</p><p>
</p><pre>  <a href="http://www-cs-students.stanford.edu/%7Etjw/srp/">http://www-cs-students.stanford.edu/~tjw/srp/</a>
</pre>
<p>

SRP authentication has been integrated into the Telnet and FTP protocol
definitions (if not yet into all Telnet and FTP clients and servers).  As a
result of the authentication, a shared secret is produced that can be used to
encrypt the authenticated session.

</p><h4><a name="x1.3.3">1.3.3. NTLM</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Microsoft NT Lan Manager (NTLM) authentication is implemented in Kermit 95
only.  Its only use is to authenticate Kermit 95 to Microsoft Windows based
Telnet services distributed as part of Windows 2000, Windows XP Professional,
and the NT Services for Unix products.  Kermit 95 can also use NTLM to
authenticate incoming Telnet sessions when it is running under Windows
NT/2000/XP.  When running under Windows 95/98/98SE/ME, Kermit 95 can only be
an authenticating client.

</p><p>

NTLM does not negotiate a shared secret and cannot be used to establish
encrypted sessions.  Therefore, connections made with NTLM are not considered
secure although it is definitely better to use NTLM authentication than it is
to transmit a password in clear text.  NTLM is a proprietary protocol
considered to be a trade secret by Microsoft.  When establishing connections
with another Kermit 95 configured to accept incoming connections, Kermit 95
can negotiate NTLM over a SSL/TLS session.  Security is then provided by
SSL/TLS while authentication is performed with NTLM.

</p><h4><a name="x1.3.4">1.3.4. X.509 Certificates</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

When SSL/TLS is used to provide security, authentication of the server and
optionally the client can be performed using <a href="#xa3">X.509 Public Key
Certificates</a>.  Certificates are used to exchange a public key for use in
establishing an encrypted connection and can be verified against a known
trusted Root Certificate and a Certificate Revocation List (CRL) to indicate
its authenticity and validity.  The contents of the certificate can then be
used to determine the identity of the remote service or the client.

</p><p>

C-Kermit and Kermit 95 provide mechanisms for the customization of the 
certificate to userid mapping.

</p><h4><a name="x1.3.5">1.3.5. Public Key</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Several distrbuted security protocols including SSH rely on a loosely 
managed form of authentication based on the same asymmetic cryptography used 
within <a href="#xa3">X.509 Public Key Certificates</a>.  The technique is to 
generate a public and private key pair and give the public key away as
a means of authenticating the holder of the private key.  The prime 
difference between this and an X.509 certificate is that the public key
is not bound to any information providing the identity of the holder
nor does it contain any information that can be used to limit the lifetime
of the public key or sources of information that can be used to determine
if the public key has been compromised or revoked for some other reason.

</p><h4><a name="x1.3.6">1.3.6. Host Based</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Several application protocols such as Rlogin and SSH support some form of
host-based authentication.  In these protocols the identity of the host (not
the user) is used to determine whether the connection is to be trusted.  In
Rlogin the host-based authenticator is the IP address or DNS host name, both
of which are insecure indicators of identity.  SSH uses the host-assigned
Public Key pair as the host-based authenticator.

</p><p>

Host-based authentication is almost always used to allow system processes
which are not associated with a specific user to establish connections.  This
is often done to allow the secure distribution of system configuration files
to clusters of related systems.

</p><h4><a name="x1.3.7">1.3.7. Password Based</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Passwords, Passphrases, and so called Keyboard Interactive authentication
methods are the old-fashioned traditional means of proving end-user identity.
These methods are still in use with secure connections whether they be Telnet,
FTP, or even SSH.  They become safer to use when the connection is protected 
by some form of encrypting cipher suite.  However, it should never be assumed
that the transmission of a password to a host is safe.  The host daemon process
could have been replaced by one that collects and transmits passwords to an 
attacker.  There have even been passive attacks that observe the timings of 
transmissions between the client and the host that have enabled the attacker
to determine the password based upon the time it takes to type keys on a QWERTY
keyboard.

</p><h3><a name="x1.4"><hr>1.4. Encryption</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

<big><i>Export of software incorporating strong encryption is
<a href="#x2">regulated by United States law</a>.</i></big>

</p><p>

SECTION CONTENTS

</p><p>

</p><pre>  1.4.1. <a href="#x1.4.1">Telnet</a>
  1.4.2. <a href="#x1.4.2">FTP</a>
  1.4.3. <a href="#x1.4.3">SSL/TLS</a>
  1.4.4. <a href="#x1.4.4">SSH</a>
  1.4.5. <a href="#x1.4.5">HTTP</a>
  1.4.6. <a href="#x1.4.6">Rlogin</a>
</pre>
<p>

ENCRYPTION is the process by which data is encoded to prevent anybody from
deciphering it except those for whom it is intended.  Encryption is an
essential component of Internet security because of the Internet's open
architecture; since (in principal) everybody can watch your sessions, you
have to scramble them to keep them private.

</p><p>

A variety of encryption methods, or <i>algorithms</i>, exists ranging from
easy to crack to next-to-impossible (but not truly impossible<b>:</b> if the
data can be decrypted legitimately, it can also be decrypted illegitimately
given adequate resources).  Most modern encryption/decryption algorithms use
<i>keys</i> as part of the process, either provided by the user or obtained
automatically from a shared secret.  For any given algorithm, the longer the
key the more secure the encryption.

</p><p>

Each application protocol such as Telnet, FTP and HTTP defines its own set of
protocols for encrypting a session based on the authentication method.

</p><h4><a name="x1.4.1">1.4.1. Telnet Encryption</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.4">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The following encryption algorithms can be negotiated for a Telnet session
with the Telnet Encryption Option
(<a href="ftp://ftp.isi.edu/in-notes/rfc2946.txt">RFC 2946</a>) when used
with Kerberos IV, Kerberos V, or Secure Remote Password authentication:

</p><p>
</p><ul>

<li>CAST-128 64-bit Cipher Feedback Mode
<a href="ftp://ftp.isi.edu/in-notes/rfc2950.txt">RFC 2950</a>

</li><li>CAST-128 64-bit Output Feedback Mode
<a href="ftp://ftp.isi.edu/in-notes/rfc2949.txt">RFC 2949</a>

</li><li>DES3 64-bit Cipher Feedback Mode
<a href="ftp://ftp.isi.edu/in-notes/rfc2947.txt">RFC 2947</a>

</li><li>DES3 64-bit Output Feedback Mode
<a href="ftp://ftp.isi.edu/in-notes/rfc2948.txt">RFC 2948</a>

</li><li>DES 64-bit Cipher Feedback Mode
<a href="ftp://ftp.isi.edu/in-notes/rfc2952.txt">RFC 2952</a>

</li><li>DES 64-bit Output Feedback Mode
<a href="ftp://ftp.isi.edu/in-notes/rfc2951.txt">RFC 2951</a>

</li></ul>
<p>

When the Telnet START_TLS option is negotiated, <a href="#x1.4.3">SSL/TLS</a>
provides encryption services for the Telnet session.
						
</p><h4><a name="x1.4.2">1.4.2. FTP Encryption</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.4">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Encryption for FTP sessions depends on the authentication method:

</p><ul>

<li>Kerberos IV authentication uses DES for encryption.

<p>

</p></li><li>Kerberos V is supported within the GSS-API framework that negotiates
the encryption algorithm at run-time.  The negotiated encryption algorithm
depends on the implementation of GSSAPI available to Kermit.  MIT Kerberos
supports ciphers based on 3DES, RC4, and DES.

<p>


</p></li><li>Secure Remote Password authentication may be used with CAST-128, 3DES, 
DES, and Blowfish as encryption algorithms.  The selected algorithm is
user configurable.

<p>

</p></li><li>SSL/TLS provides an extensive list of cipher suites for use protecting
session data.
</li></ul>

<h4><a name="x1.4.3">1.4.3. SSL/TLS Encryption</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.4">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Netscape's Secure Sockets Layer (SSL) and its IETF-approved successor,
Transport Layer Security (TLS), provide for authentication and encryption of
TCP/IP communications using a combination of public key and symmetric
cryptographic algorithms.  TLS is defined in Internet
<a href="ftp://ftp.isi.edu/in-notes/rfc2246.txt">RFC 2246</a>.  Traditional
authentication of the server (and optionally the client) is performed by
exchanging ITU-T X.509 certificate chains (see <a href="#xa3">Appendix 3</a>),
that are verified by the receiver.  Unlike raw public keys, X.509
certificates may be revoked by issuing a certificate revocation list (CRL)
that is to be checked by the receiver during verification of the certificate
chain.

</p><p>

Kerberos 5 credentials can be used as an alternative method for performing
mutual authentication within SSL/TLS sessions
(<a href="ftp://ftp.isi.edu/in-notes/rfc2712.txt">RFC 2712</a>).

</p><p>

The encryption provided by SSL/TLS is more secure than the encryption
negotiatied by the Telnet Encryption Option.  This additional security is
provided by a combination of the use of longer encryption keys, the
availability of stronger symmetric cryptographic algorithms, and the signing
of each transmitted block with a message-digest algorithm.

</p><p>

A sample list of cipher suites from OpenSSL 0.9.7 as shipped with Kermit 95
includes:

</p><p>
</p><blockquote>
ADH-AES256-SHA
DHE-RSA-AES256-SHA
DHE-DSS-AES256-SHA
AES256-SHA
ADH-AES128-SHA
DHE-RSA-AES128-SHA
DHE-DSS-AES128-SHA
AES128-SHA
DHE-DSS-RC4-SHA
EXP1024-DHE-DSS-RC4-SHA
EXP1024-RC4-SHA
EXP1024-DHE-DSS-DES-CBC-SHA
EXP1024-DES-CBC-SHA
EXP1024-RC2-CBC-MD5
EXP1024-RC4-MD5
KRB5-DES-CBC3-MD5
KRB5-DES-CBC3-SHA
KRB5-DES-CBC-MD5
KRB5-DES-CBC-SHA
EXP-KRB5-DES-CBC-MD5
EXP-KRB5-DES-CBC-SHA
EDH-RSA-DES-CBC3-SHA
EDH-RSA-DES-CBC-SHA
EXP-EDH-RSA-DES-CBC-SHA
EDH-DSS-DES-CBC3-SHA
EDH-DSS-DES-CBC-SHA
EXP-EDH-DSS-DES-CBC-SHA
DES-CBC3-SHA
DES-CBC-SHA
EXP-DES-CBC-SHA
IDEA-CBC-SHA
EXP-RC2-CBC-MD5
RC4-SHA
RC4-MD5
EXP-RC4-MD5
ADH-DES-CBC3-SHA
ADH-DES-CBC-SHA
EXP-ADH-DES-CBC-SHA
ADH-RC4-MD5
EXP-ADH-RC4-MD5
RC4-64-MD5
DES-CBC3-MD5
DES-CBC-MD5
IDEA-CBC-MD5
RC2-CBC-MD5
EXP-RC2-CBC-MD5
RC4-MD5
EXP-RC4-MD5
</blockquote>
<p>

TLS can be used with Telnet Authentication methods such as Kerberos, Secure
Remote Password, and NTLM to provide the highest level of data privacy with
the strongest forms of mutual authentication when TLS in-band authentication
is not performed.

</p><h4><a name="x1.4.4">1.4.4. SSH Encryption</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.4">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

There are two different versions of the SSH protocol: version 1 and version 2.
The cryptographic strengths of the protocols are very different.  Whenever
possible SSH version 2 should be used.

</p><p>

SSH version 1 implements an encryption scheme that may be open to advanced
theoretical attacks.  The encryption algorithms supported for this protocol
by Kermit include DES, BLOWFISH, and 3DES.  

</p><p>

SSH version 2 implements the most advanced techniques known to the
cryptographic community.  Of all the security protocols in use on the
Internet, SSH version 2 is the youngest and therefore has had the most
flexibility in implementing changes as new cryptographic attacks have been
discovered.  The SSH version 2 ciphers supported by Kermit include 3DES, AES,
BLOWFISH, RC4, and CAST-128.

</p><h4><a name="x1.4.5">1.4.5. HTTP Encryption</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.4">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Secure HTTP connections use 
<a href="#x1.4.3">SSL/TLS</a> for encryption.

</p><h4><a name="x1.4.6">1.4.6. Rlogin Encryption</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x1">Chapter Contents</a> ]
[ <a href="#x1.4">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Secure Login connections are established by using a modified version of the
Rlogin protocol which replaces host-based authentication with a Kerberos 4 or
Kerberos 5 authentication handshake.  This authentication results in the
sharing of a session key for use in encrypting the transmitted data.  Kerberos
4 is limited to the exchange of DES keys whereas Kerberos 5 can exchange keys
for 3DES, RC4, and DES.

</p><h3><a name="x1.5"><hr>1.5. Integrity</a></h3>

Certain security protocols including SSL/TLS, FTP SRP, FTP GSSAPI-Kerberos 5,
Kerberos 5 User-to-User, and SSH not only encrypt network data streams, but
also ensure that they have not been tampered with along the way.  The
integrity algorithms are most often MD4, MD5, or SHA-1.

<h3><a name="x2"><hr>2. DISCLAIMERS</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
[ <a href="#x1">Next</a> ]
[ <a href="#x3">Previous</a> ]
<p>

</p><blockquote><i>

The statements made with regard to US export law reflect our understanding of
the situation at this writing, which might change subsequently.  We expect to
update this document, and our website in general, in light of any new
developments.

</i></blockquote>
<p>

Current US law forbids export of strong encryption software in binary form
from the USA to all countries except Canada without a license or license
exception.  Thus the Kermit Project does not distribute pre-compiled secure
versions of C-Kermit on the Internet.

</p><p>

Security within Kermit is provided using the underlying services of
third-party libraries, such as Kerberos or OpenSSL.  These libraries are not
necessarily included with Kermit (they are with the secure version of Kermit
95, but not with C-Kermit).  If not, they must be obtained separately from the
sources listed below, in compliance with the terms and conditions given at
those sites and with United States and international law.  For an overview of
this issue, see (for example):

</p><p></p><pre>  <a href="http://www.mozilla.org/crypto-faq.html">http://www.mozilla.org/crypto-faq.html</a>
</pre><p>

Kermit software, when combined with the security libraries listed in this
document, has been verified to negotiate and conduct authenticated and
encrypted sessions with Kerberos, SRP, and/or SSL/TLS services on Internet
hosts at Columbia University and other test sites, with Kermit features such
as interactive terminal access, file transfer, and scripting operating
successfully over secure connections, with any exceptions noted below.

</p><p>

The Kermit Project does not and can not claim or warrant the external
Kerberos, SRP, OpenSSL or other third-party modules to be free of loopholes or
bugs.  Authentication via Kerberos, SRP, or X.509 certificates is not
unbreakable.  Any encryption method can be broken.  Any software that is used
for authentication or encryption should be analyzed for weaknesses, backdoors,
bugs, and loopholes by the site and/or end user before use.

</p><p>

The Kermit Project and Columbia University make no claim or warranty as to any
particular level of security achievable by Kermit software with
any third party security protocol, and may on no account be held liable for
any damage resulting from its use (a more complete statement to this effect is
found in the C-Kermit 8.0 license).

</p><p>

Functional limitations:

</p><p>
</p><ul>

<li>Kerberos authentication is available on Telnet, FTP, Rlogin,
and SSL/TLS secured connections.

</li><li>Secure Remote Password authentication is available only on Telnet
and FTP connections.

</li><li>NTLM authentication is available only on Windows 95/98/Me/NT/2000/XP and
only on Telnet connections.

</li><li>SSL/TLS may be used as its own connection protocol or on Telnet, FTP, and
HTTP connections.

</li><li>Kerberos support is not available in Kermit 95 for OS/2 due to lack
of Kerberos implementations for OS/2.

</li><li>SSH is built in to the Windows version Kermit 95, but C-Kermit uses the
external ssh program.

</li></ul>
<p>

[ <a href="https://kermitproject.org/index.html">Kermit Home</a> ]
[ <a href="https://kermitproject.org/ckermit.html">C-Kermit</a> ]
[ <a href="https://kermitproject.org/k95.html">Kermit 95</a> ]

</p><h3><a name="x3"><hr>3. KERMIT SECURITY USER GUIDE</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
[ <a href="#x4">Next</a> ]
[ <a href="#x2">Previous</a> ]
<p>

CHAPTER CONTENTS
</p><p>
</p><pre>  3.1. <a href="#x3.1">Overview of Security Protocols</a>
  3.2. <a href="#x3.2">Security Command List </a>
  3.3. <a href="#x3.3">Making Secure Connections</a>
  3.4. <a href="#x3.4">Using Secure Connections</a>
</pre>

Suppose you work at a company (or are a student or faculty member at a
university, or otherwised engaged in an organization of some sort) that has
secure services of the kind you can access with Kermit, such as terminal
sessions, file transfer, or website management.  Before you can access the
services securely, you have to "tell" Kermit which authentication method to
use, along with any site-specific parameters, and you might also want to say
what should happen if the desired type of security can't be negotiated.

<p>

Bear in mind that you can use only those security methods that are offered
with the services you will be connecting to.  You can't just pick any old
security method and expect it to work<b>:</b> it takes two to tango.

</p><p>

Kermit has all the commands you need to set up secure connections, and they
are the topic of this rather lengthy chapter.  But don't worry: in most cases,
you'll have to deal with these commands only once, and possibly not at all:

</p><ul>

<li>If your organization has a <a href="http://www.columbia.edu/kermit/k95bulk.html">site or bulk license</a>
for Kermit 95, the network or software license administrators in your
organization should have set it all up for you in advance.

<p>

</p></li><li>If you are setting up Kermit for your own use within an organization's
security framework, you'll need to get assistance from the network
administrators anyway, to find out the pertinent connection details.

<p>

</p></li><li>In Kermit 95, there is a security form in the Dialer for
any secure connections you need to make: fill it once, use it forever.

<p>

</p></li><li>In any case, once you have put together the commands you need, you can
add them to your Kermit customization file if you want them to be in effect
every time you start Kermit, or you can make separate scripts for each host
or organization and use them whenever needed.

</li></ul>

Therefore, this chapter is more for the system or network or security
administrator than the typical end user.  Given an organization that already
has a security infrastructure in place, this chapter explains the Kermit
commands necessary to use it.  All the information should be here, but if you
have trouble finding what you need or putting the pieces together, feel free
to <a href="mailto:kermit-support@columbia.edu">send us questions by
e-mail</a>.

<h3><a name="x3.1"><hr>3.1. Overview of Security Protocols</a></h3>

SECTION CONTENTS

<p>
</p><pre>  3.1.1. <a href="#x3.1.1">Kerberos</a>
  3.1.2. <a href="#x3.1.2">SRP</a>
  3.1.3. <a href="#x3.1.3">NTLM</a>
  3.1.4. <a href="#x3.1.4">SSL/TLS</a>  
  3.1.5. <a href="#x3.1.5">SSH</a>  
</pre>
<p>

</p><h3><a name="x3.1.1">3.1.1. Kerberos Overview</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

When making a Kerberized connection, you must first know which Kerberos
version, 4 or 5, is supported by the host or service you want to connect
to, and you must be registered in the Kerberos database at the host's
site.  If you're unsure about any of this, contact your site administrator.

</p><p>

Before authentication to a specific service (such as Telnet) can succeed, you
must login to the site's Kerberos Ticket Granting Server.  Depending on the
Kerberos implementation and installation options this might be done
automatically when you log in to your operating system.  Otherwise you can
do it with external utilities from MIT (such as Leash, KRB5, or
kinit), or with Kermit's built-in functionality, explained in this chapter.

</p><p>

Once a Ticket Granting Ticket (TGT) is acquired, Kermit can use it to request
additional tickets for each host (service) you wish to connect to.  These
service tickets can be used to authenticate you with the host automatically
during a specified time interval, after which the tickets expire.  When
authentication is successful, you are logged in to the host without
having to supply a user ID or password.

</p><p>

Besides providing credentials for use during authentication, the service
ticket also contains a session key to be used for encrypting the session.
After the connection is authenticated, Kermit (if the necessary encryption
capabilities are available) attempts to negotiate bidirectional encryption.
If encryption is negotiated, it is used in one or both directions, depending
on what the server agrees to.

</p><p>

When Kerberos V authentication is used, Kermit supports credential forwarding
by transferring your Ticket Granting Tickets to the host that you are
connecting to, so you can make additional authenticated connections from that
host to any others that accept those tickets.  This provides a single sign-on
capability to all the hosts and services within the Kerberos realm.

</p><p>

Kerberos 5 authentication is one of the few authentication methods that can
be used to provide verification of anonymous TLS connections.  This is taken
advantage of in Telnet by negotiating AUTH KRB5 after establishing a private
connection with the START_TLS option.

</p><p>

Successful operation of Kerberos requires that all machines have their dates
and times synchronized.  Be aware that PC clocks can drift, and this can
cause authentication failures.  Kerberos requires that all clocks be
synchronized within 5 minutes.

</p><h3><a name="x3.1.2">3.1.2. Secure Remote Password (SRP) Overview</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

SRP requires no special configuration of the client.  When Kermit is used to
connect to a host that supports SRP, the user name is transmitted
automatically to the host and then a Password prompt is displayed in the
Kermit command screen.  This indicates that the password will not be sent to
the host over the communication channel.  Instead the password is used as part
of a negotiation in which authentication is either mutual or none at all.

</p><p>

The result of a mutual authentication is a shared secret used to generate two
different keys for encrypting the incoming and outgoing data.

</p><p>

SRP authentication is one of the few authentication methods that can
be used to provide verification of anonymous TLS connections.  The Kermit
Telnet client takes advantage of this fact by by negotiating AUTH SRP after
establishing a private connection with the START_TLS option.

</p><h3><a name="x3.1.3">3.1.3. NTLM Overview</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Microsoft's native authentication method is called (Windows) NT LAN Manager,
or NTLM.  It is implemented in Windows 9x/ME and NT/2000/XP and requires no
configuration on the part of the user.  When K95 is used on any Microsoft
Windows version, it can be used as an NTLM Telnet client to authenticate to
Microsoft's NT Services for Unix Telnet Server or to a K95 configured to
accept incoming connections.

</p><p>

When K95 is used on Windows NT/2000/XP it can be configured to accept incoming
connections and authenticate NTLM Telnet clients.

</p><p>

NTLM is a weak form of authentication.  It provides no shared secret
and cannot be used as a means of securing a connection with encryption.

</p><h3><a name="x3.1.4">3.1.4. SSLv3 and TLSv1 Overview</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

</p><blockquote><i>
(Also see
<a href="#xa3">Appendix III</a> for an introduction to the concept of
certificates.)
</i></blockquote>

<p>

Secure Sockets Layer Version 3 (SSLv3) and its successor Transport Layer
Security Version 1 (TLSv1) 
(<a href="ftp://ftp.isi.edu/in-notes/rfc2246.txt">RFC 2246</a>)
were originally developed for Web browsing.  They provide a framework
for using public-key certificates or Kerberos 5 to negotiate server and
(optionally) client authentication and bidirectional encryption.  The
encryption provided by SSLv3 and TLSv1 is stronger than that provided by the
Telnet Encryption option.

</p><p>

SSLv3 and TLSv1 connections may be negotiated in two different ways.  First,
the connection may be SSL/TLS-only, which is used when connecting to HTTPS
services or SSL/TLS tunnels.  SSL/TLS can also be negotiatied after the
connection is established via negotiations performed in some other protocol
(such as Telnet START_TLS.)  Kermit supports both methods:

</p><p>
</p><ul>
<li>Pure SSLv3 connections via SET HOST <i>host port</i> /SSL
</li><li>Pure TLSv1 connections via SET HOST <i>host port</i> /TLS
</li><li>SSLv3 connections negotiated by Tim Hudson's Telnet AUTH SSL option
</li><li>TLSv1 connections negotiated by the IETF TN3270E Working Group's
TELNET START_TLS option
</li><li>SSLv3 and TLSv1 connections negotiated with FTP OPEN <i>host port</i>
</li><li>SSLv3 and TLSv1 connections negotiated with HTTP OPEN <i>host port</i>
</li></ul>
<p>

In their most common use, SSL and TLS negotations provide the client with
authentication of the host computer when the host's X.509 certificate is
verified or when Kerberos 5 is used.  The client can be authenticated with an
X.509 certificate issued to the end user, or with Kerberos 5, or with one of
the supported Telnet authentication methods.  Even though the data channel is
encrypted, the transmission of passwords to the host should still be avoided
to prevent theft by a compromised host.

</p><p>

If certificates are to be verified, the root certificates of the certificate
authorities (CAs) must be available.  If you are not acting as your own CA you
need a file containing the root certificates that were used to sign the
certificates belonging to the servers you want to authenticate.  A compilation
of most of the commercial Certificate Authority root certificates as extracted
from Microsoft Windows XP's certificate database is available at:

</p><p>
</p><pre>   <a href="ftp://kermit.columbia.edu/kermit/c-kermit/ca_certs.pem">ftp://kermit.columbia.edu/kermit/c-kermit/ca_certs.pem</a>
</pre>
<p>

Once the file is downloaded, you can tell Kermit where it is with
the following command (<a href="#x3.2.2.3">Section 3.2.2.3</a>):

</p><p></p><pre>  SET AUTH SSL VERIFY-FILE <i>path</i>/ca_certs.pem
</pre><p>

When Kermit is acting as an
<a href="http://www.columbia.edu/kermit/iksd.html">Internet Kermit Service</a>
daemon (IKSD), client certificates can be used for automatic login.  If a
certificate-to-userid mapping function is provided, the IKSD logs the user in
automatically if the certificate is verified and the specified userid exists.
Kermit also supports the use of a "<tt>.tlslogin</tt>" file
that allows a certificate to be used to login automatically to an account
without a certificate-to-userid mapping function.  When Kermit receives a
username via the Telnet New-Environment variable after it has received and
verified a client certificate, it looks in the home directory corresponding to
the username for a file called "<tt>.tlslogin</tt>".  If the file contains the
certificate presented by the client, the client is logged in as the requested
user without a password.  See <a href="#xa3.11">Appendix III</a> for
information on certificate to user mapping.

</p><p>

The method for negotiating Tim Hudson's Telnet AUTH SSL option is open to a
"man-in-the-middle" attack which is capable of disabling the use of SSL before
the negotiation is begun.  It should be used only with:

</p><p></p><pre>  SET TELNET AUTHENTICATION TYPE SSL
  SET TELOPT AUTHENTICATION REQUIRED
</pre><p>

When using IKSD with START_TLS you should create an <tt>/etc/iksd.conf</tt>
including Kermit commands that point to the certificate and key files:

</p><p></p><pre>  set auth tls rsa-cert-file /usr/local/ssl/certs/telnetd-rsa.pem
  set auth tls rsa-key-file  /usr/local/ssl/certs/telnetd-rsa-key.pem
  set auth tls dsa-cert-file /usr/local/ssl/certs/telnetd-dsa.pem
  set auth tls dsa-key-file  /usr/local/ssl/certs/telnetd-dsa-key.pem
</pre><p>

as well as the list of acceptable ciphers:

</p><p></p><pre>  set auth tls cipher 3DES:DSS
</pre><p>

If your server certificate was signed by an intermediary certificate 
authority instead of a root, you must provide the full chain of intermediary
certificates for the client to be able to authenticate your 
server.  These certificates can be specified with:

</p><p></p><pre>  set auth tls rsa-cert-chain-file /usr/local/ssl/certs/telnetd-rsa-chain.pem
  set auth tls dsa-cert-chain-file /usr/local/ssl/certs/telnetd-dsa-chain.pem
</pre><p>

The SSL and TLS handshake can be very time-consuming, and therefore Kermit can
cache your your SSL/TLS sessions.  When Kermit is used with a peer that
supports cached sessions, subsequent connections to the same host can be
securely established in a fraction of the time necessary for the initial
connection.  This is especially important for FTP and HTTP, which can make
many connections to the same host during during a typical session.

</p><p>

For a list of Telnet servers that support START_TLS see
<a href="#xa1.1">Section I.1</a> of <a href="#xa1">Appendix I</a>.  For a list
of FTP servers that support AUTH SSL and AUTH TLS see <a href="#xa1.2">Section
I.2</a>.

</p><h3><a name="x3.1.5">3.1.5. SSH v1 and v2 Overview</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

<i>This section applies only to Kermit 95.</i>

</p><p>

SSH provides security (or the illusion of it) by encrypting the session.  SSH
can work in the absence of authentication, but it also offers several options
for authentication, none of them particularly secure except for Kerberos 5
GSSAPI and SRP.

</p><h4><a name="x3.1.5.1">3.1.5.1.  Host Authentication</a></h4>

There are two sides to authentication:

<p>
</p><ol>
<li>Is the host what it claims to be?
</li><li>Is the user who s/he claims to be?
</li></ol>
<p>

In its simplest form, SSH lets the user make encrypted connections without
setting up any kind of keys or other special authentication procedures or
files, and all the host administrator has to do is install the ssh server and
generate host keys.  No alteration of the host login system is required.  This
is why SSH is so popular compared to authentication methods that are more
secure and manageable: it's easy to get started.  However, this kind of SSH
connection does not authenticate the host to the client and it authenticates
the client to the host only through the password file, just like an ordinary
insecure login.  The only difference is that the session (including the
password) is encrypted, which makes hackers do a little extra work to decode
their sniffer logs and get your password.  The assumption is that hackers
won't bother to do this since unencrypted passwords are easier to steal (like
cars without steering-wheel locks), but of course this is wishful thinking.

</p><p>

The most important command to know about before you try to make an SSH
connection is SET SSH STRICT-HOST-KEY-CHECK.  The values are ON, OFF, and ASK.

</p><p>
</p><ul>

<li>ON means K95 won't make an SSH connection to a host whose public key
is not in its known-hosts file.

</li><li>OFF means K95 will connect to any SSH host.

</li><li>ASK means K95 will ask you if it's OK to connect to a host whose
key is not in its known-hosts file.  This is the default.

</li></ul>
<p>

There are two known-hosts files for each protocol version.  A user
file is stored in the <tt>\v(appdata)ssh</tt> directory and is
automatically updated based upon the connections you make.  The
system-wide known-host file is (optionally) stored in the
<tt>\v(common)ssh</tt> directory for the operating system and is never
updated by Kermit 95.  It is there to be maintained by the system
administrator.

</p><p>

Your global known-hosts files are kept in a directory common to all users:

</p><p>
</p><pre>  SSH v1:  \v(common)ssh\known_hosts
  SSH v2:  \v(common)ssh\known_hosts2
</pre>
<p>

and your user-specific (and K95-specific) known-hosts files are:

</p><p>
</p><pre>  SSH v1:  \v(appdata)ssh\known_hosts
  SSH v2:  \v(appdata)ssh\known_hosts2
</pre>
<p>

(<tt>\v(appdata)</tt> is Kermit's User Application Data Directory
variable.  The user's application data directory is located in a
system dependent manner.  Windows 95/98/98SE/ME/NT store the application
data with the user's profile.  Windows 2000/XP store the application
data in the <tt>Documents and Settings</tt> directory.
Tell K95 to "show var appdata" to see its definition.)  Thus, on Windows XP
these files are in the SSH subdirectory of your Windows APPDATA directory, e.g.:

</p><p>
</p><pre>  SSH v1:  c:\Documents and Settings\username\Application Data\Kermit 95\ssh\known_hosts
  SSH v2:  c:\Documents and Settings\username\Application Data\Kermit 95\ssh\known_hosts2
</pre>
<p>

On Windows 98 with multi-user support, this would be:

</p><p>
</p><pre>  SSH v1:  c:\WINDOWS\Profiles\username\Application Data\Kermit 95\ssh\known_hosts
  SSH v2:  c:\WINDOWS\Profiles\username\Application Data\Kermit 95\ssh\known_hosts2
</pre>
<p>

On Windows 98 without multi-user support, this would be:

</p><p>
</p><pre>  SSH v1:  c:\WINDOWS\Application Data\Kermit 95\ssh\known_hosts
  SSH v2:  c:\WINDOWS\Application Data\Kermit 95\ssh\known_hosts2
</pre>
<p>

(<tt>\v(common)</tt> is Kermit's Common Data Directory
variable.  The common data directory is located in a
system dependent manner.  Windows 95/98/98SE/ME/NT store the common application
data in the WINDOWS directory.  Windows 2000/XP stores the application
data in the <tt>Documents and Settings\All Users</tt> directory.
Tell K95 to "show var common" to see its definition.)

</p><p>

Each file contains a series of (long) "lines", one per host, each line
containing the hostname and aliases and then the key in Base 64; this is the
host's public key.  Adding a host key means appending such a line to the
appropriate file.

</p><p>

SSH STRICT-HOST-KEY-CHECK ON gives you some assurrance that the host you have
connected to is the one you meant to connect to.  But it also means your first
connection to a particular host is likely to be refused.  It's the classic
chicken-and-egg situation.  You're supposed to get host keys from a trusted
source such as a disk or CDROM from your host administrators, but if you
didn't, how do you get a key when it's on the very host you can't connect to
because you don't have its key?  The possibilities include:

</p><p>
</p><ul>

<li>You can make some other kind of trusted connection to it (e.g. with
Kerberos 5 Telnet) and download the key, or:

<p>

</p></li><li>You can tell K95 to:

<p>
</p><pre>  SET SSH STRICT-HOST-KEY-CHECK OFF <i>(or ASK)</i>
</pre>
<p>

and then make an SSH connection to the host, authenticate with your
password, and then the host key is automatically retrieved and added to
your known-hosts file, and then future connections to that host can be made
with SSH STRICT-HOST-KEY-CHECK ON.  But of course since you have bypassed
the host authentication process to obtain the key, future authentication
using this key is worthless and you might as well not have have bothered.

</p></li></ul>

<p>

You might wonder if keeping host keys is a good idea.  The advantage is the
protection they offer against man-in-the-middle attacks and DNS spoofing (but
not compromised hosts).  The disadvantage is that anybody who can access your
host keys (legitimately or not) knows which hosts you access, which in itself
might be information you'd rather not reveal, but also tells hackers which
hosts to attack in your name.  As noted, Kermit 95 (like all other SSH
clients) appends new host keys to your user host-key file(s).  You can delete
these files if you wish; for example, in your K95 ON_EXIT macro definition.

</p><h4><a name="x3.1.5.2">3.1.5.2. User Authentication</a></h4>

Independent of how the host is authenticated to K95, is the method by which
K95 authenticates you to the host:

<p>
</p><ul>
<li>Password
</li><li>Public/Private Key Pair
</li></ul>

<p>

<b>The default method of client authentication</b> (that is, the method that is
used unless you have configured K95 to use any of the other methods described
below)<b> is by prompting you locally for a password</b> and then sending it
(encrypted) to the server.  This method requires you to type your password
every time you log in (unlike, say, Kerberos 5, which gives you a "single
network login").


</p><p>

</p><blockquote>
<i>

If you must use SSH to contact a particular host, <b>we recommend simple
password authentication.</b> If this is OK with you, <a href="#x4">skip the
rest of this section</a>; otherwise keep reading.

</i>
</blockquote>
<p>

<b>You can also use public/private key pairs</b>, whose purpose is to allow
you to log in to the host <i>without typing your password</i>.  THIS IS
DANGEROUS because your keys are stored on your Windows disk, where they can be
stolen (especially easy on Windows 9x/ME PCs that are attached to the network,
yet lack any form of file-system security).  If your key files are encrypted,
they can be decrypted offline.  (The longer the passphrase for key-file
encryption, the longer it takes to perform dictionary attacks against it; a
40-character character passphrase should be considered a <i>minimum</i> but
most people don't use such a long passphrase, so most key files are ripe for
plucking.)

</p><p>

To use public/private key pairs you must have each host's public key
in your PC's <tt>\v(APPDATA)\ssh\known_hosts</tt> (SSH v1) and/or
<tt>\v(APPDATA)\ssh\known_hosts2</tt> files (SSH v2), and you must
also upload your own public key to each host and put it in the
appropriate place, such as <tt>~/.ssh/authorized_keys</tt> (SSH v1)
and/or <tt>~/.ssh/authorized_keys2</tt> (SSH v2) when OpenSSH is the
daemon.  When all the right files and keys are in the right places in
the appropriate formats, you can log in without a password.  In order to
determine the correct type of key to use you must know the configuration
of the SSH daemon.  If you are not the host administrator, contact the
appropriate administrator for assistance.  (A common error is to leave
the permissions on the <tt>~/.ssh/</tt> directory and the files it contains
world or group accessible.  SSH daemons refuse to use identity files that
are accessible to anyone other than the account owner.

</p><p>

Here's an example.  I have a guest ID on a Linux machine at a remote site.  If
I make an SSH connection to it (logging in with a password), K95's status line
shows me the SSH server's level is 2.0.  If I want to be able to connect
without typing a password, then <i>(1)</i> my end is already done, since K95
added the host's public key to my <tt>known_hosts2</tt> file the first time I
made an SSH connection to it; but <i>(2)</i> I must add my PC's public key to
my:

</p><p>
</p><pre>   
  ~/.ssh/authorized_keys2
</pre>
<p>

file on the host.  In this case there happened to be no such file.  So all I
had to do was upload my public key to the host as
<tt>~/.ssh/authorized_keys2</tt>.  But which public key?  I have three of them
(see the <a href="#sshkeycreate">SSH KEY CREATE</a> command description below):

</p><p>
</p><pre>  SSH V1 RSA key:  identity.pub
  SSH V2 DSA key:  id_dsa.pub
  SSH V2 RSA key:  id_rsa.pub
</pre>
<p>

Well, since the server uses SSH v2, I can ignore the <tt>identity.pub</tt>
file, which is only for SSH v1.  So I began by uploading my
<tt>id_dsa.pub</tt> file to my <tt>~/.ssh</tt> directory, renaming it to
<tt>authorized_keys2</tt>, logging out, and making a new ssh connection to the
same host.  It let me in without password, so I guessed right the first time.
Maybe the <tt>id_rsa.pub</tt> key would have worked too, who knows -- it
probably depends on the server.

</p><p>

But now, of course, <b>anybody who can obtain a copy of the <tt>id_dsa</tt>
private key file from my Windows disk can log in to that host as me, without a
password.</b> And it's easy for them to locate the host because it's listed in
my <tt>known_hosts2</tt> file, along with all the other hosts I connect to
with SSH v2.  So what have I accomplished?  I have pretty much left the keys
to all my houses in the street, each key neatly labeled with the address of
the house it unlocks.

</p><p>

So having satisfied myself that the key-exchange mechanism works as designed
(by the SSH designers, not us), I deleted the <tt>authorized_keys2</tt> file
from the host and I deleted all the private keys from my Windows disk.  Unlike
Kerberos identities or X.509 certificates, <b>compromised private keys can't
be revoked or even tracked down.</b> And unlike encrypted password
authentication, which must be captured in its brief moment of transit, your
key files are always available to hackers, and for that matter, to a
potentially infinite number of them at once.

</p><p>
</p><blockquote>

Note, by the way, that some SSH hosts do not support public/private key pair
authentication at all, so every combination you try will fail.  There's no way
to know this without the host administrator telling you, or by exhausting all
the combinations.

</blockquote>
<p>

Since public/private key-pair authentication is unsafe, K95 also supports two
<i>secure</i> authentication methods for SSH v2 that do do not require
public/private key pairs:

</p><p>
</p><ul>

<li><a href="ftp://ftp.isi.edu/in-notes/rfc1964.txt">GSSAPI</a> (Generic
Security Services Application Programming Interface), which hooks into the
Kerberos 5 authentication system.

<p>

</p></li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2945.txt">SRP</a>
(Secure Remote Password),
<a href="http://www-cs-students.stanford.edu/%7Etjw/srp/">Stanford University</a>

</li></ul>
<p>

Of course, secure authentication for SSH clients requires <a href="#xa1.5">modified SSH servers, which are available</a>.
GSSAPI does not require host keys at all since Kerberos authentication is
mutual.

</p><p>

The complete list of K95's SSH v2 authentication methods is:

</p><p>
</p><dl><dt><tt><b>external-keyx</b></tt></dt><dd>Use the authentication performed as a side-effect of an key
exchange algorithm such as GSSAPI.
<p>
</p></dd><dt><tt><b>gssapi</b></tt></dt><dd>Kerberos 5 identity (requires Kerberos 5 to be installed at the
host site and an SSH server that can authenticate your K5 identity).
<p>
</p></dd><dt><tt><b>hostbased</b></tt></dt><dd>Like Rlogin (<tt>.rhosts</tt> file, not secure)
<p>
</p></dd><dt><tt><b>keyboard-interactive</b></tt></dt><dd>Kermit prompts you locally for authentication info such as
host password (or anything else the host might require). 
<p>
</p></dd><dt><tt><b>password</b></tt></dt><dd>Kermit prompts you locally for a single host password.
<p>
</p></dd><dt><tt><b>publickey</b></tt></dt><dd>Public/private key-pair exchange (supported but not recommended, 
and not supported by Columbia's SSH servers).
<p>
</p></dd><dt><tt><b>srp-gex-sha1</b></tt></dt><dd>Secure Remote Password (SRP, secure; requires an SSH server on the host
that performs SRP authentication).

</dd></dl>

<h3><a name="x3.2"><hr>3.2. Security Command List</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#glossary">Glossary</a> ]

SECTION CONTENTS

<p>
</p><pre>  3.2.1. <a href="#x3.2.1">Connection Establishment</a>
  3.2.2. <a href="#x3.2.2">The SET AUTHENTICATION Command</a>
  3.2.3. <a href="#x3.2.3">The AUTHENTICATE Command</a>
  3.2.4. <a href="#x3.2.4">Other Security-Related Commands</a>
</pre>
<p>

The following notation is used in Kermit command syntax descriptions:
</p><p>

</p><dl><dt><b>KEYWORD</b>
</dt><dd>Command keywords are shown in boldface.  These are literal words to
be used in the command.  Alphabetic case does not matter.  Keywords can
be abbreviated to any degree that does not produce a conflict with any other
keyword that can be used in the same position.

<p>

</p></dd><dt><i>parameter</i>
</dt><dd>Parameter names are shown in italics; they are to be replaced by an
actual value; for example, <i>number</i> might be replaced by 123, and
<i>filename</i> might be replaced by <tt>oofa.txt</tt>.

<p>

</p></dd><dt><i>[ thing ]</i>
</dt><dd>Any item enclosed in italicized square brackets is optional; that is,
it can be omitted.

<p>

</p></dd><dt><i>{ thing1, thing2, ... }</i>
</dt><dd>Italicized curly braces enclose a list of choices: pick one.

<p>

</p></dd><dt><tt>oofa.txt</tt>
</dt><dd>Typewriter font is used for computer messages, dialogs, code,
and filenames.

</dd></dl>

In all Kermit commands:

<p>
</p><ul>
<li>KERBEROS4 can be abbreviated KRB4 or K4
</li><li>KERBEROS5 can be abbreviated KRB5 or K5
</li></ul>
<p>

Some of Kermit's Kerberos-related commands are rather complex, but remember
that you don't have to memorize them, or any other Kermit commands.  Use
"<tt>?</tt>" at any point to feel your way through the command, or type HELP
for the desired command to see a brief explanation.  If you would like to
have a tutorial in Kermit basics before proceeding, please visit:

</p><p>

</p><dl><dt><i>The C-Kermit Tutorial</i>
</dt><dd><a href="http://www.columbia.edu/kermit/ckututor.html">
<tt>http://www.columbia.edu/kermit/ckututor.html</tt></a>
<p>
</p></dd><dt><i>The Kermit 95 Tutorial</i>
</dt><dd><a href="http://www.columbia.edu/kermit/k95tutor.html">
<tt>http://www.columbia.edu/kermit/k95tutor.html</tt></a>
<p>
</p></dd><dt><i>Kermit Script Tutorial and Library</i>
</dt><dd><a href="http://www.columbia.edu/kermit/ckscripts.html">
<tt>http://www.columbia.edu/kermit/ckscripts.html</tt></a>
</dd></dl>

<p>

Before you try to make any secure connections, you should check whether your
version of Kermit has the required capabilities.  The SHOW FEATURES command
lists the security methods that are and are not included.  In addition the
following commands can be used (typically in scripts) to check for specific
security features:

</p><p>

</p><dl><dt><b>CHECK KERBEROS</b>
</dt><dd>tells whether your version of Kermit has been built
to include Kerberos protocol (even if it cannot function on your system).
Succeeds if Kerberos is included, fails if it isn't.  The CHECK command can
be used in scripts like this:

<p>
</p><pre>  check kerberos
  if success {
      <i>Commands to execute if Kerberos is built in.</i>
  } else {
      <i>Commands to execute if Kerberos is not built in.</i>
  }
</pre>

<p>

</p></dd><dt><b>CHECK NTLM</b>
</dt><dd>Tells whether your version of Kermit has been built
to include the NTLM support even if it cannot function on your system,
and succeeds or fails accordingly.

<p>

</p></dd><dt><b>CHECK SRP</b>
</dt><dd>Tells whether your version of Kermit has been built
to include SRP protocols.  Succeeds or fails accordingly.

<p>

</p></dd><dt><b>CHECK SSH</b>
</dt><dd>Tells whether your version of Kermit has been built
to include SSH (even if it cannot function on your system).
Succeeds or fails accordingly.

<p>

</p></dd><dt><b>CHECK SSL/TLS</b>
</dt><dd>Tells whether your version of Kermit has been built
to include SSL/TLS (even if it cannot function on your system).
Succeeds or fails accordingly.

<p>

</p></dd><dt><b>IF AVAILABLE ENCRYPTION</b> <i>command</i>

</dt><dd>Executes the <i>command</i> if session encryption is available in your
version of Kermit (e.g. in K95 if the <tt>K95CRYPT.DLL</tt> file is installed
on your PC).  Example:
<p>
</p><pre>  if available encryption set telnet encryption type cast128_cfb64
</pre>
<p>

</p></dd><dt><b>IF AVAILABLE KERBEROS4</b> <i>command</i>
</dt><dd>Executes the <i>command</i> if 
Kerberos 4 is available in your version of Kermit 
(e.g. if the Kerberos 4 DLLs are installed on your PC).

<p>

</p></dd><dt><b>IF AVAILABLE KERBEROS5</b> <i>command</i>
</dt><dd>Executes the <i>command</i> if 
Kerberos 5 is available in your version of Kermit.

<p>

</p></dd><dt><b>IF AVAILABLE NTLM</b> <i>command</i>
</dt><dd>Executes the <i>command</i> if Microsoft NT LAN Manager protocol is
available in your version of Kermit.

<p>

</p></dd><dt><b>IF AVAILABLE SRP</b> <i>command</i>
</dt><dd>Executes the <i>command</i> if 
Secure Remote Password protocol is available
in your version of Kermit.

<p>

</p></dd><dt><b>IF AVAILABLE SSH</b> <i>command</i>
</dt><dd>Executes the <i>command</i> if 
SSH protocol is available in your version of Kermit.

<p>

</p></dd><dt><b>IF AVAILABLE</b> <i>{</i> <b>SSL, TLS</b> <i>} command</i>

</dt><dd>Executes the <i>command</i> if SSL/TLS protocol is available in your
version of Kermit.

</dd></dl>

<h3><a name="x3.2.1"><hr>3.2.1. Connection Establishment</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

SUBSECTION CONTENTS

</p><p>
</p><pre>  3.2.1.1. <a href="#x3.2.1.1">Secure Telnet Connections</a>
  3.2.1.2. <a href="#x3.2.1.2">SSH Connections</a>
  3.2.1.3. <a href="#x3.2.1.3">Secure FTP Connections</a>
  3.2.1.4. <a href="#x3.2.1.4">Secure HTTP Connections</a>
</pre>

<h4><a name="x3.2.1.1">3.2.1.1. Secure TELNET Connections</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.2">Section Contents</a> ]
[ <a href="#x3.2.1">Subsection Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The Telnet protocol is one of the most flexible protocols ever used on
computer networks, and therefore can be somewhat complicated when its advanced
options come into play.  Kermit has commands to manage every aspect of the
Telnet connection.  Kermit's Telnet engine and related commands are thoroughly
described in the Kermit Telnet Reference:

</p><p>
</p><pre>  <a href="http://www.columbia.edu/kermit/telnet.html">http://www.columbia.edu/kermit/telnet.html</a>
</pre>
<p>

(which you should read if you're not familiar with Kermit's Telnet client).
This section focuses on Telnet-related commands for making secure connections.

</p><p>

Four Telnet Options can be negotiated between a Telnet client and server that
affect secure connections: <tt>AUTH</tt>, <tt>ENCRYPT</tt>,
<tt>START_TLS</tt>, and <tt>FORWARD_X</tt>.  When people talk about Telnet not
being secure they are referring to Telnet clients and servers that can't
negotiate any of these four options (because they have not been coded to do
so).  That does not mean that secure Telnet clients (such as Kermit) and
servers (<a href="#xa1">Appendix I</a>) are not readily available.

</p><p>

Telnet sessions always begin in an insecure state.  Only after the initial
negotiations are complete can the session be secured.  Security in Telnet can
be established using many combinations of Telnet Options and authentication
and encryption methods.

</p><p>

The <tt>AUTH</tt> option negotiates whether authentication is to be used for
the current session, and if so, which type of authentication.  The
authentication type is determined by the server offering an ordered list of
types and the client choosing the most preferred type that it supports.  Most
forms of authentication generate a shared secret that can be used with the
<tt>ENCRYPT</tt> option for privacy.  The
<tt>How</tt> and <tt>Encrypt</tt> flags specify an authentication
mode and whether encryption is required for this connection.  The <tt>AUTH</tt>
option can be negotiated with either the <tt>START_TLS</tt> or the
<tt>ENCRYPT</tt> option, but not both.

</p><p>

The following commands control Kermit's Telnet security negotiation
policies and procedures:

</p><p>

</p><dl><dt><b>SET TELOPT</b><i> [ {</i> <b>/CLIENT, /SERVER</b><i> } ]</i><b>
AUTHENTICATION</b> <i>{</i> <b>ACCEPTED, REFUSED, REQUESTED, REQUIRED</b>
<i>}</i>

</dt><dd>Tells Kermit to ACCEPT or REFUSE authentication bids, or actively REQUEST
authentication.  REQUIRED refuses and closes the connection if authentication
is not successfully negotiated when either making or accepting connections.
The default is REQUESTED.

<p>
</p></dd><dt><b>SET TELNET AUTHENTICATION TYPE </b><i>{</i> <b>AUTOMATIC, KERBEROS4,
KERBEROS5, NTLM, SRP, SSL, NONE</b> <i>}</i>

</dt><dd>AUTOMATIC is the default.  Available options can vary depending on the
features Kermit was built to support and the operating system configuration;
type "<tt>set</tt> <tt>telnet</tt> <tt>auth</tt> <tt>type</tt> <tt>?</tt>" for
a list (Hint: keywords in Kermit commands can be abbreviated).

<p>

</p></dd><dl><dt><i>When Kermit is the Telnet client:</i>

</dt><dd>AUTOMATIC allows the host to choose the preferred type of authentication.
NONE instructs Kermit to refuse all authentication methods when the
authentication option is negotiated.  A list of one or more other values
allow a specific subset of the supported authentication methods to be
used.

<p>

</p></dd><dt><i>When Kermit is the Telnet server:</i>

</dt><dd>AUTOMATIC results in available authentication methods being offered to the
Telnet client in the following order: <tt>KERBEROS_V</tt>,
<tt>KERBEROS_IV</tt>, <tt>SRP</tt>, <tt>SSL</tt>, <tt>NTLM</tt>.

</dd></dl><p>

NONE results in no authentication methods being offered to the Telnet
server when the authentication option is negotiated.  The preferred
method of disabling authentication is with
SET TELOPT /SERVER AUTHENTICATION REFUSE.

</p><p>

A list of one or more authentication methods specifies the order those
methods are to be offered to the telnet client.

</p><p>

If you wish to allow NTLM authentication to be used with the Microsoft
Windows 2000 or Services for Unix Telnet client you must specify a list
with NTLM as the first item in the list.  By default, NTLM is the last
item in the list because it does not provide any form of data encryption.

</p><p>

</p><dt><b>SET TELNET AUTHENTICATION HOW-FLAG </b><i>{</i> <b>ANY, MUTUAL,
ONE-WAY</b> <i>}</i>

</dt><dd>Specifies which values for the HOW-FLAG should be accepted as a client
or offered as a server.  The default is ANY.

<p>

</p></dd><dt><b>SET TELNET AUTHENTICATION ENCRYPT-FLAG</b> <i>{</i> <b>ANY, NONE,
TELOPT, TLS</b> <i>}</i>

</dt><dd>Specifies which values for the ENCRYPT-FLAG should be accepted as a client
or offered as a server.  The default is ANY.

</dd></dl>
<p>

The Telnet protocol ENCRYPT option is used to negotiate whether streaming
ciphers are to be used to protect the privacy of the connection, and if so,
which encryption type to use in each direction.  The encryption type is
determined by each side offering the list of types it can use to receive data.
Then the sender chooses the first type that it supports from the list.  The
ENCRYPT option cannot be negotiated without the AUTH option.  Whenever both
START_TLS and ENCRYPT are both available, START_TLS is used since TLS provides
both privacy and integrity to the data stream.

</p><p>
</p><dl><dt><b>SET TELOPT</b> <i>[ {</i> <b>/CLIENT, /SERVER</b> <i>} ]</i><b>
ENCRYPTION</b><i> { </i><b>ACCEPTED, REFUSED, REQUESTED, REQUIRED</b> <i>}
{ </i><b>ACCEPTED, REFUSED, REQUESTED, REQUIRED</b><i> }</i>

</dt><dd>The first parameter specifies the Kermit-to-peer state.  The second
parameter specifies the peer-to-Kermit state.  The default is ACCEPTED
REQUESTED: Kermit accepts encryption if offered, and requests it in case it
is not offered.

<p>

</p></dd><dt><b>SET TELNET ENCRYPTION TYPE</b> <i>{</i><b> AUTOMATIC, CAST128_CFB64,
CAST128_OFB64, CAST5_40_CFB64, CAST5_40_OFB64, DES_CFB64, DES_OFB64,
DES3_CFB64, DES3_OFB64, NONE</b><i> }</i>

</dt><dd>AUTOMATIC allows the host to choose the preferred type of encryption.
Other values allow a specific encryption method to be specified.  AUTOMATIC is
the default.  The list of options varies depending on the encryption types
selected when Kermit was compiled.  An encryption method can be used only if
there is enough key data available.  Kerberos 4 can use only DES encryption
because it provides a shared secret just 56 bits in length.

</dd></dl>
<p>

The START_TLS option negotiates whether the current session is to be protected
by Transport Layer Security (TLS), the same protocol used to secure all of the
HTTP Web sites on the Internet.  TLS uses X.509 certificates or Kerberos 5
credentials to authenticate the server and optionally authenticate the client.

</p><p>

START_TLS can be used with AUTH to allow Kerberos, Secure Remote Password, or
other authentication methods to be used to authenticate the client.  START_TLS
can not be used with the ENCRYPT option.  Nor is there any
need to since the protection provided by TLS is stronger than all of the
streaming ciphers supported by the ENCRYPT option.

</p><p>
</p><dl><dt><b>SET TELOPT</b> <i>[ {</i><b> /CLIENT, /SERVER</b><i> } ]</i>
<b>START_TLS </b><i>{</i><b> ACCEPTED, REFUSED, REQUESTED,
REQUIRED</b><i> }</i>

</dt><dd>ACCEPT or REFUSE a request to negotiate TLS, or actively REQUEST
that TLS be negotiated.  REQUIRED refuses and closes the connection if
the peer refuses to negotiate TLS or the TLS negotiations end in failure.
ACCEPTED by default when a client.  REQUESTED by default when a server.

</dd></dl>
<p>

After the Telnet session is established and protected, it is possible to use
it to protect the data associated with X Windows System clients started on
the remote host via the Telnet session.  The <b>FORWARD_X</b> option is
used to negotiate and implement the protection of X Windows Systems data.

</p><p>
</p><dl><dt><b>SET TELOPT</b> <i>[ {</i> <b>/CLIENT</b><i> } ]</i> <b>FORWARD_X</b>
<i>{</i><b> ACCEPTED, REFUSED, REQUESTED, REQUIRED</b><i> }</i>

</dt><dd>ACCEPT or REFUSE a request to negotiate FORWARD_X, or actively REQUEST
that FORWARD_X be negotiated.  REQUIRED refuses and closes the connection if
the peer refuses to negotiate FORWARD_X or the FORWARD_X negotiations end in
failure.  ACCEPTED by default when a client.  Kermit does not support
FORWARD_X when it is a server.

</dd></dl>
<p>

After a Telnet session is authenticated and protected it is possible to
forward the credentials used to authenticate the session to the host.  When
credentials are forwarded to the host you do not need to enter your password
when making additional connections from it.  This is referred to as <i>Single
Sign-On</i>.  Credentials forwarding is currently only supported when the
authentication method is Kerberos 5.

</p><p>
</p><dl><dt><b>SET TELNET AUTHENTICATION FORWARDING</b>
<i>{</i> <b>ON, OFF</b> <i>}</i>

</dt><dd>When Kermit is the client, set this to ON to forward forwardable Kerberos
V Ticket Granting Tickets to the host after authentication is complete, so you
can make additional authenticated connections from there.  When Kermit is the
server, set this to ON to accept forwardable Kerberos V TGTs from the client.
OFF by default.

</dd></dl>
<p>

When establishing a secure connection there are potentially three usernames
associated with the connection: the name of the user on the local machine; the
name under which the user authenticates (the Kerberos principal name or X.509
certificate name); and the name the user wants to login as.  The login name
can be set with either of the following commands:

</p><dl><dt><b>SET TELNET ENVIRONMENT USER </b><i>name</i>
</dt><dt><b>SET LOGIN USERID </b><i>name</i>

</dt><dd>If a <i>name</i> is given, it sent to host during Telnet negotiations; if
this switch is given but the string is omitted, no user ID is sent to the
host.  If this command is not given, your current USERID value,
<tt>\v(userid)</tt>, is sent.  When a userid is sent to the host it is a
request to login as the specified user.

</dd></dl>
<p>

All forms of authentication rely on some secret information that only the user
(or service) being authenticated knows or has in their possession.  Before
Kermit can authenticate as the user it must acquire this secret information.
This is usually done by prompting the user for the necessary information at
the time of authentication.  But what if you need to automate the process?
The SET LOGIN PASSWORD command can be used to specify the password to Kermit
prior to establishing the connection.  However, we strongly advise that this
command be used in a script that prompts for the password and then establishes
the automated connection later.  Storing a password in a script file defeats
all of the hard work you have done to secure your connections.

</p><p>

An NTLM user ID consists of both a DOMAIN and a username.  This is set in
Kermit as <tt>SET</tt> <tt>LOGIN</tt> <tt>USER</tt>
<tt><i>DOMAIN</i>\\<i>username</i></tt> due to the use of backslash
(<tt>\</tt>) as the command quote character in Kermit's command lanaguage.

</p><p>
</p><dl><dt><b>SET LOGIN PASSWORD </b><i>password</i>

</dt><dd>If a <i>password</i> is given, it is treated as the password to be used (if
required) by any Telnet Authentication protocol (Kerberos Ticket retrieval,
Secure Remote Password (SRP), or X.509 certificate private key decryption).
If no password is specified a prompt is issued to request the password if
one is required for the negotiated authentication method.

</dd></dl>
<p>

If things go wrong when establishing a secure connection it is useful to be
able to watch the telnet negotiations.  Even when things go smoothly
it can be fun to watch all of the action.

</p><p>
</p><dl><dt><b>SET TELNET DEBUG ON</b>
</dt><dd>Displays all TELNET negotiations in full detail.
</dd></dl>
<p>

</p><h4><a name="x3.2.1.2">3.2.1.2. SSH Connections</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.2">Section Contents</a> ]
[ <a href="#x3.2.1">Subsection Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

</p><dl><dt><b><b>SET SSH AGENT-FORWARDING
</b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>If an authentication agent (ssh-agent.exe) is in use, setting this value
to ON results in the connection to the agent being forwarded to the remote
computer.  The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH CHECK-HOST-IP </b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether the remote host's ip-address should be checked against
the matching host key in the known_hosts file.  This can be used to determine
if the host key changed as a result of DNS spoofing.  The default is ON.

<p>

</p></dd><dt><b><b>SET SSH COMPRESSION </b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether compression will be used.  The default is ON.

<p>

</p></dd><dt><b><b>SET SSH DYNAMIC-FORWARDING
</b><i>{</i> <b>ON, OFF</b> <i>}</i></b></dt><dd>Specifies whether Kermit is to act as a SOCKS4 service on port 1080 when
connected to a remote host via SSH.  When Kermit acts as a SOCKS4 service, it
accepts connection requests and forwards the connections through the remote
host.  The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH GATEWAY-PORTS </b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether Kermit should act as a gateway for forwarded
connections received from the remote host.  The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH GSSAPI DELEGATE-CREDENTIALS
</b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether Kermit should delegate GSSAPI credentials to the remote
host after authentication.  Delegating credentials allows the credentials to
be used from the remote host.  The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH IDENTITY-FILE</b>
<i>filename [ filename [ ... ] ]</i></b></dt><dd>Specifies one or more files from which the user's authorization identities
(private keys) are to be read when using public key authorization.  These are
files used in addition to the default files:

<p>
</p><pre>  V1 RSA:  \v(appdata)ssh/identity
  V2 RSA:  \v(appdata)ssh/id_rsa
  V2 DSA:  \v(appdata)ssh/id_dsa
</pre>
<p>

</p></dd><dt><b><b>SET SSH KERBEROS4 TGT-PASSING</b>
<i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether Kermit should forward Kerberos 4 TGTs to the host.
The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH KERBEROS5 TGT-PASSING
</b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether Kermit should forward Kerberos 5 TGTs to to the host.
The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH PRIVILEGED-PORT
</b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether a privileged port (less than 1024) should be used
when connecting to the host.  Privileged ports are not required except when
using SSH V1 with Rhosts or RhostsRSA authorization.  The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH QUIET </b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether all messages generated in conjunction with SSH
protocols should be suppressed.  The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH STRICT-HOST-KEY-CHECK</b>
<i>{</i><b> ASK, ON, OFF </b><i>}</i></b></dt><dd>Specifies how Kermit should behave if the the host key check fails.  When
strict host key checking is OFF, the new host key is added to the
protocol-version-specific user-known-hosts-file.  When strict host key
checking is ON, the new host key is refused and the connection is dropped.
When set to ASK, Kermit prompt you to say whether the new host key should be
accepted.  The default is ASK.  Strict host key checking protects you against
Trojan horse attacks.  It depends on you to maintain the contents of the
known-hosts-file with current host keys.

<p>

</p></dd><dt><b><b>SET SSH USE-OPENSSH-CONFIG
</b> <i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether Kermit should parse an OpenSSH configuration file after
applying Kermit's SET SSH commands.  The configuration file would be located
at <tt>\v(appdata)ssh/ssh_config</tt>.  The default is OFF.

<p>

</p></dd><dt><b><b>SET SSH V1 CIPHER
</b><i>{</i><b> 3DES, BLOWFISH, DES </b><i>}</i></b></dt><dd>Specifies which cipher should be used to protect SSH version 1
connections.  The default is 3DES.

<p>

</p></dd><dt><b><b>SET SSH V1 GLOBAL-KNOWN-HOSTS-FILE </b><i>filename</i></b></dt><dd>Specifies the location of the system-wide known-hosts file.  The
default location depends on the operating system:

<p>
</p><pre>  Windows 95/98/98SE/ME:  %windir%\ssh_known_hosts
  Windows NT/2000/XP:     \v(common)ssh\ssh_known_hosts
</pre>
<p>

</p></dd><dt><b><b>SET SSH V1 USER-KNOWN-HOSTS-FILE </b><i>filename</i></b></dt><dd>Specifies the location of the user-known-hosts-file.  The default
location is:

<p>
</p><pre>  \v(appdata)ssh/known_hosts
</pre>
<p>

</p></dd><dt><b><b>SET SSH V2 AUTHENTICATION</b>
<i>{</i><b> EXTERNAL-KEYX, GSSAPI, HOSTBASED, KEYBOARD-INTERACTIVE, PASSWORD,
PUBKEY, SRP-GEX-SHA1 </b><i>} [ ... ]</i></b></dt><dd>Specifies an ordered list of SSH version 2 authentication methods to
be used when connecting to the remote host.  The default list is:

<p>
</p><pre>  external-keyx gssapi hostbased publickey srp-gex-sha1 
  keyboard-interactive password none
</pre>
<p>

</p></dd><dt><b><b>SET SSH V2 CIPHERS </b><i>{</i><b> 3DES-CBC, AES128-CBC,
AES192-CBC, AES256-CBC, ARCFOUR, BLOWFISH-CBC, CAST128-CBC, RIJNDAEL128-CBC,
RIJNDAEL192-CBC, RIJNDAEL256-CBC </b><i>}</i></b></dt><dd>Specifies an
ordered list of SSH version ciphers to be used to encrypt the established
connection.  "Rijndael" is an alias for "aes".  The default list is:

<p>
</p><pre>  aes128-cbc 3des-cbc blowfish-cbc cast128-cbc arcfour aes192-cbc aes256-cbc
</pre>
<p>

</p></dd><dt><b><b>SET SSH V2 GLOBAL-KNOWN-HOSTS-FILE </b><i>filename</i></b></dt><dd>Specifies the location of the system-wide known-hosts file.  The
default location depends on the operating system:

<p>
</p><pre>  Windows 95/98/98SE/ME: %windir%\ssh_known_hostss
  Windows NT/2000/XP:    \v(common)ssh\ssh_known_hosts2
</pre>
<p>

</p></dd><dt><b><b>SET SSH V2 HOSTKEY-ALGORITHMS
</b><i>{</i><b> SSH-DSA, SSH-RSA </b><i>}</i></b></dt><dd>Specifies an ordered list of hostkey algorithms to be used to verify
the identity of the host.  The default list is

<p>
</p><pre>  ssh-rsa ssh-dsa
</pre>
<p>

</p></dd><dt><b><b>SET SSH V2 MACS </b><i>{</i><b>
HMAC-MD5 HMAC-MD5-96 HMAC-RIPEMD160 HMAC-SHA1 HMAC-SHA1-96</b>
<i>}</i></b></dt><dd>Specifies an ordered list of Message Authentication Code algorithms to be
used for integrity protection of the established connection.  The default list
is:

<p>
</p><pre>  hmac-md5 hmac-sha1 hmac-ripemd160 hmac-sha1-96 hmac-md5-96
</pre>
<p>

</p></dd><dt><b><b>SET SSH V2 USER-KNOWN-HOSTS-FILE </b><i>filename</i></b></dt><dd>Specifies the location of the user-known-hosts file.  The default
location is:

<p>
</p><pre>  \v(appdata)ssh/known_hosts2
</pre>
<p>

</p></dd><dt><b><b>SET SSH VERBOSE </b><i>level</i></b></dt><dd>Specifies how many messages should be generated by the OpenSSH engine.
The level can range from 0 to 7.  The default value is 2.

<p>

</p></dd><dt><b><b>SET SSH VERSION </b><i>{</i><b> 1, 2, AUTOMATIC </b><i>}</i></b></dt><dd>Specifies which SSH version should be negotiated.  The default is
AUTOMATIC which means use version 2 if supported; otherwise to fall
back to version 1.

<p>

</p></dd><dt><b><b>SET SSH X11-FORWARDING </b><i>{</i><b> ON, OFF </b><i>}</i></b></dt><dd>Specifies whether X Windows System Data is to be forwarded across the
established SSH connection.  The default is OFF.  When ON, the DISPLAY
value is either set using the SET TELNET ENV DISPLAY command or read
from the DISPLAY environment variable.

<p>

</p></dd><dt><b><b>SET SSH XAUTH-LOCATION </b><i>filename</i></b></dt><dd>Specifies the location of the xauth executable (if provided with the
X11 Server software.)

</dd></dl>
<p>

</p><h4><a name="x3.2.1.3"><hr>3.2.1.3. Secure FTP Connections</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.2">Section Contents</a> ]
[ <a href="#x3.2.1">Subsection Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

C-Kermit 8.0 and Kermit 95 2.00 provide support for authenticated
and encrypted file transfers using Kerberos 4, GSSAPI-Kerberos 5, Secure Remote
Password (SRP), Secure Sockets Layer (SSL), and Transport Layer Security (TLS).

</p><p>

Complete details on how to use the FTP support can be found at the <a href="http://www.columbia.edu/kermit/ftpclient.html">Kermit website</a>.  Here
we explain how to make secure FTP connections (server willing) with the FTP
OPEN command:

</p><p>
</p><dl><dt><b>FTP</b> <i>[</i> <b>OPEN</b> <i> [ {</i> <b>/SSL</b>, <b>/TLS</b> <i>} ] ]
hostname [ port ] [ switches ]</i></dt><dd>Opens a connection to the FTP server on the given host.  The default
TCP port is 21 (or 990 if /SSL or /TLS are specified), but a different 
port number can be supplied if necessary.  /SSL or /TLS should be used
if the FTP daemon is accessed through an SSL Proxy Server.  
Optional switches are:

<p>

</p></dd><dl><dt><b>/ANONYMOUS</b></dt><dd>Logs you in anonymously.
<p>

</p></dd><dt><b>/USER:</b><i>text</i></dt><dd>Supplies the given text as your username.
<p>

</p></dd><dt><b>/PASSWORD:</b><i>text</i></dt><dd>Supplies the given text as your password.  If you include a username
but omit this switch and the server requires a password, you are
prompted for it.

<p>

</p></dd><dt><b>/ACCOUNT:</b><i>text</i></dt><dd>Supplies the given text as your account, if required by the server.
<p>

</p></dd><dt><b>/ACTIVE</b></dt><dd>Forces an active (rather than passive) connection.
<p>

</p></dd><dt><b>/PASSIVE</b></dt><dd>Forces a passive (rather than active) connection.
</dd></dl></dl>
<p>

The following commands configure the use of FTP Security when establishing
connections:

</p><p>
</p><dl><dt><b>SET FTP AUTHTYPE</b> <i>list</i></dt><dd>Specifies an ordered list of authentication methods to be attempted when FTP
AUTOAUTHENTICATION is ON.  The default list is: GSSAPI-KRB5, SRP, KERBEROS_V4,
TLS, SSL.  
If none of the specified methods are supported by the server, an insecure login
is used as a fallback. 
It should be noted that TLS and SSL can be used to secure an
anonymous connection.

<p>
</p></dd><dt><b>SET FTP AUTOAUTHENTICATION</b>
<i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i></dt><dd>Specifies whether or not authentication should be negotiated by the
FTP OPEN command.  Default is ON.

<p>

</p></dd><dt><b>SET FTP AUTOENCRYPTION</b>
<i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i></dt><dd>Specifies whether encryption and message integrity (privacy) should be 
negotiated by the FTP OPEN command.  Default is ON.

<p>

</p></dd><dt><b>SET FTP AUTOLOGIN</b>
<i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i></dt><dd>Tells Kermit whether to try to automatically log you in (using the
FTP USER command) during the FTP OPEN command.  Default is ON.

<p>

</p></dd><dt><b>SET FTP COMMAND-PROTECTION-LEVEL</b> <i>{</i>
<b>CLEAR</b>, <b>CONFIDENTIAL</b>, <b>PRIVATE</b>,
<b>SAFE</b> <i>}</i></dt><dd>Tells what level of protection is applied to the FTP command channel.
CLEAR means no protection at all.  CONFIDENTIAL means the 
messages are encrypted but not integrity protected.  PRIVATE means
the messages are encrypted and integrity protected.  SAFE means
the messages are integrity protected but not encrypted.

<p>

</p></dd><dt><b>SET FTP CREDENTIAL-FORWARDING</b>
<i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i></dt><dd>Specifies whether end-user credentials are to be forwarded
to the server if supported by the authentication method.  At the moment
only GSSAPI-KRB5 supports credentials forwarding.

<p>

</p></dd><dt><b>SET FTP DATA-PROTECTION-LEVEL</b> <i>{</i> <b>CLEAR</b>,
<b>CONFIDENTIAL</b>, <b>PRIVATE</b>, <b>SAFE</b> <i>}</i></dt><dd>Tells what level of protection is applied to the FTP data channel.
The levels are the same as for SET FTP COMMAND-PROTECTION-LEVEL.

<p>

</p></dd><dt><b>SET FTP SRP CIPHER <i>cipher</i></b></dt><dd>Specifies a cipher to be used to encrypt FTP data if SRP security
is negotiated.  The default cipher is DES3_ECB.

<p>

</p></dd><dt><b>SET FTP SRP HASH <i>hash</i></b></dt><dd>Specifies a hash to be used to integrity protect FTP data if SRP
security is negotiated.  The default hash is SHA1.

</dd></dl>
<p>

</p><h4><a name="x3.2.1.4"><hr>3.2.1.4. Secure HTTP Connections</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.2">Section Contents</a> ]
[ <a href="#x3.2.1">Subsection Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>
Reference:
<a href="http://www.columbia.edu/kermit/ckermit80.html#x2.2">Kermit HTTP
Client Documentation</a>

</p><p>

C-Kermit 8.0 and Kermit 95 2.00 provide support for secure HTTP requests via
the use of SSL or TLS.  Secure connections are established automatically when
the destination service name is "https" or the port number is 443.
Alternatively, SSL or TLS may be utilized with arbitrary port numbers if you
include the appropriate switch in the HTTP OPEN command:

</p><p>
</p><dl><dt><b>HTTP</b> <i>[ switches ] </i> <b>OPEN</b>
<i>[ {</i> <b>/SSL</b>, <b>/TLS</b> <i>} ]</i>
<i>hostname [ service/port ]</i></dt><dd>Instructs Kermit to open a new connection for HTTP communication with the
specified host on the specified port.  The default port is "http" (80).  If
/SSL or /TLS are specified a secure connection is established.  If
<i>switches</i> are specified, they are applied to all subsequent HTTP actions
(GET, PUT, ...)  until an HTTP CLOSE command has been executed.

</dd></dl>
<p>


</p><h3><a name="x3.2.2"><hr>3.2.2. The SET AUTHENTICATION Command</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The SET AUTHENTICATION command lets you configure Kermit's authentication
methods and set defaults for the <a href="#x3.2.3">AUTHENTICATE command</a> so
you don't always have to include all the switches if you give more than one
AUTHENTICATE command in a Kermit session.

</p><p>

If you always use the same setup, you can put the appropropriate SET
AUTHENTICATION commands in your Kermit customization file:
<tt>K95CUSTOM.INI</tt> (Windows) or <tt>~/.mykermrc</tt> (UNIX).

</p><h3><a name="x3.2.2.1">3.2.2.1. SET AUTHENTICATION Commands for Kerberos</a></h3>

<dl><dt><b>SET AUTHENTICATION</b> <i>{</i><b> KERBEROS5</b><i> }</i>
<b>ADDRESSES</b> <i>{ list-of-IP-addresses }</i>

</dt><dd>When a list of IP addresses is specified, these addresses are added
to the contents of Kerberos 5 tickets retrieved via Kermit commands.

<p>

</p></dd><dt><b>SET AUTHENTICATION</b> <i>{</i><b> KERBEROS4, KERBEROS5</b> <i>}</i>
<b>AUTODESTROY</b><i> {</i><b> ON-CLOSE, ON-EXIT, NEVER </b><i>}</i>

</dt><dd>When ON, Kermit destroys all credentials in the default
credentials cache upon Kermit termination.  Default is NEVER.

<p>

</p></dd><dt><b>SET AUTHENTICATION </b>{<b> KERBEROS4, KERBEROS5</b>
<i>}</i><b> AUTOGET</b><i> {</i><b> ON, OFF</b><i> }</i>

</dt><dd>When ON and the protocol is TELNET or FTP, 
if the host offers Kerberos 4 or Kerberos 5 authentication and
Kermit is configured to use that authentication method and there is no
TGT, Kermit automatically attempts to retrieve one by prompting for the
password (and principal if needed.)  Default is ON.

<p>

</p></dd><dt><b>SET AUTHENTICATION KERBEROS5 CREDENTIALS-CACHE </b><i>cache-name</i>

</dt><dd>Specifies an alternative credentials cache, useful when you need to
maintain two or more sets of credentials for different realms or roles.  The
default is specified by the environment variable KRB5CCNAME or as reported by
the Kerberos 5 library.

<p>

</p></dd><dt><b>SET AUTHENTICATION</b> <i>{</i><b> KERBEROS4, KERBEROS5</b>
<i>}</i><b> CHECK-ADDRESSES</b><i> {</i><b> ON, OFF </b><i>}</i>

</dt><dd>When ON, Kermit uses the embedded IP address(es) in the ticket to
determine validity.  When OFF, IP addresses are ignored by Kermit.
The default is ON.

<p>

</p></dd><dt><b>SET AUTHENTICATION KERBEROS5 FORWARDABLE
</b><i>{</i><b> ON, OFF </b><i>}</i>

</dt><dd>ON specifies that Kerberos 5 credentials should be forwardable to the
host.  If SET TELNET AUTHENTICATION FORWARDING is ON, forwardable
credentials are sent to the host.  Default is OFF.

<p>

</p></dd><dt><b>SET AUTHENTICATION KERBEROS5 GET-K4-TGT
</b><i>{</i><b> ON, OFF</b><i> }</i>

</dt><dd>ON specifies that Kerberos 4 credentials should be requested each
time Kerberos 5 credentials are requested with AUTH KERBEROS5 INIT.
The default is OFF.

<p>

</p></dd><dt><b>SET AUTHENTICATION KERBEROS4 INSTANCE </b><i>instance</i>

</dt><dd>Allows a Kerberos 4 instance to be specified as a default (if needed).

<p>

</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> KERBEROS4, KERBEROS5</b>
<i>}</i><b> LIFETIME</b> <i>minutes</i>

</dt><dd>Specifies the lifetime of the TGTs requested from the KDC.  The default
is 600 minutes (10 hours).

<p>

</p></dd><dt><b>SET AUTHENTICATION KERBEROS5 NO-ADDRESSES </b>
<i>{</i><b> ON, OFF</b><i> }</i>

</dt><dd>Kerberos 5 tickets contain a list of all of the IP addresses associated
with the computer used to acquire them.  This allows the recipient of a ticket
to check whether it came from the machine to which it was issued, and makes
stolen Kerberos tickets useless.  <a href="#xa2">Network Address
Translators</a> and other Proxy services have the side effect of changing the
IP address from which a connection appears to originate.  This causes the IP
address check to fail and for Kerberos 5 tickets to be rejected as invalid.
When ON, the NO-ADDRESSES command prevents the inclusion of IP addresses in
Kerberos 5 tickets retrieved with Kermit's AUTHENTICATE KERBEROS5 INIT
command enabling the tickets to be accepted from any host.

<p>

</p></dd><dt><b>SET AUTHENTICATION KERBEROS4 PREAUTH
</b> <i>{</i><b> ON, OFF</b><i> }</i>

</dt><dd>Allows Kerberos 4 preauthenticated TGT requests to be turned off.  The
default is ON.  Only use if absolutely necessary.  We recommend that
preauthenticated requests be required for all tickets returned by a KDC
to a requestor.

<p>

</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> KERBEROS4, KERBEROS5</b>
<i>}</i><b>
PRINCIPAL</b> <i>name</i>

</dt><dd>When Kermit starts, it attempts to set the principal name to that stored
in the current credentials cache.  If no credential cache exists, the
current SET LOGIN USERID value is used.  SET LOGIN USERID is set to the
operating systems current username when Kermit is started.  To force
Kermit to prompt the user for the principal name when requesting TGTs, place:

<p>
</p><pre>  SET AUTH K4 PRINCIPAL {}
  SET AUTH K5 PRINCIPAL {}
</pre>
<p>
in the Kermit initialization file or connection script.

</p><p>

</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> KERBEROS4, KERBEROS5</b><i> }</i><b>
PROMPT PASSWORD</b> <i>prompt</i>

</dt><dd>Specifies a custom prompt to be used when prompting for a password.  The
Kerberos prompt strings may contain two "<tt>%s</tt>" replacement fields.  The
first <tt>%s</tt> is replaced by the principal name; the second by the realm.

<p>

</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> KERBEROS4, KERBEROS5</b><i> }</i><b>
PROMPT PRINCIPAL</b> <i>prompt</i> 

</dt><dd>Specifies a custom prompt to be used when prompting for the Kerberos
principal name.  No <tt>%s</tt> replacement fields may be included.  Kermit
prompts for a principal name when retrieving a TGT if the command:
<p>
</p><pre>  SET AUTHENTICATION <i>{</i> KERBEROS4, KERBEROS5 <i>}</i> PRINCIPAL {}
</pre>
<p>

has been issued.

</p><p>

</p></dd><dt><b>SET AUTHENTICATION KERBEROS5 PROXIABLE</b>
<i>{</i><b> ON, OFF </b><i>}</i>

</dt><dd>When ON, specifies that Kerberos 5 credentials should be proxiable.
The default is OFF.

<p>

</p></dd><dt><b>SET AUTHENTICATION KERBEROS5 RENEWABLE </b><i>minutes</i>

</dt><dd>When <i>minutes</i> is greater than the ticket lifetime a TGT may be
renewed with <tt>AUTH K5 INIT /RENEW</tt> instead of granting a new ticket
as long as the ticket is not expired and it's within the renewable
lifetime.  Default is 0 (zero) minutes.

<p>

</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> KERBEROS4, KERBEROS5</b>
<i> }</i> <b>REALM</b> <i>name</i>

</dt><dd>If no default is set, the default realm configured for the Kerberos
libraries is used.  Abbreviations are accepted.

<p>

</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> KERBEROS4, KERBEROS5</b><i> }</i><b>
SERVICE-NAME</b> <i>name</i>

</dt><dd>This command specifies the service ticket name used to authenticate to the
host when Kermit is used as a client; or the service ticket name accepted by
Kermit when it is acting as the host.  If no default is set, the default
service name for Kerberos 4 is "<tt>rcmd</tt>" and for Kerberos 5 is
"<tt>host</tt>".

</dd></dl>

<h3><a name="x3.2.2.2">3.2.2.2. SET AUTHENTICATION Commands for SRP</a></h3>

<dl><dt><b>SET AUTHENTICATION SRP PROMPT PASSWORD</b> <i>text</i>

</dt><dd>Specifies a custom prompt to be used when prompting for a password.
<i>prompt</i> may contain a single instance of "<tt>%s</tt>" to be replaced
by the user's login name.

</dd></dl>

<h3><a name="x3.2.2.3">3.2.2.3. SET AUTHENTICATION Commands for SSL/TLS</a></h3>

In all of the following commands "SSL" and "TLS" are synonyms.

<p>

</p><dl><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS</b><i> }</i><b>
CIPHER-LIST</b> <i>list-of-ciphers</i>

</dt><dd>This command applies to both SSL and TLS.  A colon-separated list of any
of the following (case-sensitive) options is accepted, depending on the
options chosen when OpenSSL was compiled:

<p>
</p></dd><dl><dt><i>Key Exchange Algorithms:</i>
</dt><dd>
<li><tt>kRSA</tt>: RSA key exchange
</li><li><tt>kDHr</tt>: Diffie-Hellman key exchange (key from RSA cert)
</li><li><tt>kDHd</tt>: Diffie-Hellman key exchange (key from DSA cert)
</li><li><tt>kEDH</tt>: Ephemeral Diffie-Hellman key exchange (temporary key)
</li><li><tt>kKRB5</tt>: Kerberos 5
<p>
</p></li></dd><dt><i>Authentication Algorithm:</i>
</dt><dd>
<li><tt>aNULL</tt>: No authentication
</li><li><tt>aRSA</tt>: RSA authentication
</li><li><tt>aDSS</tt>: DSS authentication
</li><li><tt>aDH</tt>: Diffie-Hellman authentication
</li><li><tt>aKRB5</tt>: Kerberos 5
<p>
</p></li></dd><dt><i>Cipher Encoding Algorithm:</i>
</dt><dd>
<li><tt>eNULL</tt>: No encodiing
</li><li><tt>AES256</tt>: 256-bit AES encoding
</li><li><tt>AES128</tt>: 128-bit AES encoding
</li><li><tt>DES</tt>: DES encoding
</li><li><tt>3DES</tt>: Triple DES encoding
</li><li><tt>RC4</tt>: RC4 encoding
</li><li><tt>RC2</tt>: RC2 encoding
</li><li><tt>IDEA</tt>: IDEA encoding
<p>
</p></li></dd><dt><i>MAC Digest Algorithm:</i>
</dt><dd>
<li><tt>MD5</tt>: MD5 hash function
</li><li><tt>SHA1</tt>: SHA1 hash function
</li><li><tt>SHA</tt>: SHA hash function (should not be used)
<p>
</p></li></dd><dt><i>Aliases:</i>
</dt><dd>
<li><tt>ALL</tt>: all ciphers
</li><li><tt>SSLv2</tt>: all SSL version 2.0 ciphers (should not be used)
</li><li><tt>SSLv3</tt>: all SSL version 3.0 ciphers
</li><li><tt>EXP</tt>: all export ciphers (40-bit)
</li><li><tt>EXPORT56</tt>: all export ciphers (56-bit)
</li><li><tt>LOW</tt>: all low strength ciphers (no export)
</li><li><tt>MEDIUM</tt>: all ciphers with 128-bit encryption
</li><li><tt>HIGH</tt>: all ciphers using greater than 128-bit encryption
</li><li><tt>RSA</tt>: all ciphers using RSA key exchange
</li><li><tt>DH</tt>: all ciphers using Diffie-Hellman key exchange
</li><li><tt>EDH</tt>: all ciphers using Ephemeral Diffie-Hellman key exchange
</li><li><tt>ADH</tt>: all ciphers using Anonymous Diffie-Hellman key exchange
</li><li><tt>DSS</tt>: all ciphers using DSS authentication
</li><li><tt>KRB5</tt>: all ciphers using Kerberos 5
</li><li><tt>AES</tt>: all ciphers using AES
</li><li><tt>NULL</tt>: all ciphers using no encryption
</li></dd></dl><p>

Each item in the list may include a prefix modifier:
</p><p></p><dl><dt><tt>"+"</tt>
</dt><dd>Move cipher(s) to the current location in the list
</dd><dt><tt>"-"</tt>
</dt><dd>Remove cipher(s) from the list (may be added again by
a subsequent list entry)
</dd><dt><tt>"!"</tt>
</dt><dd>Kill cipher from the list (it may not be added again
by a subsequent list entry)
</dd></dl><p>
If no modifier is specified the entry is added to the list at the current
position.  "+" may also be used to combine tags to specify entries such as
"RSA+RC4" describes all ciphers that use both RSA and RC4.
</p></dl>

<p>
For example, all available ciphers not including ADH key exchange:
</p><p></p><pre>  ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP
</pre><p>
All algorithms including ADH and export but excluding patented or 
trade secreted algorithms:
</p><p></p><pre>  HIGH:MEDIUM:LOW:EXPORT56:EXP:ADH:!RC4:!RC2:!IDEA
</pre><p>
The OpenSSL command:
</p><p></p><pre>  openssl ciphers -v <i>list-of-ciphers</i>
</pre><p>
may be used to list all of the ciphers and the order described by a specific
<i>list-of-ciphers</i>.
</p><p>
</p><dl><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS</b><i> }</i><b> CRL-DIR</b>
<i>directory</i>
</dt><dd>Specifies a directory that contains certificate revocation files, where
each file is named by the hash of the certificate issuer name.
OpenSSL expects the hash symlinks to be made like this:
<p></p><pre>  ln -s crl.pem `openssl crl -hash -noout -in crl.pem`.r0
</pre><p>
Since all file systems do not have symlinks you can use the following
command in Kermit to copy the <tt>crl.pem</tt> file to the hash file name:
</p><p></p><pre>  copy crl.pem {\fcommand(openssl crl -hash -noout -in crl.pem).r0}
</pre><p>
This produces a hash based on the issuer field in the CRL such that the issuer
field of a Cert may be quickly mapped to the correct CRL.
</p><p>
In Kermit 95, the default directory is <i>\v(exedir)crls</i>
</p><p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS </b><i>}</i><b> CRL-FILE</b>
<i>filename</i>
</dt><dd>Specifies a file that contains certificate revocations used to reject
the validation of certificates.
<p>
In Kermit 95, the default file is <i>\v(exedir)ca_crls.pem</i>
</p><p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS</b><i> }</i><b> DEBUG</b><i>
{</i><b> ON, OFF</b><i> }</i>
</dt><dd>Tells whether debug information should be displayed about the SSL/TLS
connection.  When DEBUG is ON, the VERIFY command does not terminate
connections when set to FAIL-IF-NO-PEER-CERT and a certificate is
presented that cannot be successfully verified; instead each error is
displayed but the connection automatically continues.
<p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS</b><i> }</i><b>
DH-PARAM-FILE</b> <i>filename</i>
</dt><dd>Specifies a file containing DH parameters used to generate
temporary DH keys.  If a DH parameter file is not provided Kermit uses a
fixed set of parameters depending on the negotiated key length.  Kermit
provides DH parameters for key lengths of 512, 768, 1024, 1536, and 2048
bits.
<p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS</b><i> }</i><b>
DSA-CERT-CHAIN-FILE</b> <i>filename</i>
</dt><dd>Specifies a file containing a DSA certificate chain to be sent along with
the DSA-CERT to the peer.  This file must only be specified if Kermit is
being used as a server and the DSA certificate was signed by an
intermediary certificate authority.
<p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS</b><i> }</i><b>
DSA-CERT-FILE</b> <i>filename</i>
</dt><dd>Specifies a file containing a DSA certificate to be sent to the peer to
authenticate the host or end user.  The file may contain the matching DH
private key instead of using the DSA-KEY-FILE command.
<p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS</b><i> }</i><b>
DSA-KEY-FILE</b> <i>filename</i>
</dt><dd>Specifies a file containing the private DH key that matches the DSA
certificate specified with DSA-CERT-FILE.  This command is only necessary
if the private key is not appended to the certificate in the file
specified by DSA-CERT-FILE.
</dd></dl><p>
Note: When executing a script in the background or when it is
running as an Internet Kermit Service Daemon, Kermit cannot support encrypted
private keys.  When attempting to load a private key that is encrypted, a 
prompt will be generated requesting the passphrase necessary to decrypt the keyfile.
To automate access to the private key you must decrypt the encrypted keyfile 
and create an unencrypted keyfile for use by Kermit.  This can be accomplished by
using the following command and the passphrase:
</p><p></p><pre>  openssl dsa -in <i>encrypted-key-file</i> -out <i>unencrypted-key-file</i>
</pre><p>
</p><dl><dt><b>SET AUTHENTICATION </b><i>{</i> <b>SSL, TLS</b> <i>}</i>
<b>RANDOM-FILE</b> <i>filename</i>

</dt><dd>Specifies a file containing random data to be used when initializing the
Pseudo Random Number Generator (PRNG) engine.  This file is overwritten with
new random data after the file is read.

<p>

</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i><b> SSL, TLS</b><i> }</i><b>
RSA-CERT-CHAIN-FILE</b> <i>filename</i>

</dt><dd>Specifies a file containing a RSA certificate chain to be sent along with
the RSA-CERT to the peer.  This file must only be specified if Kermit is
being used as a server and the RSA certificate was signed by an
intermediary certificate authority.
<p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i> <b>SSL, TLS</b> <i>}</i>
<b>RSA-CERT-FILE</b> <i>filename</i>
</dt><dd>Specifies a file containing a RSA certificate to be sent to the peer to
authenticate the host or end user.  The file may contain the matching RSA
private key instead of using the RSA-KEY-FILE command.
<p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i> <b>SSL, TLS</b> <i>}</i>
<b>RSA-KEY-FILE</b> <i>filename</i>
</dt><dd>Specifies a file containing the private RSA key that matches the RSA
certificate specified with RSA-CERT-FILE.  This command is only necessary
if the private key is not appended to the certificate in the file
specified by RSA-CERT-FILE.
</dd></dl><p>
Note: When executing a script in the background or when it is
running as an Internet Kermit Service Daemon, Kermit cannot support encrypted
private keys.  When attempting to load a private key that is encrypted, a 
prompt will be generated requesting the passphrase necessary to decrypt the keyfile.
To automate access to the private key you must decrypt the encrypted keyfile 
and create an unencrypted keyfile for use by Kermit.  This can be accomplished by
using the following command and the passphrase:
</p><p></p><pre>  openssl rsa -in <i>encrypted-key-file</i> -out <i>unencrypted-key-file</i>
</pre><p>
</p><dl><dt><b>SET AUTHENTICATION </b><i>{</i> <b>SSL, TLS</b> <i>}</i>
<b>VERBOSE</b><i> {</i><b> ON, OFF</b><i> }</i>
</dt><dd>Specifies whether information about the authentication (the certificate
chain) should be displayed when making a connection.
<p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i> <b>SSL, TLS</b> <i>}</i> <b>VERIFY</b><i> {</i><b> NO, PEER-CERT, FAIL-IF-NO-PEER-CERT</b><i> }</i>
</dt><dd>Specifies whether certificates should be requested from the peer; whether
they should be verified when they are presented; and whether they should
be required.  When set to NO (the default for IKSD), Kermit does not
request that the peer send a certificate and if one is presented it is
ignored.  When set to PEER-CERT (the default when not IKSD), Kermit
requests a certificate be sent by the peer.  If the certificate is
presented, it is verified.  Any errors during the verification process
result in queries to the end user.  When set to FAIL-IF-NO-PEER-CERT,
Kermit asks the peer to send a certificate.  If the certificate is not
presented or fails to verify successfully, the connection is terminated
without querying the user.
<p>
If an anonymous cipher (i.e., ADH) is desired the NO setting must be
used; otherwise the receipt of the peer certificate request is
interpreted as a protocol error and the negotiation fails.
</p><p>
If you wish to allow the peer to authenticate using either an X.509
certificate to userid mapping function or via use of a ~/.tlslogin file,
you must use either PEER-CERT or FAIL-IF-NO-PEER-CERT.  Otherwise, any
certificates that are presented are ignored.  In other words, use NO if
you want to disable the ability to use certificates to authenticate a
peer.
</p><p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i> <b>SSL, TLS</b> <i>}</i>
<b>VERIFY-DIR</b> <i>directory</i>
</dt><dd>Specifies a directory that contains root CA certificate files used to
verify the certificate chains presented by the peer.  Each file is named
by a hash of the certificate.
<p>
OpenSSL expects the hash symlinks to be made like this:
</p><p></p><pre>  ln -s cert.pem `openssl x509 -hash -noout -in cert.pem`.0
</pre><p>
Since all file systems do not have symlinks you can use the following
command in Kermit to copy the cert.pem file to the hash file name:
</p><p></p><pre>  copy cert.pem {\fcommand(openssl x509 -hash -noout -in cert.pem).0}
</pre><p>
This produces a hash based on the subject field in the cert such that the
certificate may be quickly found.
</p><p>
In Kermit 95, the default directory is <i>\v(exedir)certs</i>
</p><p>
</p></dd><dt><b>SET AUTHENTICATION </b><i>{</i> <b>SSL, TLS</b> <i>}</i>
<b>VERIFY-FILE</b> <i>file</i>
</dt><dd>Specifies a file that contains root CA certificates to be used for
verifying certificate chains.
<p>
In Kermit 95, the default file is <i>\v(exedir)ca_certs.pem</i>
</p></dd></dl>

<h3><a name="x3.2.3">3.2.3. The AUTHENTICATE Command (Kerberos Only)</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The AUTHENTICATE command obtains or destroys Kerberos tickets and lists
information about them.  The general format is:

</p><p>
</p><dl><dt><b>AUTHENTICATE</b><i> {</i><b> KERBEROS4, KERBEROS5</b><i> [ switches ] }
action [ switches ]</i>

</dt><dd>The use of command switches is described in
<a href="http://www.columbia.edu/kermit/ckermit70.html#x1.5">
Section 1.5</a> of the
<a href="http://www.columbia.edu/kermit/ckermit70.html">C-Kermit 7.0
Update Notes</a>.  The actions are INITIALIZE, DESTROY, and LIST-CREDENTIALS.

</dd></dl>
<p>

The AUTHENTICATE command's INITIALIZE option is the most complex of Kermit's
security commands, and its format is different for Kerberos 4 and Kerberos 5:

</p><p></p><dl><dt><i>Kerberos 4:</i>
</dt><dd><b>AUTH K4 INITIALIZE</b><i> [ k4-switches ] [ principal ]</i>
<p>
</p></dd><dt><i>Kerberos 5:</i>
</dt><dd><b>AUTH K5</b> <i>[ k5-switches ] {</i> <b>INITIALIZE ..., DESTROY, LIST-CREDENTIALS, ...</b><i>}</i>
</dd></dl>
<p>

</p><dl><dt><b>AUTHENTICATE K4 INITIALIZE</b> switches (all optional):
</dt><dd>
</dd><dl><dt><b>/INSTANCE:</b><i>name</i>
</dt><dd>Allows an Instance to be specified (see <a href="#glossary">Glossary</a>).
<p>
</p></dd><dt><b>/LIFETIME:</b><i>number</i>
</dt><dd>Specifies the requested lifetime in minutes for the ticket.  If no lifetime
is specified, 600 minutes is used.  If the lifetime is greater than the
maximum supported by the ticket granting service, the resulting lifetime
is shortened accordingly.
<p>
</p></dd><dt><b>/NOT-PREAUTH</b>
</dt><dd>Instructs Kermit to send a ticket granting ticket (TGT) request to the KDC
 without any preauthentication data.
<p>
</p></dd><dt><b>/PASSWORD:</b><i>string</i>
</dt><dd>Allows the inclusion of a password in a script file.  If no /PASSWORD
switch is included, you are prompted on a separate line.  The password switch
is provided for use by automated scripts.  However, we strongly recommend that
it not be used because clear-text passwords are easily compromised.
<p>
</p></dd><dt><b>/PREAUTH</b>
</dt><dd>Instructs Kermit to send a preauthenticated ticket granting ticket (TGT)
request to the KDC instead of a plaintext request.  The default when
supported by the Kerberos libraries.
<p>
</p></dd><dt><b>/REALM:</b><i>name</i>
</dt><dd>Allows an alternative Realm to be specified (see
<a href="#glossary">Glossary</a>).
</dd></dl></dl>
<p>

The Kerberos 4 <i>principal</i> format is:
</p><p></p><pre>  userid<i>[</i>.instance<i>[</i>.instance<i>]]</i>@<i>[</i>realm<i>]</i>
</pre><p>
but can be omitted if it is the same as your username or SET LOGIN USERID
value on the client system.

</p><p>

</p><dl><dt><b>AUTHENTICATE K5 INITIALIZE</b> switches (all optional):
</dt><dd></dd><dl><dt><b>/ADDRESSES:</b><i>list-of-ip-addresses</i>
</dt><dd>Specifies a list of IP addresses that should be placed in the Ticket
Granting Ticket in addition to the local machine addresses.
<p>
</p></dd><dt><b>/FORWARDABLE</b>
</dt><dd>Requests forwardable tickets.
<p>
</p></dd><dt><b>/KERBEROS4</b>
</dt><dd>Instructs Kermit to get Kerberos 4 tickets in addition to Kerberos 5
tickets.  If Kerberos 5 tickets are not supported by the server, a mild
warning is printed and Kerberos 4 tickets are requested.
<p>
</p></dd><dt><b>/LIFETIME:</b><i>number</i>
</dt><dd>Specifies the requested lifetime in minutes for the ticket.  If no
lifetime is specified, 600 minutes is used.  If the lifetime is greater
than the maximum supported by the ticket granting service, the resulting
lifetime is shortened.
<p>
</p></dd><dt><b>/NO-ADDRESSES</b>
</dt><dd>Instructs Kermit to not include a list of local IP addresses in the ticket
retrieved from the KDC.
<p>
</p></dd><dt><b>/NO-KERBEROS4</b>
</dt><dd>Instructs Kermit to not attempt to retrieve Kerberos 4 credentials.
<p>
</p></dd><dt><b>/NOT-FORWARDABLE</b>
</dt><dd>Requests non-forwardable tickets.
<p>
</p></dd><dt><b>/NOT-PROXIABLE</b>
</dt><dd>Requests non-proxiable tickets.
<p>
</p></dd><dt><b>/PASSWORD:</b><i>string</i>
</dt><dd>Allows the inclusion of a password in a script.  If no password is
specified you are prompted for one.  The password switch is provided for
use by automated scripts.  However, we strongly recommend that it not be
used because clear-text passwords can be easily compromised.  See Chapter
19 of <a href="http://www.kermitproject.org/uck2epdf.html"><cite>Using C-Kermit</cite></a>.
<p>
</p></dd><dt><b>/POSTDATE:</b><i>date-time</i>
</dt><dd>Requests a postdated ticket, valid starting at <i>date-time</i>.  Postdated
tickets are issued with the invalid flag set, and need to be fed back to
the KDC before use with the /VALIDATE switch.  See 
<a href="http://www.columbia.edu/kermit/ckermit70.html#x1.6">
Section 1.6</a> of the
<a href="http://www.columbia.edu/kermit/ckermit70.html">C-Kermit 7.0
Update Notes</a> for acceptable date-time formats.
<p>
</p></dd><dt><b>/PROXIABLE</b>
</dt><dd>Requests proxiable tickets.
<p>
</p></dd><dt><b>/REALM:</b><i>string</i>
</dt><dd>Allows an alternative realm to be specified.
<p>
</p></dd><dt><b>/RENEW</b>
</dt><dd>Requests renewal of a renewable Ticket Granting Ticket.  Note that
an expired ticket cannot be renewed even if it is within its renewable
lifetime.
<p>
</p></dd><dt><b>/RENEWABLE:</b><i>number</i>
</dt><dd>Requests renewable tickets, with a total lifetime of <i>number</i> minutes.
<p>
</p></dd><dt><b>/SERVICE:</b><i>string</i>
</dt><dd>Allows a service other than the ticket granting service to be specified.
<p>
</p></dd><dt><b>/VALIDATE</b>
</dt><dd>Requests that the Ticket Granting Ticket in the cache (with the invalid
flag set) be passed to the KDC for validation.  If the ticket is within
its requested time range, the cache is replaced with the validated
ticket.
</dd></dl></dl>
<p>

The Kerberos 5 <i>principal</i> format is:
</p><p></p><pre>  userid<i>[</i>/instance<i>][</i>@realm<i>]</i>
</pre><p>

and can be omitted if it is the same principal as stored in the current ticket
cache at the time Kermit started; or the current username if a ticket
cache did not exist.

</p><p>

Note: Kerberos 5 always attempts to retrieve a Ticket Granting Ticket (TGT)
using the preauthenticated TGT request.

</p><p>

</p><dl><dt><b>AUTHORIZE K5 LIST-CREDENTIALS </b><i>[ switches ]</i>
</dt><dd>Shows start time, expiration time, service or principal name, plus
the following additional information depending the switches:
<p></p></dd><dl><dt><b>/ADDRESSES</b>
</dt><dd>Displays the hostnames and/or IP addresses embedded within the tickets.
<p>
</p></dd><dt><b>/ENCRYPTION</b>
</dt><dd>Displays the encryption used by each ticket (if applicable):
<ul>
<li>DES-CBC-CRC
</li><li>DES-CBC-MD4
</li><li>DES-CBC-MD5
</li><li>DES-CBC-RAW
</li><li>DES-HMAC-SHA1
</li><li>DES3-CBC-RAW
</li><li>DES3-CBC-SHA
</li><li>DES3-HMAC-SHA1
</li></ul>
<p>
</p></dd><dt><b>/FLAGS</b>
</dt><dd>provides the following information (if applicable) for each ticket:
<ul><li><tt>F - </tt>Ticket is Forwardable
</li><li><tt>f - </tt>Ticket was Forwarded
</li><li><tt>P - </tt>Ticket is Proxiable
</li><li><tt>p - </tt>Ticket is a Proxy
</li><li><tt>D - </tt>Ticket may be Postdated
</li><li><tt>d - </tt>Ticket has been Postdated
</li><li><tt>i - </tt>Ticket is Invalid
</li><li><tt>R - </tt>Ticket is Renewable
</li><li><tt>I - </tt>Ticket is the Initial Ticket
</li><li><tt>H - </tt>Ticket has been authenticated by Hardware
</li><li><tt>A - </tt>Ticket has been Pre-authenticated
</li></ul>
</dd></dl></dl>

<h3><a name="x3.2.4">3.2.4. Other Security-Related Commands</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

</p><dl><dt><b>SET TCP ADDRESS </b><i>[ ip-address ]</i>

</dt><dd>Specifies the IP address of the computer that C-Kermit is running on.
Normally this is not necessary.  The exceptions would be if the host is <a href="#xa2">multihomed</a> (e.g. one host pointed to by many IP addresses, or
one of many hosts pointed to by a "common" IP address) or has multiple
physical network adapters, with a different address for each adapter, AND you
want C-Kermit to either (a) accept an incoming TCP connection
("<tt>set</tt> <tt>host</tt> <tt>*</tt>") or (b) get a Kerberos ticket.

<p>

</p></dd><dt><b>SET TCP REVERSE-DNS-LOOKUP </b><i>{</i><b> ON, OFF</b><i> }</i>

</dt><dd>Specifies whether or not a Reverse DNS Lookup should be performed to
determine the hostname assigned to the IP address used to connect to the host.

</dd></dl>

<p>

For mutual authentication to succeed, the client and the server must agree on
the name to be used for the server.  It is common for servers to have more
than one name.  This is especially true for clusters of servers that provide
the same function and are referenced by an alias.  For example,
<tt>www.foo.com</tt> might be an alias for three machines
<tt>www-1.foo.com</tt>, <tt>www-2.foo.com</tt>, and <tt>www-3.foo.com</tt>.
If the hosts are configured to use separate credentials for authentication it
would be necessary to know which host is actually in use since
"<tt>www.foo.com</tt>" is not equal to "<tt>www-1.foo.com</tt>".

</p><p>

On the other hand, since DNS is not a secure service, using an additional
lookup to verify the name associated with a particular IP address increases
the susceptibility that the authentication may be forged by an attacker.

</p><p>

For the highest level of security, Reverse DNS Lookups should be turned OFF.

</p><p>
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/k95.html">Kermit 95</a> ]

</p><h3><a name="x3.3"><hr>3.3. Making Secure Connections</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

SECTION CONTENTS

</p><p>
</p><pre>  3.3.1. <a href="#x3.3.1">The SET HOST Command</a>
  3.3.2. <a href="#x3.3.2">The TELNET Command</a>
  3.3.3. <a href="#x3.3.3">The SSH Command</a>
  3.3.4. <a href="#x3.3.4">The RLOGIN Command</a>
  3.3.5. <a href="#x3.3.5">Making Secure FTP Connections</a>
  3.3.6. <a href="#x3.3.6">Making Secure HTTP Connections</a>
  3.3.7. <a href="#x3.3.7">Using Only SSL or TLS</a>
  3.3.8. <a href="#x3.3.8">Using Kerberos 5 User-to-User Protocol</a>
</pre>
<p>

TCP/IP connections established by Kermit are initiated either with the SET
HOST command; a protocol-specific command such as TELNET or RLOGIN; or in the
case of FTP and HTTP an OPEN command.

</p><p>

</p><h4><a name="x3.3.1">3.3.1. The SET HOST Command</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

When using the SET HOST command to establish a secure connection, several
switches are available between SET HOST and the hostname, plus a protocol
switch at the end:

</p><p>
</p><dl><dt><b>SET HOST</b> <i>[ switches ] hostname-or-address [ service ]
[ protocol-switch ]</i>

</dt><dd>Establishes a connection to the specified network host on the currently
selected network type.  For TCP/IP connections, the default service is
TELNET and the default protocol is TELNET.  Not all protocols have a default
service name.

</dd></dl>
<p>

The following SET HOST switches are useful with secure connections:

</p><p>
</p><blockquote>
<dl><dt><b>/CONNECT</b></dt><dd>Tells Kermit to enter CONNECT (terminal) mode automatically if the
connection is successful.

<p>

</p></dd><dt><b>/SERVER</b></dt><dd>Tells Kermit to enter server mode automatically if the connection is
successful.

<p>

</p></dd><dt><b>/USERID:</b><i>[name]</i>

</dt><dd>This switch is equivalent to SET LOGIN USERID <name> or SET TELNET
ENVIRONMENT USER <name>.  If a string is given, it sent to host during Telnet
negotiations; if this switch is given but the string is omitted, no user ID is
sent to the host.  If this switch is not given, your current USERID value,
<tt>\v(userid)</tt>, is sent.  When a userid is sent to the host it is a
request to login as the specified user.

</name></name><p>

</p></dd><dt><b>/PASSWORD:</b><i>[string]</i>

</dt><dd>This switch is equivalent to SET LOGIN PASSWORD.  If a string is given,
it is treated as the password to be used (if required) by any Telnet
Authentication protocol (Kerberos Ticket retrieval, Secure Remote
Password, or X.509 certificate private key decryption.)  If no password
switch is specified a prompt is issued to request the password if one
is required for the negotiated authentication method.

</dd></dl></blockquote>

<p>

The SET HOST protocol-switches used with secure connections are:

</p><p>
</p><blockquote>
<dl><dt><b>/RLOGIN</b></dt><dd>Use Rlogin protocol even if this is not an Rlogin port.

<p>

</p></dd><dt><b>/TELNET</b>

</dt><dd>Send initial Telnet negotiations even if this is not a Telnet port.

<p>

</p></dd><dt><b>/K4LOGIN</b>

</dt><dd>Use Kerberos IV klogin protocol even if this is not a klogin port.

<p>

</p></dd><dt><b>/EK4LOGIN</b>

</dt><dd>Use Kerberos IV Encrypted login protocol even if this is not an eklogin
port.

<p>

</p></dd><dt><b>/K5LOGIN</b>

</dt><dd>Use Kerberos V klogin protocol even if this is not a klogin port.

<p> 

</p></dd><dt><b>/EK5LOGIN</b>

</dt><dd>Use Kerberos V Encrypted login protocol even if this is not an eklogin
port.

<p>

</p></dd><dt><b>/K5USER2USER</b>

</dt><dd>Use Kerberos V User to User protocol.

<p> 

</p></dd><dt><b>/SSL</b>

</dt><dd>Perform SSL negotiations.

<p> 

</p></dd><dt><b>/SSL-TELNET</b>

</dt><dd>Perform SSL negotiations and if successful start Telnet negotiations.

<p> 

</p></dd><dt><b>/TLS</b>

</dt><dd>Perform TLS negotiations.

<p> 

</p></dd><dt><b>/TLS-TELNET</b>

</dt><dd>Perform TLS negotiations and if successful start Telnet negotiations.

</dd></dl></blockquote>


<h4><a name="x3.3.2">3.3.2. The TELNET Command</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The TELNET command combines a number of commands related to secure
telnet connections into a single interface.

</p><p>
</p><dl><dt><b>TELNET /AUTH:</b><i>type</i> <b>/ENCRYPT:</b><i>type</i>
<b>/USERID:</b><i>[name]</i> <b>/PASSWORD:</b><i>[string]</i> <i>host port</i>

</dt><dd>The TELNET command is a shortcut for making interactive terminal
connections on a TCP/IP network using Telnet protocol.  When used for secure
connections, Kermit's TELNET command is the equivalent of:

<p>
</p><pre>  SET TELOPT AUTH ...
  SET TELNET AUTH TYPE ...
  SET TELOPT ENCRYPT ...
  SET TELNET ENCRYPT TYPE ...
  SET LOGIN USERID ...
  SET LOGIN PASSWORD ...
  SET HOST /CONNECT <i>host port</i> /TELNET
</pre>
<p>

The optional TELNET command switches are:

</p><p>
</p></dd><dl><dt><b>/AUTH:</b><i>type</i>

</dt><dd>Equivalent to SET TELNET AUTH TYPE <i>type</i> and
SET TELOPT AUTH REQUIRED with the following exceptions.  If the type
is AUTO, then SET TELOPT AUTH REQUESTED is executed and if the type
is NONE, then SET TELOPT AUTH REFUSED is executed.  If START_TLS is negotiated
REQUIRED becomes REQUESTED.

<p>

</p></dd><dt><b>/ENCRYPT:</b><i>type</i>

</dt><dd>Equivalent to SET TELNET ENCRYPT TYPE <i>type</i>
and SET TELOPT ENCRYPT REQUIRED REQUIRED with the following exceptions.
If the type is AUTO then SET TELOPT AUTH REQUESTED REQUESTED is executed
and if the type is NONE then SET TELOPT ENCRYPT REFUSED REFUSED is
executed.  If START_TLS is negotiated REQUIRED becomes REFUSED.

<p>

</p></dd><dt><b>/USERID:</b><i>[name]</i>

</dt><dd>Equivalent to SET LOGIN USERID <i>name</i> or SET TELNET
ENVIRONMENT USER <i>name</i>.  If a string is given, it sent to host during
Telnet negotiations; if this switch is given but the string is omitted, no
user ID is sent to the host.  If this switch is not given, your current
USERID value, \v(userid), is sent.  When a userid is sent to the host
it is a request to login as the specified user.

<p>

</p></dd><dt><b>/PASSWORD:</b><i>[string]</i>

</dt><dd>This switch is equivalent to SET LOGIN PASSWORD.  If a string is given,
it is treated as the password to be used (if required) by any Telnet
Authentication protocol (Kerberos Ticket retrieval, Secure Remote
Password, or X.509 certificate private key decryption.)  If no password
switch is specified a prompt is issued to request the password if one
is required for the negotiated authentication method.
</dd></dl></dl>

<h4><a name="x3.3.3">3.3.3. The SSH Command</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

At the <tt>K-95&gt;</tt> prompt, simply type "ssh somehost", where
<i>somehost</i> is the IP host name or address of the host you want to connect
to or, if your user ID on the destination host is different from your local
user ID, "ssh somehost /user:remoteuserid".  You might get some messages or
questions about the hostname the first time you make a connection, for
example:

</p><p>
</p><pre>  [C:\K95] K-95&gt; <u>ssh xyzcorp.com</u>
  The authenticity of host 'xyzcorp.com' can't be established.
  DSA key fingerprint is 85:f9:8b:cd:23:12:01:d9:cf:7a:12:cf:b5:5d:ab:60.
  Are you sure you want to continue connecting (yes/no)?
</pre>
<p>

but that's normal for any SSH client.  Unless you have reason to believe the
host is an imposter, say "yes" (more about this in the <a href="#x3">next
section</a>).  Now K95 asks you for your password, you type it into the box,
K95 sends it over the encrypted connection, and off you go.

</p><p>

From this point, an SSH session is like any other K95 terminal session.  You
can escape back to the prompt with Alt-X, return to the terminal screen with C
or Alt-X, transfer files, whatever you want.  When you log out from the host,
K95 <i>should</i> pop back to its command screen automatically, but that
<a href="#x5">depends on the SSH server</a>.

</p><p>

A single instance of K95 presently can not manage multiple terminal sessions,
SSH, Telnet, modem, or otherwise, but of course you can run multiple instances
of K95.  You can, however, have an FTP session and/or an HTTP session at the
same time as a terminal session in a single K95 instance.


</p><dl><dt><i>Syntax:</i>
<b><b>SSH</b> <i>{</i> <b>ADD, AGENT, CLEAR, KEY,</b>
<i>[</i> <b>OPEN</b> <i>]</i>, <b>V2</b> <i>} operands...</i></b></dt><dd>Performs the SSH-related action specified by the keyword.
</dd></dl>

Let's look at the most important and most commonly used SSH command first:

<dl><dt><b><b>SSH </b><i>[</i><b> OPEN </b><i>] host [ port ]
[</i><b> /COMMAND:</b><i>command</i>
<b>/USER:</b><i>username</i> <b>/PASSWORD:</b><i>passwd</i>
<b>/VERSION:</b><i>{</i><b>1,2</b><i>}</i>
<b>/SUBSYSTEM:</b><i>name</i>
<b>/X11-FORWARDING:</b><i>{</i><b>ON,OFF</b><i>}]</i></b></dt><dd>This command establishes a new connection using SSH version 1 or version 2
protocol.  The connection is made to the specified host on the SSH port (you
can override the port by including a port name or number after the host name).
Once the connection is established the authentication negotiations begin.  If
the authentication is accepted, the local and remote port forwarding lists (if
any) are used to establish the desired connection(s) and if X11 Forwarding is
active, this results in a remote port forwarding between the X11 clients on
the remote host and X11 Server on the local machine.  If a <tt>/COMMAND</tt>
is provided, the command is executed on the remote host in place of your
default shell.  

<p>

<i>Approximate Synonym:</i>  <b><tt>SET HOST /NETWORK:SSH</tt></b>.
This is exactly like SSH OPEN, except it does not enter the Terminal screen
(unless you include the <tt>/CONNECT</tt> switch).  This allows SSH
connections to be made in scripts, in which interactions with the host are to
be automated.  To see how to set up an SSH-based Kermit file-transfer
and -management service (similar to SFTP but with greater flexibility,
functionality, friendliness, and scriptability),
<a href="http://www.columbia.edu/kermit/skermit.html">CLICK HERE</a>.

</p><p>

If your username on the host is not the same as K95's <tt>\v(userid)</tt>
value, you <i>must</i> include the <tt>/USER:</tt> switch to specify the
username on the host.  You can find out K95's <tt>\(userid)</tt> value by
typing SHOW VAR USERID at the K95 prompt.  You can set this variable globally
with the SET LOGIN USERID command, in which case it is used for all future
network logins until you EXIT from K95.  The <tt>/USER:</tt> switch, on the
other hand, applies only to the command with which it is given, and leaves the
global USERID setting alone.

</p></dd></dl>

<p>

</p><h5><a name="x3.3.3.1">3.3.3.1. SSH Key Management</a></h5>
Kermit provides the following set of commands to manage public/private key 
pairs for authenticating to the remote host without transmitting passphrases.


<dl><dt><b><b>SSH KEY</b> </b> Commands:</dt><dd>The SSH KEY commands create and manage public and private key pairs
(identities).  There are three forms of SSH keys.  Each key is stored
in its own file:

<p>
</p><pre>   <u><i>Key Type      Private Key File          Public Key File</i>            </u>
   v1 RSA keys   \v(appdata)ssh/identity   \v(appdata)ssh/identity.pub
   v2 RSA keys   \v(appdata)ssh/id_rsa     \v(appdata)ssh/id_rsa.pub
   v2 DSA keys   \v(appdata)ssh/id_dsa     \v(appdata)ssh/id_dsa.pub
</pre>
<p>

Keys are stored using the OpenSSH keyfile format.  The private key
files can be (optionally) protected by specifying a passphrase.  A
passphrase is a longer version of a password.  English text provides
no more than 2 bits of key data per character.  56-bit keys can be
broken by a brute force attack in approximately 24 hours.  When used,
private key files should therefore be protected by a passphrase of at
least 40 characters (about 80 bits).

</p><p>

</p></dd><dt><b><b>SSH KEY CHANGE-PASSPHRASE </b><i>[</i><b>
/NEW-PASSPHRASE:</b><i>passphrase</i><b>
OLD-PASSPHRASE:</b><i>passphrase ] filename</i></b></dt><dd>This re-encrypts the specified private key file with a new passphrase.
The old passphrase is required.  If the passphrases (and filename) are
not provided Kermit prompts your for them.

<p>

</p></dd><dt><a name="sshkeycreate"><b>SSH KEY CREATE
<i>[</i> <b>/BITS:</b><i>bits</i><b>
/PASSPHRASE:</b><i>passphrase</i><b>
/TYPE:</b><i>{</i><b>V1-RSA,V2-DSA,V2-RSA</b><i>}</i><b>
/V1-RSA-COMMENT:</b><i>comment ] filename</i></b></a></dt><dd>This command creates a new private/public key pair.  The defaults are:
BITS:1024 and TYPE:V2-RSA.  The filename is the name of the private key file.
The public key is created with the same name with .pub appended to it.  If a
filename is not specified Kermit prompts you for it.  V1 RSA key files may
have an optional comment, which is ignored for other key types.

<p>

</p></dd><dt><b><b>SSH KEY DISPLAY
</b><i>[</i><b>
/FORMAT:</b><i>{</i><b>FINGERPRINT,IETF,OPENSSH,SSH.COM</b><i>} ]
filename</i></b></dt><dd>This command displays the contents of a public or private key file.
The default format is OPENSSH.

<p>

</p></dd><dt><b><b>SSH KEY V1 SET-COMMENT </b><i>filename comment</i></b></dt><dd>This command replaces the comment associated with a V1 RSA key file.

<p>

</p></dd><dt><b><b>SSH V2 REKEY</b></b></dt><dd>Requests that an existing SSH V2 connection generate new session keys.
</dd></dl>

<h5><a name="x3.3.3.2">3.3.3.2. The SSH AGENT</a></h5>

ssh-agent.exe is a program to hold private keys used for public key authentication 
(RSA, DSA).  The idea is that ssh-agent.exe is started prior to the first Kermit 
session.  Kermit 95 then communicates with the ssh-agent program via named pipes.

<p>

The agent initially does not have any private keys.  Keys are added using 
the <b>SSH AGENT ADD</b> command.  Keys representing multiple identities can be stored 
in the agent; the agent can automatically use any of these identities.  <b>SSH AGENT LIST</b>
displays the identities currently held by the agent.

</p><p>

<b>SET SSH AGENT-FORWARDING ON</b> enables agent cache forwarding.  
When the ssh-agent to run on the user's local PC, laptop, or terminal  
authentication data need not be stored on any other machine, and 
authentication passphrases never go over the network.  However, the connection 
to the agent is forwarded over SSH remote logins, and the user can thus use 
the privileges given by the identities anywhere in the network in a secure 
way.

</p><p>

</p><dl><dt><b><b>SSH AGENT ADD </b><i>[ identity-file ]</i></b></dt><dd>Adds the contents of the identity-file (if any) to the SSH AGENT (ssh-agent.exe) private
key cache.  If no identity-file is specified, all files specified with SET SSH
IDENTITY-FILE are added to the cache.

<p>

</p></dd><dt><b><b>SSH AGENT DELETE </b><i>[ identity-file ]</i></b></dt><dd>Deletes the contents of the identity-file (if any) from the SSH AGENT (ssh-agent.exe)
private key cache.  If no identity-file is specified, all files specified with
SET SSH IDENTITY-FILE are deleted from the cache.

<p>

</p></dd><dt><b><b>SSH AGENT LIST </b><i>[</i><b> /FINGERPRINT </b><i>]</i></b></dt><dd>Lists the contents of the SSH AGENT (ssh-agent.exe) private key cache.  If
<tt>/FINGERPRINT</tt> is specified, the fingerprint of the private keys are
displayed instead of the keys.

<p>
</p></dd></dl>

<h5><a name="x3.3.3.3">3.3.3.3. SSH Port Forwarding</a></h5>
SSH can forward ports to and from the remote host to which Kermit is connected.

<p>
</p><dl><dt><b><b>SSH ADD LOCAL-PORT-FORWARD</b> <i>local-port host port</i></b></dt><dd>Adds a port forwarding triplet to the local port forwarding list.  The
triplet specifies a local port to be forwarded and the hostname / ip-address
and port number to which the port should be forwarded from the remote host.
Port forwarding is activated at connection establishment and continues until
the connection is terminated.

<p>

</p></dd><dt><b><b>SSH CLEAR LOCAL-PORT-FORWARD</b></b></dt><dd>Clears the local port forwarding list.

<p>

</p></dd><dt><b><b>SSH ADD REMOTE-PORT-FORWARD</b>
<i>remote-port host port</i></b></dt><dd>Adds a port forwarding triplet to the remote port forwarding list.  The
triplet specifies a remote port to be forwarded and the hostname/ip-address
and port number to which the port should be forwarded from the local machine.
Port forwarding is activated at connection establishment and continues until
the connection is terminated.

<p>

</p></dd><dt><b><b>SSH CLEAR REMOTE-PORT-FORWARD</b></b></dt><dd>Clears the remote port forwarding list.
</dd></dl>

<h4><a name="x3.3.4">3.3.4. The RLOGIN Command</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The RLOGIN (Remote Login) protocol is not as flexible as the Telnet protocol
and supports no option mechanism.  Authentication and privacy are not part of
the RLOGIN protocol.  When we refer to authenticated and encrypted RLOGIN we
are really referring to one of four other protocols derived from RLOGIN:
Kerberos 4 Remote Login (K4LOGIN); Kerberos 4 Encrypted Remote Login
(EK4LOGIN); Kerberos 5 Remote Login (K5LOGIN); and Kerberos 5 Encrypted Remote
Login (EK5LOGIN).

</p><p>

</p><dl><dt><b>RLOGIN /ENCRYPT /KERBEROS4 /KERBEROS5</b> <i>hostname username</i>

</dt><dd>The RLOGIN command is a shortcut for making interactive connections.
It is the equivalent of specifying:
<p></p><pre>  SET LOGIN USERID ...
  SET HOST /CONNECT <i>hostname service [ protocol-switch ]</i>
</pre><p>
where the combinations of /ENCRYPT /KERBEROS4 /KERBEROS5 result in
the following <i>protocol-switches</i>:
</p><p>
</p></dd><dl><dt><b>/KERBEROS4</b>
</dt><dd>means service <i>klogin</i> and protocol <i>k4login</i>
<p>
</p></dd><dt><b>/KERBEROS4 /ENCRYPT</b>
</dt><dd>means service <i>eklogin</i> and protocol <i>ek4login</i>
<p>
</p></dd><dt><b>/KERBEROS5</b>
</dt><dd>means service <i>klogin</i> and protocol <i>k5login</i>
<p>
</p></dd><dt><b>/KERBEROS5 /ENCRYPT</b>
</dt><dd>means service <i>eklogin</i> and protocol <i>ek5login</i>
</dd></dl></dl>

<h4><a name="x3.3.5">3.3.5. Making Secure FTP Connections</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

By default Kermit tries to negotiate a secure authentication method and to
obtain private command and data channels.  Therefore, all that is normally
required to establish a secure FTP session is to issue the FTP OPEN
command.  If the server to which you are connecting supports a common security
mechanism, it is used to secure the session.

</p><p>

For example, to establish a secure FTP connection using SRP the following
commands could be executed:

</p><p></p><pre>  SET FTP AUTHTYPE SRP
  SET FTP AUTOAUTHENTICATE ON              ; default setting
  SET FTP AUTOENCRYPTION ON                ; default setting
  SET FTP AUTOLOGIN ON                     ; default setting
  SET FTP SRP CIPHER DES_ECB               ; default setting
  SET FTP SRP HASH SHA1                    ; default setting
  SET FTP COMMAND-PROTECTION-LEVEL PRIVATE ; default setting
  SET FTP DATA-PROTECTION-LEVEL PRIVATE    ; default setting
  FTP OPEN <i>host</i> /USER:<i>username</i> /PASSWORD:<i>password</i>
</pre><p>

If the /USER and/or /PASSWORD switches are omitted, the user is prompted for
the required fields.

</p><p>

For example, to establish a secure FTP connection using GSSAPI-Kerberos 5
 the following commands could be executed:

</p><p></p><pre>  SET AUTH KERBEROS5 REALM <i>MY.REALM</i>
  SET AUTH KERBEROS5 PRINCIPAL <i>my-principal</i>
  AUTH KERBEROS5 INIT 
  SET FTP AUTHTYPE GSSAPI-KRB5
  SET FTP AUTOAUTHENTICATE ON              ; default setting
  SET FTP AUTOENCRYPTION ON                ; default setting
  SET FTP AUTOLOGIN ON                     ; default setting
  SET FTP COMMAND-PROTECTION-LEVEL PRIVATE ; default setting
  SET FTP DATA-PROTECTION-LEVEL PRIVATE    ; default setting
  FTP OPEN <i>host</i> /USER:<i>username</i>
</pre><p>

If the /USER switch is omitted, the user is prompted for the name to login
as after authentication is performed.

</p><p>

Here is an example using TLS to secure the FTP session for an anonymous
user:

</p><p>
</p><pre>  SET AUTH TLS VERIFY-FILE <i>ca-cert.pem</i>
  SET FTP AUTHTYPE TLS
  SET FTP AUTOAUTHENTICATE ON              ; default setting
  SET FTP AUTOENCRYPTION ON                ; default setting
  SET FTP AUTOLOGIN ON                     ; default setting
  SET FTP COMMAND-PROTECTION-LEVEL PRIVATE ; default setting
  SET FTP DATA-PROTECTION-LEVEL PRIVATE    ; default setting
  FTP OPEN <i>host</i> /ANONYMOUS
</pre>

<p>

Here is an example using FTP through an SSL Proxy Server:

</p><p>
</p><pre>  SET AUTH SSL VERIFY-FILE <i>ca-cert.pem</i>
  SET FTP AUTOLOGIN ON                     ; default setting
  SET FTP COMMAND-PROTECTION-LEVEL PRIVATE ; default setting
  SET FTP DATA-PROTECTION-LEVEL PRIVATE    ; default setting
  FTP OPEN /SSL <i>host</i> /USER:<i>username</i> /PASSWORD:<i>password</i>
</pre><p>

If the /USER and/or /PASSWORD switches are omitted, the user is prompted for
the required fields.

</p><p>


</p><h4><a name="x3.3.6">3.3.6. Making Secure HTTP Connections</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Here is an example of a secure GET:

</p><p>
</p><pre>  SET AUTH TLS VERIFY-FILE <i>ca-cert.pem</i>
  HTTP OPEN <i>host</i> HTTPS
  HTTP /USER:<i>username</i> /PASSWORD:<i>password</i> GET <i>index.html</i> <i>index.html</i>
  HTTP CLOSE
</pre>

<h4><a name="x3.3.7">3.3.7. Using Only SSL or TLS</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Secure Sockets Layer (SSL) and Transport Layer Security (TLS) 
protocols were designed to secure e-commerce transactions (HTTP) over the
Internet.  Their use as a tunnel protocol is becoming widespread as a means
for securing other protocols such as FTP, IMAP, POP3, LDAP, NNTP, and even
insecure versions of Telnet (this is frequently done with STunnel:
<a href="http://www.stunnel.org/">http://www.stunnel.org/</a>.)
Kermit provides the ability to establish SSL and TLS connections to transfer
data, script HTTP sessions, or use Telnet protocol without the
START_TLS option.

</p><p>

Kermit provides four <i>protocol-switches</i> for establishing SSL or TLS
connections: /SSL, /TLS, /SSL-TELNET, and
/TLS-TELNET.  Unlike other protocols such as TELNET and RLOGIN there
are no standard services (IP ports) assigned to these protocols.  Use of these
protocols assumes prior knowledge of the ports to connect to on the remote
host.  There are also no shortcut commands for use with these protocols.  Use
the SET HOST command as described above when making connections.

</p><p>

The <a href="#x3.2.2.3"><tt>SET</tt> <tt>AUTHENTICATION</tt> <i>{</i>
<tt>SSL</tt>, <tt>TLS</tt> <i>}</i></a><tt>...</tt> commands are used to
configure the <a href="#xa3">certificates and authorities</a>, and
verification options used during connection establishment.

</p><p>

[ <a href="http://www.columbia.edu/kermit/case21.html">STunnel Case Study</a> ]

</p><h4><a name="x3.3.8">3.3.8.  Using Kerberos 5 User-to-User Protocol</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#x3.3">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The Kerberos 5 authentication implemented in the Telnet protocol is a 
client to server authentication protocol.  It requires that the parties 
to the authentication be an end user principal and a service principal.
The Kerberos 5 User to User protocol is specificly designed to allow
two end user principals to authenticate one another.  The shared secret
generated during the authentication is then used to ensure the privacy
of the data transmitted on the connection.

</p><p>

There is no shortcut command provided for Kerberos 5 User to User protocol; 
nor is there a default service.  To establish a connection between two Kermit
processes using Kerberos 5 User to User protocol:

</p><p>
</p><ul>
<li>Each user must have retrieved a valid Kerberos 5 TGT.
</li><li>One user must issue a SET HOST * <i>port</i> /K5USER2USER command.
</li><li>One user must issue a SET HOST <i>hostname port</i> /K5USER2USER command.
</li></ul>

<p>
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/k95.html">Kermit 95</a> ]

</p><h4><a name="x3.4"><hr>3.4.  Using Secure Connections</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x3">Chapter Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Once you have a secure connection, you can use it just like a regular
(insecure one).  Telnet sessions are Telnet sessions; FTP is FTP.  However,
encryption and the subsequent decryption of a data stream can result in 10% to
60% reduction in file transfer performance depending on the encryption
algorithm.  Encrypted data streams are uncompressible, thus reducing
throughput on PPP or SLIP connections.

</p><p>

When OpenSSL is built with support for ZLIB compression and compressed SSL/TLS
connections can be negotiated, the degradation in file transfer performance 
can be reduced.

</p><p>

In Kermit 95, the authentication type and encryption levels are displayed in
the terminal-screen status Line as follows:

</p><p>

</p><blockquote>
<table>
<tbody><tr>
<td><tt>K4</tt>
</td><td>Kerberos IV
</td></tr><tr>
<td><tt>K5</tt>
</td><td>Kerberos V
</td></tr><tr>
<td><tt>NTLM</tt>
</td><td>NT LAN Manager
</td></tr><tr>
<td><tt>SRP</tt>
</td><td>Secure Remote Password
</td></tr><tr>
<td><tt>pp</tt>
</td><td>No encryption
</td></tr><tr>
<td><tt>Ep</tt>
</td><td>Encryption to host, plaintext from host
</td></tr><tr>
<td><tt>pD</tt>
</td><td>Plaintext to host, encryption from host
</td></tr><tr>
<td><tt>ED</tt>
</td><td>Encryption both directions
</td></tr><tr>
<td><tt>SSL</tt>
</td><td>Secure Sockets Layer (both directions)
</td></tr><tr>
<td><tt>TLS</tt>
</td><td>Transport Layer Security (both directions)
</td></tr></tbody></table>
</blockquote>
<p>

Encrypted sessions become unreadable if even one bit of data is inserted into
or deleted from the data stream.  One damaged bit results in nine damaged
bytes but subsequent bytes remain readable.  But since TCP/IP is a reliable
transport by definition, none of this should occur.

</p><p>

Windows login names are not case-sensitive.  However, Unix login names are.
If the Unix login name is "fred" but Windows was logged in using the name
"Fred", authentication appears to succeed but telnetd closes the connection
after Telnet negotiations are complete.  There are several solutions to this
problem:

</p><p>
</p><ul>
<li>Make sure the Windows login name is case identical to the Unix login name.
(If Windows has recorded the login in the registry as "Fred" it won't
matter if you login to Windows using "fred".  The only way to correct
this problem is to edit the Registry.)

<p>

</p></li><li>Use the SET LOGIN USERID <i>name</i> command to set the proper login name
before connecting to the telnet server.

<p>

</p></li><li>Use the SET AUTHENTICATION <i>{</i> KERBEROS4, KERBEROS5 <i>}</i> PRINCIPAL
<i>name</i> command to set the proper principal name before connecting to the
telnet server.

<p>

</p></li><li>Specify the remote username in the <i>principal</i> of your AUTHENTICATE
K<i>xxx</i> INITIALIZE command.
</li></ul>
<p>

Kermit adjusts the case of the name if and only if a case insensitive
comparison of the SET LOGIN USERID name and the name in the authentication
ticket shows no differences.

</p><p>
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/k95.html">Kermit 95</a> ]

</p><h3><a name="x4"><hr>4. INSTALLATION AND CONFIGURATION</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
[ <a href="#x5">Next</a> ]
[ <a href="#x3">Previous</a> ]
<p>

This chapter is intended for those who are building secure Kermit programs
from source code and/or installing secure versions of Kermit for use within
their organization.  It presumes that you've read all the previous chapters.

</p><p>

CHAPTER CONTENTS
</p><p>
</p><pre>  4.1. <a href="#x4.1">Security in Kermit 95</a>
  4.2. <a href="#x4.2">Security in C-Kermit</a>
</pre>

<h3><a name="x4.1">4.1. Security in Kermit 95</a></h3>

Kermit 95 comes precompiled with support for Kerberos 4, Kerberos 5, Secure
Remote Password (SRP), NT Lan Manager (NTLM) authentication, OpenSSL's
SSLv3 and TLSv1, and SSH v1 and v2.

<p>

SECTION CONTENTS

</p><p>
</p><pre>  4.1.1. <a href="#x4.1.1">Kerberos</a>
  4.1.2. <a href="#x4.1.2">SRP</a>
  4.1.3. <a href="#x4.1.3">NTLM</a>
  4.1.4. <a href="#x4.1.4">OpenSSL</a>
  4.1.5. <a href="#x4.1.5">SSH</a>
  4.1.6. <a href="#x4.1.6">Firewalls</a>
  4.1.7. <a href="#x4.1.7">Adding Other Security Methods to Kermit 95</a>
</pre>

<h3><a name="x4.1.1">4.1.1. Kerberos in Kermit 95</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Kermit 95 supports Kerberos Telnet Authentication, Kerberos Rlogin, Kerberos
FTP, and Kerberos SSL/TLS (K5 only) when any of the following Kerberos IV or
Kerberos V implementations are installed on a Windows 95 or Windows NT
workstation:

</p><p>

</p><ul><dl><dt><b>MIT Kerberos for Microsoft Operating Systems Release 2.2</b>

</dt><dd><li>Supports Kerberos Version 4 and Kerberos Version 5 Release 1.2.7: <br>
<a href="http://web.mit.edu/kerberos/www/"><tt>http://web.mit.edu/kerberos/www/</tt></a>

<p>

</p></li></dd><dt><b>Naval Research Laboratories</b>

</dt><dd><li>Supports Kerberos 5:<br>
<a href="ftp://ftp.cmf.nrl.navy.mil/pub/kerberos5/README"><tt>
ftp://ftp.cmf.nrl.navy.mil/pub/kerberos5/README</tt></a>

</li></dd></dl>
</ul>

<p>

When Kerberos IV and/or Kerberos V are installed and the DLLs are located in
the PATH, Kermit 95 attempts to negotiate authentication with the host if the 
host is Kerberized and if you have not instructed Kermit 95 to do otherwise.

</p><p>

In addition, if the appropriate encryption patch (obtained from the Kermit
Project) is installed, two-way encryption is also negotiated and used if
authentication was negotiated.  The encryption patch is available WITH EXPORT
RESTRICTIONS at:

</p><p>
</p><pre>  <a href="http://www.kermitproject.org/export.html">http://www.kermitproject.org/export.html</a>
</pre>
<p>

Due to the length of the shared secret negotiated by Kerberos 4 only 56-bit DES
encryption can be used.

</p><p>

Per-PC configuration files may or may not be necessary at your installation.
If your site's DNS servers supply Kerberos realm information, no
configuration files are needed and you can skip to
<a href="#x4.1.2">Section 4.1.2</a>.

</p><h3><a name="x4.1.1.1">4.1.1.1.
Kerberos IV Configuration Files for K95</a></h3>

Kerberos IV uses three configuration files in the
<tt>\WINDOWS</tt> directory: <tt>LEASH.INI</tt> (user settings),
<tt>KRB.CON</tt> and <tt>KRBREALM.CON</tt>.  <tt>KRB.CON</tt> and
<tt>KRBREALM.CON</tt> are used by Kerberos IV to map your host's domain name
to a realm and then to determine the name of the Kerberos server for that
realm.  As distributed from MIT, these files are set up for MIT's realm,
domain, and host information, so if you are not at MIT you'll need to
substitute the information for your own site; for example:

<p>
</p><pre>KRB.CON:
  CC.COLUMBIA.EDU
  CC.COLUMBIA.EDU kerberos.cc.columbia.edu
  KERMIT.COLUMBIA.EDU kerberos.cc.columbia.edu
  COLUMBIA.EDU kerberos.cc.columbia.edu
  .KERBEROS.OPTION. dns
</pre><p>

The first line is the default Kerberos IV realm to be used.  The subsequent
lines list realms and the hostnames to be used to contact the KDC for that
realm.

</p><p>

The last line is an indicator that DNS can be used to map Realms to KDCs
and host names to Realms.

</p><p></p><pre>KRBREALM.CON:
  .CC.COLUMBIA.EDU CC.COLUMBIA.EDU
  CC.COLUMBIA.EDU CC.COLUMBIA.EDU
  .COLUMBIA.EDU CC.COLUMBIA.EDU
  COLUMBIA.EDU CC.COLUMBIA.EDU
  .KERMIT.COLUMBIA.EDU CC.COLUMBIA.EDU
  KERMIT.COLUMBIA.EDU CC.COLUMBIA.EDU
</pre><p>

Each line specifies either a domain name prefaced with a "<tt>.</tt>" or a
host name and the Kerberos IV realm to which it belongs.

</p><h3><a name="x4.1.1.2">4.1.1.2.
The Kerberos V Configuration File for K95</a></h3>

Kerberos V uses a single configuration file, <tt>KRB5.CONF</tt>
(<tt>KRB5.INI</tt> on Windows).  This file must be customized for the domains,
realms, and hosts used in your network environment.  For example:

<p></p><pre>[libdefaults]
        default_realm = CC.COLUMBIA.EDU
        default_tkt_enctypes = des3-cbc-sha1 des-cbc-crc
        default_tgs_enctypes = des3-cbc-sha1 des-cbc-crc
        ticket_lifetime = 600
        dns_lookup_kdc = true
        dns_lookup_realm = true
        forwardable = true
        proxiable = true

[domain_realm]
        .cc.columbia.edu = CC.COLUMBIA.EDU
        cc.columbia.edu = CC.COLUMBIA.EDU
        .columbia.edu = CC.COLUMBIA.EDU
        columbia.edu = CC.COLUMBIA.EDU

[realms]
        CC.COLUMBIA.EDU = {
                kdc = kerberos.columbia.edu:88
                admin_server = kerberos.columbia.edu:749
                default_domain = cc.columbia.edu
                supports_tgs_enctypes = des3-cbc-sha1 des-cbc-crc
                supports_tkt_enctypes = des3-cbc-sha1 des-cbc-crc
        }
</pre><p>

</p><h3><a name="x4.1.2">4.1.2.
Secure Remote Password protocol in Kermit 95</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Kermit 95 supports Telnet Authentication via Secure Remote Password protocol
without any additional software.

</p><p>

In addition, if the appropriate encryption patch (obtained from the Kermit
Project) is installed, two-way encryption is also negotiated and used if
authentication was negotiated.  The encryption patch is available WITH EXPORT
RESTRICTIONS at:

</p><p></p><pre>  <a href="http://www.kermitproject.org/export.html">http://www.kermitproject.org/export.html</a>
</pre><p>

Kermit 95 contains support for authenticating incoming connections using SRP.
Unfortunately, there are no Windows based tools for creating the SRP password
file.  However, once a password and config file are created on Unix they can
be copied to Windows.  On Windows 9x the <tt>tpasswd</tt> and
<tt>tpasswd.conf</tt> files are stored in the <tt>C:\WINDOWS</tt> directory.
On NT they are stored in <tt>%windir%\SYSTEM32\DRIVERS\ETC</tt>.

</p><h3><a name="x4.1.3">4.1.3. NT LAN Manager Authentication in Kermit 95</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

NTLM authentication is a feature of Windows 95/98, NT, and Windows 2000.  It
is used to authenticate Windows clients to Windows services.  Telnet Auth
NTLM is implemented in the Microsoft Telnet Daemon that ships with NT
Services for Unix and with Windows 2000.

</p><p>

Windows 95/98 only contains support for the client whereas NT contains
support for both client and server.  Kermit 95 can authenticate incoming
connections with NTLM when it is executing on NT.

</p><h3><a name="x4.1.4">4.1.4.
OpenSSL support for SSLv3 and TLSv1 in Kermit 95</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Kermit 95 supports SSL/TLS security via OpenSSL when the encryption patch
(obtained from the Kermit Project) is installed.  The encryption patch is
available WITH EXPORT RESTRICTIONS at:

</p><p></p><pre>  <a href="http://www.kermitproject.org/export.html">http://www.kermitproject.org/export.html</a>
</pre><p>

On non-Unix platforms OpenSSL does not define default locations for
certificates and revocation lists therefore the appropriate SET AUTH <i>{</i>
SSL, TLS <i>}</i> commands must be given (e.g. included in the
<tt>K95CUSTOM.INI</tt> or <tt>IKSD.KSC</tt> file) before certificate
verification to be performed.

</p><p>

As of Kermit 95 version 1.1.21 the default locations are provided as follows:

</p><ul>
<li>CA certificates are searched for in the following directories using the
hash of the certificate as the filename:
<pre>   \v(appdata)certs/
   \v(common)certs/
   \v(exedir)certs/
</pre>
</li><li>CA certificates are searched for in the following files:
<pre>   \v(appdata)ca_certs.pem
   \v(common)ca_certs.pem
   \v(exedir)ca_certs.pem
</pre>

</li><li>CRLs are searched for in the following directories using the hash of the
CRL as the filename:

<pre>   \v(appdata)crls/
   \v(common)crls/
   \v(exedir)crls/
</pre>
</li><li>CRLs are searched for in the following files:
<pre>   \v(appdata)ca_crls.pem
   \v(common)ca_crls.pem
   \v(exedir)ca_crls.pem
</pre>
</li></ul>
<p>

Due to patent licensing restrictions on the IDEA algorithm within the
United States, all binaries that the Kermit Project distributes to
provide SSL/TLS support for Kermit 95 do not contain IDEA ciphers.
</p><p>

See <a href="#xa3.11.1">Appendix III</a> if you wish to provide server-side
support for authentication of clients using public key certificates.

</p><h3><a name="x4.1.5">4.1.5. SSH v1 and v2 in Kermit 95</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

SSH was added to Kermit 95 because many sites today refuse Telnet connections
(clear-text or secure) and accept only SSH connections.  As of version 1.2.21,
the Windows (not OS/2) version of Kermit 95 includes SSH v1 and v2 clients:

</p><p>

</p><ul>

<li> K95's SSH implementation was originally based on 
<a href="http://www.openssh.org/">OpenSSH</a> 3.0.2p1, and was 
customized to <i>(a)</i> allow connections in series; <i>(b)</i> incorporate 
Kerberos and Secure Remote Password authentication methods; <i>(c)</i> 
interface with the rest of K95 (settings, etc); and <i>(d)</i> close some 
potential security holes in the original distribution.

<p>

</p></li><li>K95 can make SSH connections to any host that has sshd for SSH 1.3,
1.5, or 2.0.  OpenSSH does not support SSH versions 1.2 or earlier.

<p>

</p></li><li>Unless you force a specific SSH version when connecting (<tt>SSH</tt>
<tt>OPEN</tt> <i>blah</i> <tt>/VERSION:1</tt>), K95 negotiates the version
automatically.  The negotiated version is shown in the Terminal-screen status
line, e.g. "SSH-2.0".

<p>

</p></li><li>As with all Kermit's other features, the SSH client is configurable by the
user in every conceivable way (so anybody who doesn't like its defaults or
behavior can change them) and it includes built-in key creation and management
tools so no external "helper applications" are required.

<p>

</p></li><li>The K95 implementation of SSH has been tested in connections to Solaris,
HP-UX 8.00 and above, Linux, OpenBSD, FreeBSD, and VMS ...

</li></ul>
<p>

The following is a list of things to watch out for in the Kermit 95
implmentation:

</p><ul>

<li>K95 tries to negotiate SSH v2 by default so if you try to connect to an
SSH V1 server, it might take a long time.  In such cases, use "<tt>ssh</tt>
<i>host</i> <tt>/version:1</tt>" to get an immediate connection.

<p>

</p></li><li>Stairsteps.  SSH servers on some Unix systems (usually old ones but
reportedly also some new ones too) do not translate LF to CRLF, so lines come
out on your screen in stairstep fashion.  You can usually fix this by giving
an "stty sane" command at the Unix host prompt, or by telling Kermit to "set
terminal newline on".  Other SSH clients behave exactly the same way with the
same hosts.

<p>

</p></li><li>Some SSH servers do not break the connection when you log out.  If you
log out but Kermit stays in its terminal screen, use Alt-u to disconnect.
(The same thing happens with other SSH clients.)

<p>

</p></li><li>SSH compression is enabled by default.  It improves performance on fast
machines, but might slow things down when the CPU is the bottleneck,
especially on fast LAN connections.  Compression is important, however, for
modem connections (e.g. PPP) because the encrypted data stream can't be
compressed by the modem.

</li></ul>

<h3><a name="x4.1.6">4.1.6. Firewalls</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Both the Windows and OS/2 versions of Kermit 95 support SOCKS 4.  In Windows
there is no nameserver support; local username is retrieved from Windows.
Requires SOCKS_SERVER environment variable and <tt>SOCKS.CONF</tt> file in the
<tt>/ETC</tt> directory.  Command: SET TCP SOCKS-SERVER <i>host</i>.


</p><h3><a name="x4.1.7">4.1.7. Adding Other Security Methods to Kermit 95</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.1">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Kermit 95 includes a DLL interface for adding new security methods.
The DLL can be loaded with the SET NETWORK TYPE command:

</p><p>
</p><pre>  SET NETWORK TYPE DLL <i>dll-file</i>
</pre>
<p>

The connection is made with a SET HOST command:
</p><p>
</p><pre>  SET HOST <i>command-line</i>
</pre>
<p>

where the <i>command-line</i> is passed to the DLL after the normal Kermit
quoting rules are applied.  A C language skeleton for the DLL is available
here:

</p><p>
</p><pre>  <a href="http://www.columbia.edu/kermit/k95dll_c.txt">http://www.columbia.edu/kermit/k95dll_c.txt</a>
</pre>

<h3><a name="x4.2"><hr>4.2. Security in C-Kermit</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

SECTION CONTENTS

</p><p>
</p><pre>  4.2.1. <a href="#x4.2.1">Kerberos</a>
  4.2.2. <a href="#x4.2.2">SRP</a>
  4.2.3. <a href="#x4.2.3">SSL/TLS</a>
  4.2.4. <a href="#x4.2.4">Shadow Passwords</a>
  4.2.5. <a href="#x4.2.5">PAM</a>
  4.2.6. <a href="#x4.2.6">Using External Security Methods with C-Kermit</a>
</pre>
<p>

C-Kermit 8.0 can be compiled with support for Kerberos 4, Kerberos 5, Secure
Remote Password, and OpenSSL's SSLv3 and TLSv1.  As of this writing the
following combinations of platforms and security protocols are provided in the
Makefile distributed with C-Kermit:

</p><p>
</p><ul>
<li>aix41+krb5+krb4            
</li><li>aix43gcc+krb5+krb4         
</li><li>aix43gcc+krb5+krb4+openssl 
</li><li>irix6x+krb5		       
</li><li>irix65+krb5
</li><li>linux+krb5
</li><li>linux+krb5+krb4
</li><li>linux+srp+gmp
</li><li>linux+srp+gmp+no-des
</li><li>linux+srp+gmp-export
</li><li>linux+srp+gmp+pam
</li><li>linux+srp
</li><li>linux+srp+pam
</li><li>linux+shadow+pam
</li><li>linux+openssl
</li><li>linux+openssl+shadow
</li><li>linux+openssl+zlib+shadow+pam
</li><li>linux+srp+openssl
</li><li>linux+krb5+krb4+srp
</li><li>linux+krb5+krb4+srp+openssl
</li><li>linux+krb5+krb4+openssl
</li><li>linux+krb5+krb4+openssl+shadow
</li><li>linux+krb5+krb4+openssl+zlib+shadow
</li><li>linux+krb5+krb4+srp-export
</li><li>linux+krb5+krb4+srp+pam
</li><li>linux+krb5+krb4+srp+openssl+pam-debug
</li><li>linux+krb5+krb4+srp+openssl+pam
</li><li>linux+krb5+krb4+srp+openssl+zlib+pam
</li><li>linux+krb5+openssl+zlib+shadow+pam
</li><li>redhat71
</li><li>redhat71+srp
</li><li>solaris2x+krb4  
</li><li>solaris2xg+krb4
</li><li>solaris2xg+openssl+zlib+pam+shadow
</li><li>solaris2xg+openssl+pam+shadow
</li><li>solaris2xg+krb5+krb4+openssl+shadow
</li><li>solaris25+krb4
</li><li>solaris25g+krb4
</li><li>solaris25g+krb5+krb4+openssl+shadow
</li><li>solaris26g+openssl
</li><li>solaris8g+openssl+zlib+pam+shadow
</li><li>solaris8g+krb4
</li><li>sunos41gcc+krb4                 
</li><li>sunos41gcc+openssl              
</li><li>sunos41gcc+krb4+openssl         
</li><li>sunos41gcc+krb4+openssl+zlib    
</li><li>sunos41gcc+krb4+srp+openssl+zlib
</li><li>sunos41gcc+srp+openssl+zlib        
</li><li>uw7ssl
</li></ul>

<h3><a name="x4.2.1">4.2.1. Kerberos in C-Kermit 8.0</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Kerberos IV and Kerberos V support is available for Unix versions of C-Kermit
8.0.  Kerberos support in C-Kermit is provided for both outgoing and incoming
connections (<tt>SET HOST /SERVER * <i>port</i> /TELNET</tt> or the <a href="http://www.columbia.edu/kermit/iksd.html">Internet Kermit Service</a>).

</p><p>

Kerberized C-Kermit binaries are not available due to export restrictions (see
<a href="#x2">Section 2</a>); you must build your own binary from a
combination of Columbia source code and Kerberos libraries from other sources.

</p><p>
</p><ol>
<li>Retrieve a Kerberos 5 1.2.7 or later source code kit from the appropriate
site:

<p></p><pre>  <a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</a>
  <a href="http://web.mit.edu/network/kerberos-form.html">http://web.mit.edu/network/kerberos-form.html</a>
</pre><p>

</p></li><li>Choose a Kerberos 4 installation (from MIT) and retrieve a source code
kit from the appropriate site:

<p></p><pre>  <a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</a>
  <a href="http://web.mit.edu/network/kerberos-form.html">http://web.mit.edu/network/kerberos-form.html</a>
</pre><p>

</p></li><li>Build and install Kerberos on your system according to the instructions
that come with the Kerberos distribution you have chosen.

<p>

</p></li><li>Add a new entry to the C-Kermit makefile for your platform that
uses "krbmit" as the build target and adds the following to CFLAGS:

<p></p><pre>  -DCK_AUTHENTICATION -DCK_KERBEROS
</pre><p>

</p><dl><dt>For Kerberos 4 include:
</dt><dd><tt>-DKRB4 $(K4INC)</tt>
<p>
</p></dd><dt>For Kerberos 5 include:
</dt><dd><tt>-DKRB5 $(K5INC)</tt>
<p>
</p></dd><dt>For Kerberos 5 with Kerberos 4 compatibility mode:
</dt><dd><tt>-DKRB5 -DKRB524 -DKRB4 $(K5INC)</tt>
<p>
</p></dd><dt>If you desire DES and 3DES encryption include:
</dt><dd><tt>-DCK_ENCRYPTION -DCK_DES</tt>
<p>
</p></dd><dt>Add the appropriate libraries to LIBS.  For Kerberos 4 include:
</dt><dd><tt>$(K4LIB) -lkrb</tt>
<p>
</p></dd><dt>For Kerberos 5 include:
</dt><dd><tt>$(K5LIB) -lgssapi_krb5 -lkrb5 -lcom_err -lk5crypto</tt>
<p>
</p></dd><dt>For Kerberos 4 compatibility mode with Kerberos 5 include:
</dt><dd><tt>$(K5LIB) -ldes425 -lkrb4 -lgssapi_krb5 -lkrb5 -lcom_err -lk5crypto</tt>
<p>
</p></dd><dt>The makefile defines the path to the Kerberos header files using the
variables K4INC or K5INC:
</dt><dd><tt>-I/usr/kerberos/include</tt>
<p>
</p></dd><dt>The location of the Kerberos libraries is specified using the variables 
K4LIB or K5LIB:
</dt><dd><tt>-L/usr/kerberos/lib</tt>
</dd></dl>
<p>

The Kerberos header files and libraries are often installed in host specific
locations.  The values of the K4INC, K5INC, K4LIB, and K5LIB variables can
be altered by:

</p><p>
</p><ul>
<li>Editing the makefile
</li><li>Defining new values on the <i>make</i> command line
</li><li>Exporting the variables to the system environment and specifying the
<tt>-e</tt> on the <i>make</i> command line.
</li></ul>
<p>

Use the "<tt>linux+krb5</tt>", "<tt>linux+krb5+krb4</tt>", and 
"<tt>sunos41gcc+krb4</tt>" makefile entries as models.
</p></li></ol>
<p>

Note that the <tt>select()</tt> version of the CONNECT-command module
(<tt>ckucns.c</tt>) must be used rather than the older <tt>fork()</tt> based
(<tt>ckucon.c</tt>) version.

</p><p>

When C-Kermit 8.0 is built with Kerberos support and installed as an <a href="http://www.columbia.edu/kermit/iksd.html">Internet Kermit Service
Daemon</a> (IKSD), Kerberos is offered for authenticating incoming connections
if there is a valid keytab file providing local access to the key necessary
for decrypting meesages encoded in the server's key.

</p><p>

Note: Due to conflicts between the internal DES implementations used by MIT
Kerberos 4 (not the Kerberos 4 compatibility mode provided by Kerberos 5) and
OpenSSL, C-Kermit cannot be built to support Kerberos 4 FTP authentication
when both OpenSSL and Kerberos 4 are used in combination.

</p><h3><a name="x4.2.2">4.2.2.
Secure Remote Password protocol in C-Kermit</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Secure Remote Password (SRP) support is available for Unix versions of
C-Kermit 8.0.  SRP support in C-Kermit is provided for both outgoing and
incoming connections (SET HOST /SERVER * <i>port</i> /TELNET or the Internet
Kermit Service).

</p><p>

SRP C-Kermit binaries are not available due to export restrictions (see
<a href="#x2">Section 2</a>); you must build your own binary from a
combination of Columbia source code and SRP libraries from other sources.

</p><p>
</p><ol>
<li>Retrieve the SRP 1.7.4 source code kit from:

<p></p><pre>  <a href="http://srp.stanford.edu/srp/">http://srp.stanford.edu/srp/</a>
</pre><p>

</p></li><li>There are several different methods for configuring the build process 
of SRP.  Two methods are supported for use with C-Kermit.  The recommended
way is to build SRP using OpenSSL to provide the required big number math and
cryptographic functionality.  DES/3DES functionality is built into OpenSSL.

<p>

The second method is to build SRP with the
GNU MP library for big number math and use SRP's Krypto library for the
cryptographic functionality.  If 

</p><p>

Regardless of which method you decide to use, be sure to read 
the installation instructions before installing because SRP replaces many
standard Unix system files and failure to follow the procedures may leave
you locked out of your system.

</p><p>

</p></li><li>Add a new entry to the C-Kermit makefile for your platform that:
uses "srpmit" as the build target and adds the following CFLAGS:

<p></p><pre>  -DCK_AUTHENTICATION -DCK_SRP $(SRPINC)
</pre><p>

</p><dl><dt>If you built SRP with OpenSSL add:
</dt><dd><tt>$(SSLINC)</tt>
<p>

</p></dd><dt>If you desire telnet encryption include:
</dt><dd><tt>-DCK_ENCRYPTION</tt>
<p>

</p></dd><dt>For CAST encryption add:
</dt><dd><tt>-DCK_CAST</tt>
<p>

</p></dd><dt>For DES and 3DES encryption add:
</dt><dd><tt>-DCK_DES -DLIBDES</tt>
<p>

</p></dd><dt>Add the appropriate libraries to LIBS.  If you built SRP using OpenSSL:
</dt><dd><tt>$(SRPLIB) -lsrp -lkrypto $(SSLLIB) -lcrypto</tt>
<p>

</p></dd><dt>If you built SRP with GNU MP but without DES/3DES support use:
</dt><dd><tt>$(SRPLIB) -lsrp -lgmp -lkrypto</tt>
<p>

</p></dd><dt>If you built SRP with GNU MP and Eric Young's DES library use:
</dt><dd><tt>$(SRPLIB) -lsrp -lgmp -ldes -lkrypto</tt>
<p>

</p></dd><dt>The makefile defines the path to the SRP header files using the variable
SRPINC:
</dt><dd><tt>-I/usr/local/include</tt>
<p>

</p></dd><dt>The location of the Kerberos libraries is specified using the variable SRPLIB:
</dt><dd><tt>-L/usr/local/lib</tt>
<p>

</p></dd><dt>The makefile defines the path to the OpenSSL header files using the
variable SSLINC:
</dt><dd><tt>-I/usr/local/ssl/include</tt>
<p>

</p></dd><dt>The location of the OpenSSL libraries is specified using the variable
SSLLIB:
</dt><dd><tt>-L/usr/local/ssl/lib</tt>
</dd></dl>
<p>

The SRP and OpenSSL header files and libraries are often installed in host 
specific locations.  The values of the SRPINC, SRPLIB, SSLINC, and SSLLIB 
variables can be altered by:

</p><p>
</p><ul>
<li>Editing the makefile
</li><li>Defining new values on the <i>make</i> command line
</li><li>Exporting the variables to the system environment and specifying the
<tt>-e</tt> on the <i>make</i> command line.
</li></ul>
<p>

Use the "<tt>linux+srp</tt>" and
"<tt>linux+krb5+krb4+srp</tt>" makefile entries as models.
</p></li></ol>
<p>

Note that the <tt>select()</tt> version of the CONNECT-command module
(<tt>ckucns.c</tt>) must be used rather than the older <tt>fork()</tt> based
(<tt>ckucon.c</tt>) version.

</p><p>

When C-Kermit 8.0 is built with SRP support and installed as an
<a href="http://www.columbia.edu/kermit/iksd.html">Internet Kermit Service
Daemon</a> (IKSD), SRP is offered for authenticating incoming connections.

</p><h3><a name="x4.2.3">4.2.3.
OpenSSL support for SSLv3 and TLSv1 in C-Kermit 8.0.</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

OpenSSL support is available for Unix versions of C-Kermit 8.0.  SSLv3 and
TLSv1 support in C-Kermit is provided for both outgoing and incoming
connections (<tt>SET HOST /SERVER * <i>port</i> /TELNET</tt> or the <a href="http://www.columbia.edu/kermit/iksd.html">Internet Kermit Service</a>).

</p><p>

OpenSSL C-Kermit binaries are not available due to export restrictions (see
<a href="#x2">Section 2</a>); you must build your own binary from a
combination of Columbia source code and the OpenSSL libraries from other
sources.

</p><p>
</p><ol>
<li>Retrieve the OpenSSL 0.9.7 source code kit from:
<p></p><pre>  <a href="http://www.openssl.org/">http://www.openssl.org/</a>
</pre><p>

</p></li><li>Build OpenSSL according to the installation instructions.  Be aware that
OpenSSL includes support for algorithms that are covered by patents or
claimed as intellectual property in the United States (and perhaps some other
countries.)  Use of these algorithms without the proper licenses can make you
liable to legal action.  Be sure to read the entire README file before
building and installing OpenSSL.

<p>

OpenSSL has many features that can be selected when it is configured prior to
compiling the libraries.  One feature that's useful to C-Kermit is support for
Anonymous-Diffie-Hellman (ADH) ciphers in SRP and Kerberos 5 Telnet
Authentication.

</p><p>

Note: If you are using a version of OpenSSL later than SNAPSHOT 20011201 you
can build it with support for ZLIB compression and Kebreros 5 ciphers.
However, OpenSSL releases prior to version 1.0 are not guarranteed to be
backward compatible.  C-Kermit 8.0 builds with any 0.9.7 version of OpenSSL.
C-Kermit 8.0 might not build with future versions of OpenSSL without
modification.

</p><p>

</p></li><li>Add a new entry to the C-Kermit makefile for your platform that uses
"krbmit" as the build target and adds the following to CFLAGS:

<p></p><pre>  -DCK_AUTHENTICATION -DCK_SSL $(SSLINC)
</pre><p>

</p><dt>To add support for ZLIB compression add the following to CFLAGS:
</dt><dd><tt>-DZLIB</tt>
<p>

</p></dd><dt>Add the appropriate libraries to LIBS:
</dt><dd><tt>$(SSLLIB) -lssl -lcrypto</tt>
<p>

</p></dd><dt>For ZLIB compression add to LIBS:
</dt><dd><tt>-lzlib</tt>
<p>

</p></dd><dt>The makefile defines the path to the OpenSSL header files using the
variable SSLINC:
</dt><dd><tt>-I/usr/local/ssl/include</tt>
<p>

</p></dd><dt>The location of the OpenSSL libraries is specified using the variable
SSLLIB:
</dt><dd><tt>-L/usr/local/ssl/lib</tt>


<p>

The OpenSSL header files and libraries are often installed in host specific
locations.  The values of the SSLINC and SSLLIB variables can
be altered by:

</p><ul>
<li>editing the makefile
</li><li>defining new values on the <i>make</i> command line
</li><li>exporting the variables to the system environment and specifying the <i>-e</i>
on the <i>make</i> command line.
</li></ul>

<p>
Use the "<tt>linux+openssl</tt>" and
"<tt>linux+krb5+krb4+srp+openssl</tt>" makefile entries as models.
</p></dd></li></ol>
<p>

Note that the <tt>select()</tt> version of the CONNECT-command module
(<tt>ckucns.c</tt>) must be used rather than the older <tt>fork()</tt> based
(<tt>ckucon.c</tt>) version.

</p><p>

When C-Kermit 8.0 is installed as an Internet Kermit Service (IKSD), TLSv1
is offered for authenticating incoming connections via the Telnet START_TLS
option.

</p><p>

If you wish to provide support for authentication of clients using public
key certificates you must provide two custom functions <tt>X509_to_user()</tt> 
and <tt>X509_userok</tt>.  These functions
provide the certificate to local userid mapping and user authorization 
functionality.  Example functions that
use the /UID field of the Certificate Subject name may be activated by
specifying:

</p><p></p><pre>  make <i>entry</i> KFLAGS=-DX509_UID_TO_USER
</pre><p>

when compiling C-Kermit.  If you with to use the Certificate Subject Alternate
Name you can specify:

</p><p></p><pre>  make <i>entry</i> KFLAGS=-DX509_SUBJECT_ALT_NAME_TO_USER
</pre><p>

The <tt>X509_to_user()</tt> and <tt>X509_userok()</tt> 
functions are the last functions in the <tt>ck_ssl.c</tt> module.  See
<a href="#xa3.11.2">Appendix III</a>.

</p><h3><a name="x4.2.4">4.2.4.  Shadow Passwords in C-Kermit 8.0</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Shadow password files are used in many versions of Unix to provide a greater
level of security for user passwords stored on the local disk.  The standard
Unix password file must be world readable so processes can find out the user's
shell, home directory, and other permissions.  By moving the passwords into a
separate file that only stores passwords, access to the file can be restricted
to only those processes that are authorized to perform authentication.

</p><p>

When C-Kermit 8.0 is used as the Internet Kermit Service on systems that are
configured to use shadow passwords the following CFLAG must be added to the
makefile entry:
</p><p></p><pre>  -DCK_SHADOW
</pre>

<h3><a name="x4.2.5">4.2.5.
Pluggable Authentication Module (PAM) Support in C-Kermit 8.0</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

PAM is implemented in many versions of Unix so system administrators can
add new forms of authentication for interactive login (console, telnet,
rlogin, ...) without requiring recompilation of each service.

</p><p>

When C-Kermit 8.0 is used as the Internet Kermit Service on systems that are
configured to use PAM the following CFLAG must be added to the makefile
entry:

</p><p></p><pre>  -DCK_PAM
</pre><p>

and the following libraries may have to be included:

</p><p></p><pre>  -lpam -ldl
</pre><p>

The default PAM Service Name is "kermit".  If you wish to use a different
name specify:

</p><p></p><pre>  KFLAGS=-DPAM_SERVICE_NAME="service-name"
</pre>

when building C-Kermit.

<p>

Before C-Kermit can be used with PAM, configuration information must be added
for the specified PAM_SERVICE_NAME to either <tt>/etc/pam.conf</tt> or
<tt>/etc/pam.d/</tt> depending on the version of PAM your operating system has
installed.  A complete primer on PAM can (or once could be) be found at:

</p><p>
</p><pre>  <a href="http://www.kernel.org/pub/linux/libs/pam/Linux-PAM-html/">http://www.kernel.org/pub/linux/libs/pam/Linux-PAM-html/</a>.
</pre>
<p>

</p><h3><a name="x4.2.6">4.2.6.
Using External Security Methods with C-Kermit</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#x4">Chapter Contents</a> ]
[ <a href="#x4.2">Section Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Other protocols can be used to create secure connections that are not
currently implemented in Kermit, such as Secure Shell (SSH).  The fact that
SSH is not integrated into Kermit software does not mean that Kermit cannot be
used in conjunction with it.  SSH provides for tunneling, which allows a
localhost proxy to be configured to take insecure connections on the local
machine and connect them via secure connections to remote hosts.

</p><p>

Secure connection clients can be used as the communication channel in C-Kermit
7.0 and later and Kermit 95 1.1.16 and later via the PTY (Unix only) and PIPE
commands.  See
<a href="http://www.columbia.edu/kermit/ckermit70.html#x2.7">Section 2.7</a>
of the
<a href="http://www.columbia.edu/kermit/ckermit70.html">C-Kermit 7.0 Update
Notes</a> for details.

</p><p>

Firewalls based on access lists, proxies, and SOCKS do not provide secure
connections.  However, they do restrict the ports that may be used to
communicate between the Internet and the Intranet which makes it more
difficult for someone to break into the Intranet from outside.  They do not
protect the network from internal attacks nor do they protect a connection,
once made, from eavesdropping or hijacking.  They may be used in conjunction
with secure connection systems but should not be used as a replacement for
them.  C-Kermit can be built as a SOCKS client if you have a SOCKS library;
otherwise you can run SOCKSified Telnet or Rlogin clients through C-Kermit
with the PIPE command.  See <a href="http://www.columbia.edu/kermit/ckccfg.html#x8.1.1">Section 8.1.1</a> of
the <a href="http://www.columbia.edu/kermit/ckccfg.html">C-Kermit
Configuration Options</a> document for details.

</p><p>

[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/k95.html">Kermit 95</a> ]

</p><h3><a name="x5"><hr>5. SCRIPTING AND AUTOMATION</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
[ <a href="#xa1">Appendices</a> ]
[ <a href="#x4">Previous</a> ]
<p>

</p><h3><a name="x5.1">5.1 VARIABLES</a></h3>
<h3><a name="x5.1.1">5.1.1 General Authentication Variables</a></h3>

<dl><dt><tt><b>\v(authname)</b></tt>

</dt><dd>Valid only when Kermit is accepting a connection.  This
variable contains the name of the user that has been
authenticated as opposed to \v(userid) which contains the
name the user chose to login as.  This distinction is
important for \v(authstate) = "user" since this means that
although we were able to authenticate the user as \v(authname)
we could not verify that she has authorization to access
the account of \v(userid).

<p>
</p></dd><dt><tt><b>\v(authstate)</b></tt>
</dt><dd>String indicating current state of authentication:
<p></p><pre>"rejected" - Rejected or otherwise not authenticated
"unknown"  - Anonymous connection
"other"    - We know him, but not his name
"user"     - We know his name
"valid"    - We know him, and he needs no password
</pre><p>
</p></dd><dt><tt><b>\v(authtype)</b></tt>
</dt><dd>String indicating which telnet (or other) authentication method
is in use.
<p></p><pre>"NULL"              - No authentication
"KERBEROS_V4"       - Kerberos 4
"KERBEROS_V5"       - Kerberos 5
"SRP"               - Secure Remote Password
"NTLM"              - NT Lan Manager
"X_509_CERTIFICATE" - X.509 certificate
</pre>
</dd><dt><tt><b>\v(secure)</b></tt>
</dt><dd>The numeric value 1 if the connection is encrypted and 0 otherwise.
</dd></dl>

<h3><a name="x5.1.2">5.1.2. Kerberos Variables</a></h3>

<dl><dt><tt><b>\v(krb5cc)   </b></tt>
</dt><dd>Current kerberos V credentials cache.
</dd><dt><tt><b>\v(krb5princ)</b></tt>
</dt><dd>Current kerberos V principal name.
</dd><dt><tt><b>\v(krb5realm)</b></tt>
</dt><dd>Current kerberos V realm name.
</dd><dt><tt><b>\v(krb5errno)</b></tt>
</dt><dd>Last Kerberos V errno
</dd><dt><tt><b>\v(krb5errmsg)</b></tt>
</dt><dd>Last Kerberos V error message
</dd><dt><tt><b>\v(krb4princ)</b></tt>
</dt><dd>Current kerberos IV principal name.
</dd><dt><tt><b>\v(krb4realm)</b></tt>
</dt><dd>Current kerberos IV realm name.
</dd><dt><tt><b>\v(krb4errno)</b></tt>
</dt><dd>Last Kerberos IV errno
</dd><dt><tt><b>\v(krb4errmsg)</b></tt>
</dt><dd>Last Kerberos IV error message
</dd></dl>

<h3><a name="x5.1.3">5.1.3. SSL/TLS Variables</a></h3>

<dl><dt><tt><b>\v(x509_issuer)</b></tt>
</dt><dd>The issuer string from the peer's X.509 certificate
</dd><dt><tt><b>\v(x509_subject)</b></tt>
</dt><dd>The subject string from the peer's X.509 certificate
</dd></dl><p>
[ <a href="#top">Top</a> ]
[ <a href="http://www.kermitproject.org/case21.html">Case Study</a> ]
[ <a href="http://www.kermitproject.org/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.kermitproject.org/ck80.html">C-Kermit 8.0</a> ]
[ <a href="http://www.kermitproject.org/index.html">Kermit Home</a> ]
[ <a href="http://www.kermitproject.org/k95.html">Kermit 95</a> ]
[ <a href="http://www.kermitproject.org/index.html">Kermit Home</a> ]
</p><hr>

<h3><a name="x5.2">5.2. FUNCTIONS</a></h3>

All Kerberos functions require the Kerberos version number, 4 or 5, as the
first argument (n).
<p></p><dl><dt><tt><b>\fkrbtickets(</b><i>n</i><b>)</b></tt>
</dt><dd>The number of active Kerberos <i>n</i> (4 or 5) tickets.  This resets the
ticket list used by <tt>\fkrbnextticket(<i>n</i>)</tt>.
<p>
</p></dd><dt><tt><b>\fkrbnextticket(</b><i>n</i><b>)</b></tt>
</dt><dd>The next ticket in the Kerberos <i>n</i> (4 or 5) ticket list that was set
up by the most recent invocation of <tt>\fkrbtickets(<i>n</i>)</tt>.
<p>
</p></dd><dt><tt><b>\fkrbisvalid(</b><i>n,name</i><b>)</b></tt>
</dt><dd>The name is a ticket name, as returned by
<tt>\fkrbnextticket(<i>n</i>)</tt>.  Returns
1 if the ticket is valid, 0 if not valid.  A ticket is valid if all the
following conditions are true:
<p></p><ol>
<li>it exists in the current cache file;
</li><li>it is not expired;
</li><li>it is not marked invalid (K5 only);
</li><li>it was issued from the current IP address
</li></ol><p>
This value can be used in an IF statement, e.g.:
</p><p></p><pre>    if \fkrbisvalid(4,krbtgt.FOO.BAR.EDU@FOO.BAR.EDU) ...
</pre><p>
</p></dd><dt><tt><b>\fkrbtimeleft(</b><i>n,name</i><b>)</b></tt>
</dt><dd>The name is a ticket name, as returned by
<tt>\fkrbnextticket(<i>n</i>)</tt>.  Returns
the number of seconds remaining in the ticket's lifetime.
<p>
</p></dd><dt><tt><b>\fkrbflags(</b><i>n,name</i><b>)</b></tt>
</dt><dd>The name is a ticket name, as returned by
<tt>\fkrbnextticket(<i>n</i>)</tt>.  Returns the flags string as reported with
<tt>AUTH K5 LIST /FLAGS</tt>.  This string can be searched for a particular
flag using the <tt>\findex()</tt> function when SET CASE is ON (for case
sensitive searches).  Flag strings are only available for K5 tickets.
</dd></dl>
<p>
Kerberos 5 functions operate against the current credential-cache file as set
by SET AUTHORIZATION K5 CREDENTIALS-FILE <i>filename</i>.
</p><p>
[ <a href="#top">Top</a> ]
[ <a href="http://www.kermitproject.org/case21.html">Case Study</a> ]
[ <a href="http://www.kermitproject.org/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.kermitproject.org/ck80.html">C-Kermit 8.0</a> ]
[ <a href="http://www.kermitproject.org/index.html">Kermit Home</a> ]
[ <a href="http://www.kermitproject.org/k95.html">Kermit 95</a> ]
[ <a href="http://www.kermitproject.org/index.html">Kermit Home</a> ]
</p><hr>

<h3><a name="x5.3">5.3. SCRIPTING HINTS</a></h3>
<h3><a name="x5.3.1">5.3.1.  Kerberos Autoget</a></h3>

When developing scripts to be used without user interaction you should turn
off the Kerberos AutoGet TGT feature with
<p></p><pre>  SET AUTHENTICATION KERBEROS4 AUTOGET OFF
  SET AUTHENTICATION KERBEROS5 AUTOGET OFF
</pre><p>
When autoget mode is disabled, Kermit does not automatically perform the
function of KINIT. Instead this automation can be scripted; for example:
</p><p></p><pre>  SET TELOPT AUTHENTICATION REQUIRED
  SET HOST <i>host</i>:<i>port</i> /TELNET
  IF FAILURE {
      AUTHENTICATE K4 INIT ; (or K5)
      SET HOST <i>host</i>:<i>port</i>
      IF FAILURE { <i>do whatever on failure</i> }
  }
</pre><p>
or place the following in your K95CUSTOM.INI file to insure a valid
Ticket Granting Ticket each time you start K95:
</p><p></p><pre>  IF AVAILABLE KERBEROS4 {
    IF NOT \Fkrbisvalid(4,krbtgt.\v(krb4realm)@\v(krb4realm)) {
      echo Kerberos 4 Ticket Granting Ticket is invalid!
      AUTH K4 INIT
    }
  }

  IF AVAILABLE KERBEROS5 {
    IF NOT \Fkrbisvalid(5,krbtgt/\v(krb5realm)@\v(krb5realm)) {
      echo Kerberos 5 Ticket Granting Ticket is invalid!
      AUTH K5 INIT
    }
  }
</pre>

<h3><a name="x5.3.2">5.3.2. Autodestruction of Kerberos Credentials</a></h3>

When Kermit is used on a machine in a public lab and Kerberos is used for
authentication it is often desireable to not have the Kerberos credentials
survive the current session.
<p></p><dl><dt><b>SET AUTH</b><i> {</i><b> K4, K5</b><i>}</i><b> AUTODESTROY</b><i> {</i><b> ON-CLOSE, ON-EXIT</b><i> }</i>
</dt><dd>Automates the destruction of Kerberos credentials under the specified
condition.
</dd></dl>

<h3><a name="x5.3.3">5.3.3.  Automated prompting for usernames</a></h3>

To prevent Kermit from using the username reported by the local operating
system for the remote userid and kerberos principal use:
<p></p><pre>  SET LOGIN USERID {}
  SET AUTHENTICATION KERBEROS4 PRINCIPAL {}
  SET AUTHENTICATION KERBEROS5 PRINCIPAL {}
</pre><p>
This forces Kermit to prompt the user for the userid and principal
when requesting credentials.

</p><h3><a name="x5.3.4">5.3.4.  Password Inclusion in Script Files</a></h3>

Although it is not recommended (since storing passwords openly in a file,
especially on a PC, is a serious security risk), connections may be scripted
without user interaction:
<p></p><pre>  SET HOST /PASSWORD:<i>password</i> /USERID:<i>user</i> <i>host port</i> /TELNET
</pre><p>
The security risk can be avoided if the script prompts for the password:
</p><p></p><pre>  ASKQ \%p Password:
  SET HOST PASSWORD:\%p /USERID:<i>user</i> <i>host port</i> /TELNET
  UNDEF \%p
</pre><p>
Of course, if the /PASSWORD switch is not specified Kermit prompts for the
password automatically when the host requests the use of authentication.

</p><h3><a name="x5.3.5">5.3.5.   Using Kermit Scripts to Produce Secure Telnet Services</a></h3>

The following series of commands causes a Kermit script to accept only
authenticated and encrypted connections:
<p></p><pre>  SET TELOPT /SERVER AUTH REQUIRE
  SET TELOPT /SERVER ENCRYPT REQUIRE REQUIRE
  SET HOST * <i>port</i> /TELNET
  IF FAILURE { <i>do appropriate error handling</i> }
</pre><p>

The <tt>\v(authstate)</tt> variable tells the script which level of
authentication has been achieved.  If the value is "valid" that means that the
account specified by <tt>\v(userid)</tt> has been authenticated and authorized
for use by <tt>\v(authname)</tt>.  If the value of <tt>\v(authstate)</tt> is
"user" then \v(authname) has been authenticated but she does not have known
authorization to access the account <tt>\v(userid)</tt>.  This usually means
that some additional verification is needed.
</p><p>
</p><pre>  IF EQ "\v(authstate)" "valid" {
    <i>proceed without further authorization</i>
  }
  IF EQ "\v(authstate)" "user" {
    <i>perform further authorization before providing service</i>
  }
</pre>
<p>

It is important to realize that when a Kermit script is used in this manner,
the Telnet negotiations provide authentication of the user and potentially
encryption of the data communication.  There is no facility in a Kermit script
to change the ownership of the currently running process from the user that
started it to the user ID of the authenticated user.  This means that the
script the authenticated user is accessing has all of the privileges of the
process executer and not the authenticated user.

</p><p>

Another important fact to remember is that secure access to an insecure
environment is not secure.  If you are using Windows 95 or 98 to run scripts,
while it is possible to use Kerberos or SRP to authenticate the incoming
clients, the insecure nature of the Windows environment means that it is
impossible for the Kerberos service key tables and SRP password databases to
be protected from tampering; the security in this case is no stronger than
than the security of Windows 9x.

</p><p>
[ <a href="#top">Top</a> ]
[ <a href="http://www.kermitproject.org/case21.html">Case Study</a> ]
[ <a href="http://www.kermitproject.org/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.kermitproject.org/ck80.html">C-Kermit 8.0</a> ]
[ <a href="http://www.kermitproject.org/index.html">Kermit Home</a> ]
[ <a href="http://www.kermitproject.org/k95.html">Kermit 95</a> ]
[ <a href="http://www.kermitproject.org/index.html">Kermit Home</a> ]

</p><h3><a name="xa1"></a><a name="servers"><hr>APPENDIX I.
WHERE TO FIND SECURE TELNET AND FTP SERVERS</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Home</a> ]
<p>

CONTENTS

</p><p>
</p><pre>  I.1. <a href="#xa1.1">Telnet</a>
  I.2. <a href="#xa1.2">FTP</a>
  I.3. <a href="#xa1.3">Internet Kermit Service</a>
  I.4. <a href="#xa1.4">HTTP</a>
  I.5. <a href="#xa1.5">SSH</a>
  I.6. <a href="#xa1.6">Securing Insecure Services with STunntl</a>
</pre>
<p>

Contrary to widespread misconception, Telnet and FTP are not insecure
protocols to be discarded.  These protocols have been secured by the IETF
through the addition of standard security methods: Kerberos, SSL/TLS, and SRP
(see <a href="#references">REFERENCES</a>) and continue to offer manifold
advantages over their would-be replacements in terms of functionality,
flexibility, and platform independence.  If your operating system does not
include secure remote access methods, secure third-party servers can often be
found.

</p><h3><a name="xa1.1">I.1. Secure Telnet Servers</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa1">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

</p><dl><dt><b>Sun Solaris 8 and later</b>
</dt><dd>Ships with a Kerberos 5 enabled Telnetd.

<p>

</p></dd><dt><b>Apple Mac OS X</b>
</dt><dd>Ships with a Kerberos 5 enabled Telnetd.

<p>

</p></dd><dt><b>Cisco IOS</b>
</dt><dd>The telnet server for Cisco routers, terminal servers, ... ships
with Kerberos 5 support.

<p>

</p></dd><dt><b>SCO (Caldera) OSR5, Unixware 7, and Open UNIX 8</b>
</dt><dd>Ships with Kerberos 5 support.

<p>


</p></dd><dt><b>Z/OS V1R2.0 Communication Server for Server/390 IP</b>
</dt><dd>Ships with Kerberos 5 support:
<pre>  <a href="http://www-1.ibm.com/servers/eserver/zseries/zos/commserver/kerberos.html">http://www-1.ibm.com/servers/eserver/zseries/zos/commserver/kerberos.html</a>
</pre>

<p>

</p></dd><dt><b>Debian and Red Hat Linux</b>
</dt><dd>Recent versions ship with Kerberos 5 support.

<p>

</p></dd><dt><b>HP-UX 11</b>
</dt><dd>Ships with Kerberos 5 support.

<p>

</p></dd><dt><b>Compaq DCE for OpenVMS</b>
</dt><dd>provides Kerberos 5 support.

<p>

</p></dd><dt><b>MIT Kerberos 5 1.2.7</b>

</dt><dd>The Kerberos 5 Telnet server is part of the standard Kerberos 5
distribution available from MIT.  Kerberos 5 is unique among authentication
methods in offering true single sign-on capability to the network via
forwarded credentials.  It also allows authentication to cross Kerberos
realms; for example, between different organizations.

<p>

The Kerberos 5 Telnet server is "downwards compatible" with the older Kerberos
4 protocol.  The Kerberos 5 Telnet authentication protocol provides for strong
mutual authentication of the client and server without requiring the client to
possess prior knowledge of the server's credentials.  During authentication a
session key (DES, RC4, 3DES) is produced that is used with a negotiated
encryption algorithm to give privacy protection to incoming and outgoing
data.

</p><p></p><pre>  <a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</a>
</pre><p>

Follow the links to "Getting Kerberos from MIT".  Future versions of 
the MIT Kerberos 5 distribution will include support for
SSL/TLS and X Windows System Data Forwarding.

</p><p> 

</p></dd><dt><b>MIT Kerberos 4</b>

</dt><dd>The precursor to Kerberos 5.  Kerberos 4 provides strong authentication
without the single sign-on or cross-realm capabilities of Kerberos 5.  The
Kerberos 4 Telnet server is part of the Kerberos 4 distribution.

<p>

The Kerberos 4 Telnet authentication protocol provides for strong mutual
authentication of client and server without requiring prior knowledge by the
client of the server's credentials.  During authentication a session key
(56-bit DES only) is produced for use with a negotiated encryption
algorithm for privacy of incoming and outgoing data.

</p><p></p><pre>  <a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</a>
</pre><p>
</p><p>
Follow the links to "Getting Kerberos from MIT".
</p><p>

</p></dd><dt><b>Secure Remote Password</b>

</dt><dd>SRP is based on Zero Knowledge Identification algorithms by which the
client and server prove their identities by exchanging data over a public
channel.  This data can't be used to determine the secrets involved nor can it
be used to replicate the authentication sequence.  Authentication of the
server does not require the client to have prior knowledge of the server's
credentials.  During authentication a session key (320-bits) is produced for
use with a negotiated encryption algorithm to provide privacy protection to
incoming and outgoing data.  As of the 1.7.1 release, the SRP Telnet client
and server implement the START_TLS option as well as the X Windows Systems
Data Forwarding option.  This distribution can be built against MIT Kerberos 5
or MIT Kerberos 4 distribution to enable Kerberos authentication.  The
combination of START_TLS and AUTH (SRP and KRB5) provide for the strongest
combination of private communication and password based mututal
authentication.

<p>
The SRP Telnet server is part of the SRP distribution: 

</p><p></p><pre>  <a href="http://www-cs-students.stanford.edu/%7Etjw/srp/">http://www-cs-students.stanford.edu/~tjw/srp/</a>
</pre>
<p>

Follow the link to Download Software

</p><p> 

</p></dd><dt><b>Transport Layer Security (X.509 certificates and Kerberos 5)</b>

</dt><dd>TLSv1 (the successor to SSLv3 used in most Web browsers) provides strong
encryption and optional authentication of the server and client using X.509
certificates or Kerberos 5.  Authentication of the server via X.509 requires
the client to have prior knowledge of the server's X.509 certificate or the
certificates of the Certificate Authorities that signed the server's
certificate.  An open source distribution of TLSv1 is available from:

<p></p><pre>  <a href="http://www.openssl.org/">http://www.openssl.org/</a>
</pre><p>
</p><p>

Current development snapshots of OpenSSL are required for Kerberos 5 support.
A Telnet server that implements the START_TLS option and X Windows
System Data Forwarding is available from:

</p><p></p><pre>  <a href="ftp://ftp.runestig.com/pub/starttls/start_tls-telnet.current.tar.gz">ftp://ftp.runestig.com/pub/starttls/start_tls-telnet.current.tar.gz</a>
</pre>
</dd></dl>

<h3><a name="xa1.2"><hr>I.2. Secure FTP Servers</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa1">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]

<p>
</p><dl><dt><b>MIT Kerberos 5 1.2.7</b>

</dt><dd>The Kerberos 5 FTP server is part of the standard Kerberos 5 distribution
available from MIT.  Kerberos 5 is unique among authentication methods in
offering true single sign-on capability to the network via forwarded
credentials.  It also allows authentication to cross Kerberos realms; for
example, between different organizations.

<p>

The Kerberos 5 FTP server provides for strong authentication using either
Kerberos 4 or GSSAPI-Kerberos 5.  Both the command and data channels are
encrypted and integrity protected.

</p><p></p><pre>  <a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</a>
</pre><p>

Follow the links to "Getting Kerberos from MIT".  Future versions of 
the MIT Kerberos 5 distribution will include support for 
SSL/TLS and X Windows System Data Forwarding.

</p><p> 

</p></dd><dt><b>MIT Kerberos 4</b>

</dt><dd>The precursor to Kerberos 5.  Kerberos 4 provides strong authentication
without the single sign-on or cross-realm capabilities of Kerberos 5.  The
Kerberos 4 Telnet and FTP clients and servers are part of the Kerberos 4
distribution.

<p>

The Kerberos 4 FTP server provides for strong authentication.  Both the 
command and data channels are encrypted and integrity protected.

</p><p></p><pre>  <a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</a>
</pre>
<p>

Follow the links to "Getting Kerberos from MIT".

</p><p>

</p></dd><dt><b>Secure Remote Password</b>

</dt><dd>SRP is based on Zero Knowledge Identification algorithms by which the
client and server prove their identities by exchanging data over a public
channel.  This data can't be used to determine the secrets involved nor can it
be used to replicate the authentication sequence.  Authentication of the
server does not require the client to have prior knowledge of the server's
credentials.  During authentication a session key (320-bits) is produced 
for use with a negotiated encryption algorithm to provide privacy protection
to incoming and outgoing data.

<p>

The FTP server provides for strong authentication.  Both the command and
data channels are encrypted and integrity protected with a user selectable
set of encryption algorithms (blowfish, cast-128, 3des, des) and hash
algorithms (md5, sha-1). 

</p><p></p><pre>  <a href="http://www-cs-students.stanford.edu/%7Etjw/srp/">http://www-cs-students.stanford.edu/~tjw/srp/</a>
</pre>
<p>

Follow the link to Download Software

</p><p> 

</p></dd><dt><b>Transport Layer Security (X.509 certificates and Kerberos 5)</b>

</dt><dd>TLSv1 (the successor to SSLv3 used in most Web browsers) provides strong
encryption and optional authentication of the server and client using X.509
certificates or Kerberos 5.  Authentication of the server via X.509 requires
the client to have prior knowledge of the server's X.509 certificate or the
certificates of the Certificate Authorities that signed the server's
certificate.  An open source distribution of TLSv1 is available from:

<p></p><pre>  <a href="http://www.openssl.org/">http://www.openssl.org/</a>
</pre><p>
</p><p>

Current development snapshots of OpenSSL are required for Kerberos 5 support.

</p><p>

Two FTP servers that implement the SSL/TLS protocol for securing both the
command and data channels are available from:

</p><p></p><pre>  <a href="ftp://ftp.runestig.com/pub/ftp-tls/">ftp://ftp.runestig.com/pub/ftp-tls/</a>
  <a href="ftp://ftp.runestig.com/pub/ftpd-tls/">ftp://ftp.runestig.com/pub/ftpd-tls/</a>
  <a href="ftp://ftp.runestig.com/pub/proftpd-tls/">ftp://ftp.runestig.com/pub/proftpd-tls/</a>
</pre>
</dd></dl>
<p>
The current (Dec 2001) test version of

<a href="http://www.debian.org/">Debian Linux</a> includes
ProFTPD with TLS security.

</p><h3><a name="xa1.3"><hr>I.3. Secure Internet Kermit Service</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa1">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Available from Columbia University:

</p><p>
</p><ul>
<li><a href="http://www.columbia.edu/kermit/cuiksd.html">Unix User Documentation</a>
</li><li><a href="http://www.columbia.edu/kermit/iksd.html">Unix Administrator Documentation</a>
</li><li><a href="http://www.columbia.edu/kermit/wiksduse.html">Windows User Documentation</a>
</li><li></li><li><a href="http://www.columbia.edu/kermit/wiksdadm.html">Windows Administrator Documentation</a>
</li></ul>

<h3><a name="xa1.4">I.4. Secure HTTP Servers</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa1">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Most web servers provide support for SSL/TLS secured HTTP connections.

</p><h3><a name="xa1.5">I.5. Secure SSH Servers</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa1">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The OpenSSH Project distributes SSH servers.  To add the extra security of SRP
and/or GSSAPI authentication, they must be patched.  First download the
OpenSSH source code, then use the 'patch' program to apply the desired
patches:


</p><dl><dt>OpenSSH Source Code:
</dt><dd><a href="http://www.openssh.org/"><tt>http://www.openssh.org/</tt></a>
<p>
</p></dd><dt>SRP Patch:
</dt><dd><a href="http://members.tripod.com/professor_tom/archives/"><tt>http://members.tripod.com/professor_tom/archives/</tt></a>
<p>
</p></dd><dt>GSSAPI Patch:
</dt><dd><a href="http://www.sxw.org.uk/computing/patches/openssh.html"><tt>http://www.sxw.org.uk/computing/patches/openssh.html</tt></a>
</dd></dl>


<h3><a name="xa1.6">I.6. Securing Insecure Services with STunnel</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa1">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

It is also possible to wrap a nonsecure service such as Telnet or Sredird in <a href="http://www.stunnel.org/">Stunnel</a>, for use with Kermit's abiity to 
negotiate non-secure protocols over SSL/TLS; 
<a href="http://www.columbia.edu/kermit/case21.html">CLICK HERE</a> for a case
study.

</p><h3><a name="xa2"><hr>APPENDIX II.
MULTI-HOMED HOSTS, FIREWALLS, AND NETWORK ADDRESS TRANSLATION</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

CONTENTS

</p><p>
</p><pre>  II.1. <a href="#xa2.1">Firewalls</a>
  II.2. <a href="#xa2.2">Network Address Translation</a>
  II.3. <a href="#xa2.3">Multi-Homed Hosts and Aliasing</a>
</pre>
<p>

The Internet was originally designed for end-to-end communication between
connected computers belonging to a single cloud.  All computers were able to 
directly communicate with all the other computers attached to the network.
In particular, if computer A could communicate with computer B then computer B
could communicate with computer A.  Unfortunately, this no longer true.

</p><p>

Three factors changed this.  First, the abuse of the Internet by hackers and
virus/worm authors convinced organizations that wished to join the internet
that it was not safe to do so without limiting their exposure.  This resulted
in the popular use of firewalls to restrict the types of communications that
could flow across the Internet gateways.

</p><p>

The second factor was the success of the world wide web and the use of client
only computers that did not have permanent addresses.  These computers (mostly
DOS, Windows, and Macintosh) did not run services and were only used to 
communicate with a very small number of server computers that spoke HTTP.
Connectivity to these machines only required one way communication:  from the
client to the server.

</p><p>

The third factor was the explosion in the number of client devices that are
connected to the Internet.  When an individual or company wants to connect
their computers to the Internet they need to be assigned IP addresses for
their computers.  However, most ISPs sell service based on the number of
assigned IP addresses or, in the case of home networks, provide only a single
address.  To save money or simply two put all the kids' computers on the
network at the same time, people started to experiment with network gateways
that implemented Network Address Translation (NAT).  The NAT would convert the
IP addresses of multiple computers on the private side of the gateway to share
a single address on the public side of the gateway.  A computer that has been
assigned an address that is being translated can establish and listen for
connections with other computers on the private side of the network and can
establish connections to computers on the public side of the network.
However, the computers cannot receive connections established from computers
on the pubic side of the network because the true address of the computer has
been hidden.

</p><p>

These factors complicate the use of many Internet protocols such as FTP and
cause problems for authentication systems.  In addition to these problems
there are some other issues that must be taken into account.  It is possible
for a single computer to have multiple network adapter cards.  This is often
done to allow a computer to act as a gateway between two networks; to provide
the computer with redundancy for critical services; or to allow the computer
to maintain more than one identity (such as to provide web services for two
different domains.)  Computers with multiple network addresses are referred to
as being "multi-homed".

</p><p>

There are also potential problems caused when multiple computers are used to
serve a single purpose.  For instance, a web server for a large commercial
operation probably does not have a single computer providing service to all of
their customers.  Instead they have a farm (or cluster) of computers.  The one
you actually are served by is determined randomly using a load-balancing
algorithm.  When you authenticate to one of these computers you do not want to
authenticate to the individual name assigned to each computer but to the
common name used to access any one of them.  The technique used to allow
multiple computers to respond to a single name is called "aliasing".

</p><h3><a name="xa2.1">II.1 Firewalls</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa2">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Firewalls are used to restrict the types of network packets that may cross
a network boundary.  Firewall products fall into four general categories:

</p><p>
</p><dl><dt><b>Port Filtering Firewalls</b>
</dt><dd>Port Filtering firewalls are the simplist of the firewall techniques.
Port filtering is performed by specifying an ordered set of ACCEPT and DENY
rules for each combination of:

<p>
</p><ul>
<li>packet type
</li><li>source address
</li><li>source port
</li><li>destination address
</li><li>destination port
</li><li>if packet type is TCP, whether a connection must exist or not
</li></ul>
<p>

This allows a firewall to be configured to only allow through the firewall
packets that are meant for specific computers; or packets meant for specific
services; or packets to/from specific hosts/networks.

</p><p>

Port Filtering firewalls frequently cause problems for users of Kerberos
authentication when they are not configured to allow UDP packets to be
sent or received from the Key Distribution Center.

</p><p>

Port Filtering firewalls are also a problem for the FTP protocol since the
standard mode is for the FTP server to establish a data channel on a random
port number to the FTP client when data is to be transfered.  This port 
number is agreed to be sending the destination address and port value across
the FTP command channel.

</p><p>

Port Filtering firewalls need to be configured to allow connections
from clients to reach the host ports necessary for each protocol that is
used with Kermit:

</p><p>
</p><blockquote>
<table>
<tbody><tr>
<th align="left">Port
</th><th align="left">Protocol
</th></tr><tr>
<td>21<tt>/</tt>tcp
</td><td>FTP
</td></tr><tr>
<td>22<tt>/</tt>tcp
</td><td>SSH
</td></tr><tr>
<td>23<tt>/</tt>tcp
</td><td>Telnet
</td></tr><tr>
<td>80<tt>/</tt>tcp
</td><td>HTTP
</td></tr><tr>
<td>88<tt>/</tt>udp
</td><td>Kerberos 5 authentication
</td></tr><tr>
<td>443<tt>/</tt>tcp
</td><td>HTTP over TLS
</td></tr><tr>
<td>750<tt>/</tt>udp
</td><td>Kerberos 4 authentication
</td></tr><tr>
<td>990<tt>/</tt>tcp
</td><td>FTP over TLS
</td></tr><tr>
<td>992<tt>/</tt>tcp
</td><td>Telnet over TLS
</td></tr><tr>
<td>1649<tt>/</tt>tcp
</td><td>Internet Kermit Service (Kermit)
</td></tr></tbody></table>
</blockquote>
<p>

The official list of "well-known" and "registered" port assignments is
available from Internet Assigned Numbers Authority:

</p><p>
</p><pre>  <a href="http://www.iana.org/assignments/port-numbers">http://www.iana.org/assignments/port-numbers</a>
</pre>
<p>

</p></dd><dt><b>Content-Aware Firewalls</b>

</dt><dd>Content-Aware Firewalls attempt to solve the problem with FTP and similar
protocols that transmit addressing information as part of the protocol.
These firewalls are aware of a specific set of internet protocols such as FTP.
When the FTP client specifies the destination address and port to used by the
server to establish the data channel, the firewall can watch and temporarily
allow that connection to pass through the firewall.  Unfortunately, Content
Aware Firewalls cannot work with secure protocols since all of the data is
being transmitted in encrypted form.

<p>
</p></dd><dt><b>Application Layer Gateways</b>

</dt><dd>Application Layer Gateways are services that appear to be the actualy
service you wish to connect to.  Instead of connecting directly to the telnet
service on foo.bar.com you connect to the telnet service on the firewall and
allow the firewall to establish an equivalent session with the telnet service
on foo.bar.com.

<p>

As with Content-Aware Firewalls this procedure simply does not work with
secure connections.  The Application Layer Gateway (ALG) will either not know
the key to use to read the protected data; or the ALG will be able to 
decrypt all of the data and the end-to-end security of the connection
know has a location where a man-in-the-middle attack can be targeted.

</p><p>

</p></dd><dt><b>Authenticated Firewall Traversal Protocols</b>

</dt><dd> Authenticated Firewall Traversal Protocols simply allow a client process
running on a computer to create connections that may cross the firewall once
the client or service has been authenticated and authorized.  These firewalls
are quite flexible and work very well with secure connections.  In fact, they
enhance the security of the connection from the perspective of the network
administrator.

<p>
</p></dd></dl>
<p>

</p><h4><a name="xa2.1.1">II.1.1 FTP Passive Mode</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa2">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

FTP is one of the few well-known Internet services that requires the use of
multiple connections.  As described above, FTP originally required the server
to establish the data connection to the client using a destination address and
port provided by the client.  This method of operation does not work with Port
Filtering Firewalls.

</p><p>

More recently, FTP was extended to support "passive mode".  When passive mode
is use the connections for the data channels are created in the reverse
direction.  Instead of the server establishing a connection to the client; the
client establishes a second connection with server as the destination.  This
works just fine as long as the client is behind the firewall and the server is
in public address space.  If the server is behind a firewall then the
traditional mode must be used.  If both the client and server are each behind
their own Port Filtering Firewalls then data channels cannot be established.

</p><p>

This is supposed to be solved by the use of Content Aware Firewalls or
Application Layer Gateways.  However, was the command channel is encrypted
the Firewall is unable to view the IP address information.

</p><p>

In Kermit, the use of passive mode is controlled with the command:
</p><p>
</p><pre>  SET FTP PASSIVE-MODE <i>{</i> ON, OFF <i>}</i>
</pre>
<p>

The default is to use passive mode.

</p><h4><a name="xa2.1.2">II.1.2 Firewall Traversal via an HTTP Proxy</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa2">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The simplist form of firewall traversal is the HTTP CONNECT command.  The
CONNECT command was implemented to allow a public web server which usually
resides on the boundary between the public and private networks to forward
HTTP requests from clients on the private network to public web sites.  In
order to allow secure web connections to be established, the CONNECT command
works by authenticating the client with a username/password and then
establishing a tunnel to the desired host.

</p><p>

Many web servers support the CONNECT command and it can be configured to allow
outgoing connections to authenticated user to any TCP/IP hostname/port
combination accessible to the web server.  The limitations of HTTP CONNECT is
that it can only be used for outgoing connections for protocols that are
implemented using TCP/IP.  Protocols such as Kerberos authentication that use
UDP/IP cannot be tunneled using HTTP CONNECT.

</p><p>

Kermit provides support for the use of HTTP CONNECT proxy services with the
command:

</p><p>
</p><pre>  SET TCP HTTP-PROXY <i>[/USER:username /PASSWORD:password] hostname/ip-address[:port]</i>
</pre>
<p>

When a port is not specified the default port configured on the HTTP server is
used.  This is frequently port 443.  When a hostname is specified, it is
resolved using the DNS available to the web server.

</p><h4><a name="xa2.1.3">II.1.3 Firewall Traversal with SOCKS</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa2">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

In the early 1990s as firewalls were becoming prevalent, David Koblas
developed the SOCKS protocol for firewall traversal of TCP/IP.  There are two
popular versions of SOCKS currently in use.  Version 4.2 provides support for
client applications using TCP/IP to traverse firewalls.  This functionality is
similar to the support provided by HTTP CONNECT.  However, there is one
distinction.  A client using SOCKS is aware of the public source IP address
and port.  This allows this information to be used within the application
protocol to assist in securing the connection.  (This information is crucial
to securing FTP sessions with GSSAPI Kerberos 5.)

</p><p>

After 1995, the IETF began working on a successor to the SOCK 4 protocol.
This work produced SOCKS Version 5
(<a href="ftp://ftp.isi.edu/in-notes/rfc1928.txt">RFC 1928</a>).
SOCKS 5 is significantly more general than version 4.  In addition to
supporting client to server TCP/IP connections, it provides two crucial sets
of functionality not found in previous protocols:

</p><p>
</p><ul>
<li>Authenticated firewall traversal of UDP/IP packets.
</li><li>Authenticated binding of incoming public ports on the firewall.
</li></ul>
<p>

This allows a service on the private network to offer public services.  It
also allows client applications such as FTP to establish a temporary public
presence that can be used by the FTP server to create a data channel.  By
allowing the client bind to a public port on the firewall and be aware of the
public address, SOCKS 5 allows the application protocol to communicate that
information to the server.

</p><p>

C-Kermit can be built using either SOCKS 4 or SOCKS 5.  Configuration of the
SOCKS servers is determined by the requirements of the SOCKS library.

</p><p>

Kermit 95 2.00 supports SOCKS 4.2.  The SOCKS Server is specified with the
command:
</p><p>
</p><pre>  SET TCP SOCKS-SERVER <i>[/USER:username /PASSWORD:password] hostname/ip-address[:port]</i>
</pre>
<p>

It should be noted that the best part about the SOCKS protocols is that each
and every application does not need to implement them.  Instead, SOCKS can
be built into the IP stack on each host operating system and the protocols
could work transparently without any change to the programs already shipped.

</p><h3><a name="xa2.2">II.2 Network Address Translation</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa2">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Network Address Translation (NAT) is a technique used to allow a single public
IP address provided by an Internet Service Provider (ISP) to be shared among
multiple computers on a private IP based network.  NAT technology is often
found in routers designed for the Home and Small Office market.  This
technique is wonderful as long as the application protocols being used do not
require knowledge of the IP addresses being used.  In fact, NATs when combined
with SOCKS Version 5 would be a perfect solution except that we have never
seen a product that combines these two technologies.  (It is most likely a
chicken-and-egg situation.  No client applications support SOCKS 5, therefore
no router manufacturers feel pressure to produce them.  Since no routers
support SOCKS 5, application vendors do not implement it.)

</p><p>

NAT has particularly bad implications for Kerberos authentication that
traditionally embeds into the ticket the IP addresses on which the ticket is
valid.  Another protocol that is adversely affected by NAT is FTP.  However,
FTP passive mode works around it.

</p><p>

As luck would have it.  Kerberos 4 has no problem with NAT because the
Kerberos 4 ticket has room for only a single IP address and that IP address is
assigned not by the client but by the KDC.  The result is that when Kerberos 4
is used from behind a NAT the IP address that is placed into the ticket is the
public IP address of the NAT, not the IP address of the client machine.  This
means the ticket is good only on the far side of the NAT and not on the near
side.

</p><p>

Kerberos 5 on the other hand is seriously affected by NAT.  
The addresses are stored in the ticket by the client.  This allows the 
ticket to support the multiple addresses needed for multi-homed systems.
However, when NAT is used, it is the private IP address that is stored into
the ticket and not the public address seen by the KDC.  If this ticket is 
now used to access a service on the public network, the service rejects
the Kerberos 5 ticket since the IP address in the ticket does not match the
source IP address used to establish the connection.

</p><p>

This can be worked around if the client uses a kinit that allows a list of 
additional IP addresses to be specified for inclusion in the TGT.  
Kermit supports this capability with one of the following commands:

</p><p></p><pre>  AUTH K5 INIT /ADDRESSES:{<i>list-of-addresses</i>}
  SET AUTH K5 ADDRESSES {<i>list-of-addresses</i>}
</pre><p>

The problem with this solution is that, although it is secure, in most cases
the end user does not know which IP address is assigned to the far side of the
NAT.  In this situation it is necessary to remove all IP addresses from the
TGT.  Kermit provides the AUTH K5 INIT /NO-ADDRESSES and SET AUTH K5
NO-ADDRESSES ON commands for this purpose.  However, this solution is less
secure since a TGT with no specified IP addresses can be used from any
machine.  Stolen TGTs are therefore extremely useful to a thief.  We strongly
advise that removing the IP address information from Kerberos 5 tickets not be
performed on computers using file based caches as they are particularly
vulnerable to theft.

</p><p>
Sometimes it is possible to read the public address from the device providing
NAT, as shown in the following Kermit script:

</p><p>
</p><pre>  <a href="ftp://kermit.columbia.edu/kermit/scripts/ckermit/linksys">ftp://kermit.columbia.edu/kermit/scripts/ckermit/linksys</a>
</pre>
<p>

</p><pre></pre>
<p>
For those interested in more technical information on the consequences
of Network Address Translation, the IETF has several Informational RFCs
on the subject:
</p><p>
</p><dl><dt><i>Architectural Implications of NAT</i></dt><dd><a href="ftp://ftp.isi.edu/in-notes/rfc2993.txt"><tt>ftp://ftp.isi.edu/in-notes/rfc2993.txt</tt></a>
<p>
</p></dd><dt><i>IP Network Address Translator (NAT) Terminology and Considerations</i></dt><dd><a href="ftp://ftp.isi.edu/in-notes/rfc2663.txt"><tt>ftp://ftp.isi.edu/in-notes/rfc2663.txt</tt></a>
<p>
</p></dd><dt><i>Traditional IP Network Address Translator (Traditional NAT)</i></dt><dd><a href="ftp://ftp.isi.edu/in-notes/rfc3002.txt"><tt>ftp://ftp.isi.edu/in-notes/rfc3002.txt</tt></a>
<p>
</p></dd><dt><i>NAT Friendly Application Design Guidelines</i></dt><dd><a href="http://www.ietf.org/internet-drafts/draft-ietf-nat-app-guide-06.txt"><tt>http://www.ietf.org/internet-drafts/draft-ietf-nat-app-guide-06.txt</tt></a>
<p>
</p></dd><dt><i>Keith Moore's "What NATs Break"</i></dt><dd><a href="http://www.cs.utk.edu/%7Emoore/what-nats-break.html"><tt>http://www.cs.utk.edu/~moore/what-nats-break.html</tt></a>
</dd></dl>

<h3><a name="xa2.3">II.3 Multi-Homed Hosts and Aliasing</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa2">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

IP socket connections are established using IP addresses and port numbers.
Human beings do not remember large groups of numbers well.  Instead we
remember do a better job remembering names.  The Domain Name Service (DNS) is
globally distributed database that converts between the names that humans
recognize and the IP addresses that allow the desired service to be
communicated with.

</p><p>

There are two situations where multiple IP addresses can be associated with
the same computer or service.  The first is a computer that has multiple
network interfaces.  This is known as a multi-homed computer.  Each interface
is assigned its own IP address.  The second situation is where a DNS name
resolves to multiple computers.  This is referred to as aliasing.  Both can
play havoc with authentication when using either Kerberos or X.509
certificates.  Kermit is designed to support multi-homed computers and those
with multiple names.  Unfortunately, not everything else is.

</p><p>

Kerberos 4 does not support multi-homed computers.  Its ticket format only has
space for a single IP address.  If you are using Kermit as a client with
Kerberos 4 authentication you must be sure to set the network interface you
use for establishing your connections to match the one stored in the Kerberos
4 ticket.  The ticket address can be viewed with the command:

</p><p>
</p><pre>  AUTH K4 LIST
</pre>
<p>

The interface to be used can be configured with:

</p><p>
</p><pre>  SET TCP ADDRESS <local-ip-address>
</local-ip-address></pre>
<p>

There is no method for automating this process at the current time.  

</p><p>

Kerberos 5 has no problem with multihomed hosts because the ticket supports
multiple IP addresses and those IP addresses are inserted into the ticket by
the client, not by the KDC.

</p><p>

There can also be problems when a host is being accessed through a
DNS alias.  The administrator for the host needs to install the
service keys for both the unique hostname and the alias name in the
Kerberos 4 service key file.  When this is not done it can lead to 
problems because the service key retrieved by the client does not
match the one used by the service.

</p><p>

Kermit attempts to compensate for this by resolving the DNS alias to real
hostname.  However, this does not always work on Windows 95 or Windows NT 3.5x
due to their caching of DNS information.  For instance, at Columbia University
the CUNIX name resolves to one of six machines, each with a different name,
such as HOSTA, HOSTB, etc.  When telneting to CUNIX, you might be given IP
address 128.59.35.136.  But even though the DNS servers are properly
configured to return the proper name (e.g. HOSTB) for that IP address, Windows
95 returns CUNIX because it retrieves the information from its internal cache
instead of performing another network call.  This means that instead of
retrieving a Kerberos 4 ticket for the service:

</p><p></p><pre>  rcmd.hostb@CC.COLUMBIA.EDU
</pre><p>

we get a ticket for:

</p><p></p><pre>  rcmd.cunix@CC.COLUMBIA.EDU
</pre><p>

This use of the wrong ticket produces the following error:

</p><p></p><pre>  Can't decode authenticator (krb_rd_req)
</pre><p>
</p><p>

DNS aliases and multiple addresses can be a problem for connections protected
with SSL/TLS.  To maximize their revenue streams, most commercial certificate
authorities do not issue certificates with multiple hostnames and/or IP
addresses.  Therefore the hostname used to access the service has to match the
one that used in the certificate.  Although Kermit can resolve aliases to
unique hostnames for Kerberos, it cannot do so for X.509 certificates.

</p><p>

When you are acting as your own Certificate Authority using the OpenSSL tools
you can produce certificates containing multiple hostnames and IP addresses.
Kermit authenticates connections correctly when presented with these
certificates.

</p><p>

[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/k95.html">Kermit 95</a> ]

</p><h3><a name="xa3"><hr>APPENDIX III:
INTRODUCTION TO CERTIFICATES WITH OPENSSL</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

CONTENTS

</p><p>
</p><pre>  III.1.  <a href="#xa3.1">What Are Certificates (etc)...?</a>
  III.2.  <a href="#xa3.2">RSA vs DSA Certifications</a>
  III.3.  <a href="#xa3.3">Should You Be Your Own Certificate Authority?</a>
  III.4.  <a href="#xa3.4">Generating a DSA CA (self-signed) Certificate</a>
  III.5.  <a href="#xa3.5">Generating a DSA CSR</a>
  III.6.  <a href="#xa3.6">Generating an RSA CA (self-signed) certificate</a>
  III.7.  <a href="#xa3.7">Generating an RSA CSR</a>
  III.8.  <a href="#xa3.8">Signing a CSR with your CA certificate</a>
  III.9.  <a href="#xa3.9">Revoking a Certificate</a>
  III.10. <a href="#xa3.10">Generating a CRL</a>
  III.11. <a href="#xa3.11">Mapping a Client Certificate to a User ID</a>
</pre>
<p>

LINKS
</p><p>
</p><ul>
<li><a href="http://www.ietf.org/html.charters/pkix-charter.html">
IETF Public-Key Infrastructure (X.509) (pkix) Charter</a>
</li><li><a href="http://www.ietf.org/rfc/rfc2459.txt">RFC 2459:
Internet X.509 Public Key Infrastructure - Certificate and CRL Profile</a>
</li><li><a href="http://www.imc.org/rfc2527">RFC 2527:
Internet X.509 Public Key Infrastructure -
Certificate Policy and Certification Practices Framework</a>
</li><li><a href="http://www.imc.org/rfc2528">RFC 2528:
Internet X.509 Public Key Infrastructure -
Representation of Key Exchange Algorithm (KEA) Keys in
Internet X.509 Public Key Infrastructure Certificates</a>
</li></ul>
<p>

This is a brief introduction to certificates, certificate authorities, and how
to use them.  The information presented here is highly technical and can be
skipped unless:

</p><p>
</p><ul>

<li>you are a system administrator and want to learn how to secure your host,
or:

</li><li>you want to know how to use client certificates to authenticate to a host.

</li></ul>
<p>

RSA Security, Inc., has a good Frequently Asked Questions (FAQ):

</p><p></p><pre>  <a href="http://www.rsasecurity.com/rsalabs/faq/questions.html">http://www.rsasecurity.com/rsalabs/faq/questions.html</a>
</pre><p>

The FAQ covers many topics related to cryptography as well as how public key
certificates work and how they are to be used.

</p><h3><a name="xa3.1">III.1.
What Are Certificates, Private Keys, CSRs, CAs, and CRLs?</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Public key (asymmetric) cryptography defines a class of algorithms for key
exchange that include RSA and Diffie-Hellman (DH).  These algorithms provide a
mechanism to create a shared secret that can be used for encrypting future
communications.  Anyone listening to the exchange would be no closer to
figuring out the value of the shared secret than if they were to take a guess.

</p><p>

There are two parts to the exchange.  A private key that is never disclosed,
and a public key that may be viewed by all.  An X.509 certificate is a
standard package for distributing a public key with identifying features such
that the authenticity and validity of the public key may be verified by a
recipient.

</p><p>

The authenticity and validity of a certificate is provided by a combination of
information provided within the certificates (the subject, the issuer, dates
of validity, ...) as well as the trust that is placed in the certificate
issuer (the Certificate Authority, or CA).  The CA signs each of the
certificates that it issues with its own certificate.  With a copy of the CA's
certificate it is possible to validate all of the certificates that were
signed by the CA's private key.

</p><p>

A user who wants to have a certificate signed by a CA creates a Certificate
Signing Request (CSR).  The CSR is an unsigned certificate presented
to the CA along with information verifying the identity and desired use for
the certificate.  The CA signs the CSR producing a certificate that is valid
for a specific time frame, which is then returned to the user.

</p><p>

If the private key of the certificate were to be compromised the CA may revoke
the certificate.  The CA publishes a Certificate Revocation List (CRL) on a
periodic basis containing a list of all certificates that would otherwise be
valid if they were not revoked.  It is the responsibility of the verifier to
check not only the authenticity of the certificate but also whether or not it
has been revoked by the issuer.

</p><h3><a name="xa3.2">III.2.  RSA Certificates vs DSA Certificates</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

The important differences between RSA and DSA certificates are:

</p><p></p><ul>

<li>The RSA algorithms are faster than DSA.

<p>

</p></li><li>The RSA algorithms are supported by all the major browsers whereas DSA
are not.

<p>

</p></li><li>The RSA algorithms were patented in the United States (until Sept 29,
2000), requiring payments of licensing fees for producers of software
utilizing them, whereas DSA is free.

<p>

</p></li><li>The RSA private and public key pairs may be used for encrypting data as
well as signing.  DSA private and public key pairs may only be used for
signing.  Therefore, products incorporating only DSA algorithms are easier
to export from the United States.
</li></ul>
<p>

</p><h3><a name="xa3.3">III.3.
Should You Be Your Own Certificate Authority?</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

There are many companies that believe that providing CA services is big
business.  These include but are not limited to:
</p><p>
</p><ul>
<li><a href="http://www.verisign.com/">Verisign</a>
</li><li><a href="http://www.thawte.com/">Thawte Consulting</a>
</li><li><a href="http://www.certisign.com.br/">CertiSign Cerificadora Digital Ltda.</a>
</li><li><a href="http://www.iks-jena.de/">IKS GmbH</a>
</li><li><a href="http://www.uptimecommerce.com/">Uptime Commerce Ltd.</a>
</li><li><a href="http://www.belsign.be/">BelSign NV/SA</a>
</li></ul>
<p>

The root CA certificates of these companies certificates are included most of
the popular browsers.  This provides an ease-of-use advantage to the
recipients of certificates they sign since the root certificates do not need
to be otherwise distributed to authenticate the signed certificates.

</p><p>

On the other hand, as is pointed out by C. Ellison and B. Schneier in their
paper, <cite>Ten Risks of PKI: What You're Not Being Told About Public Key
Infrastructure</cite>:

</p><p></p><pre>  <a href="http://www.counterpane.com/pki-risks.html">http://www.counterpane.com/pki-risks.html</a>
</pre>

<p>

using the commercial CA services it makes it difficult to decide whether or
not a certificate should be trusted for a particular purpose, especially if
you want to use certificates to authenticate an end user to a system for
remote access.  In this situation it is necessary to not only be able to
authenticate a certificate but be able to know that the information within the
certificate, such as the uniqueIdentifier used for the User ID, is tightly
controlled and in fact unique in your environment.

</p><p>

If you choose to be your own CA you will have to configure your environment.
Create the following directory trees to store the DSA and RSA CAs.

</p><p>
</p><pre>   openssl/dsaCA/certs/
   openssl/dsaCA/crl/
   openssl/dsaCA/private/
   openssl/dsaCA/newcerts/
   openssl/dsaCA/requests/
   openssl/rsaCA/certs/
   openssl/rsaCA/crl/
   openssl/rsaCA/private/
   openssl/rsaCA/newcerts/
   openssl/rsaCA/requests/
</pre>
<p>

Place the <tt>openssl.cnf</tt> file into the openssl directory.  Edit it to
meet the requirements of your organization.  Create two sections,
<tt>[CA_DSA]</tt> and <tt>[CA_RSA]</tt>:

</p><p>
</p><pre>  [ CA_DSA ]

  dir             = <i>openssl_path</i>/dsaCA/    # Where everything is kept
  certs           = $dir/certs             # Where the issued certs are kept
  crl_dir         = $dir/crl               # Where the issued crl are kept
  database        = $dir/index.txt         # database index file.
  new_certs_dir   = $dir/newcerts          # default place for new certs.

  certificate     = $dir/certs/cacert.pem  # The CA certificate
  serial          = $dir/ca.srl            # The current serial number
  crl             = $dir/crl.pem           # The current CRL
  private_key     = $dir/private/cakey.pem # The private key
  RANDFILE        = $dir/private/.rand     # private random number file

  x509_extensions = x509v3_extensions      # The extentions to add to the cert
  default_days    = 365                    # how long to certify for
  default_crl_days= 30                     # how long before next CRL
  default_md      = sha1                   # which md to use.
  preserve        = no                     # keep passed DN ordering
  policy	  = policy_match           # which CA policy

  [ CA_RSA ]

  dir             = <i>openssl_path</i>/rsaCA/    # Where everything is kept
  certs           = $dir/certs             # Where the issued certs are kept
  crl_dir         = $dir/crl               # Where the issued crl are kept
  database        = $dir/index.txt         # database index file.
  new_certs_dir   = $dir/newcerts          # default place for new certs.

  certificate     = $dir/certs/cacert.pem  # The CA certificate
  serial          = $dir/ca.srl            # The current serial number
  crl             = $dir/crl.pem           # The current CRL
  private_key     = $dir/private/cakey.pem # The private key
  RANDFILE        = $dir/private/.rand     # private random number file

  x509_extensions = x509v3_extensions      # The extentions to add to the cert
  default_days    = 365                    # how long to certify for
  default_crl_days= 30                     # how long before next CRL
  default_md      = sha1                   # which md to use.
  preserve        = no                     # keep passed DN ordering
  policy	  = policy_match           # which CA policy
</pre>
<p>

If you wish to use the <tt>uniqueIdentifier</tt> field to perform certificate
to user ID mapping, add it after the <tt>emailAddress</tt> field.

</p><p>

If you wish to use the <tt>subjectAltName</tt> field to perform certificate to
user ID mapping, you must to add a
<tt>[x509v3_externsions]</tt> section:

</p><p>
</p><pre>  [ x509v3_extensions ]

  subjectAltName                 = email:copy
</pre><p>
Other formats of the subjectAltName field are:
</p><p></p><pre>  subjectAltName                 = email:copy
  subjectAltName                 = issuerl:copy
  subjectAltName                 = email:fred@company.com
  subjectAltName                 = DNS:www.company.com
  subjectAltName                 = IP:100.99.98.97
  subjectAltName                 = RID:2.99999.1
</pre>
<p>

Other x509v3 extensions include:

</p><p>
</p><pre>  nsCaRevocationUrl              = http://www.domain.com/ca-crl.pem
  nsComment                      = "This is a comment"
</pre>
<p>

To avoid the need to specify the location of the openssl.cnf file, set the
environment variable OPENSSL_CNF to be equal to the full path of the file.  If
you do not create this environment variable you must to include the option:

</p><p></p><pre>  -config <i>path</i>/openssl.cnf
</pre>
<p>

to each openssl command.

</p><p>

Create the file that stores the next available serial number for each CA:

</p><p>
</p><pre>   openssl/dsaCA/ca.srl
   openssl/rsaCA/ca.srl
</pre>
<p>

The format of this file is a hex value followed by a LF (0x0A) character.
The value "01" is an appropriate initial value.

</p><p>

Create an empty file to store the index of signed certificates:

</p><p>
</p><pre>   openssl/dsaCA/index.txt
   openssl/rsaCA/index.txt
</pre>
<p>

Now you are ready to create the DSA and RSA CA certificates for your
organization.

</p><h3><a name="xa3.4">III.4.
Generating a DSA CA (self-signed) Certificate</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Change the current working directory to <tt>openssl/dsaCA/</tt>.

</p><p>

Generate the DSA parameters to be used when generating the keys for use with
your certificates:

</p><p>
</p><pre>  openssl dsaparam 1024 -out dsa1024.pem
</pre>
<p>

Generate the self-signed certificate to be used as the CA certificate for your
organization:

</p><p>
</p><pre>  openssl req -x509 -newkey dsa:dsa1024.pem -days <i>days</i> \
    -keyout private/cakey.pem -out certs/cacert.pem
</pre>
<p>

The <i>days</i> parameter should be replaced by the number of days you want
this certificate to remain valid.  All certificates signed by this certificate
become invalid when this certificate expires.

</p><p>

Be sure to not forget the pass-phrase you use to protect the private key of
the CA certificate.  If you do not wish to encrypt the CA's private key you
may specify the -nodes option.  But this is highly discouraged.

</p><p>

You can check the contents of the CA certificate with the command:

</p><p>
</p><pre>  openssl x509 -text -in certs/cacert.pem
</pre>
<p>

</p><h3><a name="xa3.5">III.5.  Generating a DSA CSR</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Change the current working directory to <tt>openssl/dsaCA/</tt>.

</p><p>

If you have not already created a set of DSA parameters, you must generate a
set:

</p><p>
</p><pre>  openssl dsaparam 1024 -out dsa1024.pem
</pre>
<p>

It is safe to reuse the DSA parameters.

</p><p>

Generate the DSA certificate request:

</p><p>
</p><pre>  openssl req -newkey dsa:dsa1024.pem -keyout private/<i>name</i>-key.pem \
    -out requests/<i>name</i>-req.pem
</pre>
<p>

where <i>name</i> should be replaced by something that identifies the files.
Perhaps the hostname or userid for which the certificate is being generated.

</p><p>

If you are generating a CSR for use as a host certificate, be sure to specify
the fully qualified domain name as reported by the DNS as the Common Name for
the certificate.  Otherwise, it won't be recognized as belonging to the host
it is installed on by its clients.

</p><p>

Be sure not to forget the pass-phrase you use to protect the private key of
the CA certificate.  The certificate (after signing) is unusable without it.
Use the -nodes option if you wish to store the key unencrypted.

</p><p>

You can check the contents of the CSR with the command:

</p><p>
</p><pre>  openssl req -text -in requests/<i>name</i>-req.pem
</pre>
<p>

The CSR now stored in requests/<i>name</i>-req.pem may be sent to one of the
commerical CAs if you do not wish to be your own CA.

</p><h3><a name="xa3.6">III.6.
Generating an RSA CA (self-signed) certificate</a></h3>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Change the current working directory to <tt>openssl/rsaCA/</tt>.

</p><p>

Generate the self-signed certificate to be used as the CA certificate for
your organization:

</p><p>
</p><pre>  openssl req -x509 -newkey rsa:1024 -days <i>days</i> \
    -keyout private/cakey.pem -out certs/cacert.pem
</pre><p>

The <i>days</i> parameter should be replaced by the number of days you want
this certificate to remain valid.  All certificates signed by this certificate
become invalid when this certificate expires.

</p><p>

Be sure not to forget the pass-phrase you use to protect the private key of
the CA certificate.  If you do not wish to encrypt the CA's private key you
may specify the -nodes option.  But this is highly discouraged.

</p><p>

You can check the contents of the CA certificate with the command:

</p><p>
</p><pre>  openssl x509 -text -in certs/cacert.pem
</pre>
<p>

</p><h3><a name="xa3.7">III.7.  Generating an RSA CSR</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Change the current working directory to <tt>openssl/rsaCA/</tt>.

</p><p>
</p><pre>  openssl req -newkey rsa:1024 -keyout private/<i>name</i>-key.pem \
    -out requests/<i>name</i>-req.pem
</pre>
<p>

<i>name</i> should be replaced by something that identifies the files, such as
the hostname or userid for which the certificate is being generated.

</p><p>

If you are generating a CSR for use as a host certificate be sure to specify
the fully qualified domain name as reported by the DNS as the Common Name for
the certificate.  Otherwise, it is not recognized as belonging to the host it
is installed on by its clients.

</p><p>

Be sure not to forget the pass-phrase you use to protect the private key of
the CA certificate.  The certificate (after signing) is unusable without it.
Use the -nodes option if you wish to store the key unencrypted.

</p><p>

You can check the contents of the CSR with the command:
</p><p>
</p><pre>  openssl req -text -in requests/<i>name</i>-req.pem
</pre>
<p>

The CSR now stored in requests/<i>name</i>-req.pem may be sent to one of the
commerical CAs if you do not wish to be your own CA.

</p><h3><a name="xa3.8">III.8. Signing a CSR with your CA certificate</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

If you are signing a DSA certificate change directory to
<tt>openssl/dsaCA/</tt> and use a <i>caname</i> of "CA_DSA".  If you are
signing an RSA certificate change directory to <tt>openssl/rsaCA/</tt> and use
a <i>caname</i> of "CA_RSA":

</p><p>
</p><pre>  openssl ca -name <i>caname</i> -in requests/<i>name</i>-req.pem \
    -out certs/<i>name</i>.pem -days <i>days</i>
</pre>
<p>

The <i>days</i> parameter should be replaced by the number of days you want the
signed certificate to remain valid.  If you want to specify a specific date
range you can replace the -days parameters with:

</p><p>
</p><pre> -startdate YYMMDDHHMMSSZ  - certificate validity notBefore
 -enddate YYMMDDHHMMSSZ    - certificate validity notAfter
</pre>
<p>

The file <tt>certs/<i>name</i>.pem</tt> now contains a signed certificate that
may be used by a host or client for authentication with its
matching private key (<tt>private/<i>name</i>-key.pem</tt>.)

</p><p>

An alternative method of signing the CSR is to use the command:

</p><p>
</p><pre>  openssl x509 -req -in requests/<i>name</i>-req.pem -CA certs/cacert.pem \
    -CAkey private/cakey.pem -out certs/<i>name</i>.pem -days <i>days</i> \
    -CAserial ca.srl -CAcreateserial
</pre>
<p>

The "openssl x509" command provides greater functionality at the expense of
ease of use.  The X509 may be used to assign X.509v3 certificate extensions
with the -extfile and -extensions switches.  It may also be used to produce
certificates that may only be used for specific purposes.

</p><p>

You can check the contents of the CA certificate with the command:

</p><p>
</p><pre>  openssl x509 -text -in certs/<i>name</i>.pem
</pre>
<p>

</p><h3><a name="xa3.9">III.9. Revoking a Certificate</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

If you are revoking a DSA certificate change directory to
<tt>openssl/dsaCA/</tt> and use a <i>caname</i> of "CA_DSA".  If you are
revoking an RSA certificate change directory to <tt>openssl/rsaCA/</tt> and use
a <i>caname</i> of "CA_RSA".

</p><p>
</p><pre>  openssl ca -name <i>caname</i> -revoke certs/<i>name</i>.pem
</pre>
<p>

marks the certificate as being revoked in the <tt>index.txt</tt> file.  It is
necessary to revoke a certificate with a given subject name if you wish to
generate a new certificate with an identical subject name.  Once a
certificate is revoked it is listed in the next generated CRL.

</p><h3><a name="xa3.10">III.10. Generating a CRL</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

If you are generating a CRL for your DSA certificates change directory to
<tt>openssl/dsaCA/</tt> and use a <i>caname</i> of "CA_DSA".  If you are
generating a CRL for your RSA certificate change directory to
<tt>openssl/rsaCA/</tt> and use a <i>caname</i> of "CA_RSA":

</p><p>
</p><pre>  openssl ca -name <i>caname</i> -gencrl -out crl/<i>date</i>-crl.pem
</pre>
<p>

<i>date</i> should be replaced by the date the crl was generated.

</p><p>

You can check the contents of the CRL with the command:

</p><p>
</p><pre>  openssl crl -in crl/<i>date</i>-crl.pem -text
</pre>
<p>

The current CRL should be placed somewhere it is publicly and easily
accessible.  For instance, by HTTP or FTP.  The CRL is signed by the CA
certificate

</p><h3><a name="xa3.11">III.11.
Mapping a Client Certificate to a User ID</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Kermit can be configured to perform a mapping from an X.509 client certificate
to a User ID.  This is primarily of use when Kermit is installed as an
Internet Kermit Service.  When a mapping is enabled, the client certificate
may be used to authenticate and automatically login a user to their account or
resources.

</p><p>

Unfortunately, it is not possible to build a function in to Kermit to provide
the mapping from Certificate to User ID that would be secure and/or applicable
to every installation.  There are several commonly used approaches to map a
certificate to a userid.  Kermit can be customized to use whichever one
you choose to use in your environment.

</p><p>
</p><dl><dt><b>Map the X.509 uniqueIdentifier field to the User ID</b>

</dt><dd>The uniqueIdentifier field of the X.509 client certificate can include the
userid of the end user.  For instance, John Doe's uniqueIdentifier might be
<i>jdoe</i>.  A mapping function can extract the contents of this field and 
return it as the User ID.

<p>

The problem with this approach is the uniqueIdentifier may not be very unique.
Let us assume that you do not want to go through the trouble of managing your
own Certificate Authority because it is too much work.  So you refer all of
your clients to request X.509 certificates from one of the commercial
Certificate Authorities.  It is possible that another site is doing exactly
the same thing and that this other site has a user Jane Doe with User ID
<i>jdoe</i>.  In this circumstance, simply verifying the certificate against
the CA certificate and extracting the uniqueIdentifier results in a
security hole since Jane Doe would be able to gain access to John Doe's
account.

</p><p>
</p></dd><dt><b>Map the X.509 subjectAltName to the User ID</b>

</dt><dd>The subjectAltName field of the X.509 client certificate can include the
e-mail address of the user instead of simply the userid of the user.  In the
case of John Doe, his subjectAltName would be <i>jdoe@mydomain.com</i> whereas
Jane Doe's subjectAltName would be <i>jdoe@someotherdomain.com</i>.  A mapping
function using the subjectAltName can extract the contents of the
subjectAltName, verify the domain is correct and then return the User ID.

<p>

This method is safer than the uniqueIdentifier, but it is still placing a lot
of trust in the Certificate Authority.  If you are not issuing the
certificates yourself you'll have to trust that the CA has a legitimate
method for verifying that the e-mail address belongs to the user for whom the
CA is signing a certificate.

</p><p>

</p></dd><dt><b>Map the Entire Certificate to the User ID</b>

</dt><dd>Instead of trusting the contents of one of the fields within the
certificate you can require that your user's submit their certificates for
registration prior to use.  The mapping function can then lookup the
certificate in a local database or an LDAP server to retrieve the User ID.  Of
the methods described, this is the most secure.

</dd></dl>
<p>

In addition to determing which userid is associated with a given client 
certificate, it is just as important to know whether or not the user is
actually authorized to access the service when the certificate is provided.

</p><p>

The <tt>X509_userok()</tt> function determines whether or not the combination
of the provided X509 certificate and username is valid for automatic login.
Whereas <tt>X509_to_user()</tt> is used to provide authentication of the user,
the <tt>X509_userok()</tt> function is used to provide authorization.  The
certificate passed into <tt>X509_userok()</tt> does need to map to a userid;
nor would the userid it would map to need to match the userid provided to the
function.  There are numerous circumstances in which it is beneficial to have
the ability for multiple users to gain access to a common account such as
'root' on Unix; or a class account on a web server.

</p><p>

In Unix this capability can be provided with a
<tt>~<i>userid</i>/.tlslogin</tt> file that contains a list of X509
certificates thatMay can be used to access the account <tt><i>userid</i></tt>.

</p><h4><a name="xa3.11.1">III.11.1.
Mapping a Client Certificate to a User ID in Kermit 95</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

X.509 to User ID mapping functions are implemented in Kermit 95 via the use of
a user compiled Dynamic Link Library (DLL), <tt>X5092UID.DLL</tt>.  To build
this DLL you need a C compiler such as Microsoft's Visual C++ and OpenSSL
0.9.7 compiled and installed.

</p><p>

OpenSSL sources may be retrieved from the web site:

</p><p></p><pre>  <a href="http://www.openssl.org/">http://www.openssl.org/</a>
</pre>
<p>

Kermit 95 2.1.3 for Windows was compiled against version 0.9.7.
The OS/2 version is still built against the older 0.9.4
build that was ported to that platform.

</p><p>

Patches for OpenSSL 0.9.4 to allow compilation under OS/2 are located at:

</p><p></p><pre>  <a href="http://www.geocities.com/SiliconValley/Hills/8057/files/openssl.html">http://www.geocities.com/SiliconValley/Hills/8057/files/openssl.html</a>
</pre><p>

On Windows, OpenSSL must be compiled and linked to use the NT DLL option
without Debug information.  Compiling the DLLs with support for debugging
links the DLLs to an incompatible C Run Time Library DLL.  On OS/2, OpenSSL
must be compiled to use the DLL version of the run time library.

</p><p>

The DLL must contain two functions with the following prototypes:

</p><p></p><pre>  /* X509_to_user() returns 0 if valid userid in 'userid', else -1 */
  int X509_to_user(X509 *peer_cert, char *userid, int len);

  /* X509_userok() returns 0 if access is denied; 1 is access is permitted */
  int X509_userok(X509 * peer_cert, const char * userid);
</pre><p>

An example function that
uses the /UID field of the Certificate Subject name follows:
</p><p></p><pre>  int
  X509_to_user(X509 *peer_cert, char *userid, int len) {
      int err;

      if (!(peer_cert &amp;&amp; userid) || len &lt;= 0)
          return -1;

      /* Userid is in cert subject /UID */
      err = X509_NAME_get_text_by_NID(X509_get_subject_name(peer_cert),
                                       NID_uniqueIdentifier, userid, len);
      if (err &gt; 0)
          return 0;
      return -1;
  }
</pre>
<p>
An example function provides userid authorization follows:
</p><p></p><pre>int
X509_userok(X509 * peer_cert, const char * userid) {
    /* check if clients cert is in "user"'s ~/.tlslogin file */
    char buf[512];
    int r = 0;
    FILE *fp;
    struct passwd *pwd;
    X509 *file_cert;

    if ( peer_cert == NULL )
      return(0);

    if (!(pwd = getpwnam(userid)))
     return 0;
    if (strlen(pwd-&gt;pw_dir) &gt; 500)
     return(0);
    sprintf(buf, "%s/.tlslogin", pwd-&gt;pw_dir);

    if (!(fp = fopen(buf, "r")))
      return 0;
    while (!r &amp;&amp; (file_cert = PEM_read_X509(fp, NULL, NULL, NULL))) {
        if (&lt;ASN1_STRING_cmp(peer_cert-&gt;signature, file_cert-&gt;signature))
            r = 1;
        X509_free(file_cert);
    }
    fclose(fp);
    return(r);
}
</pre>
<p>

These functions must be compiled into a DLL called "<tt>X5092UID.DLL</tt>".  It
should be linked to the OpenSSL libraries and the DLL version of the run time
library.  
</p><p>

Contact <a href="mailto:kermit-support@columbia.edu">Kermit Support</a>
for further information..

</p><h4><a name="xa3.11.2">III.11.2
Mapping a Client Certificate to a User ID in C-Kermit</a></h4>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#xa3">Appendix Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

X.509 to User ID mapping functions are implemented in C-Kermit in one of two
ways.

</p><p>

</p><ul>
<li>If you want to use the uniqueIdentifier field you can specify
KFLAGS=-DX509_UID_TO_USER at compile time.
</li><li>If you want to use the subjectAltName field you can specify
KFLAGS=-DX509_SUBJECT_ALT_NAME_TO_USER at compile time.
</li><li>Otherwise, you need to customize the X509_to_user() function in the
<tt>ck_ssl.c</tt> source file to implement your verification method.
</li></ul>

<p>

A <tt>X509_userok()</tt> that supports the use of the ~userid/.tlslogin file
is provided.  This function should be examined for compatibility with the
institutional access policies.  It should be replaced or modified as needed.

</p><p>

Contact <a href="mailto:kermit-support@columbia.edu">Kermit Support</a> for
further information..

</p><h3><a name="xa4"><hr>APPENDIX IV. USING OTHER SECURITY METHODS WITH KERMIT</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
<p>

Other protocols can be used to create secure connections that are not
currently implemented in Kermit, such as Secure Shell (SSH) in C-Kermit.
The fact that SSH is not integrated into C-Kermit does not mean that
Kermit cannot be used in conjunction with it.  SSH provides for tunneling,
which allows a localhost proxy to be configured to take insecure connections
on the local machine and connect them via secure connections to remote hosts.

</p><p>

Secure connection clients can be used as the communication channel in C-Kermit
7.0 (and later) and Kermit 95 1.1.16 (and later) via the PTY (Unix only) and
PIPE commands.  See
<a href="http://www.columbia.edu/kermit/ckermit2.htm#x2.7">
Section 2.7</a> of the
<a href="http://www.columbia.edu/kermit/ckermit2.html">C-Kermit 7.0
Update Notes</a> for details.

</p><p>

Firewalls based on access lists, proxies, and SOCKS do not provide secure
connections.  However, they do restrict the ports that may be used to
communicate between the Internet and the Intranet which makes it more
difficult for someone to break into the Intranet from outside.  They do not
protect the network from internal attacks nor do they protect a connection,
once made, from eavesdropping or hijacking.  They may be used in conjunction
with secure connection systems but should not be used as a replacement for
them.  (The Windows 95 and NT versions of Kermit 95 do not support SOCKS; the
OS/2 version has built-in support for SOCKS4.  C-Kermit can be built as a
SOCKS client if you have a SOCKS library; otherwise you can run SOCKSified
Telnet or Rlogin clients through C-Kermit with the PIPE command.)
</p><p>
NEC distributes a SOCKS5 Winsock shim for Windows 9x/NT at:
</p><p></p><pre>  <a href="ftp://ftp.nec.co.jp/pub/packages/sotools/">ftp://ftp.nec.co.jp/pub/packages/sotools/</a>
</pre><p>

</p><h3><a name="xa4.1">IV.1.  Implementing Other Security Methods for Kermit 95</a></h3>

Kermit 95 provides an interface that allows it to use a DLL to provide an
alternative mechanism for implementing secure communication methods.  The DLL
is loaded via a network type command:
<p></p><pre>  SET NETWORK TYPE DLL <i>dll-file</i>
</pre><p>
The connection is then made with a SET HOST command
</p><p></p><pre>  SET HOST <i>command-line</i>
</pre><p>
where the <i>command-line</i> is passed to the DLL after the normal Kermit
quoting rules are applied.
</p><p></p><pre>/* Kermit 95 - External Network DLL specification
 * July 16 1998
 * Jeffrey Altman &lt;jaltman@columbia.edu&gt;
 *
 * The following specification defines a set of functions to be exported from
 * a DLL in order for the DLL to work with Kermit 95 version 1.1.17 or higher.
 *
 * The DLL is loaded by Kermit 95 via use of the command:
 *   SET NETWORK TYPE DLL <i>dllname</i>
 *
 * Notes:
 *   The functions specified here must be thread safe.  It is possible
 *   for multiple threads to be calling any combination of functions
 *   simultaneously.
 *
 *   The 1.1.17 interface does not provide for the ability of the
 *   DLL to query the user with echoing input, nor is the a method
 *   for querying the values of Kermit variables such as 'userid'
 *   or Kermit version number.  This will be added in a later release.
 */

/*
 * N E T O P E N - Network Open
 *
 * The network open function is called by Kermit 95 when a new connection
 * is desired.  Usually in response to:
 *    SET HOST <i>command_line</i>
 *
 * Parameters:
 *   command_line - the command line specified in the SET HOST command
 *                  after quoting rules and variables have been applied.
 *   termtype     - a string representing either the currently selected
 *                  terminal type or a user specified string as per
 *                  SET TELNET TERMINAL <i>string</i>
 *   height       - initial height of the terminal window (chars)
 *   width        - initial width of the terminal window (chars)
 *   readpass     - a pointer to a function to be used to read a password
 *                  without echoing
 *
 * Return values:
 *   0   on success
 *   &lt; 0 on failure
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
netopen(char * command_line, char * termtype, int height, int width,
        int (* readpass)(char * prompt,char * buffer, int length));
/*
 * N E T C L O S - Network Close
 *
 * The network close function is called by Kermit 95 when the user requests
 * a disconnect or in response to fatal error.
 *
 * Parameters: None
 *
 * Return values:
 *   0   on success
 *   &lt; 0 on failure
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
netclos(void) ;

/*
 * N E T T C H K - Network Terminal I/O Check
 *
 * The network terminal i/o check function is called regularly by Kermit 95
 * to poll the status of the connection and to retrieve the number of input
 * characters waiting to be processed.  Because it is called frequently this
 * function should be designed to be low cost.
 *
 * Parameters: None
 *
 * Return values:
 *   &gt;= 0 number of characters waiting in the input queue
 *   &lt; 0  indicates a fatal error on the connection and the connection
 *        should be closed.
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
nettchk(void);

/*
 * N E T F L U I - Network Flush Input
 *
 * The network flush input function should clear the connection's input
 * queue.
 *
 * Parameters: None
 *
 * Return values:
 *   0    indicates success
 *   &lt; 0  indicates an error
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
netflui(void);

/*
 * N E T B R E A K - Network Break
 *
 * The network break signal is called in response to a user initiated
 * break command.  For example, on a serial device this should result in
 * a Break signal and on a Telnet connection a Break Command is sent.
 * For connection types without an equivalent simply return 0.
 *
 * Parameters: None
 *
 * Return values:
 *   0    indicates success
 *   &lt; 0  indicates an error
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
netbreak(void);

/*
 * N E T I N C - Network Input Character
 *
 * The network input character is used to read the next character from
 * the input queue.
 *
 * Parameters:
 *   timeout - 0   indicates no timeout, block until the next character
 *                 is available;
 *             &gt; 0 indicates a timeout value in seconds;
 *             &lt; 0 indicates a timeout value in milliseconds;
 *
 * Return values:
 *   &gt;= 0 is interpreted as a valid character
 *   -1   is a timeout [errorstr() is not called]
 *   &lt; -1 is a fatal error
 *
 *   return codes &lt; -1 should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
netinc(int timeout);

/*
 * N E T X I N - Network Extended Input
 *
 * The network extended input is called to read a large number of waiting
 * input characters.  It will never be called with a number larger than
 * reported as available and waiting by nettchk().  The function may return
 * fewer characters than is requested.  This function should not block.
 *
 * Parameters:
 *   count  - number of characters to be read
 *   buffer - buffer of length count to be used to store the data
 *
 * Return values:
 *   &gt;= 0  the number of characters actually returned by the function
 *   &lt; 0  indicates an error
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
netxin(int count, char * buffer);

/*
 * N E T T O C - Network Terminal Output Character
 *
 * The network terminal output character transmits a single character
 *
 * Parameters:
 *   c - a single character to be output
 *
 * Return values:
 *   0    indicates success
 *   &lt; 0  indicates an error
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
nettoc(int c);

/*
 * N E T T O L - Network Terminal Output Line
 *
 * The network terminal output line is used to output one or more
 * characters.
 *
 * Parameters:
 *   buffer - contains the characters to be output
 *   count  - the number of characters to be output from buffer
 *
 * Return values:
 *   &gt;= 0 the number of characters actually output.  The function
 *        should make its best attempt to transmit all 'count'
 *        characters.
 *   &lt; 0  indicates a fatal error
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
nettol(char * buffer, int count);

/*
 * T T V T - Terminal to Virtual Terminal Mode
 *
 * Terminal to Virtual Terminal Mode is called to notify the DLL that
 * Kermit 95 is about to enter terminal mode communications.  This means
 * either the CONNECT or DIAL commands will be sending output.  In most
 * cases, this will be either printable text or escape sequences.
 *
 * Parameters: None
 *
 * Return values:
 *   0    indicates success
 *   &lt; 0  indicates an error
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
ttvt(void);

/*
 * T T P K T - Terminal to Packet Mode
 *
 * Terminal to Packet Mode is called to notify the DLL that
 * Kermit 95 is about to enter file transfer operations.
 *
 * Parameters: None
 *
 * Return values:
 *   0    indicates success
 *   &lt; 0  indicates an error
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
ttpkt(void);

/*
 * T T R E S - Terminal Restore Mode
 *
 * Terminal Restore Mode is called to notify the DLL that it should
 * Kermit 95 restore to default settings.
 *
 * Parameters: None
 *
 * Return values:
 *   0    indicates success
 *   &lt; 0  indicates an error
 *
 *   return codes should be defined such that they can be passed to
 *   errorstr() to retrieve an appropriate error message for the user.
 */

int
ttres(void);

/*
 * T E R M I N F O - Terminal Information
 *
 * The terminal information function is called whenever the terminal
 * type or window size is changed.
 *
 * Parameters:
 *   termtype     - a string representing either the currently selected
 *                  terminal type or a user specified string as per
 *                  SET TELNET TERMINAL <i>string</i>
 *   height       - initial height of the terminal window (chars)
 *   width        - initial width of the terminal window (chars)
 *
 * Return values: None
 */

void
terminfo(char * termtype, int height, int width);

/*
 * V E R S I O N - Version String
 *
 * Version is called to get a user displayable version string for use
 * as part of the SHOW NETWORK command.
 *
 * Parameters: None
 *
 * Return values:
 *   a string which will not be deleted by the caller.
 */

const char *
version(void);

/*
 * E R R O R S T R - Error String
 *
 * Error string is called to retrieve a user displayable error message
 * describing the type of error being reported by the function.
 *
 * Parameters:
 *   error - the error value reported by the DLL function.
 *
 * Return values:
 *   a string which will not be deleted by the caller.
 */

const char *
errorstr(int error);
</pre>
<p>
[ <a href="#top">Top</a> ]
[ <a href="http://www.kermitproject.org/case21.html">Case Study</a> ]
[ <a href="http://www.kermitproject.org/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.kermitproject.org/ck80.html">C-Kermit 8.0</a> ]
[ <a href="http://www.kermitproject.org/index.html">Kermit Home</a> ]
[ <a href="http://www.kermitproject.org/k95.html">Kermit 95</a> ]
[ <a href="http://www.kermitproject.org/index.html">Kermit Home</a> ]
</p><hr>




<h3><a name="glossary"></a><hr><a name="glossary">GLOSSARY</a></h3>

<a name="glossary">[ </a><a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]

<dl><dt><i>ARPANET</i>
</dt><dd>The US Department of Defense 
<a href="http://www.isoc.org/internet/history/">
Advanced Research Projects Agency Network</a>,
the precursor to the Internet.
<p>

</p></dd><dt><i>Authentication</i>
</dt><dd>The process by which one entity proves its identity to another
entity on the Internet.
<p>

</p></dd><dt><i>Authorization</i>
</dt><dd>The process by which one gains access to a particular resource.
<p>

</p></dd><dt><i>CA</i>
</dt><dd>SSL/TLS X.509 Certificate Authority.
<p>

</p></dd><dt><i>Certificate</i>
</dt><dd>A public security key packaged in a way that allows its verification.
<p>

</p></dd><dt><i>Client</i>
</dt><dd><i>(Kerberos)</i> An entity that can obtain a ticket (see Ticket).
<p>

</p></dd><dt><i>Credentials Cache</i>

</dt><dd><i>(Kerberos)</i> The location where Kerberos stores tickets. The
credentials cache can be a file or a buffer in memory.

<p>

</p></dd><dt><i>CAST</i>
</dt><dd>An encryption algorithm similar to DES (<i>q.v.</i>).

<p>


</p></dd><dt><i>CRL</i>
</dt><dd>SSL/TLS X.509 Certificate Revocation List.
<p>

</p></dd><dt><i>CSR</i>
</dt><dd>SSL/TLS X.509 Certificate Signing Request.
<p>


</p></dd><dt><i>DES</i>
</dt><dd>USA Federal Information Processing Standard (FIPS)
<a href="http://www.itl.nist.gov/fipspubs/fip46-2.html">46-2 Data Encryption
Standard</a> (1988, 1993).
<p>

</p></dd><dt><i>DNS</i>
</dt><dd>Domain Name System (which resolves IP hostnames into numeric IP
addresses).
<p>

</p></dd><dt><i>DNSSEC</i>
</dt><dd><a href="http://www.ietf.org/ids.by.wg/dnssec.html">Domain Name System
Security</a>.
<p>

</p></dd><dt><i>Entity</i>
</dt><dd>In this document, a user, host, or service.
<p>

</p></dd><dt><i>Expiration</i>

</dt><dd><i>(Kerberos)</i> Invalidation of a ticket after a certain period of time.
A ticket's lifetime is chosen by the user when obtaining the ticket; the
maximum allowable lifetime for different kinds of tickets is set by the site
administrator.

<p>

</p></dd><dt><i>FTP</i>
</dt><dd>File Transfer Protocol.  On the Internet, this refers to a specific
protocol defined in 
<a href="ftp://ftp.isi.edu/in-notes/rfc959.txt">RFC 959</a> and its followons.

<p>

</p></dd><dt><i>Forwardable Tickets</i>

</dt><dd><i>(Kerberos)</i> Tickets that can be forwarded (copied) to a remote
machine, where they can be used, eliminating the need to obtain new Ticket
Granting Tickets (q.v.) on that machine, e.g. for Telnetting from machine A to
machine B and then from machine B to machine C.

<p>

</p></dd><dt><i>Host</i>
</dt><dd>A computer that can be accessed over a network.
<p>

</p></dd><dt><i>HTTP</i>
</dt><dd>Hyper Text Transfer Protocol, the protocol of the World Wide Web,
<a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">RFC 2616</a>.
<p>

</p></dd><dt><i>IETF</i>
</dt><dd>The <a href="http://www.ietf.org/">Internet Engineering Task Force</a>,
the body that sets standards for use on the Internet.
<p>

</p></dd><dt><i>IKSD</i>
</dt><dd><a href="http://www.columbia.edu/kermit/cuiksd.html">Internet Kermit
Service Daemon</a>.
<p>

</p></dd><dt><i>IPsec</i>
</dt><dd><a href="http://www.ietf.org/html.charters/ipsec-charter.html">IP Security
Protocol</a>.
<p>

</p></dd><dt><i>IPv6</i>
</dt><dd><a href="http://www.ipv6.org/">Internet Protocol Version 6</a>, the
"next generation" Internet protocol.
<p>

</p></dd><dt><i>ITU-T</i>
</dt><dd>International Telecommunications Union, the body that sets international
X-dot-series standards.
<p>

</p></dd><dt><i>Integrity</i>
</dt><dd>The assurance that traffic on a network connection has not been altered
in transit.
<p>

</p></dd><dt><i>KDC</i>

</dt><dd><i>(Kerberos)</i> Key Distribution Center, a machine that issues Kerberos
tickets.

<p>
</p></dd><dt><i>PGP</i>
</dt><dd><a href="http://www.cypherspace.org/%7Eadam/timeline/">
Pretty Good Privacy</a>, the original do-it-yourself
public key security scheme, first developed in 1991 by Phil Zimmerman.

<p>

</p></dd><dt><i>Preauthenticated Ticket Granting Ticket Request</i>

</dt><dd><i>(Kerberos)</i> The client must include a time stamp encrypted with the
user's password when requesting the TGT from the KDC.  This allows the KDC to
only deliver a TGT to a valid user.  When preauthentication is not used the
TGT may be attacked offline to determine the user's password.

<p>

</p></dd><dt><i>NAT</i>
</dt><dd>Network Address Translator.
<p>

</p></dd><dt><i>NTLM</i>
</dt><dd>Microsoft (Windows) NT LAN Manager authentication protocol.
<p>

</p></dd><dt><i>PKI</i>
</dt><dd>Public Key Infrastructure.
<p>

</p></dd><dt><i>Postdated Ticket</i>

</dt><dd><i>(Kerberos)</i> A ticket that does not become valid until after a
specified time.  This allows for secure unattended operations.

<p>

</p></dd><dt><i>Principal</i>
</dt><dd><i>(Kerberos)</i> A string that names a specific entity to which a set of
credentials may be assigned.  It generally has three parts,
<tt>primary/instance@REALM</tt>:
<ol>
<li><i>Primary:</i> Identifies the user or service.
</li><li><i>Instance:</i> Usually a hostname or REALM.
</li><li><i>REALM:</i> Logical network served by a single Kerberos database and
KDC.

</li></ol>
<p>

</p></dd><dt><i>Privacy</i>
</dt><dd>The assurance that traffic on a network connection is intelligible only
to the two communicating parties.
<p>


</p></dd><dt><i>Proxiable Ticket</i>
</dt><dd><i>(Kerberos)</i> A ticket that may be given to a service to allow the
service to impersonate the user for whom the ticket has been issued.
<p>

</p></dd><dt><i>SSH</i>
</dt><dd>Secure Shell protocol.  There are two versions of this protocol.

<p>
</p></dd><dt><i>SSL</i>
</dt><dd>Secure Sockets Layer, developed by/for Netscape for secure Web connections.

<p>
</p></dd><dt><i>SOCKS</i>
</dt><dd>Protocol for firewall traversal.
SOCKS5 is an Internet standard
(<a href="ftp://ftp.isi.edu/in-notes/rfc1928.txt">RFC 1928</a>).

<p>
</p></dd><dt><i>SSL/TLS</i>
</dt><dd>SSL (<i>q.v.</i>) and/or TLS (<i>q.v.</i>).

<p>
</p></dd><dt><i>SRP</i>

</dt><dd>Stanford University's Secure Remote Password protocol, a zero-knowledge
based authentication method.
<p>

</p><p>
</p></dd><dt><i>TELNET</i>
</dt><dd>ARPANET/Internet Network Virtual Terminal Protocol ("Teletype Network"),
described in <a href="ftp://ftp.isi.edu/in-notes/rfc854.txt">RFC 854</a> plus
many followons.

<p>

</p></dd><dt><i>Ticket</i>

</dt><dd><i>(Kerberos)</i> A temporary set of electronic credentials that verifies
the identity of its owner to a particular service.

<p>
</p></dd><dt><i>TGT</i>

</dt><dd><i>(Kerberos)</i> Ticket Granting Ticket.  A special ticket that lets its
owner obtain additional tickets within the same realm.  A TGT is obtained
during the initial authentication process.

<p>
</p></dd><dt><i>TLS</i>
</dt><dd>Transport Layer Security, the Internet standard form of SSL (<i>q.v.</i>),
<a href="ftp://ftp.isi.edu/in-notes/rfc2246.txt">RFC 2246</a>.

<p>
</p></dd><dt><i>X.509</i>
</dt><dd>ITU-T standard for exchanging public keys.

</dd></dl>




<h3><a name="references"><hr>REFERENCES</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]

<ol>
<li>Schneier, Bruce, <cite>Applied Cryptography: Protocols, Algorithms, and
Source Code in C</cite>, 2nd Edition, 784 pages,
John Wiley &amp; Sons; ISBN: 0471117099 (1995).

<p>

</p></li><li>da Cruz, Frank, and Christine M. Gianone, <cite>Using C-Kermit</cite>,
2nd Edition, 622 pages, Digital Press / Butterworth Heinemann;
ISBN: 1-55558-164-1 (1997)

<p>

</p></li><li><a href="http://www.columbia.edu/kermit/">The Kermit Project Website</a>

<p>

</p></li><li><a href="ftp://ftp.isi.edu/in-notes/rfc854.txt">RFC 854</a>:
<tt></tt>Telnet Protocol Specification

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc959.txt">RFC 959</a>:
<tt></tt>File Transfer Protocol (FTP)

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc1282.txt">RFC 1282</a>:
BSD Rlogin

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc1510.txt">RFC 1510</a>:
The Kerberos Network Authentication Service (V5)

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc1928.txt">RFC 1928</a>:
SOCKS Protocol Version 5

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc1964.txt">RFC 1964</a>:
The Kerberos Version 5 GSS-API Mechanism

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2217.txt">RFC 2217</a>
Telnet Com Port Control Option

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2228.txt">RFC 2228</a>:
FTP Security Extensions

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2246.txt">RFC 2246</a>:
The TLS Protocol Version 1.0

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2663.txt">RFC 2663</a>:
IP Network Addres Translator (NAT) Terminology and Considerations

</li><li><a href="http://www.ietf.org/rfc/rfc2459.txt">RFC 2459</a>:
Internet X.509 Public Key Infrastructure - Certificate and CRL Profile

</li><li><a href="http://www.imc.org/rfc2527">RFC 2527</a>:
Internet X.509 Public Key Infrastructure -
Certificate Policy and Certification Practices Framework

</li><li><a href="http://www.imc.org/rfc2528">RFC 2528</a>:
Internet X.509 Public Key Infrastructure -
Representation of Key Exchange Algorithm (KEA) Keys...

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">RFC 2616</a>:
Hypertext Transfer Protocol -- HTTP/1.1

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2712.txt">RFC 2712</a>:
Addition of Kerberos Cipher Suites to Transport Layer Security (TLS)

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2818.txt">RFC 2818</a>:
HTTP over TLS

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2839.txt">RFC 2839</a>:
Internet Kermit Service

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2840.txt">RFC 2840</a>:
Telnet KERMIT Option

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2941.txt">RFC 2941</a>:
Telnet Authentication Option

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2942.txt">RFC 2942</a>:
Telnet Authentication: Kerberos Version 5

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2943.txt">RFC 2943</a>:
TELNET Authentication Using DSA

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2944.txt">RFC 2944</a>:
Telnet Authentication: SRP

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2945.txt">RFC 2945</a>:
The SRP Authentication and Key Exchange System

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2946.txt">RFC 2946</a>:
Telnet Data Encryption Option

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2946.txt">RFC 2947</a>:
Telnet Encryption: DES3 64 bit Cipher Feedback

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2948.txt">RFC 2948</a>:
DES3 64-bit Output Feedback Mode

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2949.txt">RFC 2949</a>:
CAST-128 64-bit Output Feedback Mode

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2950.txt">RFC 2950</a>:
CAST-128 64-bit Cipher Feedback Mode

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2951.txt">RFC 2951</a>:
DES 64-bit Output Feedback Mode

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2952.txt">RFC 2952</a>:
DES 64-bit Cipher Feedback Mode

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2953.txt">RFC 2953</a>:
Telnet Encryption: DES 64 bit Output Feedback

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc2993.txt">RFC 2993</a>:
Architectural Implications of NAT

</li><li><a href="ftp://ftp.isi.edu/in-notes/rfc3002.txt">RFC 3002</a>:
Traditional IP Network Address Translator (Traditional NAT)

</li></ol>

<p>

</p><dl><dt><i>Also see:</i></dt><dd><a href="http://www.columbia.edu/kermit/standards.html"><tt>http://www.columbia.edu/kermit/standards.html</tt></a>
</dd></dl>

<h3><a name="trademarks"><hr>TRADEMARKS</a></h3>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]

<dl><dt><b>Kerberos</b>
</dt><dd>Is a trademark of Massachusetts Institute of Technology.

<p>
</p></dd><dt><b>Secure Remote Password</b>
</dt><dd>Is a trademark of Stanford University.

</dd></dl>

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="#glossary">Glossary</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]
</p><hr>

<a href="#top"><i>Kermit Security Reference</i></a> /
<a href="http://www.columbia.edu/kermit/index.html">The Kermit Project</a> /
<a href="http://www.columbia.edu/">Columbia University</a> /<br>
<a href="mailto:kermit-support@columbia.edu">
<tt>kermit-support@columbia.edu</tt></a> /
 1 January 2003
</body></html>