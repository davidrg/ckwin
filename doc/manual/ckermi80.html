<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN//2.0"> 
<html><head>
<title>C-Kermit 8.0 Update Notes</title>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000">

<h1><tt>C-Kermit 8.0 Update Notes</tt></a></h1>

<a name="top"></a>
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h1>Second Supplement to <cite>Using C-Kermit</cite>, Second Edition</h1>
<h2>For C-Kermit 8.0</h2>

<i>As of C-Kermit version:</i>  <b>8.0.206</b><br>
<i>Date of C-Kermit release:</i>  <b>24 October 2002</b><br>
<i>This file last updated:</i>
Sat Jan 11 10:19:27 2003
</pre>

<p>
<ul>

<li>IF YOU ARE READING A PLAIN-TEXT version of this document, note that it
is a plain-text dump of a Web page.  You can visit the original (and
possibly more up-to-date) Web page here:

<p>
<pre>
  <a href="http://www.columbia.edu/kermit/ckermit80.html">http://www.columbia.edu/kermit/ckermit80.html</a>
</pre>

<p>

<li><font color="red">If you are reading the HTML version of this file
with a GUI Web browser, the features added since C-Kermit 8.0.201 are
shown in red if your browser and monitor permit.</font>
Features that were new to versions 8.0.200 and 201 are in black.

</ul>

<p>
<pre>
<i>Authors:</i> Frank da Cruz and Christine M. Gianone
<i>Address:</i> The Kermit Project
         Columbia University
         612 West 115th Street
         New York NY 10025-7799
         USA
<i>Fax:</i>     +1 (212) 662-6442
<i>E-Mail:</i>  <a href="mailto:kermit-support@columbia.edu">kermit-support@columbia.edu</a>
Web:     <a href="http://www.columbia.edu/kermit/">http://www.columbia.edu/kermit/</a>
Or:      <a href="http://www.kermitproject.org/">http://www.kermitproject.org/</a>
Or:      <a href="http://www.columbia.nyc.ny.us/kermit/">http://www.columbia.nyc.ny.us/kermit/</a>
</pre><p>
<hr>
<h3>NOTICES</h3>

<dl>
<dt>This document:
<dd>Copyright &copy; 1997, 2002, Frank da Cruz and Christine M. Gianone.
All rights reserved.
<p>
<dt>Kermit 95:
<dd>Copyright &copy; 1995, 2002, Trustees of Columbia University in the City of
New York.  All rights reserved.
<p>
<dt>C-Kermit:
<dd>Copyright &copy; 1985, 2002,<br>
Trustees of Columbia University in the City of New York.
All rights reserved.  See the C-Kermit <a href="ftp://kermit.columbia.edu/kermit/f/COPYING.TXT">COPYING.TXT</a> file or the
copyright text in the
<a href="ftp://kermit.columbia.edu/kermit/f/ckcmai.c">ckcmai.c</a>
module for disclaimer and permissions.
</dl>
<p><dl>
<dt>When Kerberos(TM) and/or SRP(TM) (Secure Remote Password) and/or SSL/TLS
protocol are included:
<dd>Portions Copyright &copy; 1990, Massachusetts Institute of Technology.<br>
Portions Copyright &copy; 1991, 1993 Regents of the University of California.<br>
Portions Copyright &copy; 1991, 1992, 1993, 1994, 1995 by AT&#38;T.<br>
Portions Copyright &copy; 1997, Stanford University.<br>
Portions Copyright &copy; 1995-1997,
Eric Young <tt>&#60;eay@cryptosoft.com&#62;</tt>.
</dl>
<p>
For the full text of the third-party copyright notices, see
<a href="#xv">Appendix V</a>.
<p>
<hr>
<h3>WHAT IS IN THIS FILE</h3>

This file lists changes made to C-Kermit
since version 7.0 was released in January 2000.
Use this file as a supplement to:
<p>
<ul>
<li>The second edition of
<a href="https://www.kermitproject.org/usingckermit.html"><cite>Using C-Kermit</cite></a>; and:
<li>The <a href="ckermi70.html">C-Kermit 7.0 Update Notes</a>.  Also
available in plain-text form as <a
href="ftp://kermit.columbia.edu/kermit/f/ckermit70.txt"><tt>ckermit70.txt</tt></a>.

</ul>
<p>
until the third edition of <cite>Using C-Kermit</cite> is published.  We
apologize for the scattered documentation and will consolidate it when
we are able.

<h3><hr>ADDITIONAL FILES</h3>

Several other files accompany this new Kermit release:
<p><dl>

<dt><tt><a href="http://www.columbia.edu/kermit/ckututor.html">ckututor.html</a></tt>
<dd>C-Kermit Tutorial (for Unix).  Also distributed in Nroff
form as 
<a href="ftp://kermit.columbia.edu/kermit/f/ckuker.nr"><tt>ckuker.nr</tt></a>,
the Unix C-Kermit manual page.

<p>
<dt><tt><a href="security.html">security.htm</a></tt>
<dd>Discussion of Kermit's new authentication and encryption features,
updated for C-Kermit 8.0.

<p>
<dt><tt><a href="telnet.html">telnet.htm</a></tt>
<dd>Detailed documentation of Kermit's Telnet client, updated for C-Kermit 8.0.

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/ftpscripts.html">ftpscripts.html</a></tt>
<dd>Tutorial: Writing FTP automation scripts
<p>
<dt><tt><a href="http://www.columbia.edu/kermit/ckcbwr.html">ckcbwr.html</a></tt>
<dd>Platform-independent C-Kermit hints and tips.  Also distributed in plain
text form as 
<a href="ftp://kermit.columbia.edu/kermit/f/ckcbwr.txt"><tt>ckcbwr.txt</tt></a>

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/ckubwr.html">ckubwr.html</a></tt>
<dd>Unix-specific C-Kermit hints and tips.  Also distributed in plain
text form as 
<a href="ftp://kermit.columbia.edu/kermit/f/ckubwr.txt"><tt>ckubwr.txt</tt></a>.

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/ckvbwr.html">ckvbwr.html</a></tt>
<dd>VMS-specific C-Kermit hints and tips.  Also distributed in plain
text form as 
<a href="ftp://kermit.columbia.edu/kermit/f/ckvbwr.txt"><tt>ckvbwr.txt</tt></a>.

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/ckuins.html">ckuins.html</a></tt>
<dd>Unix C-Kermit installation instructions.  Also distributed in plain
text form as 
<a href="ftp://kermit.columbia.edu/kermit/f/ckuins.txt"><tt>ckuins.txt</tt></a>.

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/ckvins.html">ckvins.html</a></tt>
<dd>VMS C-Kermit installation instructions.  Also distributed in plain
text form as 
<a href="ftp://kermit.columbia.edu/kermit/f/ckvins.txt"><tt>ckvins.txt</tt></a>.

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/ckccfg.html">ckccfg.html</a></tt>
<dd>Compile-time configuration options.  Also distributed in plain
text form as 
<a href="ftp://kermit.columbia.edu/kermit/f/ckccfg.txt"><tt>ckccfg.txt</tt></a>.

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/ckcplm.html">ckcplm.html</a></tt>
<dd>C-Kermit Program Logic Manual.  Also distributed in plain
text form as 
<a href="ftp://kermit.columbia.edu/kermit/f/ckcplm.txt"><tt>ckcplm.txt</tt></a>.

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/iksd.html">iksd.html</a></tt>
<dd>Internet Kermit Service Aministrators Guide for Unix.

<p>
<dt><tt><a href="http://www.columbia.edu/kermit/skermit.html">skermit.html</a></tt>
<dd>C-Kermit as an SSH Subsystem (SFTP server replacement).

</dl>
<p>
[ <a href="#top">Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="contents"><hr>CONTENTS</a></h2>

<tt>&nbsp;&nbsp;</tt><a href="#x0"><b>0. WHAT'S NEW</b></a><br>
<tt>&nbsp;&nbsp;</tt><a href="#x1"><b>1. FIXES SINCE VERSION 7.0.196</b></a><br>
<tt>&nbsp;&nbsp;</tt><a href="#x2"><b>2. SSH AND HTTP </b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x2.1"><b> 2.1. SSH Connections</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x2.2"><b> 2.2. HTTP Connections</b></a><br>

<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x2.2.1">2.2.1. HTTP Command Switches</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x2.2.2">2.2.2. HTTP Action Commands</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x2.2.3">2.2.3. HTTP Headers</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x2.2.4">2.2.4. Secure HTTP Connections</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x2.2.5">2.2.5. HTTP Variables</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x2.2.6">2.2.6. The HTTP Command-Line Personality</a><br>

<tt>&nbsp;&nbsp;</tt><a href="#x3"><b>3. THE BUILT-IN FTP CLIENT</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.1"><b> 3.1. Making and Managing FTP Connections</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.1.1"> 3.1.1. Kermit Command-Line Options for FTP</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.1.2"> 3.1.2. The FTP Command-Line Personality</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.1.3"> 3.1.3. The FTP URL Interpreter</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.1.4"> 3.1.4. Interactive FTP Session Establishment</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.2"><b> 3.2. Making Secure FTP Connections</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.3"><b> 3.3. Setting FTP Preferences</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.4"><b> 3.4. Managing Directories and Files</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.5"><b> 3.5. Uploading Files With FTP</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.5.1"> 3.5.1. FTP PUT Switches</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.5.2"> 3.5.2. Update Mode</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.5.3"> 3.5.3. Recovery</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.6"><b> 3.6. Downloading Files With FTP</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.6.1"> 3.6.1. FTP GET Switches</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.6.2"> 3.6.2. Filename Collisions</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.6.3"> 3.6.3. Recovery</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.7"><b> 3.7. Translating Character Sets</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.7.1"> 3.7.1. Character Sets and Uploading</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.7.2"> 3.7.2. Character Sets and Downloading</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.8"><b> 3.8. FTP Command Shortcuts</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.9"><b> 3.9. Dual Sessions</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.10"><b>3.10. Automating FTP Sessions</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.10.1"> 3.10.1. FTP-Specific Variables and Functions</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.10.2"> 3.10.2. Examples</a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x3.11"><b> <font color="red">3.11. Advanced FTP Protocol Features</font></b></a></br>
<tt>&nbsp;</tt><a href="#x4"><b>4. FILE SCANNING</b></a><br>
<tt>&nbsp;</tt><a href="#x5"><b>5. FILE AND DIRECTORY NAMES CONTAINING SPACES</b></a><br>
<tt>&nbsp;</tt><a href="#x6"><b>6. OTHER COMMAND PARSING IMPROVEMENTS</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x6.1"><b> 6.1. Grouping Macro Arguments</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x6.2"><b> 6.2. Directory and File Name Completion</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x6.3"><b> 6.3. Passing Arguments to Command Files</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x6.4"><b> 6.4. More-Prompting</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x6.5"><b> 6.5. Commas in Macro Definitions</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x6.6"><b> 6.6. Arrow Keys</b></a><br>
<tt>&nbsp;</tt><a href="#x7"><b>7. NEW COMMANDS AND SWITCHES</b></a><br>
<tt>&nbsp;</tt><a href="#x8"><b>8. SCRIPTING IMPROVEMENTS</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.1"><b> 8.1. Performance and Debugging</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.2"><b> 8.2. Using Macros as Numeric Variables</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.3"><b> 8.3. New IF Conditions</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.4"><b> 8.4. The ON_UNKNOWN_COMMAND Macro</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.5"><b> 8.5. The SHOW MACRO Command</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.6"><b> 8.6. Arrays</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.7"><b> 8.7. New or Improved Built-in Variables and Functions</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.8"><b> 8.8. The RETURN and END Commands</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.9"><b> 8.9. UNDEFINing Groups of Variables</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.10"><b> 8.10. The MINPUT Command</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.11"><b> 8.11. Learned Scripts</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.12"><b> 8.12. Pattern Matching</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.13"><b> 8.13. Dates and Times</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x8.14"><b> 8.14. Trapping Keyboard Interruption</b></a><br>
<tt>&nbsp;</tt><a href="#x9"><b>9. S-EXPRESSIONS</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.1"><b> 9.1. What is an S-Expression?</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.2"><b> 9.2. Integer and Floating-Point-Arithmetic</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.3"><b> 9.3. How to Use S-Expressions</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.4"><b> 9.4. Summary of Built-in Constants and Operators</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.5"><b> 9.5. Variables</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.6"><b> 9.6. Assignments and Scope</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.7"><b> 9.7. Conditional Expressions</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.8"><b> 9.8. Extensibility</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.9"><b> 9.9. Examples</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.10"><b> 9.10. Differences from Algebraic Notation</b></a><br>
<tt>&nbsp;&nbsp;</tt>  <tt>&nbsp;&nbsp;</tt>  <a href="#x9.11"><b> 9.11.Differences from Lisp</b></a><br>
<tt>&nbsp;</tt><a href="#x10"><b>10. FILE TRANSFER</b></a><br>
<tt>&nbsp;</tt><a href="#x11"><b>11. MODEMS AND DIALING</b></a><br>
<tt>&nbsp;</tt><a href="#x12"><b>12. TERMINAL CONNECTION</b></a><br>
<tt>&nbsp;</tt><a href="#x13"><b>13. CHARACTER SETS</b></a><br>
<tt>&nbsp;</tt><a href="#x14"><b>14. DIALOUT FROM TELNET TERMINAL SERVERS</b></a><br>
<tt>&nbsp;</tt><a href="#x15"><b>15. COPING WITH BROKEN KERMIT PARTNERS</b></a><br>
<tt>&nbsp;</tt><a href="#x16"><b>16. NEW COMMAND-LINE OPTIONS</b></a><br>
<tt>&nbsp;</tt><a href="#x17"><b>17. LOGS</b></a><br>
<p>
[ <a href="#top">Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x0"><hr>0. WHAT'S NEW</a></h2>

<dl>
<dt><b>The Initialization and Customization Files</b></dt>

<dd>C-Kermit 8.0 now supports specification of the initialization file
name (path) in an environment variable, <tt>CKERMIT_INI</tt>.  It also relies
far less than before on the initialization for functioning.
See <a href="http://www.columbia.edu/kermit/ckuins.html#x5">Section 5</a> of
the Unix C-Kermit
<a href="http://www.columbia.edu/kermit/ckuins.html">installation instructions</a> for details.
As of version 8.0.201, C-Kermit also executes your customization file (if
you have one) even if the initialization file was not found.  Previously,
the customization file was executed by a TAKE command in the initialization
file (and it still is, if an initialization is found).

<p>
<dt><b>Incompatible Changes</b></dt>
<dd>As always, we do our best to avoid changes that break existing scripts.
However, C-Kermit 8.0 does include a rather pervasive syntax change that
might alter the behavior of scripts that depend on the previous behavior.
As described in <a href="#x5">Section 5</a>, C-Kermit now accepts doublequotes
in most contexts where you previously had to use braces to group multiple
words into a single field, or to force inclusion of leading or trailing
blanks.  Most noticeably, in C-Kermit 7.0 and earlier:
<p><pre>
  echo {this is a string}
</pre>
<p>
would print:
<p><pre>
  this is a string
</pre>
<p>
whereas:
<p><pre>
  echo "this is a string"
</pre>
<p>
printed:
<p><pre>
  "this is a string"
</pre>
<p>
In C-Kermit 8.0, both print:
<p><pre>
  this is a string
</pre>
<p>
To force the doublequotes to be treated as part of the string, use either
of the following forms:
<p><pre>
  echo {"this is a string"}
  echo ""this is a string""
</pre>
<p>
Similarly, to force braces to be treated as part of the string:
<p><pre>
  echo "{this is a string}"
  echo {{this is a string}}
</pre>
<p>

Other incompatibilities:
<p>
<ol>
<li>Using the SET HOST command to make HTTP connections is no longer
supported.  Instead, use the new HTTP OPEN command, described
in <a href="#x2.2">Section 2.2</a>.
</ol>

<p>
<dt><b>C-Kermit 7.1 Alpha.01</b> (8 December 2000)</dt>

<dd><li>Its major new features are those listed in the
<a href="#contents">Table of Contents</a>: the FTP client, file scanning,
command parsing and scripting improvements, S-Expressions, and support for the
Telnet Com Port Option, plus wider availability of the Kerberos, SSL/TLS, and
SRP security options for secure Internet connections.

<p>

<dt><b>C-Kermit 7.1.199 Alpha.02</b> (4 January 2001)</dt>

<dd>
<ul>
<li>C-Kermit now accepts
<a href="#x15">FTP, TELNET, and IKSD URLs</a> as its first command-line
argument.
<li>Character-set translation added to the FTP client for
<a href="#x3.7">filenames.
<li>Optional <a href="#ftpdates">setting of date</a> of incoming files by FTP
[M]GET from the server date.
<li><a href="#ftpcheck">FTP CHECK <i>filename</i></a> added to let FTP client
check the existence of a file on the server.
<li><a href="#ftpnamelist">FTP GET /NAMELIST:<i>filename</i></a> added to get
list of server filenames into a local file.
<li><a href="#srvrename">FTP [M]PUT /SERVER-RENAME:<i>template</i></a> added
to make server rename a file as indicated by the template after it has arrived
completely.
<li>FTP [M]GET /SERVER-RENAME:<i>template</i> added to make server rename
a file as indicated by the template after it has been sent completely.
<li>FTP <a href="#ftpvdir">VDIRECTORY</a> added for getting verbose directory
listings from TOPS-20.
<li><a href="#setftptype">FTP TYPE TENEX</a> added for transferring 8-bit
binary files with PDP-10s.
<li>Added <a href="#x3.6">automatic text/binary mode switching
for FTP [M]GET</a>, based on
filename patterns (e.g. <tt>*.zip</tt>, <tt>*.gz</tt>, <tt>*.exe</tt>
are binary; <tt>*.txt</tt>, <tt>*.c</tt> are text).
<li><a href="#x15">SET SEND I-PACKETS OFF</a> added for coping with Kermit
servers that do not support I packets.
<li>A new option was added to <a href="#x8.7"><tt>\fword()</tt> and
<tt>\fsplit()</tt></a> for parsing comma-separated lists that might contain
empty elements.
<li>Bug fixes including:<ul>
<li><tt>{}</tt> or <tt>""</tt> could not be used as expected to represent the
empty string.
<li><tt>,-</tt> on a line by itself in a macro definition caused subsequent
statements to be skipped.
<li>FTP [M]GET didn't work right if path segments were included in the filespec.
<li>FTP MGET, if interrupted, did not clear its file list.
<li>Various problems with FTP PUT /AS-NAME that nobody noticed.
<li>Some FTP messages and displays interfered with each other.
<li>Parsing of YESTERDAY, TODAY, and TOMORROW in date-time fields was broken.
<li>Automatic old-to-new dialing directory format conversion was broken on VMS.
<li>Various source-code portability problems fixed.
</ul>
<li>Improvement of various HELP and SHOW messages.
</ul>
<p>
<dt><b>C-Kermit 7.1.199 Alpha.04</b> (1 April 2001)</dt>
<dd>
<ul>
<li>Big changes:
<ul>
<li>Changed default modem type from NONE to GENERIC.
<li>Generic dialing now sends no init string at all.
<li>Changed default terminal bytesize from 7 to 8.
</ul>
<li>New features:
<ul>
<li>SET SESSION-LOG TIMESTAMPED-TEXT for timestamped session log.
</ul>
<li>New modem types:
<ul>
<li>Conexant modem family
<li>Lucent VENUS chipset
<li>PCTel V.90 chipset
<li>Zoom V.90
<li>Zoom V.92
</ul>
<li>FTP client:
<ul>
<li>FTP OPEN <host> /PASSIVE and /ACTIVE switches added.
<li>Now works with servers that that don't include path in NLST response.
<li>Fixed SEND /RECURSIVE not to follow symlinks (UNIX).
<li>SET FTP VERBOSE-MODE default is now OFF instead of ON.
</ul>
<li>Kermit protocol:
<ul>
<li>Fixed what I hope is the last "Receive window full" error.
<li>SET PREFIXING <anything> or SET CONTROL PREFIX <anything> now
automatically sets CLEARCHANNEL OFF.
<li>Fixed incorrect report of number of files transferred at end of transfer.
<li>Fixed SEND /RECURSIVE not to follow symlinks (UNIX).
</ul>
<li>UNIX:
<ul>
<li>HTTP and shadow passwords enabled for SCO 5.0.6.
<li>Even with SET FILENAMES CONVERTED, spaces were still accepted in incoming
filenames; now they are converted to underscores. 
<li>Added support for compile-time <tt>mktemp()/mkstemp()</tt> selection.
</ul>
<li>VMS:
<ul>
<li>Session-log format for scripted sessions fixed.
</ul>
<li>Scripting:
<ul>
<li>Fixed <tt>\frdir()</tt> not to follow symlinks (UNIX).
<li>Fixed <tt>\fday()</tt> not to dump core for dates prior to 17 Mar 1858.
</ul>
<li>General:
<ul>
<li>"Closing blah..." message upon exit could not be surpressed.
<li>Added /PAGE and /NOPAGE to DELETE switches.
<li>Added GO response for DELETE /ASK (delete all the rest without asking).
<li>Added GO response to "more?" prompt (for multi-page screen output).
<li>Updated HELP texts.
</ul>
</ul>
<p>

<dt><b>C-Kermit 7.1.199 Beta.01</b> (10 May 2001)</dt>
<dd>
<ul>
<li>FTP client verbosity adjustments.
<li>Bug with generic modem dialing pausing several secs fixed.
<li>SET HOST /USER:, SET LOGIN USERID, etc, fixed when given no user ID.
<li>A couple <tt>\v(dm_blah)</tt> dial modifier variables added.
<li>"--version" command-line switch added.
<li>Fixed NetBSD serial-port DTR handling.
<li>Lots of syntax cleanups for Flexelint and gcc -Wall.
<li>Fixed modem-type aliases to not take precedence over real names.
<li>Fixed funny treatment of doublequotes by ECHO command.
<li>Enabled SET SESSION-LOG for VMS and other non-UNIX platorms.
<li>Fixed changing direction in command history buffer.
<li>Fixed handling of IKSD URLs.
<li>Made sure DELETE prints a message if it got any errors.
</ul>

<p>

<dt><b>C-Kermit 8.0.200 Beta.02</b> (28 June 2001)</dt>
<dd>
<ul>
<li>Major version number increased from 7 to 8.
<li><a href="#x2.1">SSH command</a>.
<li>More-consistent Kermit protocol defaults.
<li>CONNECT idle timeout and action selection.
<li>CONNECT status variable.
<li>A way to allocate more space for filename lists.
<li>Pseudoterminal handler fixed for late-model Linuxes.
<li>Command-line option <tt>-dd</tt> for timestamped debug log.
<li>Download directory now works for external protocols too.
<li>GREP /COUNT:<i>variable</i>.
<li>SET ATTRIBUTE RECORD-FORMAT <i>{</i> OFF, ON <i>}</i>.
<li>Bug fixes.
</ul>

<p>

<dt><b>C-Kermit 8.0.200 Beta.03</b> (9 Sep 2001)</dt>
<dd>
<ul>
<li><a href="#x2.2">HTTP 1.1 connections and scripting</a>
<li><a href="#x8.14">ON_CTRLC macro for trapping Ctrl-C in scripts</a>
<li><a href="#x8.13">Date-time parsing improvements, timezones, comparison, arithmetic</a>
<li><a href="#x8.13">Pattern-matching improvements</a>
<li>FTP improvements
<li>SET EXIT HANGUP <i>{</i> ON, OFF <i>}</i>
<li>SET FILE EOF <i>{</i> CTRL-Z, LENGTH <i>}</i>
<li>ASK[Q] /TIMEOUT
<li>Bug fixes
<li>New platforms
</ul>
<p>
<dt><b>C-Kermit 8.0.200 Beta.04</b> (16 Nov ckermi80.html:<li>New <a href="#x3.11">FT2001)</dt>
<dd>
<ul>
<li><a href="http://www.columbia.edu/kermit/ckututor.html">New Unix man page</a>
<li><a href="http://www.columbia.edu/kermit/ckuins.html">New Unix installation instructions</a>
<li>SET TELOPT policies are now enforced on non-Telnet ports if the
server begins Telnet negotiations.
<li>SET TERMINAL IDLE-ACTION <i>{</i> TELNET-NOP, TELNET-AYT <i>}</i>.
<li>UUCP lockfile creation race condition fixed.
<li>Dialout, modem signals, hangup, hardware flow control, etc, tested
extensively on many platforms, numerous problems fixed.
<li>Improved hints when dialing fails.
<li>SET STOP-BITS 2 can now be given without SET FLOW HARDWARE.
<li>Major improvements in RFC 2217 Telnet Com-Port Control.
<li>Improved ability to REDIAL a modem server port.
<li><tt>kermit -h</tt> now shows the command name in the usage usage string.
<li><tt>kermit -h</tt> now shows ALL command-line options.
<li><tt>kermit -s <i>blah</i></tt>, where <i>blah</i> is a symlink, now works.
<li>--noperms command-line option = SET ATTRIBUTE PERMISSIONS OFF.
<li>HTTP and HTTPS URLs now supported on the command line.
<li>An http command-line personality is now available.
<li>Initialization file streamlined to load faster, anachronisms removed.
<li>Updated NEWS, INTRO, HELP text, SHOW commands.
In particular, see SHOW COMM, HELP SET LINE, HELP WAIT.
<li>Date/time arithmetic routines converted from floating-point to integer
arithmetic (internally) for greater accuracy and portability.
<li>Quoted strings containing commas no longer break macro execution.
<li>Dynamic Kermit file-transfer timeouts are now much more aggressive.
<li>New "hot keys" to turn <tt>debug.log</tt> on/off during file transfer.
<li>Improved hints when file transfer fails.
<li>FTP CD orientation messages are now printed.
<li><tt>-R</tt> now accepted on the FTP command line to request Recursion.
<li><tt>-m</tt> allows Active or Passive mode to be chosen on the FTP command
line.
<li><tt>-dd</tt> on the FTP command line creates a timestamped
<tt>debug.log</tt>.
<li>FTP command-line security options filled in.
<li>Improved automatic text/binary mode switching for MGET.
<li>Removed spurious error messages that sometimes occur during MGET.
<li>DIRECTORY, GREP, TYPE, HEAD, and TAIL now have a
/OUTPUT<tt>:</tt><i>file</i> option.
<li>TYPE /NUMBER adds line numbers.
<li>CAT = TYPE /NOPAGE; MORE = TYPE /PAGE.
<li>GETOK ?-help fixed.
<li><tt>\v(timestamp)</tt> (= "\v(ndate) \v(time)")
<li><tt>\v(hour)</tt>      (hour of the day, 0-23)
<li><tt>\funix2dospath()</tt> converts a UNIX path (/) to a DOS one (\).
<li><tt>\fdos2unixpath()</tt> converts a DOS (Windows, OS/2) path to a UNIX
one.
<li><tt>\fkeywordval()</tt> parses name=value pair, allows macro keyword
parameters.
<li>We now make every attempt to not write passwords to the <tt>debug.log</tt>.
<li>New Certficate Authority certificates file, includes the Kermit
Project at Columbia University so you can access our IKSD securely.
<li>Secure targets improved and better documented in Unix makefile.
<li>All Linux (libc and glibc) builds consolidated under "make linux".
<li>HP-UX makefile targets now have consistent names.
<li>New aix50 and aix51 targets added.
</ul>

<p>
<dt><b>C-Kermit 8.0.200 Final</b> (12 Dec 2001)</dt>
<dd>
<ul>
<li>Remote/local-mode confusion on some platforms introduced in Beta.04,
fixed.
<li>Many of the makefile targets adjusted, new ones added.
<li>New "make install" target should please most people.
<li>New command: SHOW IKSD.
<li>FTP over TLS.
<li>Last-minute touchups to text messages, HELP text, etc.
<li>Enable modem-signal reading for SCO OSR5 and Unixware 7.
<li>Special superfast TRANSMIT /BINARY /NOECHO /NOWAIT mode added.
<li>Fixed PBX dialing in unmarked-area-code case.
<li>Improved SHOW COMMUNICATIONS tells lockfile directory, typical
dialout device name.
<li>Some FTP OPEN command parsing problems fixed.
<li>Some errors in date arithmetic fixed.
<li>New command: SET TERMINAL AUTODOWNLOAD <i>{</i> ..., ERROR <i>{</i> STOP, CONTINUE <i>}</i> <i>}</i>
<li>New command: HELP FIREWALL.
<li>SET MODEM HANGUP-METHOD DTR added as synomym for RS232-SIGNAL
<li>Support for secure URL protocols added: telnets:, ftps:, https:.
</ul>
<p>
<dt><b>C-Kermit 8.0.201</b> (8 Feb 2002)</dt>
<dd>
<ul>
<li>Installability as an <a href="http://www.columbia.edu/kermit/skermit.html">SSH v2 Subsystem</a>.
<li><a href="#setlocus">SET LOCUS</a> command.
<li><a href="#lcommands">L-versions of CD, DIR, DELETE, MKDIR</a>,
etc, to force local execution.
<li><a href="#ftpuser">USER and ACCOUNT</a> added as synonyms for FTP USER and
FTP ACCOUNT.
<li><a href="#showvar">SHOW VARIABLES</a> now accepts a list of variables.
<li>Rudimentary support for <a href="#callerid">Caller ID</a> when receiving
phone calls.
<li>Up/Down <a href="#x6.6">Arrow-key</a> navigation of command history buffer.
<li><a href="#x0">Automatic execution of customization file</a>
if init file is missing.
</ul>
<p>
<dt><a name="ck206"><b>C-Kermit 8.0.206 Beta.01</b> (11 Oct 2002)</a></dt>
<dd>

<dl>
<dt><b>New commands:</b></dt>
<ul>
<li>ORIENTATION lists location-related variables and their values.
<li>KCD changes to special directories by their symbolic names
("kcd ?" for a list).
<li>SET CD HOME <i>path</i> to specify home directory for CD and KCD commands.
<li>CONTINUE given at top level is equivalent to END -- handy when PROMPT'ed
 out of a script, to continue the script.
</ul>
<p>
<dt><b>New switches or operands for existing commands:</b></dt>
<ul>
<li>GETOK /TIMEOUT
<li>ASK, ASKQ, GETOK /QUIET (suppresses error message on timeout)
<li>COPY /APPEND now allows concatenating multiple source files into one
dest file.  
<li>SET TCP <i>{</i> HTTP-PROXY, SOCKS-SERVER <i>}</i> /USER, /PASSWORD.
<li>DIRECTORY command now accepts multiple filespecs, e.g. "dir a b c".
</ul>
<p>
<dt><b>SET QUIET ON now also applies to:</b></dt>
<ul>
<li>SET HOST connection progress messages.
<li>"Press the X or E key to cancel" file-transfer message.
<li>REMOTE CD response.
<li>REMOTE LOGIN response.
</ul>
<p>
<dt><b>Improvements and new features:</b></dt>
<ul>
<li>Numerous FTP client fixes and new features, listed below.
<li>C-Kermit, when in remote mode at the end of a file transfer, now prints
a one-line "where" message.  Control with SET TRANSFER REPORT.
<li>Unix makefile "install" target now creates an UNINSTALL script.
<li>Improved operation and performance on RFC 2217 Telnet connections.
<li>Improved CONNECT (interactive terminal connection) performance.
<li>HELP text updated for many commands.
</ul>
<p>
<dt><b>New or fixed makefile targets:</b></dt>
<ul>
<li>Solaris 9 (several variations)
<li>Concurrent PowerMAX
<li>Mac OS X 10.2
<li>FreeBSD 1.0
<li>FreeBSD 4.6, 5.0
<li>AIX 5.2, 5.3
</ul>
<p>
<dt><b>Bugs fixed (general):</b></dt>
<ul>
<li>Failure to run in VMS Batch fixed.
<li>LDIRECTORY fixed to run Kermit's built-in DIRECTORY command rather than
an external one.
<li>Fixed Solaris and other SVORPOSIX builds to find out their
full hostnames rather than just the "uname -n" name.
<li>Fixed some problems matching strings that start with ".".
<li>Fixed some problems matching pattern that contain <tt>{a,b,c}</tt> lists.
<li>Fixed erroneous reporting of text-mode reception as binary when sender
did not report the file size (cosmetic only).
<li>Many problems with SWITCH statements fixed.
<li>Fixed SET OPTIONS DIRECTORY /DOTFILES to work for server too.
<li>Fixed DELETE to print an error message if the file was not found.
<li>Fixed SET CONTROL UNPREFIX ALL and SET PREFIXING NONE to do the same thing.
<li>Fixed bugs executing macros from within the ON_EXIT macro.
<li><tt>\fday()</tt> and <tt>\fnday()</tt> fixed for dates prior to 17 Nov
1858.
<li>Serial speed-changing bug in Linux fixed.
<li>"Unbalanced braces" script parsing errors when using
<tt>\{<i>number</i>}</tt>  fixed.
<li>"<tt>if defined \v(<i>name</i>)</tt>" fixed to behave as described in the
book.
<li>Fixed Problems caused by LOCAL variables whose names are left substrings of
macro names.
<li>The INPUT command was fixed to honor the PARITY setting.
<li>Fixed bug with COPY to existing file that is longer than source file.
<li>REINPUT command failed to strip braces/quotes around its target string.
<li>Network directory lookups didn't work for SSH connections.
<li>REMOTE SET <i>{</i> FILE, TRANSFER <i>}</i> CHARACTER-SET fixed.
<li>Closed some holes whereby an incompletely received file was not deleted
when SET FILE INCOMPLETE is DISCARD, e.g. when the Kermit is hung up upon.
<li>SET XFER CHARACTER-SET TRANSPARENT fixed to do the same as SET XFER
TRANSLATION OFF.
<li>SET HOST PTY (e.g. SSH) connection fixed to pass along window-size changes.
<li>C-Kermit search path for TAKE files was accidentally disabled.
</ul>
<p>
<dt><b>FTP client bugs fixed:</b></dt>
<ul>
<li>Character set translation was broken on little-endian (e.g. PC)
architectures.
<li>FTP PUT /SERVER-RENAME:, /RENAME-TO:, /MOVE-TO: switches were sticky.
<li>Make SET TRANSFER MODE MANUAL apply to FTP.
<li>Make SET FILE INCOMPLETE <i>{</i> KEEP, DISCARD <i>}</i> apply to FTP.
<li>FTP MGET /UPDATE handled equal times incorrectly.
<li>FTP MGET /RECOVER fixed to ignore file dates, use only size.
<li>FTP MGET /RECOVER sometimes downloaded files it didn't need to.
<li>FTP downloads with TRANSFER DISPLAY BRIEF could give misleading error 
messages.
<li>FTP MGET temp file not deleted if FTP DEBUG set to OFF after it was ON.
<li>LOCUS not switched back when FTP connection is lost.
<li>Set incoming file date even if it was not completely received.
<li>FTP MGET sent SIZE and MDTM commands even when it didn't have to.
<li>FTP MGET sent SIZE and MDTM commands even when it knew they wouldn't work.
<li>FTP MGET failed if no files were selected for download.
<li>FTP MGET a* b* c* would fail to get any c*'s if no b*'s existed.
<li>Big problems canceling MGET with Ctrl-C.
<li>Some extraneous LOCUS dialogs squelched.
<li>Some inconsistencies in SET FTP FILENAMES AUTO fixed.
<li>Fixed file-descriptor pileup after multiple MGETs when using
<tt>mkstemp()</tt>.
<li>Fixed "mget foo", where foo is a directory name.
</ul>
<p>
<dt><b>FTP improvements:</b></dt>
<ul>
<li>New <a href="#x3.11">FTP protocol features</a> added (FEAT, MLSD).
<li>FTP MGET /RECURSIVE now works as expected if server supports MLSD.
<li>FTP MGET /DATES-DIFFER to download if local and remote file dates differ.
<li>FTP DATES default changed to ON.
<li>FTP MPUT, MGET /EXCEPT now allows up to 64 patterns (up from 8).
<li>Top-level SITE and PASSIVE commands added for convenience.
<li>MGET /COLLISION:APPEND /AS-NAME:newfile *.* puts all remote files into one
local file.
<li>SET FTP SERVER-TIME-OFFSET for when server has wrong timezone set.
<li>Allow for alternative server interpretations of [M]MPUT /UNIQUE.
<li>SET FTP ANONOMOUS-PASSWORD lets you specify the default anonymous
password.
<li>Allow "GET /RECURSIVE path/file" to force local subdirectory creation.
<li>SET FTP DISPLAY is like SET TRANSFER DISPLAY but applies only to FTP.
<li>FTP <i>{</i> ENABLE, DISABLE <i>} new-protocol-feature-name</i>.
<li>FTP MGET /NODOTFILES.
<li>Debug log now records FTP commands and responses in grep-able format.
</ul>
</dl>

</dl>

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x1"><hr>1. FIXES SINCE VERSION 7.0.196</h2>

First, the changes from 7.0.196 to 7.0.197...  Source and makefile tweaks
to get successful builds on platforms that were not available in time for
the 7.0 release:
<p>
<ul>
<li>4.2BSD
<li>4.3BSD
<li>AIX 4.3
<li>AT&#38;T 3B2 and 3B20
<li>BeOS 4.5
<li>CLIX
<li>Interactive UNIX System V/386 R3.2 V4.1.1
<li>OS-9/68000
<li>OSF/1 1.3.
<li>PS/2 AIX 1.2.1
<li>SCO OSR5.0.x
<li>SCO Xenix 2.3.4
<li>SINIX 5.41/Intel
<li>Stratus FTX
<li>Stratus VOS
<li>SunOS 4.1 with X.25
<li>Ultrix 4.2
<li>Unixware 2.0
</ul>
<p>
There were no functional changes from 196 to 197.
<p>

Fixes applied after C-Kermit 7.0.197 was released:
<p>
Source code: Big flexelint and "gcc -Wall" audit and cleanup.
<p>
Configuration:
<ul>
<li>Solaris RTS/CTS (hardware flow control) didn't work.
<li>BSDI RTS/CTS worked only in one direction.
<li>FreeBSD 4.0 with ncurses 5.0 broke interactive command parsing.
<li>QNX-32 build lacked -DBIGBUFOK so couldn't execute big macros.
</ul>
<p>
Connections:
<ul>
<li>SET HOST /PTY didn't work on some platforms.
<li>Broken SET HOST /USER:xxx /PASSWORD:yyy /ACCOUNT:zzz switches fixed.
<li>Transparent printing was broken in Unix.
<li>ANSWER 0 (wait forever) didn't work.
<li>Some problems in Multitech modem command strings.
<li>Spurious "?Sorry, can't condition console terminal" errors.
<li>Disabling modem command strings by setting them to nothing broke dialing.
<li>SET DIAL TIMEOUT value was usually ignored.
<li>SET DIAL METHOD PULSE didn't work.
<li>Certain modem commands, if changed, not refreshed if modem type changed.
<li>SET SESSION-LOG command was missing from VMS.
<li>VMS session log format fixed for scripts.
<li>HANGUP by dropping DTR didn't work in NetBSD.
<li>SET FLOW /AUTO versus SET FLOW <specific-flow> confusion fixed.
<li>Spurious secondary Solaris lockfile removed.
<li>SCO OSR5 DTR On/Off hangup.
<li>UUCP lockfile race condition.

</ul>
<p>
Commands and scripts:
<ul>
<li>Missing CAUTIOUS and FAST commands restored.
<li>Broken PTY command in late-model Linuxes fixed (API changed).
<li>Fixed off-by-one error in command recall when switching direction.
<li>Fixed recall of commands that contain '?'.
<li>COPY /SWAP-BYTES didn't work on some architectures.
<li>Various combinations of COPY switches didn't work.
<li>Various problems with COPY or RENAME with a directory name as target.
<li>SHIFT didn't decrement <tt>\v(argc)</tt> if used within IF, ELSE, or
SWITCH block.
<li>SHIFT didn't affect the <tt>\%*</tt> variable.
<li>Divide by zero improperly handled in some <tt>\f<i>unction</i>()</tt>s.
<li>Problems with RETURN from right-recursive functions.
<li>FSEEK /LINE <tt>\%c</tt> LAST didn't work if already at end.
<li>Some buffer vulnerabilities and potential memory leaks
were discovered and fixed.
<li><tt>\frdirectory()</tt> fixed not to follow symbolic links.
<li>SET EXIT WARNING OFF fixed to work when EXIT given in a script.
<li>Missing DELETE and MKDIR error message fixed.
<li><tt>\fday()</tt> core dump for ancient dates fixed.
</ul>
<p>
File transfer:
<ul>
<li>SEND /COMMAND was broken.
<li>CRECEIVE was broken (but RECEIVE /COMMAND was OK).
<li>Quoting wildcard chars in filenames didn't work.
<li>Problems canceling streaming file transfers with X or Z.
<li>Problems shifting between streaming and windowing file transfer.
<li>Non-FULL file-transfer displays erroneously said STREAMING when not.
<li>An active SEND-LIST prevented GET from working.
<li>SET SERVER GET-PATH interpretation of relative names like "<tt>.</tt>" was
wrong.
<li>The MAIL command was broken.
<li>"<tt>kermit -s *</tt>" might have skipped some files.
<li>Transaction log entries were not made for external protocol transfers.
<li>File count report fixed to show number of files actually transferred.
<li>Fixed filename conversion to convert spaces to underscores.
<li>Made SET PREFIXING / SET CONTROL PREFIX also adjust CLEARCHANNEL.
<li>More "Receive window full" errors fixed.
<li>Broken terminal buffering after curses display in Solaris fixed.
<li>SET FILE INCOMPLETE DISCARD did not work in all cases.
<li>Packet log changed to reformat the start-of-packet character printably.
<li>Dynamic timeouts could grow ridiculously large.
</ul>

<p>
Character sets:
<ul>
<li>Hebrew-7 translations missed the letter Tav.
<li>C1 area of CP1252 was ignored.
<li>SET TRANSFER CHARACTER-SET TRANSPARENT could give garbage translations.
<li>TRANSLATE might not work on Little Endian architectures.
<li>Insufficient range checking in certain TRANSLATE operations.
</ul>
<p>

<a name="bugsin200">The following bugs in C-Kermit 8.0.200</a>
were fixed in 8.0.201:
<p>
<ul>
<li>An obscure path through the code could cause the Unix version
of C-Kermit to dump core during its startup sequence.  This happened
to only one person, but now it's fixed.
<p>
<li>When C-Kermit 8.0 is in Kermit server mode and the client says
"get blah", where blah (on the server) is a symlink rather than a real
file, the server unreasonably refused to send the linked-to file.
<p>
<li>When C-Kermit is an FTP client and says "get foo/bar" (i.e. a filename
that includes one or more path segments), it failed to accept the
incoming file (this happened only with GET, not MGET).
<p>
<li>Array references should be case insensitive but only lowercase array
letters were accepted.
<p>
<li>SHOW VARIABLES dumped core on <tt>\v(sexpression)</tt>
and <tt>\v(svalue)</tt>.
<p>
<li>Spurious refusals of remote directory listings if the remote server's
date was set in the past.
<p>
<li>In AIX, and maybe elsewhere too, Kermit's COPY command always failed with
"Source and destination are the same file" when the destination file didn't
exist.
<p>
<li>The VMS version of C-Kermit did not work in Batch or when SPAWN'd.
To compound the problem, it also pretty much ignored the -B and -z
command-line options, whose purpose is to work around such problems.
<p>
<li>C-Kermit 8.0 could not be built on IRIX 5.x.
<p>
<li>The C-Kermit 8.0 build for QNX6 said it was an "(unknown version)".
</ul>
<p>
Other fixes are listed in the <a href="#x0">previous section</a>.
<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x2"><hr>2. SSH AND HTTP</a></h2>

<h3><a name="x2.1">2.1. SSH Connections</a></h3>

<blockquote>
<i>

This section does not apply to
<a href="http://www.columbia.edu/kermit/k95.html">Kermit 95 2.0</a>, which has
its own built-in SSH client, which is documented
<a href="http://www.columbia.edu/kermit/sshclient.html">SEPARATELY</a>.

</i>
</blockquote>


On most UNIX platforms, C-Kermit can make SSH (Secure SHell) connection by
running the external SSH command or program through its pseudoterminal
interface.  The command is:
<p>
<dl>

<dt><tt><b>SSH</b> <i>text</i></tt></dt>

<dd>Tells Kermit to start the external SSH client, passing the given
<i>text</i> to it on the command line.  Normally the <i>text</i> is just the
hostname, but it can be anything else that is acceptable to the ssh client.
If the command succeeds, the connection is made and Kermit automatically
enters CONNECT (terminal) mode.  You can use the SSH command to make a
connection to any host that has an SSH server.

</dl>

<p>

Kermit's SSH command gives you all the features of Kermit on an SSH
connection: command language, file transfer, character-set translation,
scripting, and all the rest.  By default, C-Kermit invokes SSH with "<tt>-e
none</tt>", which disables the ssh escape character and makes the connection
transparent for purposes of file transfer.  You can, however, change the SSH
invocation to whatever else you might need (an explicit path, additional
command-line arguments, etc) with:

<p>

<dl>
<dt><tt><b>SET SSH COMMAND</b> <i>text</i></tt></dt>
<dd>Specifies the system command that Kermit's SSH command should use to
invoke the external SSH client.  Use this command to supply a specific path or
alternative name, or to include different or more command-line options.
</dl>
<p>

In most cases, these connections work quite well.  They can be scripted like
any other connection, and file transfer goes as fast as, or faster than, on
a regular Telnet connection.  In some cases, however, the underlying
pseudoterminal driver is a limiting factor, resulting in slow or failed
file transfers.  Sometimes you can work around such problems by reducing the
Kermit packet length.  Note that Kermit does not consider SSH connections to
be reliable, so it does not offer to use streaming in Kermit protocol
transfers (but you can force it with SET RELIABLE or SET STREAMING if you
wish).

<p>

The SSH command is like the TELNET command: it enters CONNECT mode
automatically when the connection is made.  Therefore, to script an SSH
connection, use:
<p>
<pre>
  set host /pty ssh -e none <i>[ other-options ] host</i>
  if fail ...
</pre>
to make the connection.
<p>

Here's a sequence that can be used to make a connection to a given host
using Telnet if the host accepts it, otherwise SSH:

<p>
<pre>
  if not defined \%1 exit 1 Usage: \%0 host
  set quiet on
  set host \%1 23 /telnet
  if fail {
      set host /pty ssh -l \m(user) -e none \%1
      if fail exit 1 \%1: Telnet and SSH both fail
      echo SSH connection to \%1 successful  
  } else {
      echo Telnet connection to \%1 successful  
  }
</pre>
<p>

In SSH v2, it is possible to make an SSH connection direct to a Kermit server 
system if the host administrator has configured the SSH server to allow this;
<a href="http://www.columbia.edu/kermit/skermit.html">CLICK HERE</a> for details.

<p>

Since Kermit uses external ssh client software, and since there are
different ssh clients (and different releases of each one), the exact command
to be used to make an SSH/Kermit connection can vary.  Here is the command
for the OpenSSH 3.0.2p1 client:

<p>
<blockquote>
<pre>
set host /pipe ssh -e none [ -l username ] -T -s hostname kermit
</pre>
</blockquote>
<p>

Example:

<p>
<blockquote>
<pre>
set host /pipe ssh -e none -l olga -T -s hq.xyzcorp.com kermit
</pre>
</blockquote>
<p>

The SSH client might or might not prompt you for a password or other
information before it makes the connection; this depends on your SSH
configuration (your public and private keys, your authorized hosts file, etc).
Here's a brief synopsis of the OpenSSH client command syntax ("man ssh" for
details):

<dl>
<dt><tt>-e none</tt></dt>
<dd>This tells the SSH client to use no escape character.  Since we will be
transferring files across the connection, we don't want the connection
to suddenly block because some character in the data.

<p>

<dt><tt>-l <i>username</i></tt></dt>
<dd>This is the username on the remote host.  You can omit the <tt>-l</tt>
option and its argument if your local and remote usernames are the same.  If
they are different, you must supply the remote username.

<p>

<dt><tt>-T</tt></dt>
<dd>This tells the SSH client to tell the SSH server not to allocate a
pseudoterminal.  We are not making a terminal connection, we don't need a
terminal, and in fact if a terminal were allocated on the remote end, the
connection would not work.

<p>

<dt><tt>-s ... kermit</tt></dt>
<dd>This tells the SSH client to tell the SSH server to start the specified
subsystem ("kermit") once the connection is made.  The subsystem name
comes after the hostname.

<p>

<dt><tt><i>hostname</i></tt></dt>
<dd>The IP host name or address of the desired host.

</dl>
<p>

You might want to include other or additional ssh command-line options; "man
ssh" explains what they are.  Here are some examples for the OpenSSH 
3.0.2p1 client:

<p>
<dl>

<dt><tt>-oClearAllForwardings yes</tt></dt>
<dt><tt>-oForwardAgent no</tt></dt>
<dt><tt>-oForwardX11 no</tt></dt>
<dt><tt>-oFallbackToRsh no </tt></dt>
<dd>These ensure that a secure connection is used and that the connection
used for file transfer is not also used for forwarding other things
that might be specified in the ssh_config file.

<p>

<dt><tt>-oProtocol 2</tt></dt>
<dd>(i.e. SSH v2) Ensures that the negotiated protocol supports subsystems.

</dl>

<p>

Once you have an SSH connection to a Kermit server, it's just like any other
connection to a Kermit server (and very similar to a connection to an FTP
server).  You give the client file transfer and management commands for the
server, and the server executes them.  Of course you can also give the client
any other commands you wish.

<p>
[ <a href="http://www.columbia.edu/kermit/skermit.html">SSH Kermit Server Subsystem</a> ]
[ <a href="sshclien.html">Kermit 95 Built-in SSH Client</a> ]

<hr>
<h3><a name="x2.2"><a name="http">2.2. HTTP Connections</a></a></h3>

Hypertext Transfer Protocol, or HTTP, is the application protocol of the World
Wide Web (WWW), used between Web browsers (clients) and Web servers.  It
allows a client to get files from websites, upload files to websites, delete
files from websites, get information about website directories and files, and
interact with server-side CGI scripts.  C-Kermit includes an HTTP client
capable of both clear-text and secure HTTP connections, that can do all these
tasks and can be automated through the Kermit scripting language.

<p>

Although C-Kermit 7.0 could make HTTP connections to Web servers, it could do
so only when no other connection was open, and the procedure was somewhat
awkward.  C-Kermit 8.0 improves matters by:

<p>
<ul>
<li>Allowing an HTTP connection to be open at the same time as a regular SET
LINE or SET HOST connection, and also at the same time as an FTP connection
(<a href="#x3">Section 3</a>);

<li>Upgrading the HTTP protocol level from 1.0 to 1.1, thus allowing for
persistent connections, in which a series of commands can be sent on the same
connection, rather than only one as in HTTP 1.0 (and C-Kermit 7.0);

<li>Providing for "one-shot" URL-driven HTTP operations such as GET or PUT.

<li>Providing a distinct HTTP command-line personality.
</ul>
<p>
<b>Persistent HTTP connections</b> are managed with the following commands:
<p>
<dl>
<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>OPEN</b> 
<i>[ security-options ] host-or-url [ port ]
</i></tt></dt>

<dd>Opens a persistent connection to the specified host (IP host name or
address) on the specified port.  If any switches (options, listed in the next
section) are included, their values are saved and used for all subsequent HTTP
action commands on the same connection.  If no port is specified, HTTP (80) is
used.  A Uniform Resource Locator
(URL, <a href="ftp://ftp.isi.edu/in-notes/rfc1738.txt">RFC 1738</a>) can be
given instead of a hostname (or address) and port (but the URL can not include
a directory/file path).  The security options are explained
<a href="#x2.2.2">below</a>.  The HTTP OPEN command replaces the C-Kermit 7.0
<tt>SET HOST <i>hostname</i> HTTP</tt> command, which no longer works with
<tt>HTTP</tt> <tt>GET</tt> and related commands.
 
<p>

<dt><tt><b>HTTP CLOSE</b></tt></dt>
<dd>Closes any open HTTP connection and clears any saved switch values.

</dl>

<p>

A <b>URL</b> starts with a protocol name, which must be
<tt>http</tt> or <tt>https</tt> in this case; optionally
includes a username and password; and must contain a host name or address:
<p>
<pre>
  <i>protocol</i>://<i>[user[.password</i>]]@<i>host[:port][URI]</i>
</pre>
<p>

HTTP is Hypertext Transfer Protocol.  HTTPS is the secure (SSL/TLS) version of
HTTP.  The TCP service port is derived from the protocol prefix (so normally
the "<tt><i>:port</i></tt>" field is omitted).  Thus the URL protocol name
specifies a default TCP service port and the URL <i>user</i> and
<i>password</i> fields can take the place of the <tt>/USER</tt> and
<tt>/PASSWORD</tt> switches (<a href="#x2.2.1">Section 2.2.1</a>).  The
optional URI is a "compact string of characters for identifying an abstract or
physical resource" (<a href="ftp://ftp.isi.edu/in-notes/rfc2396.txt">RFC
2396</a>), such as a file.  It must begin with a slash (<tt>/</tt>); if the
URI is omitted, "<tt>/</tt>" is supplied.
Examples:

<p>
<dl>
<dt><tt>http open http://www.columbia.edu/</tt></dt>
<dd>Equivalent to <tt>http</tt> <tt>open</tt> <tt>www.columbia.edu </tt>
or <tt> http</tt> <tt>open</tt> <tt>www.columbia.edu</tt> <tt>http</tt>.
<p>
<dt><tt>http open https://olga.secret@www1.xyzcorp.com/</tt></dt>
<dd>Equivalent to
<tt>http</tt> <tt>/user:olga</tt> <tt>/pass:secret</tt> <tt>open</tt> <tt>www1.xyzcorp.com https</tt>.
</pre>
</dl>
<p>

<b>Persistence is accomplished unilaterally by C-Kermit 8.0.</b>
An HTTP 1.0 server closes the connection after each action.  Although HTTP 1.1
allows multiple actions on the same connection, an HTTP 1.1 server tends to
close the connection if it is idle for more than a few seconds, to defend
itself against denial-of-service attacks.  But when you use Kermit's HTTP OPEN
command to create a connection, Kermit reopens it automatically (if necessary)
for each HTTP action until you close it with HTTP CLOSE, regardless of the
server's HTTP protocol version, or how many times it closes the connection.

<p>

<b>Firewalls</b> can be negotiated through proxies with the following commands:

<dl>

<dt><tt><b>SET TCP HTTP-PROXY</b> <i>[ host[:port] ]</i></tt></dt>

<dd>If a host (by hostname or IP address) is specified, Kermit uses it as a
proxy server when attempting outgoing TCP connections -- not only HTTP
connections, but all TCP/IP connections, Telnet and FTP included.  This allows
Kermit to adapt to the HTTP firewall penetration method (as opposed to other
methods such as SOCKS4).  If no hostname or ip-address is specified, any
previously specified Proxy server is removed.  If no port number is specified,
the "http" service is used.  This command must be given <i>before</i> the HTTP
OPEN command if a proxy is to be used or canceled.

<p>

<dt><tt><b>HTTP</b> <i>[ switches ]</i>
<b>CONNECT</b> <i>host[:port]</i></tt></dt>

<dd>Instructs the HTTP server to act as a proxy, establishing a connection to
the specified host (IP hostname or address) on the given port (80 = HTTP by
default) and to redirect all data transmitted between Kermit and itself to the
given host for the life of the connection.  This command is to be used only
for debugging HTTP proxy connections.  If a proxy connection is required,
instruct Kermit to use the proxy with the <tt>SET</tt> <tt>TCP</tt>
<tt>HTTP-PROXY</tt> command.

</dl>


<h4><a name="x2.2.1">2.2.1. HTTP Command Switches</a></h4>

HTTP switches, like all other switches, are optional.  When HTTP switches are
included with the HTTP OPEN command, they apply automatically to this and all
subsequent HTTP actions (GET, PUT, ...) on the same connection until an HTTP
CLOSE command is given.  So if you include switches (or the equivalent URL
fields, such as <i>user</i> and <i>password</i>) in the HTTP OPEN command, you
can omit them from subsequent commands on the same connection.  If the
connection has closed since your last command, it is automatically reopened
with the same options.

<p>

If you include switches with an HTTP action command (such as GET or PUT), they
apply only to that command.

<p>
<dl>
<dt><tt><b>/USER:</b><i>name</i></tt></dt>

<dd>To be used in case a page requires a username for access.  The username is
sent with page requests.  If it is given with the OPEN command it is saved
until needed.  If a username is included in a URL, it overrides the username
given in the switch.  CAUTION: Username and password (and all other
information, including credit card numbers and other material that you might
prefer to protect from public view) are sent across the network in clear text
on regular HTTP connections, but authentication is performed securely on HTTPS
connections.

<p>
<dt><tt><b>/PASSWORD:</b><i>text</i></tt></dt>
<dd>To be used in case a web page requires a password for access.  The
password is sent with page requests.  If it is given with the OPEN command it
is saved until needed.  If a password is given in a URL, it overrides the one
given here.  CAUTION: (same as for <tt>/USER:</tt>).

<p>
<dt><tt><b>/AGENT:</b><i>user-agent</i></tt></dt>
<dd>Identifies the client to the server.  Overrides the default agent string,
which is "C-Kermit" (for C-Kermit) or "Kermit-95" (for Kermit 95).
<p>
<dt><tt><b>/ARRAY:</b><i>array-designator</i></tt></dt>
<dd>Tells Kermit to store the response headers in the given array, one line
per element.  The array need not be declared in advance.  Example:
<tt>/array:&a</tt>.
<p>
<dt><tt><b>/TOSCREEN</b></tt></dt>
<dd>Tells Kermit to display any response text on the screen.  It applies
independently of the output file specification; thus it is possible to have
the server response go to the screen, a file, both, or neither.
<p>
<dt><tt><b>/HEADER:</b><i>header-item(s)</i></tt></dt>
<dd>Used for specifying any optional headers to be sent with HTTP requests.
<p>
<pre>
  /HEADER:<i>tag</i>:<i>value</i>
</pre>
<p>
To send more than one header, use braces for grouping:
<p>
<pre>
  /HEADER:{{<i>tag</i>:<i>value</i>}{<i>tag</i>:<i>value</i>}...}
</pre>
<p>
For a list of valid tags and value formats see
<a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">RFC 2616</a>,
"Hypertext Transfer Protocol -- HTTP/1.1".  A maximum of eight headers
may be specified.
</dl>
<p>

<h4><a name="x2.2.2">2.2.2. HTTP Action Commands</a></h4>

HTTP actions can occur within a persistent connection, or they can be
self-contained ("connectionless").  A <b>persistent HTTP connection</b>
begins with an HTTP OPEN command, followed by zero or more HTTP action
commands, and is terminated with an HTTP CLOSE command:

<p>
<pre>
  http open www.columbia.edu
  if failure stop 1 HTTP OPEN failed: \v(http_message)
  http get kermit/index.html
  if failure stop 1 HTTP GET failed: \v(http_message)
  <i>(more actions possible here...)</i>
  http close
</pre>
<p>

A <b>self-contained HTTP action</b> occurs when a URL is given instead of a
remote file name to an HTTP action command.  In this case, Kermit makes the
HTTP connection, takes the action, and then closes the connection.  If an HTTP
connection was already open, it is closed silently and automatically.

<p>
<pre>
  http get http://www.columbia.edu/kermit/index.html
</pre>
<p>

Kermit's HTTP action commands are as follows.  Switches may be included with
any of these to override switch (or default) values given in the HTTP OPEN
command.

<p>

<dl>

<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>GET</b> <i>remote-filename [ local-filename ]</i></tt></dt>

<dd>Retrieves the named file from the server specified in the most recent HTTP
OPEN command for which a corresponding HTTP CLOSE command has not been given.
The filename may not include wildcards (HTTP protocol does not support them).
If no HTTP OPEN command is in effect, this form of the HTTP GET command fails.
The default local filename is the same as the remote name, but with any
pathname stripped.  For example, the command <tt>http</tt> <tt>get</tt>
<tt>kermit/index.html</tt> stores the file in the current local directory as
<tt>index.html</tt>.  If the <tt>/HEADERS:</tt> switch is included,
information about the file is also stored in the specified array (explained in
<a href="#x2.2.3">Section 2.2.3</a>).  All files are transferred in binary
mode.  HTTP does not provide for record-format or character-set conversion.

<p>

<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>GET</b> <i>url [ local-filename ]</i></tt></dt>

<dd>When HTTP GET is given a URL rather than a filename, Kermit opens a
connection to the designated server (closing any previously open HTTP
connection), gets the file, and then closes the connection.  If the URL does
not include a filename, <tt>index.html</tt> is supplied.  This is the
self-contained one-step "connectionless" method for getting a file from a Web
server.  The data is not interpreted; HTTP GET is like "lynx -source"
rather than "lynx -dump".

</dl>
<p>

In the remaining HTTP action commands, the distinction between a remote
filename and a URL are the same as in the HTTP GET command.

<p>
<dl>
<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>HEAD</b> <i>remote-filename-or-url
[ local-filename ]</i></tt></dt>

<dd>Like GET except without actually getting the file; instead it retrieves
only the headers.  If the <tt>/ARRAY:</tt> or <tt>/TOSCREEN</tt> switch is
included, there is no default local output filename but you can still specify
one.  If neither of these switches is included, the default local filename is
the same as the remote filename, but with any path stripped and with
"<tt>.head</tt>" appended.  The HEAD command can be used in a script with the
<b>/ARRAY:</b> switch to retrieve information about the requested resource to
determine whether the resource should actually be retrieved with a subsequent
GET request.
<p>

<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>INDEX</b> <i>remote-directory-or-url
 [ local-filename ]</i></tt></dt>

<dd>Asks the server to send a listing of the files in the given server
directory.  This command is not supported by most Web servers.  Even when it
is supported, there is no standard format for the listing.

<p>

<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>POST</b> <i>[</i>
<b>/MIME-TYPE:</b><i>type ] source-file remote-path-or-url
[ result-file ]</i></tt></dt>

<dd>

Sends data to a process running on the remote host; the result is usually
an HTML file but could be anything.
The data to be
posted must be read from a local file (the <i>source-file</i>).  If a result
file is specified, Kermit stores the server's response in it.

<p>

<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>PUT</b> <i>[</i>
<b>MIME-TYPE:</b><i>type ] local-file [ remote-file-or-url
[ result-file ] ]</i></tt></dt>

<dd>Uploads a local file to the server.  Only the name of a single file can be
given; wildcards (and group transfers) are not supported by HTTP protocol.  If
no remote filename is given, the file is sent with the same name as the local
file, but with any pathname stripped.

<p>
<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>DELETE</b> <i>remote-file-or-url</i>
[ local-result-file ]</i></tt></dt>
<dd>Asks the server to delete the specified single file.  If a result file is
specified, it will contain any response data returned by the server.

</dl>

<p>

Note the limitations of HTTP protocol compared to (say) FTP or Kermit.  There
is no command for changing directories, no standard way to get file or
directory lists, no way to transfer file groups by using wildcard notation,
etc, and therefore no good way to (say) fetch all pages, descend through
subdirectories, perform automatic updates, etc.  There is no assurrance a
connection will stay open and, as noted, there is no provision for data
conversion between unlike platforms.  The data's MIME
headers can be used for postprocessing.

<h4><a name="x2.2.3">2.2.3. HTTP Headers</a></h4>

Each HTTP request and response contains a set of name/value pairs called
headers.  HTTP headers are specified in
<a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">RFC 2616</a>.
For example, an HTTP GET request for <tt>/index.html</tt> on
<tt>www.columbia.edu</tt> contains the following headers:
<p>
<pre>
  GET /index.html HTTP/1.1
  Host: www.columbia.edu:80
  User-agent: C-Kermit 8.0
  Authorization: Basic <i>base64-encoded-username-password</i>
</pre>
<p>
These might be followed by any others specified with a /HEADERS: switch:
<p>
<pre>
  Accept: image/gif, image/x-xbitmap, image/jpeg, *.*
  Accept-Encoding: gzip
  Accept-Language: en
  Accept-Charset: iso-8859-1,utf-8
  Cookie: <i>cookie-data</i>
</pre>  

<p>

The server sends back a short report about the file prior to sending the file
contents.  Example:
<p>
<pre>
  HTTP/1.1 200 OK
  Date: Fri, 24 Aug 2001 21:09:39 GMT
  Server: Apache/1.3.4 (Unix)
  Last-Modified: Mon, 06 Aug 2001 21:16:13 GMT
  ETag: "1fa137-10d7-3b6f091d"
  Accept-Ranges: bytes
  Content-Length: 4311
  Content-Type: text/html
</pre>
<p>

If you want to have this information available to a Kermit script you can use
the <tt>/ARRAY</tt> switch to have Kermit put it in array, one line per array
element.  Example:

<p>
<pre>
  set exit warning off
  http open www.columbia.edu
  if fail exit 1 Can't reach server
  http /array:&a get /index.html
  if fail exit 1 Can't get file
  echo Header lines: \fdim(&a)
  for \%i 1 \fdim(&a) 1 {
      echo \%i. \&a[\%i]
  }
</pre>
<p>

Note that the "<tt>Date:</tt>" item is the current date and time; the
"<tt>Last-Modifed:</tt>" item is the file's modification date and time.  An
example showing how to use this information is presented in
<a href="#x8.13.7">Section 8.13.7</a>.

<h4><a name="x2.2.4">2.2.4. Secure HTTP Connections</a></h4>

SSL/TLS (Secure Sockets Layer / Transport Layer Security) is the 
protocol used to secure HTTP, SMTP, and other Internet applications.
See the <a href="security.html#x3.1.4">C-Kermit
Reference Section 3.1.4</a> for an introduction to SSL/TLS.

To make a secure HTTP connection, you need:

<p>
<ol>
<li>A secure client (a version of C-Kermit or Kermit 95 with SSL/TLS security
built in).  Type "check ssl" at the Kermit prompt to make sure you have it.
<li>A secure server to connect to.
<li>The CA Root Certificate used to authenticate the server to the client.
(see <a href="security.html#xa3">Appendix III</a> of the security reference
for an introduction to certificates).

</ol>
<p>

And you must make a connection to the secure HTTP port: service name HTTPS,
port number 443 (as opposed to service HTTP, port 80).  You can also make
secure connections to other ports by including the <tt>/TLS</tt> or
<tt>/SSL</tt> switch with the HTTP OPEN command, if the host supports SSL/TLS
on the given port:

<p>

The quality of the SSL/TLS connection depends on the cipher suite.
There are several possibilities:

<p>
<dl>
<dt><i>Anonymous cipher suite:</i></dt>
<dd>If an anonymous cipher suite is negotiated, the connection is 
encrypted but there is no authentication.  This connection is
subject to a Man-In-The-Middle (MITM) attack.
<p>
<dt><i>X.509 certificate on the server:</i></dt>
<dd>When you connect to certain secure servers, an X.509 certificate is
returned.  This certificate is issued to a special hostname, something like
<tt>www1.xyzcorp.com</tt> or <tt>wwws.xyzcorp.com</tt> (rather than the normal
<tt>www.xyzcorp.com</tt>).  It is signed by the host's Certificate Authority
(CA).  If the host certificate is configured on the client, it can be used to
verify the certificate received from the server.  If the certificate it
verified as authentic, a check is made to ensure it has not expired and it was
issued to the host you were attempting to connect to.  If you had asked to
connect to (say) <tt>www.xyzcorp.com</tt> but were given a certificate for
<tt>www1.xyzcorp.com</tt>, you would be prompted for permission to continue.

<p>

If the verification succeeded, the connection would be encrypted
with one-way (server-to-client) authentication.  This connection
is not subject to a MITM attack.

<p>

If a username and password are transmitted over this connection, they are not
subject to interception.  However, the standard risks associated with passing
the password to the host for verification apply; for example, if the host has
been compromised, the password will be compromised.

<p>
<dt><i>X.509 client certificate:</i></dt>

<dd>If a connection has been established with an X.509 server certificate, the
server can ask the client to send a certificate of its own.  This certificate
must be verified against a CA Root certificate.  The certificate itself (or
subject info from the certificate) is used to determine the authorization for
the client, and if successful, the username and password need not be sent to
the server.

<p>
<dt><i>Kerberos 5:</i></dt>
<dd>Instead of using X.509 certifcates, Kerberos 5 can be used to perform the
authentication and key exchange.  In this situation, there is mutual
authentication between the client and server.  The Kerberos 5 principal is
used by the server to look up the appropriate authorization data.  There is no
need to send username and password.

</dl>

<p>

An HTTP connection is made with the HTTP OPEN command:

<p>
<dl>
<dt><tt><b>HTTP</b> <i>[ switches ]</i> <b>OPEN</b> 
<i>[ {</i> <b>/SSL</b>, <b>/TLS</b> <i>} ] host [ port ]
</i></tt></dt>

<dd>If <tt>/SSL</tt> or <tt>/TLS</tt> switches are included (these are
synonyms), or if the service is HTTPS or the port is 443, a secure connection
is attempted using the current authentication settings; see HELP SET
AUTHENTICATION for details (<a href="security.html#x3.2.2">Section 3.2.2</a> of
the security reference).  If the no
<tt>/SSL</tt> or <tt>/TLS</tt> switch is included but the port is 443 or the
service is HTTPS, a secure connection is attempted.  If an <tt>/SSL</tt> or
<tt>/TLS</tt> switch is included but a port is not specified, an SSL/TLS
connection is attempted on the default port (80).

</dl>

<p>

Certificates are covered in the separate 
<a href="http://www.columbia.edu/kermit/security.html">Kermit Security
Reference</a> for C-Kermit 8.0.  You should let Kermit know to
verify certificates with the SET AUTHENTICATION TLS command.  For example:

<p>

<dl>

<dt><tt><b>SET AUTHENTICATION TLS CRL-DIR</b> <i>directory</i></tt></dt>
<dd>Specifies a directory that contains certificate revocation files where
each file is named by the hash of the certificate that has been revoked.

<p>

<dt><tt><b>SET AUTHENTICATION TLS CRL-FILE</b> <i>filename</i></tt></dt>
<dd>Specifies a file that contains a list of certificate revocations.

<p>

<dt><tt><b>SET AUTHENTICATION TLS VERIFY-DIR</b> <i>directory</i></tt></dt>
<dd>Specifies a directory that contains root CA certificate files used to
verify the certificate chains presented by the peer.  Each file is named
by a hash of the certificate.

<p>

<dt><tt><b>SET AUTHENTICATION TLS VERIFY-FILE</b> <i>filename</i></tt></dt>
<dd>Specifies a file that contains root CA certificates to be used for
verifying certificate chains.
<p>


<dt><tt><b>SET AUTHENTICATION TLS VERIFY OFF</b></tt></dt>
<dd>Tells Kermit not to require a certificate and accept any certificate
that is presented regardless of whether it is valid.
</dl>
<p>
There are many other options; see the security document for details.

<p>

Now suppose you need need to fetch the file denoted by the following URL:
<p>
<pre>
  https://myuserid:mypassword@wwws.xyzcorp.com/clients/info/secret.html
</pre>
<p>
Once you have set up the handling of certificates as desired, you can
use the following Kermit commands:
<p>
<pre>
  http /user:<i>myuserid</i> /password:<i>mypassword</i> open www1.xyzcorp.com https
  if success {
      http get /clients/info/secret.html
      http close
  }
</pre>

As another example, let's say that you have a web form you need to
populate with three fields: red,white and blue.  
<p>
<pre>
  &#60FORM ACTION="http://www.xyzcorp.com/cgi-bin/form.cgi" METHOD="POST"&#62
  &#60INPUT NAME="Red"&#62
  &#60INPUT NAME="White"&#62
  &#60INPUT NAME="Blue"&#62
  &#60/FORM&#62
</pre>
<p>
You can handle this with the HTTP POST command.  The data to be posted
is stored in the local file <i>data.txt</i>.
<p>
<pre>
  Red=seven stripes&White=six stripes&Blue=fifty stars<CR><LF>
</pre><p>
and the response from the server
will be stored into <i>response.txt</i>.
<p>
<pre>
  http open www.xyzcorp.com http
  if success {
    http /array:c post data.txt /cgi-bin/form.cgi response.txt
    http close
  }
</pre>

In this scenario, the Common Gateway Interface (CGI) sends a
response whether it succeeds or fails in a script-dependent manner.  The
script can either report success and enclose the response data; or it might
send a 302 Found error which indicates that the "Location:" header should be
used to determine the URL at which the data can be found.

<h4><a name="x2.2.5">2.2.5. HTTP Variables</a></h4>

<dl>
<dt><tt><b>\v(http_code)</b></tt></dt>
<dd>The HTTP protocol code number of the most recent server reply,
e.g. 404 for "not found".
<p>
<dt><tt><b>\v(http_connected)</b></tt></dt>
<dd>1 when an HTTP connection is open, 0 when there is no HTTP connection.
<p>
<dt><tt><b>\v(http_host)</b></tt></dt>
<dd>If an HTTP connection is open, the <tt><i>hostname:port</i></tt>, e.g.
<tt>www.columbia.edu:80</tt>; otherwise, empty.
<p>
<dt><tt><b>\v(http_message)</b></tt></dt>
<dd>Server error message, if any, from most recent HTTP command.
<p>
<dt><tt><b>\v(http_security)</b></tt></dt>
<dd>A list of the security parameters and values for the current connection,
if any.  Empty if the connection is not to a secure server, or there is no
connection.
</dl>
<p>
To display all the HTTP variables at once, type SHOW VAR HTTP:
<p>
<pre>
  C-Kermit&#62; <u>http open www.columbia.edu</u>
  C-Kermit&#62; <u>http get lkjlkjlkjlkj </u>
  C-Kermit&#62; <u>sho var http</u>
   \v(http_code) = 404
   \v(http_connected) = 1
   \v(http_host) = www.columbia.edu:80
   \v(http_message) = Not Found
   \v(http_security) = NULL
  C-Kermit&#62;
</pre>


<h4><a name="x2.2.6">2.2.6. The HTTP Command-Line Personality</a></h4>

If you invoke C-Kermit with the name "http" or "https", you can use a special
set of HTTP-specific command-line options.  You can do this by creating a
symbolic linke "http" or "https" to the C-Kermit 8.0 executable, or by having
a separate copy of it called "http" or "https".  Here's the usage message
("<tt>http</tt> <tt>-h</tt>"):

<p>
<pre>
  Usage: ./http host [ options... ]
   -h             This message.
   -d             Debug to debug.log.
   -S             Stay (issue command prompt when done).
   -Y             Do not execute Kermit initialization file.
   -q             Quiet (suppress most messages).
   -u name        Username.
   -P password    Password.
   -g pathname    Get remote pathname.
   -p pathname    Put remote pathname.
   -H pathname    Head remote pathname.
   -l pathname    Local path for -g, -p, and -H.
   -z opt[=value] Security options...
      cert=file   Client certificate file
      certsok     Accept all certificates
      key=file    Client private key file
      secure      Use SSL
      verify=n    0 = none, 1 = peer , 2 = certificate required
</pre>
<p>

The "host" argument is the name of a Web host, e.g.
www<tt>.</tt>columbia<tt>.</tt>edu.  The action options are <tt>-p</tt>,
<tt>-g</tt>, and <tt>-H</tt>.  If you give an action option, Kermit does
the action and then exits.  If you give a host without an action option,
Kermit makes an HTTP connection to the host and then gives you the C-Kermit
prompt.  Here's a simple example that fetches a publicly readable Web page:

<p>
<pre>
  http www.columbia.edu -g kermit/index.html
</pre>
<p>

If you need to access a website for which a username and password are
required, you can supply them on the command line with <tt>-u</tt> and
<tt>-P</tt>.  If you include a username but omit the password, Kermit
prompts you for it:

<p>
<pre>
  http www.columbia.edu -u olga -p kermit/index.html -l index.html
  Password:
</pre>
<p>

Note that when PUT'ing files to websites, you have to supply both the
<tt>-p</tt> (remote pathname) and <tt>-l</tt> (local path) options.

<p>

If your version of Kermit is built with SSL/TLS
security, you can also use the <tt>-z</tt> option to make secure HTTP
(https) connections.

<p>

Finally, as noted in <a href="#x16">Section 16</a>, you can also give a URL
instead of a host name and options.


<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]

<a name="ftp"></a>
<h2><a name="x3" ><hr>3. THE BUILT-IN FTP CLIENT</a></h2>

<blockquote>
3.1.<tt>&nbsp;&nbsp;</tt><a href="#x3.1">Making and Managing FTP Connections</a><br>
3.2.<tt>&nbsp;&nbsp;</tt><a href="#x3.2">Making Secure FTP Connections</a><br>
3.3.<tt>&nbsp;&nbsp;</tt><a href="#x3.3">Setting FTP Preferences</a><br>
3.4.<tt>&nbsp;&nbsp;</tt><a href="#x3.4">Managing Directories and Files</a><br>
3.5.<tt>&nbsp;&nbsp;</tt><a href="#x3.5">Uploading Files With FTP</a><br>
3.6.<tt>&nbsp;&nbsp;</tt><a href="#x3.6">Downloading Files With FTP</a><br>
3.7.<tt>&nbsp;&nbsp;</tt><a href="#x3.7">Translating Character Sets</a><br>
3.8.<tt>&nbsp;&nbsp;</tt><a href="#x3.8">FTP Command Shortcuts</a><br>
3.9.<tt>&nbsp;&nbsp;</tt><a href="#x3.9">Dual Sessions</a><br>
3.10.<tt>&nbsp;</tt><a href="#x3.10">Automating FTP Sessions</a><br>
<font color="red">3.11.</font><tt>&nbsp;</tt><a href="#x3.11"><font color="red">Advanced FTP Protocol Features</font></a><br>
</blockquote>
<p>

Earlier versions of C-Kermit and K95 included an FTP command, but it simply
invoked an external FTP client.  Now, by popular demand, Kermit includes its
own built-in FTP client that offers the following advantages over traditional
FTP clients (and its previous interface to them):

<p>
<ul>

<li>Any of Kermit's built-in <a href="security.html">security methods</a> can
be used to establish and conduct secure FTP sessions with <a
href="security.html#servers">FTP servers that support these methods</a>.
(Security modules can be subject to export restrictions.)

<p>

<li>Kermit's FTP client uses "passive mode" by default to avoid blockage
by firewalls and network address translators.
<font color="red">Of course active mode can be chosen too when needed.</font>

<p>

<li><a href="http://www.columbia.edu/kermit/ckcsets.html">Character sets</a>
can be translated as part of the transfer process even when the FTP server
does not support character-set translation, including to/from the new Internet
standard international character set, <a
href="http://www.columbia.edu/kermit/unicode.html">Unicode</a> UTF-8.  This
includes both the file's name and (for text files only) its contents.

<p>

<li>All of C-Kermit's <a href="ckermi70.html#x1.5.4">
file-selection mechanisms</a> are available: size, date,
name patterns and lists, exception lists, etc.

<p>

<li><a href="http://www.columbia.edu/kermit/case10.html">Atomic file
movement</a> capabilities are provided (delete, move, or rename files
automatically after successful transfer).

<p>

<li>The correct file type, "ascii" (i.e. text) or binary,
is chosen automatically for each file (explained in <a href="#x4">Section
4</a>), and any mixture of text and binary files can be sent in a single
operation, even across platforms.

<p>

<li>Update mode ("don't bother transferring files that didn't change since
last time") and recovery (resumption of an interrupted transfer from the
point of failure) are available in both directions.

<p>

<li>When uploading files from UNIX to UNIX, the file's permissions can be
preserved if desired.

<p>

<li>Recursive directory-tree PUTs are supported between any two platforms
that have tree-structured file systems.  Recursive GETs are supported
between like platforms if the server cooperates
<font color="red">and between like or unlike platforms if the server supports
MLSD (<a href="#x3.11">Section 3.11</a>).</font>

<p>

<li>When receiving files, all of Kermit's file collision actions are
available: backup, update, refuse, rename, etc.

<p>

<li>Multi-file transfers can be interrupted on a per-file basis, automatically
skipping to the next file.

<p>

<li>FTP sessions are <a
href="http://www.columbia.edu/kermit/ftpscripts.html">fully scriptable</a>.

<p>

<li>An entire FTP session (connect, login, CD, upload or download, logout)
can be specified on the command line without using a script.

<p>

<li>All of Kermit's logging options and formats are available to keep an
accurate and complete record of each connection and file transfer, and
to aid in troubleshooting.

<p>

<li>All of Kermit's file-transfer display options are available (fullscreen,
brief, CRT, serial, none).

</ul>
<p>

And best of all:

<ul>

<li>Kermit doesn't give you those annoying per-file prompts every time you
start a multi-file transfer without remembering to give a "prompt"
command first <tt>:-)</tt>.

</ul>
<p>

[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ftpclient.html"><b>FTP Client Overview</b></a> ]
[ <a href="http://www.columbia.edu/kermit/ftpscripts.html"><b>FTP Script Tutorial</b></a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.1">3.1. Making and Managing FTP Connections</a></h3>

Each copy of Kermit can have one FTP connection open at a time.  FTP
connections are independent of regular terminal connections; a terminal
connection (serial or network via SET LINE, DIAL, SET HOST, TELNET, etc) may
be, but need not be, open at the same time as an FTP connection, and terminal
connections can also be closed, and new connections opened, without
interfering with the FTP connection (and vice versa).  Thus, for example,
Kermit can have an FTP connection and a TELNET connection open to the same
host simultaneously, using the TELNET connection (e.g.) to send mail or take
other desired actions as various FTP actions complete.  Of course, each copy
of Kermit can do only one thing at a time, so it can't (for example) transfer
a file with FTP and another file with Kermit protocol simultaneously.

<p>
A Kermit FTP session can be established by
<a href="#x3.1.1">command-line options</a>, by
<a href="#x3.1.3">URL</a>, or by
<a href="#x3.1.4">interactive commands</a>.

<h4><a name="x3.1.1">3.1.1. Kermit Command-Line Options for FTP</a></h4>

The new command-line option '<tt>-9</tt>' (sorry, we're out of letters) can be
used when starting C-Kermit, telling it to make an FTP connection:
<p><pre>
  kermit -9 hostname
</pre><p>
or if a non-default FTP port is needed:
<p><pre>
  kermit -9 hostname:port
</pre><p>
You can also specify the username on the command line with the <tt>-M</tt>
("My User ID") option that was already there for other connection types:
<p><pre>
  kermit -9 hostname -M olga
</pre><p>
If you specify the username on the command line, Kermit uses it when making
the connection and does not prompt you for it (but it does prompt you for
the password if one is required).
<p>
Once the connection is made, you get the regular Kermit prompt, and can give
interactive commands such as the ones described below.  When you give a BYE
command, Kermit closes the session and exits, just as a regular FTP client
would do.  If you don't want Kermit to exit when you give a BYE command,
include the <tt>-S</tt> ("Stay") option on the command line.
<p>
Other Kermit command-line options that are not specific to non-FTP connections
should affect the FTP session in the expected ways; for example, <tt>-i</tt>
and <tt>-T</tt> force binary and text mode transfers, respectively.
<p>
File transfers can not be initiated on the "<tt>kermit</tt> <tt>-9</tt>"
command line; for that you need to use Kermit's FTP personality (next section)
or you can use URLs (<a href="#x3.1.3">Section 3.1.3</a>).

<p>
<hr>
<h4><a name="x3.1.2">3.1.2. The FTP Command-Line Personality</a></h4>

If you want to replace your regular FTP client with C-Kermit, you can make
a link called "ftp" to the C-Kermit binary (or you can store a copy of the
C-Kermit binary under the name "ftp").  When C-Kermit is invoked with a
program name of "ftp" (or "FTP", case doesn't matter), it assumes the
command-line personality of the regular FTP client:
<p><pre>
  ftp <i>[ options ] hostname [ port ]</i>
</pre>
<p>
In this case the options are like those of a regular FTP client:
<p><pre>
  -d  Debug: enables debug messages and creates a debug.log file.
  -n  No autologin: Kermit should not send your user ID automatically.
  -t  Packet trace: accepted but is treated the same as -d.
  -v  Verbose: accepted but ignored (operation is verbose by default).
  -i  Not interactive: accepted but ignored.
</pre><p>
and the hostname can also be a URL (explained in
<a href="#x3.1.3">Section 3.1.3</a>).  To specify a
non-default TCP port for the FTP server, include the port number or name after
the hostname.
<p>

There are also some bonus options that allow you to execute an entire FTP
session from the shell command line, as long as you don't include the
<tt>-n</tt> option.  These are not available with regular FTP clients, and at
least one of these options (<tt>-g</tt>) conflicts with UNIX ftp (where
<tt>-g</tt> means "no globbing", which does not apply to Kermit), and some of
them (like the options above) also conflict with regular Kermit command-line
options:
<p>
<pre>
  -m mode      = "passive" (default) or "active"
  -Y            Don't execute the Kermit initialization file [1]
  -q            Quiet, suppresses all but error messages [1]
  -S            Stay, don't exit automatically [1]
  -A            Autologin anonymously [2]
  -u name       Username for autologin [2] (synonym: -M [1])
  -P password   Password for autologin (see cautions below) [2]
  -D directory  cd after autologin [2]
  -b            Binary mode [2]
  -a            Text ("ascii") mode [2] (synonym: -T [1])
  -R            Recursive (works with -p) [4]
  -p files      Files to put (upload) after autologin [2] (synonym: -s [1])
  -g files      Files to get (download) after autologin [3]
</pre><p>
<tt>[1] </tt>Same as Kermit, not available in regular FTP clients.<br>
<tt>[2] </tt>Conflicts with Kermit, not available in regular FTP clients.<br>
<tt>[3] </tt>Same as Kermit, conflicts with regular FTP clients.<br>
<tt>[4] </tt>Conflicts with Kermit, available in some FTP clients.
<p>
Fancier options such as restart, character-set translation, filename collision
selection, automatic move/rename/delete, etc, are not available from the
command line; for these you can use the commands described in the following
sections.  The <tt>-R</tt> option might also work with <tt>-g</tt> (GET) but
that depends on the server.
<p>
The following security options are also available, explained in
<a href="#x3.2">Section 3.2</a>:
<p><pre>
  -k realm      Kerberos 4 realm [4]
  -f            Kerberos 5 credentials forwarding [4]
  -x            autoencryption mode [4]
  -c cipher     SRP cipher type [4]
  -H hash       SRP encryption hash [4]
  -z option     Security options [4]
</pre>
<p>

If you include <tt>-A</tt> or specify a name of "anonymous" or "ftp", you are
logged in anonymously and, in the absence of <tt>-P</tt>, Kermit automatically
supplies a password of "<i>user</i><tt>@</tt><i>host</i>", where "user" is
your local user ID, and "host" is the hostname of the computer where Kermit is
running.  If you do not include <tt>-p</tt> or <tt>-g</tt>, Kermit enters
command mode so you can type commands or execute them from a script.

<p>

If you include <tt>-p</tt> or <tt>-g</tt>, Kermit attempts to transfer the
specified files and then exits automatically at the end of the transfer unless
you also included <tt>-S</tt> (Stay).  It uses the "brief" file transfer
display (one line per file) unless you include the <tt>-q</tt> option to
suppress it.

<p>

When uploading files with <tt>-p</tt>, Kermit switches automatically between
text and binary mode for each file.

<p>

When downloading, you can either specify a particular mode (text or binary) to
be used for all the files, or you can let Kermit select the type for each file
automatically, based on its name (see <a href="#x3.5">Sections 3.5</a> and <a
href="#x3.6">3.6</a> for greater detail).  In UNIX be sure to quote any
wildcard characters to prevent the shell from expanding them, as shown in the
examples just below.  Filename collisions are handled according Kermit's FILE
COLLISION setting (if specified in your Kermit customization file; otherwise
the default, which is BACKUP).

<p>

<i><big>I</big>t should go without saying</i> that the <b><tt>-P</tt> option
should be used with caution.</b>  In addition to the well-known risks of
transmitting plaintext passwords over the Internet, in this case the password
also echos to the screen if you type it, and can be seen in <tt>ps</tt> and
<tt>w</tt> listings that show the user's currently active command and
command-line arguments.  Thus command-line FTP sessions are most appropriate
for secure or anonymous connections (those that do not require passwords).


<p>
Here's an example in which you download the latest C-Kermit "tarball" from
the Columbia University FTP archive:
<p><pre>
  ftp -A kermit.columbia.edu -bg kermit/archives/ckermit.tar.gz
</pre><p>
This assumes that "ftp" is a symbolic link to C-Kermit.  It logs you in
anonymously and gets the <tt>ckermit.tar.gz</tt> file in binary mode from the
<tt>kermit/archives</tt> directory.
<p>
Here's a slightly more ambitious example that illustrates CD'ing to the
desired server directory to get a group of files in text mode (in this case
the C-Kermit source files):
<p><pre>
  ftp -A kermit.columbia.edu -D kermit/f -ag "ck[cuw]*.[cwh]" makefile
</pre>
<p>

In this case we CD to the <tt>kermit/f</tt> directory so we don't have to
include it in each file specification, and we quote the
<tt>ck[cuw]*.[cwh]</tt> specification so the shell doesn't expand it, since we
have to pass it as-is to the server.  Note also that the quotes don't go
around the entire file list; only around each file specification that needs to
be quoted.

<p>

Here's one more example, that uploads a debug log file in binary mode to the
Kermit incoming directory (as we might ask you to do when following up on a
problem report):
<p>
<pre>
  ftp -A kermit.columbia.edu -D kermit/incoming -bp debug.log
</pre><p>
In this case the <tt>-D</tt> option is required to tell the server where to
put the incoming file.
<p>

Unless the <tt>-Y</tt> option is included, your Kermit initialization file
(<tt>.mykermrc</tt> in UNIX, <tt>K95.INI</tt> in Windows) is executed before
the command line options, so you can set any FTP-related preferences there, as
described in the subsequent sections.

<p>
<hr>
<h4><a name="x3.1.3">3.1.3. The FTP URL Interpreter</a></h4>

<dl>
<dt>If Kermit is invoked with either its regular personality (as "kermit")
or its FTP personality (as "ftp"), you can also give a URL
(Universal Resource Locator) instead of a hostname and options, with or
without a username and password:</dt>
<dd><tt>ftp ftp://<i>user</i>:<i>password</i>@<i>host</i>/<i>path</i></tt><br>
<tt>ftp ftp://<i>user</i>@<i>host</i>/<i>path</i></tt><br>
<font color="red"><tt>ftp ftp://@<i>host</i>/<i>path</i></tt> &nbsp; (or
<tt>ftp://:@<i>host</i>/<i>path</i></tt>)</font><br>
<tt>ftp ftp://<i>host</i>/<i>path</i></tt><br>
<tt>kermit ftp://<i>host</i>/<i>path</i></tt>
</dl>
<p>
If the FTP personality is used,
the service must be "ftp".   In all cases,
a hostname or address must be included.  If a
user is included but no password, you are prompted for the password.  If a
path (filename) is included:
<ul>
<li><font color="red">If "<tt>@</tt>" is included without a user, Kermit
prompts for the username and password.</font>
<li>If no user 
<font color="red">
and no "<tt>@</tt>"</font> are included, "anonymous" is used.
<li> GET is assumed.
</ul>
<p>
<dl>
<dt>If no path (and no action options) are included, an interactive FTP
session is started, as in this example:</dt>
<dd><tt>ftp ftp://kermit.columbia.edu</tt>
</dl>
<p>

If a path is included, but a username is not included, "anonymous" is used and
an appropriate <i>user</i><tt>@</tt><i>host</i> password is supplied
automatically.  If authentication is successful, Kermit attempts to GET the
file indicated by the path or, if the path is the name of a directory, it asks
the server for a directory listing.  In both cases, Kermit disconnects from
the server and exits after the operation is complete (unless you have included
the <tt>-S</tt> option on the command line).
<p>
<dl>
<dt>Here's an example that gets a listing of the Kermit directory at the
Kermit ftp site:</dt>
<dd><tt>ftp ftp://kermit.columbia.edu/kermit/</tt>
<p>
<dt>This example gets the top-level <tt>READ.ME</tt> file from the same directory:</dt>
<dd><tt>ftp ftp://kermit.columbia.edu/kermit/READ.ME</tt>
<p>
<dt>Here's the same example, but requesting a text-mode transfer:</dt>
<dd><tt>ftp -T ftp://kermit.columbia.edu/kermit/READ.ME</tt><br>
This illustrates that you can mix command-line options and URLs if you desire.
<p>
<dt>Here's an example that logs in as a (fictitious) real user to get a file:</dt>
<dd><tt>ftp ftp://olga@ftp.xyzcorp.com/resume.txt</tt><br>
The password is not included, so Kermit prompts for it.
</dl>
<p>
This scheme allows Kermit to be used as the FTP helper of other applications,
such as Web browsers, with all its advantages over other FTP clients
(especially the ones that are built in to most Web browsers), e.g. that it
can be given wildcards, and it can pick text and binary mode automatically
for each file.

<p>

HINT: suppose somebody sends you an FTP URL in email, or you see it in
some text.  If your terminal screen supports copy/paste, copy the url,
and then at the shell prompt type "kermit", a space, and then paste the
URL, e.g.:

<p>
<pre>
  $ <u>kermit </u>ftp://alpha.greenie.net/pub/mgetty/source/1.1/mgetty1.1.27-O
</pre>
<p>

"<tt>$</tt> is the shell prompt; the part you type is underlined, the rest
is pasted in.  Kermit does the rest.

<p>
<hr>
<h4><a name="x3.1.4">3.1.4. Interactive FTP Session Establishment</a></h4>

As you read this and the following sections, bear in mind that any command
that can be given at the prompt can also be used in a script program.
Kermit's script programming language is the same as its interactive command
language.  <a href="http://www.columbia.edu/kermit/ftpscripts.html">CLICK
HERE</a> if you would like to learn a bit more about script writing.

<p>
An FTP session is established with the FTP OPEN command:
<p><dl>
<dt><tt><b>FTP</b> <i>[</i> <b>OPEN</b> <i>]
[ {</i> <b>/SSL</b>, <b>/TLS</b> <i>} ]
hostname [ switches ] [ port ]</i></b></tt></dt>
<dd>Opens an FTP connection to the given host on the given port and, if FTP
AUTOLOGIN is ON, also logs you in to the server, prompting for username and
password if necessary.  If no port is specified, the regular FTP protocol
port (21) is used.  The OPEN keyword is optional (unless the hostname
conflicts with one of the FTP command keywords, which you can list
by typing "<tt>ftp</tt> <tt>?</tt>").
</dl>
<p>
The hostname can be an IP host name, numeric IP address, or if you have a
network directory active (SET NETWORK DIRECTORY; see Chapter 6 of
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>), an
entry name in the directory.  In the latter case, if the given hostname
matches exactly one entry, the associated name or address is used; if it
matches more than one, Kermit cycles through them until one is found that can
be opened; if it matches none, then the hostname is used as-is.  If a
directory is active but you want to bypass directory lookup, include an "="
sign at the beginning of the hostname, and/or use a numeric IP address.
<p>

When an FTP connection is opened, the default file-transfer mode is set to
binary if the client and server platforms are alike (e.g. both of them are
some kind of UNIX), and to text ("ascii") if they are not alike.  This has
no particular effect for uploading since Kermit automatically switches between
text and binary mode for each file, but might be important for downloading.
The connection is also set to Stream mode and File structure.  Record- or
page-oriented file transfers are not supported by C-Kermit's FTP client.

<p>
The optional FTP OPEN switches are:
<p><dl>
<dt><tt><b>/ANONYMOUS</b></tt></dt>
<dd>Logs you in anonymously, automatically supplying username "anonymous"
and <i>user</i>@<i>host</i> as the password, based on your local user and 
host names.
<p>
<dt><tt><b>/USER:</b><i>name</i></tt></dt>
<dd>Uses the given username to log you in, thus avoiding the Name: prompt.
<p>
<dt><tt><b>/PASSWORD:</b><i>text</i></tt></dt>
<dd>Uses the given text as your password, thus avoiding the Password: prompt.
This switch is not recommended for use in script files, which would be a
security risk.
<p>
<dt><tt><b>/ACCOUNT:</b>text</i></tt></dt>
<dd>Uses the given text as your account (or secondary password, depending on
the requirements of the server; most servers do not require or accept an
account name).  If an account is not supplied, you are not prompted for
one.
<p>
<dt><tt><b>/PASSIVE</b></tt></dt>
<dd>Opens the connection in passive mode.  Passive mode is the default in
Kermit's FTP client, unlike in most others, since it works better through
firewalls.  The <tt>/PASSIVE</tt> and <tt>/ACTIVE</tt> switches apply only
to the connection that is being opened, and do not affect the global 
FTP PASSIVE-MODE setting.

<p>
<dt><tt><b>/ACTIVE</b></tt></dt>
<dd>Opens the connection in active mode.  Use this switch if the server does
not support passive mode, or use the command SET FTP PASSIVE-MODE OFF.

<p>
<dt><tt><b>/NOINIT</b></tt></dt>

<dd><i>Added in C-Kermit <b>8.0.201</b>.</i> &nbsp; Tells C-Kermit not to send
REST, STRU, <font color="red">FEAT</font>, and MODE commands to the server
when the connection is opened, since these have been reported to cause
confusion in certain servers.

</dl>
<p>


When a username or password is missing, a prompt is issued at the controlling
terminal and you must type the response; the response can not be scripted.
Use the switches to avoid prompts, or one of the secure authentication methods
described in the next section, or see
<a href="#ftpautolog">SET FTP AUTOLOGIN</a> and the 
<a href="#ftpuser">FTP USER</a>
and similar commands described later in this section.
<p>
Examples:
<p><pre>
  ftp open kermit.columbia.edu /anonymous  ; Open and log in anonymously
  ftp kermit.columbia.edu /anonymous       ; The OPEN keyword can be omitted
  ftp xyzcorp.com                          ; Open and maybe prompt for username
  ftp xyzcorp.com /user:olga               ; Open and log in as olga
  ftp testing.abccorp.com 449              ; Specify a special TCP port number
  ftp testing.abccorp.com /user:olaf /password:secret 449
</pre>

<p>

The FTP OPEN command succeeds if a connection was opened to the server (even
if the given username and password were not valid) and fails otherwise (see
<a href="#x3.8">Section 3.8</a> for details).
<p>
When your FTP session is complete, you can terminate it as follows:
<p><dl>
<dt><tt><b>FTP BYE</b></tt></dt>
<dd>Closes the FTP connection if one was open.
The FTP prefix can be omitted if no other connection is open at the same time
(see <a href="#x3.8">Section 3.8</a> for details).  If a
connection log is active, an FTP record is written to it.  If Kermit was
started with the <tt>-9</tt> command-line option or with its FTP command-line
personality, and the <tt>-S</tt> (Stay) option was not given, AND there is no
other active connection, the FTP BYE command also exits, just as it does on a
regular FTP client.  <i>Synonyms:</i> <tt><b>FTP CLOSE</b></tt>,
<tt><b>FTP QUIT</b></tt> (but if the FTP prefix is omitted from QUIT, this
becomes the regular Kermit QUIT command, which is equivalent to EXIT; i.e.
it closes the connection and exits from Kermit).

</dl><p>
The following commands can be used to achieve greater control over the
connection and login process:

<p>
<dl>

<dt><tt><font color="red"><b>SET FTP ANONYMOUS-PASSWORD</b>
<i>text</i></font></tt></dt>

<dd><font color="red">Allows you to choose the password text to be sent
automatically by Kermit when you open an FTP connection with the /ANONYMOUS
switch.</font>

<p>

<dt><a name="ftpautolog"><tt><b>SET FTP AUTOLOGIN</b>
<i>{</i> <b>ON</b>, <b>OFF</b></b> <i>}</i></tt></a></dt>

<dd>If you give this command prior to opening an FTP connection, it controls
whether Kermit tries to log you in automatically as part of the connection
process.  Normally ON, which means the username and password are sent
automatically (and prompted for if they are not yet known).  When OFF, FTP
OPEN connects to the server without logging in.  OFF is equivalent to the
<tt>-n</tt> command-line option when using Kermit's FTP command-line
personality. 

<p>

<dt><a name="ftpuser"><tt><b>FTP USER</b> <i>name [ password [ account ] ]</i></tt></a></dt>

<dd>Used to log in to an FTP server to which a connection has been made without
autologin, or when autologin failed.  If the password is furnished on the
command line, it is used; otherwise you are prompted for a password.  An
account may also be furnished if required by the server; it is not required
by Kermit and is not prompted for if omitted.  <i>Synonyms:</i>
<tt><b>USER, FTP LOGIN</b></tt>.
<p>
<dt><tt><b>FTP ACCOUNT</b> <i>text</i></tt></dt>
<dd>Sends an account name to a server that supports accounts.  If the server
does not support accounts, an error response occurs.  If the server does
support accounts, the account is accepted if it is valid and rejected if
it is not.  The account might be used for charging purposes or it might
be a secondary password, or it might be used for any other purpose, such
as an access password for a particular disk.  Servers that support
accounts might or might not allow or require the account to be sent
prior to login; usually it is sent after login, if at all.
<i>Synonym:</i> <tt><b>ACCOUNT</b></tt>.
</dl>
<p>
Example:
<p>
<blockquote>
<pre>
set ftp autologin off                  ; One thing at a time please
ftp xyzcorp.com                        ; Try to make the connection
if fail exit 1 FTP connection failed   ; Check that it was made
ftp user olga secret                   ; Now log in to the server
if fail exit 1 FTP login failed        ; Check that it worked
ftp account 103896854                  ; Login OK - send account
if fail echo WARNING - FTP ACCT failed ; Warn if problem
...                                    ; (have session here)
bye                                    ; Log out and disconnect
</pre>
</blockquote>
<p>

The following commands are used to control or get information about the FTP
connection.  Any particular FTP server does not necessarily support all of
them.

<p>
<dl>
<dt><tt><b>FTP RESET</b></tt></dt>
<dd>Terminates a user session but leaves the connection open, allowing a new
login via FTP USER.

<p>

<dt><tt><b>FTP IDLE</b> <i>[ number ]</i></tt></dt>
<dd>Most FTP servers automatically log you out and and disconnect your session
if there has been no activity for a certain amount of time.  Use this
command to ask the server to set its idle limit to the given number of
seconds.  Omit the number to ask the server to inform you of its current
idle limit.

<p>

<dt><tt><b>FTP STATUS</b> <i>[ filename ]</i></tt></dt>

<dd>Asks the FTP server to send information about the current session.
The result is a free-format report that might include server 
identification, username and login time, FTP protocol settings, and
file-transfer statistics.  If a filename is given, the server is supposed to
send detailed information about the file.

<p>

<dt><tt><b>FTP SYSTEM</b></tt></dt>

<dd>Asks the FTP server to identify its operating system (Listed in Internet
Assigned Numbers, Operating System Names).  Examples: UNIX, VMS, VM/CMS,
WINDOWS-NT.  Unfortunately many variations are allowed (e.g. LINUX-2.0,
LINUX-2.2, FREEBSD, ULTRIX, etc, instead of UNIX; WINDOWS-NT-3,
WINDOWS-NT-3.5, WINDOWS-NT-3.51, WINDOWS-NT-4, etc).  The report might
also include other information like "Type L8", "Type I", or "Type A",
indicating the file-transfer mode. 

<p>

<dt><tt><b>FTP HELP</b> <i>[ keyword  [ keyword [ ... ] ]</i></tt></dt>
<dd>Asks the server to list the commands it supports.  The response is usually
cryptic, listing FTP command mnemonics, not the commands used by the client
(since the server has no way of knowing anything about the client's user
interface).  For example, the PUT command is STOR in FTP protocol.  If a
keyword is given, which should be an FTP protocol command, slightly-more-
detailed help is given about the corresponding command (if the FTP server
supports this feature).  Examples: "ftp help", "ftp help stor".

<p>

<dt><tt><b>FTP SITE</b> <i>text</i></tt></dt>

<dd>(Advanced) Sends an FTP SITE (site-specific) command.  Usually this means
that the FTP server is asked to run an external command with the given
arguments.  You might be able to find out what SITE commands are available
by sending "ftp help site" to the server, but in general the availability
of and response to SITE commands is (not surprisingly) site specific.

<p>

<dt><tt><b>FTP QUOTE</b> <i>text</i></tt></dt>

<dd>(Advanced) Sends an FTP command in FTP protocol format.  Use this command
to send commands to the server that the FTP client might not know about.

<p>

<dt><tt><b>SHOW FTP</b></tt></dt>

<dd>Lists client (Kermit) FTP settings and information.
Also SHOW CONNECTION, SHOW COMMUNICATIONS.

<p>

<dt><tt><b>HELP FTP</b> <i>[ keyword ]</i></tt></dt>

<dd>Asks Kermit to list and describe its built-in FTP commands.

<p>

<dt><tt><b>HELP SET FTP</b> <i>[ keyword ]</i></tt></dt>

<dd>Asks Kermit to list and describe its built-in SET FTP commands.

</dl>
<p>

[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.2">3.2. Making Secure FTP Connections</a></h3>

<i>Also see:</i>
<a href="http://www.columbia.edu/kermit/ibm_ie.html">Accessing IBM Information
Exchange with Kermit</a>.

<p>

In the previous section, you can see several examples of traditional insecure
authentication: username and password sent across the network in clear text.
Of course this is bad practice on at least two counts: <i>(1)</i> storing
passwords in files (such as script files) gives access to the target systems
to anybody who can obtain read access to your scripts; and <i>(2)</i> sending
this information over the network leaves it open to interception by network
sniffers or compromised hosts.

<p>

Because of the increasing need for security on the Internet, FTP servers are
beginning to appear that offer secure forms of authentication, in which no
information is sent over the network that would allow anyone who intercepts
it to usurp your identity and gain your access rights.

<p>

Kermit provides an equivalent form of FTP security for each type of IETF
standard security implemented in Telnet.  These include GSSAPI-KERBEROS5,
KERBEROS4, Secure Remote Password (SRP), and Transport Layer Security (SSL and
TLS).  It does not presently include SSL tunneling nor any form of SSH v1 or
v2.  When Kermit is built with the necessary libraries, secure FTP connections
are attempted by default, in which all connections are authenticated and the
command and data channels are private.

<p>

The use of authentication and encryption for FTP connections can be 
adjusted with the commands listed below, which are available only if your
version of Kermit was built with the corresponding security options and
libraries:

<p>

<dl>
<dt><tt><b>SET FTP AUTHTYPE</b>
<i>{</i> <b>AUTOMATIC, GSSAPI-KRB5, KERBEROS4, SRP, SSL, TLS</b> <i>}</i>
</tt></dt>
<dd>Specifies an ordered list of authentication methods to be attempted when
AUTOAUTHENTICATION is ON.  The default list is: GSSAPI-KRB5, SRP,
KERBEROS_V4, TLS, SSL.  If none of the selected methods are supported by
the server, an insecure login is used as a fallback.  Note, by the way,
that SSL or TLS can be used to secure an anonymous connection.
<p>
<dt><tt><b>SET FTP AUTOAUTHENTICATION</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>
<dd>Tells whether authentication should be negotiated by the FTP OPEN command.
Default is ON.  Use SET FTP AUTOAUTHENTICATION OFF to force a clear-text,
unencrypted connection to FTP servers (such as the one at the Kermit FTP site)
that normally would try to negotiate secure authentication and encryption.

<p>

<dt><tt><b>SET FTP AUTOENCRYPTION</b>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>Tells whether encryption (privacy) should be negotiated by the FTP OPEN
command, which can happen only if secure authentication is also negotiated.
Default is ON.

<p>

<dt><tt><b>SET FTP AUTOLOGIN</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>
<dd>Tells Kermit whether to try logging in automatically when you make an
FTP connection, as opposed to letting you do it "by hand" with the FTP USER
command.

<p>

<dt><tt><b>SET FTP COMMAND-PROTECTION-LEVEL</b>
<i>{</i> <b>CLEAR, CONFIDENTIAL, PRIVATE, SAFE</b> <i>}</i></tt></dt>

<dd>Determines the level of protection applied to the command channel:
<p><pre>
  CLEAR         Data is sent in plaintext and not protected against tampering.
  CONFIDENTIAL  Data is encrypted but not protected against tampering.
  PRIVATE       Data is encrypted and is protected against tampering.
  SAFE          Data is sent in plaintext but protected against tampering.
</pre><p>
The default is PRIVATE.

<p>

<dt><tt><b>SET FTP CREDENTIAL-FORWARDING</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>Tells whether end-user credentials are to be forwarded to the server if
supported by the authentication method (GSSAPI-KRB5 only).  This is often
required to allow access to distributed file systems (e.g. AFS.)

<p>

<dt><tt><b>SET FTP DATA-PROTECTION-LEVEL</b> <i>{</i> <b>CLEAR, CONFIDENTIAL, PRIVATE, SAFE</b> <i>}</i></tt></dt>

<dd>Tells what level of protection is applied to subsequent data channels.
The meanings of the protection-level keywords are the same as for
SET FTP COMMAND-PROTECTION-LEVEL.  The default is PRIVATE.

<p>

<dt><tt><b>SET FTP SRP CIPHER</b> <i>name</i></tt></dt>

<dd>Specifies the cipher to be used for encryption when SRP authentication
is in use.  The list of possible choices is computed based on the
capabilities of the local SRP library and includes NONE plus zero or 
more of the following:
<p><pre>
  BLOWFISH_ECB        CAST5_ECB          DES_ECB          DES3_ECB 
  BLOWFISH_CBC        CAST5_CBC          DES_CBC          DES3_CBC
  BLOWFISH_CFB64      CAST5_CFB64        DES_CFB64        DES3_CFB64
  BLOWFISH_OFB64      CAST5_OFB64        DES_OFB64        DES3_OFB64
</pre><p>
The default is DES3_ECB.

<p>

<dt><tt><b>SET FTP SRP HASH name</b></tt></dt>

<dd>Specifies the hash to be used for data protection when SRP authentication
is in use.  The choices are MD5 and SHA.  The default is SHA.

</dl>
<p>

Command-line options:

<p>
<dl>

<dt><tt><b>-k</b> <i>name</i></tt></dt>

<dd>Specifies the realm to be used with Kerberos 4 authentication
(= SET AUTH K4 REALM name).

<p>

<dt><tt><b>-f</b></tt></dt>

<dd>Enables forwarding of Kerberos 5 credentials to the host when using
GSSAPI authentication (= SET AUTH K5 FORWARDABLE ON).

<p>

<dt><tt><b>-x</b></tt></dt>

<dd>Enables autoencryption (= SET FTP AUTOENCRYPTION ON).

<p>

<dt><tt><b>-c</b> <i>cipher</i></tt></dt>

<dd>Specifies the kind of cipher to be used for encryption with SRP 
authentication.  Equivalent to SET FTP SRP CIPHER, with the same
choices.  If this option is not given, CAST5_CBC is used.

<p>

<dt><tt><b>-H</b> <i>hash</i></tt></dt>

<dd>Specifies the hash to be used for encryption with SRP authentication.
Equivalent to SET FTP SRP HASH, with the same choices.  If this option
is not given, SHA is used.

<p>

<dt><tt><b>-z debug</b></tt></dt>

<dd>Turns on SSL/TLS debugging.

<p>

<dt><tt><b>-z secure</b></tt></dt>

<dd>Requires secure connection.

<p>

<dt><tt><b>-z certsok</b></tt></dt>

<dd>Says to accept all certificates without checking validity.

<p>

<dt><tt><b>-z verify=</b><i>n</i></tt></dt>

<dd>Sets certificate verification mode to the given number, <i>n</i>:<br>
<tt>&nbsp;&nbsp;0</tt> = no verification<br>
<tt>&nbsp;&nbsp;1</tt> = verify certificate if presented<br>
<tt>&nbsp;&nbsp;2</tt> = require verification of certificate

<p>

<dt><tt><b>-z cert=</b><i>filename</i></tt></dt>

<dd>Specifies a file containing a client certificate to be presented to the
FTP server.

<p>

<dt><tt><b>-z key=</b><i>filename</i></tt></dt>

<dd>Specifies a file containing a private key matching the client certificate.

<p>

<dt><tt><b>-z !krb4</b></tt></dt>

<dd>(nokrb4) Disables the use of Kerberos 4.

<p>

<dt><tt><b>-z !gss</b></tt></dt>

<dt><tt><b>-z nogss</b></tt></dt>

<dd>Disables the use of GSSAPI - Kerberos 5.

<p>

<dt><tt><b>-z !srp</b></tt></dt>

<dt><tt><b>-z nosrp</b></tt></dt>

<dd>Disables use of SRP.

<p>

<dt><tt><b>-z !ssl</b></tt></dt>

<dt><tt><b>-z nossl</b></tt></dt>

<dd>Disables the use of SSL.

<p>

<dt><tt><b>-z !tls</b></tt></dt>

<dt><tt><b>-z notls</b></tt></dt>

<dd>Disables the use of TLS.

</dl>
<p>

<i>Caution:</i><tt> </tt>If your FTP connection is secured via AUTH TLS,
it is not possible to interrupt a file transfer.  This is a limitation of
all known FTP servers that support AUTH TLS.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]

<h3><hr><a name="x3.3">3.3. Setting FTP Preferences</a></h3>

FTP preferences can be set globally and persistently with the commands in the
following sections; many of these can also be overridden on a per-command
basis with switches that have the same name.

<h4>3.3.1. Logs, Messages, and Other Feedback</h4>

You can control the amount of feedback received from your FTP session with
the commands in this section.  First, you can create a log of your FTP
transfers with the following commands:

<p>
<dl>

<dt><tt><b>SET TRANSACTION-LOG</b> <i>{</i> <b>VERBOSE, FTP, BRIEF</b>
<i>}</i></tt></dt>

<dd>Selects the log format.  VERBOSE is the default, and is described in
<a href="http://www.columbia.edu/kermit/ck60manual.html">the
manual</a>.  FTP chooses a WU-FTPD format, the same as is used by the popular
FTP server.  BRIEF creates per-file records in comma-separated-list format.
For greater detail, see
<a href="http://www.columbia.edu/kermit/ckermit70.html#x4.17">Section 4.17</a>
of the 
<a href="http://www.columbia.edu/kermit/ckermit70.html">C-Kermit 7.0 Update
Notes</a>.

<p>

<dt><tt><b>LOG TRANSACTIONS</b> <i>filename</i></tt></dt>

<dd>Records FTP (or Kermit, or any other protocol) uploads and downloads 
in the given file using the format selected by the most recent
SET TRANSACTION-LOG command, if any, or else the default format.

</dl>
<p>

FTP screen messages and displays are controlled by the following commands:

<p>
<dl>

<dt><tt><b>SET TRANSFER DISPLAY</b> <i>{</i> <b>FULLSCREEN, CRT, SERIAL,
BRIEF, NONE, OFF</b> <i>}</i></tt></dt>

<dd>FTP transfers use Kermit's normal file-transfer display styles.  Use this
command to choose the desired format; the default on most platforms is
FULLSCREEN.  The display is automatically disabled if Kermit is running in
the background or in batch.  BRIEF is always used for command-line initiated
transfers (unless suppressed by <tt>-q</tt>).
While a file-transfer is in progress, you can interrupt it in the normal
Kermit way by typing one of the following keys or key combinations:<br>
<tt>&nbsp;&nbsp;</tt>X - Cancel current file but go on to the next one (if any).<br>
<tt>&nbsp;&nbsp;</tt>Z - Cancel the entire transfer.</br>
<tt>&nbsp;&nbsp;</tt>Ctrl-L or Ctrl-W - Refresh the file-transfer display (if any).
</pre>
<p>

<dt><tt><font color="red"><b>SET FTP DISPLAY</b>
<i>{</i> <b>FULLSCREEN, CRT, SERIAL,
BRIEF, NONE, OFF</b> <i>}</i></font></tt></dt>

<dd><font color="red">Like SET TRANSFER DISPLAY, but applies only to FTP
connections, and does not affect Kermit- or other protocol file transfers.
</font>

<p>

<dt><tt><b>SET QUIET</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>This command applies to Kermit in general, not just FTP.  OFF by default;
when ON, it surpresses most messages from most commands as well as the
file-transfer display.

<p>

<dt><tt><b>SET FTP PROGRESS-MESSAGES</b>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>Tells whether Kermit should print locally-generated feedback messages for
each non-file-transfer command.  ON by default.

<p>

<dt><tt><b>SET FTP VERBOSE-MODE</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>Tells whether to display all responses from the FTP server.  OFF by
default.  This shows all responses to all commands, except when the
file-transfer display is active, and unless you have SET QUIET ON.  When OFF,
responses are shown only for commands such as FTP PWD whose purpose is to
display a response.

<p>

<dt><tt><b>SET FTP DEBUG</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>Tells whether local client debugging information should be displayed.
OFF by default.  When ON, the commands that are sent to the server are
shown, as well as its responses (even if VERBOSE-MODE is OFF), plus
additional informational messages are printed regarding the progress of
secure operations.  Also, the temporary file created by the
<a href="#x3.6">MGET command</a> is not deleted so you can see what's in it.

</dl>
<p>

Set all of these to OFF when silent running is desired.

<h4>3.3.2. Operational Preferences</h4>

<dl>

<dt><tt><font color="red"><b>FTP DISABLE</b>
<i>new-protocol-feature-name</i></font></tt></dt>
<dt><tt><font color="red"><b>FTP ENABLE</b>
<i>new-protocol-feature-name</i></font></tt></dt>

<dd><font color="red">Explained in <a href="#x3.11">Section 3.11</a>.</font>

<p>

<dt><tt><b>SET FTP AUTOLOGIN</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>If you give this command prior to opening an FTP connection, it controls 
whether Kermit tries to log you in automatically as part
of the connection process. Normally ON, which means the username and 
password are sent automatically (and prompted for if
they are not yet known). When OFF, FTP OPEN connects to the server without 
logging in. OFF is equivalent to the <tt>-n</tt>
command-line option when using Kermit's FTP command-line personality.  
See <a href="#x3.1.4">Section 3.1.4</a> for usage.

<p>

<dt><tt><b>SET FTP PASSIVE-MODE</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>ON by default, to avoid random TCP port assignment for data connections,
which can prevent FTP protocol from working through firewalls and network
address translators (for more on these topics, see the <a
href="security.html">Kermit security reference</a>.  Set to OFF in case the
FTP server does not support passive mode, or in case the client has problems
with it (it has been observed, for example, that when using passive mode, the
SCO XENIX 2.3.4 TCP/IP stack hangs in the <tt>connect()</tt> call forever).

<p>

<dt><tt><b>SET FTP SEND-PORT-COMMANDS</b>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>This command determines whether the FTP client sends a new PORT command
to the server when accepting incoming data connections (as when not using
passive mode.)  When PASSIVE-MODE is OFF and SET SEND-PORT is OFF, the port
that was originally specified is reused.  This is the default behavior for
normal FTP clients but it is not compatible with many firewalls.

<p>

<dt><tt><b>SET FTP CHARACTER-SET-TRANSLATION</b>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>Whether to translate character sets when transferring files with FTP
(explained in <a href="#x3.7">Section 3.7</a>).  OFF by default.

<p>

<dt><tt><b>SET FTP SERVER-CHARACTER-SET</b> <i>name</i></tt></dt>

<dd>Tells Kermit the character set used by the FTP server, UTF-8 by default
(<a href="#x3.7">Section 3.7</a>).

<p>

<dt><tt><font color="red"><b>SET FTP SERVER-TIME-OFFSET</b>
<i>delta-time</i></font></tt></dt>

<dd><font color="red">Tells Kermit to apply the given <a href="#x8.13.4">delta
time</a> to file timestamps provided by the server for its files; for
use when (for example) the server does not have its timezone set
correctly.</font>

<p>

<dt><a name="erroraction"><tt><b>SET FTP ERROR-ACTION</b>
<i>{</i> <b>PROCEED, QUIT</b> <i>}</i></tt></a></dt>

<dd>When transferring a group of files with FTP, and an error occurs with one
of the files, Kermit normally goes on the next file.  Use SET FTP
ERROR-ACTION to QUIT to make Kermit stop the transfer immediately and
fail if an error occurs with any single file in the group.  Example:
you have given Kermit a list of files to send, and one of the files can
not be found, or read permission is denied.  Note that cancelling a
file by typing 'X' during transfer is not considered an error (if you want
to cancel the entire transfer, type 'Z' or Ctrl-C).

<p>

<dt><a name="ftpperms"><tt><b>SET FTP PERMISSIONS</b>
<i>{</i> <b>AUTO, ON, OFF</b> <i>}</i></tt></a></dt>

<dd>When uploading files with PUT or MPUT, this tells whether Kermit should
send each file's permissions.  The default is OFF, which means not to send
permissions, in which case the uploaded file's permissions are set by the
FTP server according to its own criteria.  ON means to send them, AUTO
means to send them only if the client (Kermit) and server are on like
platforms (e.g. both UNIX).  This command has no effect when downloading,
since the FTP protocol does not include a way for the server to inform the
client of a file's permissions.  Also see
<a href="#permswitch">FTP PUT /PERMISSIONS</a>.
Note that setting permissions after uploading is likely to work (correctly or
at all) only when the client and server platforms are alike (e.g. both of them
are some form of UNIX).  Also note that Windows files don't have permissions.
Also see <a href="#ftpchmod">FTP CHMOD</a>.

<p>

<dt><a name="ftpdates"><tt><b>SET FTP DATES</b>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></a></dt>

<dd>When downloading files with GET or MGET, this tells whether Kermit should
try to set the received file's date from the server's date.  FTP DATES is
<font color="red">ON</font> by default.  Note, however, that FTP protocol does
not allow date preservation when uploading.  So at best, SET FTP DATES ON can
work only when downloading, and then only when the server agrees to furnish
file dates.

<p>

<dt><a name="ftpfilenames"><tt><b>SET FTP FILENAMES</b>
<i>{</i> <b>AUTO, CONVERTED, LITERAL</b> <i>}</i></tt></a></dt>

<dd>When uploading (sending) files, this tells whether to convert outbound
filenames to "common form".  This means allowing only one period in a name,
uppercasing any lowercase letters, replacing spaces by underscores, etc.
AUTOMATIC is the default, meaning LITERAL when client and server are the
same type of system (e.g. UNIX) and CONVERTED otherwise.  Special case: if
the setting is AUTOMATIC and the client is not UNIX and the server
identifies itself as UNIX, Kermit uses a less-strict form of conversion, in
which lowercase letters are not uppercased and the filename can contain any
number of periods, but spaces are still converted to underscore.  When
receiving, conversion generally means to change all-uppercase names to
lowercase and spaces to underscore.

<p>

<dt><a name="ftpunique"><tt><b>SET FTP UNIQUE-SERVER-NAMES</b>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></a></dt>

<dd>Applies only to uploads.  Tells the server to create new, unique names for
incoming files that have the same names as existing files.  OFF by default,
in which case the server overwrites existing files with new files of the
same name.  When ON, the server uses its own built-in method for creating
new names for incoming files; for example, appending a period (<tt>.</tt>)
and a number to the name.  CAUTION: Use this option only if you do not need
to refer to the file after it is uploaded, since FTP protocol provides no
mechanism for the client to find out what name was assigned by the server.

<p>

<dt><tt><b>SET FTP COLLISION</b> <i>{</i> <b>...</b> <i>}</i></tt></dt>

<dd>When downloading, what to do if an incoming file has the same name as an
existing file.  Options are the same as for SET FILE COLLISION.  If this
command is not given, Kermit's regular FILE COLLISION setting is used.  If
this command is given, it overrides the FILE COLLISION setting for FTP
transfers only.  See <a href="#x3.6.2">Section 3.6.2</a> for details.

<p>

<dt><a name="setftptype"><tt><b>SET FTP TYPE</b>
<i>{</i> <b>TEXT, BINARY, TENEX</b> <i>}</i></tt></a></dt>

<dd>Changes the default transfer mode.  When sending (uploading) files,
this command has no effect unless you disable automatic text/binary mode
switching (<a href="#x4">Section 4</a>) with SET FILE SCAN OFF or SET TRANSFER
MODE MANUAL.  When receiving (downloading) files, this command establishes the
transfer mode to be used when a filename does not match any of Kermit's text
or binary filename patterns, unless you use SET FTP GET-FILETYPE-SWITCHING or
SET TRANSFER MODE MANUAL to disable automatic switching, in which case, this
command establishes the transfer mode for all downloaded files.  In all cases,
however, the FTP TYPE can be overridden in any GET or PUT command by including
a /TEXT (/ASCII), /BINARY, or /TENEX switch.  The FTP TYPE is independent of
the Kermit FILE TYPE setting.  TENEX is used for sending 8-bit binary files to
36-bit platforms such as TOPS-10, TOPS-20, and TENEX, and getting them back
again.  <i>Synonym:</i> <tt><b>ASCII</b> = <b>TEXT</b></tt>.  Note: there is
also an FTP TYPE command, which does what SET FTP TYPE does but also sends a
TYPE command to the server immediately if the given type is different from the
current one.

</dl>
<p>

If you want want specific FTP preference settings to be in effect for all
your Kermit FTP sessions, put the desired SET FTP commands in your Kermit
customization file (<tt>~/.mykermrc</tt> in UNIX, <tt>K95CUSTOM.INI</tt> in
Windows).

<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.4">3.4. Managing Directories and Files</a></h3>

In Kermit, commands for directory and file management can refer to:

<p>
<ul>
<li>The local computer
<li>A remote computer when you have a connection to a Kermit server or IKSD.
<li>A remote computer when you have a connection to an FTP server.
</ul>
<p>

(There can also be an HTTP connection, but the commands in this section don't
apply to HTTP connections.)

<p>

Thus in general, each such command comes in three forms:

<p>
<ol>

<li>With <b>no prefix</b> in C-Kermit 8.0.200, it refers to the local computer
(CD, DIR, etc).  In C-Kermit 8.0.201 and later, however, the "locus" switches
to automatically to the remote FTP server when you make an FTP connection (see
the SET LOCUS description <a href="#x7">Section 7</a>); thus C-Kermit 8.0.201
acts almost exactly like a regular FTP client when it has an FTP connection,
yet still acts like itself on other kinds of connections.

<p>

<li>With the <b>REMOTE</b> prefix, it is for a Kermit server (REMOTE CD,
REMOTE DIR).

<p>

<li>With the <b>FTP</b> prefix, it's for an FTP server (FTP CD, FTP DIR).

<p>

<li>Also see <a href="#x3.8">Section 3.8</a>, which explains "R-commands" and
"L-commands".

</ol>
<p>


<p>

Kermit's FTP file and directory management commands are as follows.  When an
R-command is included in the Synonyms list, be sure to read <a
href="#x3.8">Section 3.8</a> about rules for use of R-commands.

<p>
<dl>

<dt><tt><b>FTP CD</b> <i>[ directory ]</i></tt></dt>
<dd>Tells the FTP server to change its default (working) directory to the
one given, which usually must be expressed in the syntax of the server
platform (UNIX, VMS, etc).  If the directory is not specified, the result
depends on the FTP server -- it might complain that the command is
illegal, or it might change to your original login directory.
<i>Synonyms:</i> <tt><b>FTP
CWD</b></tt> (Change Wording Directory); <tt><b>RCD</b></tt>.
<p>
<dt><tt><b>FTP CDUP</b></tt></dt>
<dd>Tells the FTP server to change its default (working) directory to the
parent directory of its current one (equivalent to
"<tt>cd</tt>&nbsp;<tt>..</tt>"
in UNIX, or "<tt>cd</tt>&nbsp;<tt>[-]</tt>" in VMS).
<i>Synonyms:</i> <tt><b>RCDUP</b>, <b>FTP UP</b></tt>.
<p>
<dt><tt><b>FTP PWD</b></tt></dt>
<dd>Asks the FTP server to report ("print") its current working directory.
<i>Synonym:</i> <tt><b>RPWD</b></tt>.
<p>
<dt><tt><b>FTP MKDIR</b> <i>directory</i></b></tt></dt>
<dd>Asks the FTP server to create the directory whose name is given.  In
general, the name must be in the syntax of the server's file system, and
it must be either absolute (a full pathname) or relative to the server's
current (working) directory.  This command fails if the directory can't
be created for any reason, including that it exists already.
<i>Synonym:</i> <tt><b>RMKDIR</b></tt>.
<p>
<dt><tt><b>FTP RMDIR</b> <i>directory</i></tt></dt>
<dd>Asks the FTP server to remove the directory whose name is given.  The rules
are the same as for MKDIR, plus in most cases, the server will not remove
any directory unless it is empty.
<i>Synonym:</i> <tt><b>RRMDIR</b></tt>.
<p>
<dt><tt><b>FTP DIRECTORY</b> <i>[ filespec ] [ redirectors ]</i></tt></dt>
<dd>Tells the FTP server to send a directory listing of the specified files.
If no filespec is given, the server lists all files in its current working
directory.  The results are in whatever format the server chooses to send
them.  You can use UNIX-like redirectors to send the listing to a file or
a pipeline, exactly as with the regular Kermit client/server REMOTE
DIRECTORY command (<a href="ckb2.html"><cite>Using C-Kermit</cite></a>,
Chapter 11).  <i>Synonym:</i> <tt><b>RDIRECTORY</b></tt>.  Examples:
<p><pre>
    ftp dir                           ; Show listing of all files on screen
    ftp dir *.txt                     ; List *.txt files on screen
    ftp dir *.txt > somefile          ; Put listing in somefile
    ftp dir *.txt >> somefile         ; Append listing to somefile
    ftp dir *.txt | sort > somefile   ; Put sorted listing in somefile
    ftp dir | more                    ; Runs list through "more"
    ftp dir | sort | more             ; Runs list through "sort" and "more"
</pre><p>
<dt><a name="ftpvdir"><tt><b>FTP VDIRECTORY</b> <i>[ filespec ] [ redirectors ]</i></tt></a></dt>
<dd>"Verbose" directory.  This is an alternative FTP DIRECTORY command
primarily for use with DECSYSTEM-20 (TOPS-20) FTP servers, which send only
filenames when given a DIRECTORY command; the VDIRECTORY command makes them
also send file sizes, dates, and attributes.
<p>
<dt><a name="ftpcheck"><tt><b>FTP CHECK</b> <i>filespec</i></tt></a></dt>
<dd>Asks the FTP server whether the given file exists or, if the
<i>filespec</i> contains wildcards, if any files match, and this command
succeeds or fails accordingly.
<p>
<dt><tt><b>FTP MODTIME</b> <i>filename</i></tt></dt>
<dd>Asks the FTP server, via the not-yet-standard FTP MDTM command,
to send the modification date and time of the given
file.  The response should be a numeric string in the format:
yyyymmddhhmmssxxxxx...  where yyyy is the year, mm is the month, dd is the
day, hh is the hour (0-23), mm is the minute, ss is the second, and xxx...
is the optional fraction of the second (0 or more digits).  The date and time
is expressed in UTC (GMT, Zulu, Zero-Meridian).  The result is available
programmatically in the <a href="#x3.10"><tt>\v(ftp_message)</tt></a>
variable, and is understandable by Kermit's date-time switches and functions.
For example, suppose we want to upload all local files that are newer than
a particular file on the server:
<p>
<pre>
  C-Kermit&gt; ftp modtime signpost
  C-Kermit&gt; echo \v(ftp_message)
  20010807113542.014
  C-Kermit&gt; ftp mput /after:\v(ftp_message)GMT *
</pre>
<p>
Note that we must append "GMT" to the date-time string to let the
<tt>/AFTER</tt> switch know the time is GMT rather than local.

<p>
<dt><tt><b>FTP SIZE</b> <i>filename</i></tt></dt>
<dd>Asks the FTP server to send the size (in bytes) of the given file.
The result might vary depending on whether the current FTP TYPE is binary
or text ("ascii").  For a reliable byte count, do FTP TYPE BINARY first.
The result is available
programmatically in the <a href="#x3.10"><tt>\v(ftp_message)</tt></a> variable.
<p>
<dt><a name="ftpchmod"><tt><b>FTP CHMOD</b> <i>permissions filename</i></tt></a></dt>
<dd>Tells the FTP server to set the permissions (protection) of the given
file to the ones given.  The permissions and filename must be given in
whatever syntax is required by the server.  Example (for a UNIX-based FTP
server):
<p><pre>
  ftp chmod 664 oofa.txt
</pre>
<p>
Not all servers support this
command.  For non-UNIX-based servers, you might need to use FTP QUOTE
or FTP SITE and the appropriate platform-specific FTP server command.
<p>
<dt><tt><b>FTP UMASK</b> <i>[ number ]</i></tt></dt>
<dd>This command is probably specific to UNIX-based servers; it sets the UNIX
"umask", which is the default permissions mask for new (in this case,
incoming) files.  Crudely put, the UNIX umask is an octal representation of
a binary number in in which a 1 bit stands for a permission bit that must be
0, and a 0 bit stands for a permission bit that can be 0 or 1 depending on
other factors, such as the permissions of the parent directory.  Example:
"umask 007" requires that new files are created without read/write/execute
world permission.  If the number is not specified, the server's current
umask is reported.
<p>
<dt><tt><b>FTP RENAME</b> <i>filename newname</i></tt></dt>
<dd>Asks the FTP server to rename the file whose name is "filename" to
"newname".  Works only for one file; can not be used with wildcards.  The
server's interpretation of "newname" can vary (in some cases it must be a
filename, in others perhaps it can also be a directory name, in which case if
the filename denote a regular file, the file might be moved to the given
directory).  Some servers might allow files to be renamed ("moved") between
physical disks or partitions, others might not.
<i>Synonym:</i> <tt><b>RRENAME</b></tt>.
<p>
<dt><tt><b>FTP DELETE</b> <i>[ switches ] filespec [ filespec [ ... ] ]</i></tt></dt>
<dd>Tells the FTP server to delete the file or files listed.  Each file
specification may, but need not, contain wildcard characters to match
multiple files.  File specifications and wildcard syntax must be those
of the server.  Any file specifications that contain spaces must be
enclosed in braces or doublequotes.  FTP DELETE switches are:
<p><pre>
 /ERROR-ACTION:  /FILENAMES:     /NOBACKUPFILES  /QUIET
 /EXCEPT:        /LARGER-THAN:   /NODOTFILES     /NOPAGE
 /PAGE           /RECURSIVE      /SMALLER-THAN:
</pre><p>
When used with FTP DELETE, the /RECURSIVE switch deletes files but not
directories, and furthermore depends on the server providing recursive file
lists, which is not the normal behavior.  For further details, see the
decriptions of these switches in <a href="#x3.6">Section 3.6</a>.
<i>Synonyms:</i> <tt><b>FTP MDELETE</b></tt> (Kermit makes no distinction
between DELETE and MDELETE); <tt><b>RDELETE</b></tt>.
<p>
<dt><tt><b>FTP TYPE</b> <i>{</i> <b>TEXT, BINARY, TENEX</b> <i>}</i></tt></dt>
<dd>Tells the FTP server to change its file-transfer type to the one given,
immediately.  See <a href="#setftptype">SET FTP TYPE</a> for details.
</dl>

<p>


<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.5">3.5. Uploading Files With FTP</a></h3>

Uploading means sending files from the client (Kermit) to the FTP server.  
The basic command for uploading files with FTP is PUT:
<p><dl>
<dt><tt><b>FTP PUT</b> <i>[ switches ] [ filespec [ as-name ] ]</i></tt></dt>
<dd>Uploads (sends) the file or files that match the file specification, which
may include wildcards, to the server.  If no filespec is given, the names
of files to send are taken from the /LISTFILE: file, if any, otherwise
from the SEND-LIST, if any.  Unless you go out of your way to prevent it,
Kermit determines the transfer mode (text or binary) for each file
automatically, and switches automatically on a per-file basis.  If an
as-name is given, the file is sent under that name instead of its own (if
an as-name is given with a wildcard filespec, the result is a bit more
complicated, and is explained later in this section).
</dl>
<p>
Unlike normal FTP clients, Kermit does not prompt you by default (or at all)
for each file; it just sends them, just as it does with Kermit protocol.
The <i>filespec</i> can be a literal filename or a Kermit pattern, described
in:
<p><pre>
  <a href="http://www.columbia.edu/kermit/ckermit70.html#x4.9">http://www.columbia.edu/kermit/ckermit70.html#x4.9</a>
</pre><p>
Kermit patterns are equivalent to C-Shell patterns and provide a fair amount
of flexibility in selecting which files to send, which is augmented by the
file-selection switches presented in <a href="#x3.5.1">Section 3.5.1</a>.
<p>
<dl>
<dt><tt><b>FTP MPUT</b> <i>[ switches ] filespec [ filespec [ ... ] ]</i></tt></dt>
<dd>FTP MPUT is just like FTP PUT except it allows you to give more than one
file specification, and it does not allow an as-name in the file list.
However, as-names can be given to either PUT or MPUT with the /AS-NAME:
switch.
</dl>
<p>
If a PUT or MPUT command results in one file being uploaded, it succeeds if
the file is uploaded completely and fails otherwise.  If more than one file
is selected for upload, success or failure depends on the
<a href="#erroraction">FTP ERROR-ACTION</a>
setting; if it is PROCEED (the default setting), then the [M]PUT command
succeeds if at least one of the files was completely uploaded, and fails
otherwise,  If FTP ERROR-ACTION is QUIT, the [M]PUT command succeeds if all
selected files were uploaded successfully, and fails if any file failed.
<p>
FTP uploads may be interrupted just like Kermit uploads.  While the transfer
is in progress, type:
<p><pre>
  X to interrupt the current file and go on to the next file.
  Z to cancel the current file and all remaining files.
  ^C (Control-C): Like Z, but might act more quickly.
</pre><p>
MPUT may be used as in regular FTP clients, but it is not required to send
multiple files; in Kermit it is required only if you want to give multiple
file specifications.  Examples:
<p><pre>
  ftp put oofa.txt               ; Send a single file oofa.txt
  ftp put oofa.txt budget.txt    ; Send single file oofa.txt as budget.txt
  ftp put *.txt                  ; Send all *.txt files
  ftp mput *.txt                 ; Send all *.txt files (same as "put *.txt")
  ftp mput *.txt foo.bar         ; Send all *.txt files plus foo.bar
</pre><p>
The distinction between PUT and MPUT is important only when more than one
filespec is given, just like the distinction between Kermit SEND and MSEND:
<p><pre>
  ftp put oofa.txt budget.txt    ; Send oofa.txt AS budget.txt
  ftp mput oofa.txt budget.txt   ; Send oofa.txt AND budget.txt
</pre><p>
If the source file specification includes any path segments, for example:
<p><pre>
  put /tmp/oofa.txt
  put subdir/another/andanother/oofa.txt
</pre>
<p>
the path portion is stripped from the filename that is sent to the server.
However, if an as-name contains a path, it is retained.  Examples:
<p><pre>
  ftp put /usr/doc/oofa.txt      ; Send as "oofa.txt".
  ftp put oofa.txt /tmp/oofa.txt ; Send as "/tmp/oofa.txt"
</pre>
<p>
The latter example sends the file <tt>oofa.txt</tt> from your current local
directory to the server's <tt>/tmp</tt> directory.  This works only if the
server uses the same directory notation that you used in the as-name AND the
given directory already exists on the server AND if you have write access to
it.
<p>
Use caution when uploading from a case-sensitive file system, such as UNIX, 
to a file system that is not case sensitive, such as Windows or VMS.  If
you have two files in UNIX, <tt>AA</tt> and <tt>aa</tt> and upload both of
them, the second one will overwrite the first.  The only way around this
provided by FTP protocol is its "unique server names" feature (SET FTP
UNIQUE-SERVER-NAMES or the /UNIQUE switch described below).

<p>
<hr>
<h4><a name="x3.5.1">3.5.1. FTP PUT Switches</a></h4>

FTP PUT and MPUT are similar in format and behavior to the regular Kermit
SEND and MSEND commands, and they allow most of the same optional switches:
<p><pre>
C-Kermit&gt;<u>ftp put ?</u> Filename, or switch, one of the following:
 /after:                 /larger-than:           /rename-to:
 /array:                 /listfile:              /server-character-set:
 /as-name:               /local-character-set:   /server-rename-to:
 /before:                /move-to:               /simulate
 /binary                 /nobackupfiles          /smaller-than:
 /command                /nodotfiles             /tenex
 /delete                 /nofollowlinks          /text
 /dotfiles               /not-after:             /transparent
 /error-action:          /not-before:            /type:
 /except:                /permissions:           /update
 /filenames:             /quiet                  /unique-server-names
 /filter:                /recover
 /followlinks            /recursive
</pre><p>

Since most of these switches are common to Kermit's SEND and MSEND commands,
they described only briefly here.  For greater detail see:
<p>
<tt>&nbsp;&nbsp;<a href="http://www.columbia.edu/kermit/ckermit70.html#x1.5">http://www.columbia.edu/kermit/ckermit70.html#x1.5</a></tt> (explanation of switches)<br>
<tt>&nbsp;&nbsp;<a href="http://www.columbia.edu/kermit/ckermit70.html#x4.7">http://www.columbia.edu/kermit/ckermit70.html#x4.7</a></tt> (file-transfer switches)
<p>
First the file-selection switches:
<p>
<dl>
<dt><tt><b>/AFTER:</b><i>date-time</i></tt></dt>
<dt><tt><b>/BEFORE:</b><i>date-time</i></tt></dt>
<dt><tt><b>/NOT-AFTER:</b><i>date-time</i></tt></dt>
<dt><tt><b>/NOT-BEFORE:</b><i>date-time</i></tt></dt>
<dd>Only send those files modified on or after or before the given date and
time.  These switches can be combined to select files modified between
two date/times.  Various date-time formats are accepted; if the date-time
contains spaces, it must be enclosed in braces or doublequotes.  See
<a href="http://www.columbia.edu/kermit/ckermit70.html#x1.6"><tt>http://www.columbia.edu/kermit/ckermit70.html#x1.6</tt></a>
and <a href="#x8.13">Section 8.13 of this document</a>
for details about date-time formats.
Examples:<br><pre>  ftp put /after:{1 jan 2000 0:00:00} *
  ftp put /after:-5days *
</pre><p>
<dt><tt><b>/LARGER-THAN:</b><i>number</i></tt></dt>
<dt><tt><b>/SMALLER-THAN:</b><i>number</i></tt></dt>
<dd>Only send files larger (smaller) than the given number of bytes
(octets).  These switches can be combined to select files in a
certain size range.
<p>
<dt><tt><b>/TYPE:</b><i>{</i><b>TEXT,BINARY</b><i>}</i></tt></dt>
<dd>Only send files that are the given type, which is determined for each
file just before sending it by file scanning.  BINARY includes TENEX; if you
have included a /TENEX switch, or previously given a [SET] FTP TYPE TENEX
command, binary files are sent in TENEX, rather than BINARY mode.
<p>
<dt><tt><b>/[NO]DOTFILES</b></tt></dt>
<dd>[Don't] include files whose names begin with dot (<tt>.</tt>).  By default,
such files are not included unless your filespec explicitly mentions
them.
<p>
<dt><tt><b>/NOBACKUPFILES</b></tt></dt>
<dd>Don't include files whose names end with <tt>.~<i>nnn</i>~</tt>, where
<i>nnn</i> is a number, e.g. <tt>oofa.txt.~27~</tt>.  These are backup files
created by Kermit, EMACS, and other applications.   By default, backup files
are included.
<p>

<dt><tt><b>/NOFOLLOWLINKS</b></tt></dt>
<dd>(UNIX only) Skip over symbolic links rather than following them
(default).  This applies to wildcard and/or recursive [M]PUTs; if a single
filename is given, and it happens to be a symbolic link, the file it points
to is sent.

<p>

<dt><tt><b>/FOLLOWLINKS</b></tt></dt>
<dd>(UNIX only) Always follow (resolve) symbolic links, even in wildcard or
recursive [M]PUTs.  Use with caution.  Watch out for circular
links, endless loops, etc.

<p>
<dt><tt><b>/EXCEPT:</b><i>pattern</i></tt></dt>
<dd>Exception list -- don't send files whose names match the given pattern.
See <a href="ckermi70.html#x1.5.4">Section 1.5.4</a>
of the <a href="ckermi70.html">C-Kermit 7.0 Update Notes</a>
for details.  If you want to exclude a directory from a recursive
<tt>[M]PUT</tt>, use <tt>/EXCEPT:{dirname/*}</tt>.
<p>
<dt><tt><b>/RECURSIVE</b></tt></dt>
<dd>Sends the desired files from the current (or given) directory, plus all
directories beneath it, including empty directories,
replicating the directory structure on the server.
No special capabilities are required in the server, but of course your
login ID on the server must have the appropriate access and permission to
create directories.  Recursive PUTs work not only between like platforms
(e.g. UNIX to UNIX) but also between unlike ones (e.g. UNIX to VMS or
Windows), in which case text-file format differences are handled by Kermit's
automatic text/binary mode switching
(<a href="#x4">Section 4</a>) and character-set
translation (<a href="#x3.7">Section 3.7</a>).  <i>Synonym:</i>
<tt><b>/SUBDIRECTORIES</b></tt>.
<p>
<dt><tt><b>/UPDATE</b></tt></dt>
<dd>Send only files that have changed since last time
(<a href="#x3.5.2">Section 3.5.2</a>).
<p>
<dt><tt><b>/ARRAY:</b><i>arrayname</i></b></tt></dt>
<dd>The "file" to be sent is an array, or a segment of one, rather than a
real file.  In this case the other selection switches don't apply.
The array contents are sent in text mode, and each array element is
treated as a line.  Example:
<pre>
  ftp put /as-name:array.txt /array:&a
</pre>
(or, to send a segment of the array, <tt>/array:&a[100:199]</tt>).  If you
don't include an /AS-NAME, a name of "<tt>_array_x_</tt>" is used (where x is
the array letter).  If you include this switch, most other switches are
meaningless and ignored.
<p>
<dt><tt><b>/COMMAND</b></tt></dt>
<dd>The "file" to be sent is the standard output of a command, rather than
a real file.  It is sent in text or binary mode according to the prevailing
FTP TYPE, which can be overridden with a /TEXT or /BINARY switch.  Example:
Example:
<pre>
  ftp put /command /as-name:{userlist} {finger | sort -r}
</pre>
<p>
<dt><tt><b>/LISTFILE:</b><i>filename</i></tt></dt>
<dd>Tells Kermit to obtain the list of files to be sent from the file whose
name is given.  This file must contain one file specification (which may
be wild) per line.  If the list includes files from different directories,
such as a recursive listing of a directory tree, the paths are recreated on
the server (if possible) if you include the <tt>/RECURSIVE</tt> switch;
otherwise all the files are sent to the current directory on the server.
</dl>
<p>
Now the other switches:
<p>
<dl>
<dt><tt><b>/AS-NAME:</b><i>text</i></tt></dt>
<dd>If a single file is being sent, send it with the given <i>text</i> as
its name.
If multiple files are being sent, the <i>text</i> must be a template that
includes variables such as <tt>\v(filename)</tt>, <tt>\v(filenumber)</tt>,
<tt>\v(ntime)</tt>, to allow dynamic creation of each name.  The same applies
to the as-name field of the FTP PUT command.  If this switch is not included
(and an as-name is not included as the second filename to PUT), each file is
sent with its own name.
<p>
<dt><tt><b>/BINARY</b></tt></dt>
<dt><tt><b>/TEXT</b></tt></dt>
<dt><tt><b>/TENEX</b></tt></dt>
<dd>Forces this upload to take place in the given mode, regardless of the
current FTP TYPE setting, and without automatic text/binary switching.
/ASCII is a synonym for /TEXT.
<p>
<dt><tt><b>/FILTER:</b><i>command</i></tt></dt>
<dd>Specifies that the file(s) is/are to be passed through the given
command or pipeline on their way to the server.  Example:
<p><pre>
  ftp put /binary /filter:{gzip -c \v(filename)} /as-name:\v(filename).gz *
</pre><p>
<dt><tt><b>/TRANSPARENT</b></tt></dt>
<dt><tt><b>/LOCAL-CHARACTER-SET:</b><i>name</i></tt></dt>
<dt><tt><b>/SERVER-CHARACTER-SET:</b><i>name</i></tt></dt>
<dd>Character-set translation for text files, explained in
<a href="#x3.7">Section 3.7</a>.
<p>
<dt><tt><b>/ERROR-ACTION:</b><i>{</i><b>PROCEED,QUIT</b><i>}</i></tt></dt>
<dd>Overrides the prevailing
<a href="#erroraction">FTP ERROR-ACTION</a> for the duration of this
PUT or MPUT command only.
<p>
<dt><tt><b>/RECOVER</b></tt></dt>
<dd>Resume an interrupted transfer where from the point of interruption
(explained in <a href="#x3.5.2">Section 3.5.2</a>).
<i>Synonym:</i> <tt><b>/RESTART</b></tt>.
<p>
<dt><tt><b>/DELETE</b></tt></dt>
<dd>Tells Kermit to delete each source file immediately after, and only if,
it has been uploaded completely and successfully.  This, in effect,
<i>moves</i> the file from the client to the server.
<p>
<dt><tt><b>/MOVE-TO:</b><i>directory</i></tt></dt>
<dd>Tells Kermit to move each source file to the named local directory after,
and only if, it has been uploaded completely and successfully.
<p>
<dt><tt><b>/RENAME-TO:</b><i>template</i></tt></dt>
<dd>Tells Kermit to rename each (local) source file according to the given
template after, and only if, it has been uploaded completely and successfully.
The template works as in /AS-NAME.
<p>
<dt><a name="srvrename"><tt><b>/SERVER-RENAME-TO:</b><i>template</i></tt></a></dt>
<dd>Tells Kermit to ask the server to rename each file according to the given
template as soon as, and only if, it has been received completely and
successfully.  The template works as in /AS-NAME.
Requires write and rename access on the server, so doesn't
usually work with (e.g.) anonymous uploads to public incoming areas where
the permissions don't allow renaming.  Examples:<p>
<dl>
<dt><tt>ftp mput /server-rename:\v(filename).ok *</tt></dt>
<dd>Appends "<tt>.ok</tt>" to each filename on the server when it's finished
uploading. 
<p>
<dt><tt>ftp mput /as-name:\v(filename).tmp /server-rename:\v(filename) *</tt></dt>
<dd>This is the reverse of the previous example; it uses a temporary name
while uploading is in progress and reverts the file to its real name when
uploading is complete.
<p>
<dt><tt>ftp mput /as-name:\v(filename) /server-rename:../final/\v(filename) *</tt></dt>
<dd>Moves the file from the working directory to a final
directory when the upload is complete,
but in this case you have to know the pathname syntax of the server.  If the
rename fails, the [M]PUT command fails according to the
<a href="#erroraction">FTP ERROR-ACTION</a> selection.
</dl>
<p>
<dt><tt><b>/FILENAMES:</b><i>{</i><b>AUTOMATIC,CONVERTED,LITERAL</b><i>}</i></tt></dt>
<dd>Overrides the <a href="#ftpfilenames">FTP FILENAMES</a> setting for this upload only.
<p>
<dt><a name="permswitch"><tt><b>/PERMISSIONS:</b><i>{</i><b>ON,OFF</b><i>}</i></tt></a></dt>
<dd>Overrides the
<a href="#ftpperms">FTP PERMISSIONS</a>
setting for this upload only.  
<p>
<dt><tt><b>/UNIQUE</b></tt></dt>

<dd>Tells Kermit to tell the server to give
<a href="#ftpunique">unique names</a> to incoming files that
would otherwise overwrite existing files that have the same name.  This
switch conflicts with /UPDATE, /RECOVER, /PERMISSIONS, and /SERVER-RENAME
since the client has no way of knowing the name assigned by the server.

<p>
<dt><tt><b>/QUIET</b></tt></dt>
<dd>Don't display file-transfer progress or statistics.
<p>
<dt><tt><b>/SIMULATE</b></tt></dt>
<dd>Shows which files would be sent without actually sending them.  Useful
(for example) with /UPDATE (next section).  The results are shown in the
file-transfer display (if it is not disabled) and in the transaction log
(if one is active).  Hint: use SET TRANSFER DISPLAY BRIEF.
</dl>

<p>
<hr>
<h4><a name="x3.5.2">3.5.2. Update Mode</a></h4>

When you include the /UPDATE switch, this means to skip sending any file that
already exists on the server if the local file's modification date/time is not
later than that of the corresponding file on the server.  Here is a typical
application for update mode: Suppose that on Computer A, you maintain a large
set of files (say, a collection of Web pages and graphics images, or the
source files for a software application), and you need to keep a parallel copy
on another Computer, B.  Of course you could upload the entire collection
every day:
<p><pre>
  cd <i>source-directory</i>
  ftp computerb.xyzcorp.com
  <i>( authentication details... )</i>
  ftp cd <i>target-directory</i>
  ftp put <i>[ switches ]</i> *
</pre><p>
But if the total size is large or the network slow, this would be
unnecessarily time-consuming.  Worse, if other users or sites had to update
whenever new files appeared in B's directory, this would cause them
unnecessary work.  By including the /UPDATE switch:
<p><pre>
  ftp put /update <i>[ other-switches ]</i> *
</pre><p>
only those files that changed since last time are uploaded.  Here's how it
works.  For each local file that is selected for uploading:
<p><ul>
<li>The remote filename is determined in the normal way, according to
the <a href="#ftpfilenames">FTP FILENAMES</a>
setting, /FILENAMES switch, or the as-name, if any.
<p>
<li>Kermit sends an MDTM (modification time) command for the corresponding
remote filename to the server.
<p>
<li>If the server does not understand the MDTM command, the file is sent.
<p>
<li>If the server can't find a file with the given name, the file is sent.
<p>
<li>If the local file's modification time is later than that of the remote
file, the file is sent.
<p>   
<li>Otherwise -- the remote file exists but its modification time is equal
to or earlier than that of the local file -- the file is skipped.
</ul><p>
All time comparisons take place in Coordinated Universal Time
(UTC)(<a href="#note_utc">1</a>), also
known as GMT or Zulu time: Timezone 0; standard time, without daylight savings.
<p>
<blockquote>
WARNING: Some FTP servers, such as Novell <tt>NWFTPD.NLM</tt>, ignore or
misimplement the FTP specification and send local time rather than UTC.
</blockquote>
<p>

Update mode is useful only when always used in the same direction.  When you
upload (PUT) a file with FTP, the destination file receives the current
timestamp on the server's computer, not the original file's timestamp (<a
href="#note_date">2</a>).  If you try to FTP PUT /UPDATE the same file again,
it will be skipped (as expected) since the remote copy is newer.  However, if
you try to FTP GET /UPDATE the same file (<a href="#x3.6">Section 3.6</a>), it
will be transferred for the same reason.

<p>

To check the availability of PUT /UPDATE on a particular connection, issue an
FTP MODTIME command for a file that is known to exist on the server.  If it
succeeds, PUT /UPDATE should work and in that case, you can run a procedure
like the one above every day: the first time, it sends all the files; after
that, it sends only the ones that changed.
If a transaction log is active, a notation is included for any files that
are skipped.
<p>
<i>Notes:</i>
<ol>
<li><a name="note_utc">
Why is Coordinated Universal Time abbreviated UTC?</a>  From the
<a href="http://www.boulder.nist.gov/timefreq/faq/faq.htm#10:">
National Institute of Standards and Technology FAQ</a>:
"In 1970 the Coordinated Universal Time system was devised by an
international advisory group of technical experts within the
International Telecommunication Union (ITU).  The ITU felt it was
best to designate a single abbreviation for use in all languages in
order to minimize confusion.  Since unanimous agreement could not be
achieved on using either the English word order, CUT, or the French
word order, TUC, the acronym UTC was chosen as a compromise."
<p>
<li><a name="note_date">The Kermit FTP client is unusual in that, when
downloading only, it can set the received file's date from the file's date
on the server, but this should not affect the update feature.  When uploading
to an FTP server, however, there is no mechanism for the client to set the
date of the uploaded file on the server.
</ol>
<p>
<hr>
<h4><a name="x3.5.3">3.5.3 Recovery</a></h4>

Suppose that while you are uploading a large file over a slow connection, the
connection is lost before the entire file is transferred.  With most FTP
clients, you would have to start over, thus resending the portion of the file
that was sent already, and that is already on the server.  But Kermit's
/RECOVER switch (<i>Synonym:</i> /RESTART) lets you continue an interrupted transfer
from the point of failure, thus transferring only the part that wasn't sent
already.  The prerequisites for recovery are:
<p><ul>
<li>The transfer must be in BINARY mode, or else the client and server must
   reside on like systems (e.g. both on some form of UNIX).
<p>
<li>The FTP server must support the SIZE command.
</ul><p>
Here's how it works.  When you include the /RECOVER switch:
<p><ul>
<li>Kermit checks for conflicting switches, such as /UPDATE and /UNIQUE;
   if /RECOVER is given with these switches an error occurs.  If /RECOVER
   is given in other circumstances where it could serve no useful purpose
   (e.g. with arrays, pipes, or filters), it is ignored.
</ul><p>
If the switch is accepted, then for each selected file:
<p><ul>
<li>If it is not binary (determined by scanning) and the client and server
   are not on like platforms, recovery is canceled (the entire file is sent).
   Otherwise:
<p>
<li>A SIZE command is sent for the file (using its remote name).  If the
   reply indicates the file was not found, or the SIZE command was not
   understood, or any other kind of error, recovery is canceled.  Otherwise:
<p>
<li>A MDTM (modification time) command is sent for the file.  If a valid
   reply is received, and the modification time of the local file is later
   than that of the remote file, recovery is canceled.  Otherwise:
<p>
<li>If the sizes of the two files are identical, the file is not sent.
   Otherwise:
<p>
<li>Kermit seeks to the recovery spot in the local file, tells the server
   to APPEND the data which is about to arrive to the remote file, and then
   sends the data starting at the recovery point.
</ul><p>
To safeguard file integrity, recovery is not attempted unless all the
preconditions are met.  For the widest possible usefulness, APPEND is used
rather than RESTART.  For stream transfers (the only kind that Kermit
supports) the results are the same.
<p>
By design, the /RECOVER switch can be included with any FTP PUT or MPUT
command, even if it specifies a group of files.  This allows you to resume
an interrupted batch transfer from where it left off.  The files that were
already completely sent are skipped, the file that was interrupted is
recovered, and the remaining files are uploaded.
<p>
By the way, it doesn't matter how the original partial file was uploaded --
FTP, Kermit, Zmodem, etc: as long as the preconditions are met, it can be
recovered with FTP PUT /RECOVER, or for that matter also using Kermit
protocol and SEND /RECOVER.
<p>
A word of caution, however, when the original upload was in text mode with
character-set translation (<a href="#x3.7">Section 3.7</a>):
<p><ul>
<li>If the original upload involved a translation from one single-byte
character set to another (e.g. Code Page 850 to Latin-1), recovery is
safe if you specify the same translations for the recovery.  If you don't,
the resulting file will contain a mixture of character sets.
<p>
<li>If the original upload involved a translation that changed the size
of the file (e.g. from an alphabetic Code Page or Latin Alphabet to
Unicode, or vice versa), recovery is NOT safe, even if you specify
the same translations.
</ul><p>
Kermit has no way of knowing anything about the previous upload.  As a
safeguard, an error occurs if you include /RECOVER and also specify a
character-set of UCS2 or UTF8, since recovery can't possibly work in that
situation.  Otherwise, it's up to you to avoid unsafe recovery operations.
<p>
<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.6">3.6. Downloading Files With FTP</a></h3>

Although uploading files with Kermit's FTP client is just as easy and flexible
as sending files with Kermit protocol, the same is not always true for
downloading because FTP servers lack some of the capabilities of a Kermit
server:

<p>
<ul>

<li>If you want to get more than one file, you have to use MGET, not GET,
since the underlying FTP protocol is different in the two cases.  Kermit
can't "autodetect" which one you mean, as it can with PUT and MPUT,
since it can't be expected to know the wildcard syntax of the remote
platform and/or FTP server (the same is true for all other FTP clients).
<font color="red">To complicate matters, FTP protocol now includes two
underlying mechanisms (NLST and MLSD) for accomplishing MGET operations
and, as explained in <a href="#x3.11">Section 3.11</a>, the two behave
differently.</font>

<p>

<li>Automatic text-binary mode switching is not done by the server.  It can
be done by the client (Kermit), but in this case it is not based on a file
scan (since there is no way for Kermit prescan a server file), but rather
on the filename, using C-Kermit 7.0
<a href="ckermi70.html#x4.3">filename patterns</a>.

<p>

<li>Some options that are available with FTP PUT can not be used with FTP
[M]GET or don't work the same way:
<p>
&nbsp;&nbsp;<tt>/PERMISSIONS</tt> (FTP protocol has no mechanism for this).<br>
&nbsp;&nbsp;<tt>/[NOT-]BEFORE</tt>, <tt>/[NOT-]AFTER</tt> (because of the timezone problem).<br>
&nbsp;&nbsp;<tt>/RECOVER</tt> works only in binary mode.
&nbsp;&nbsp;<tt>/RECURSIVE</tt> has limited utility.
</ul>
<p>
The commands for downloading are:
<p>
<dl>
<dt><tt><b>SET FILE DOWNLOAD-DIRECTORY</b> <i>[ directory ]</i></tt></dt>
<dd>As with Kermit transfers, this command, if given, tells C-Kermit where to
store incoming files in the absence of a specific as-name.  If not given,
incoming files are stored as indicated by the as-name, if any, otherwise
in the current directory, just as with Kermit transfers.  The more verbose
transfer display formats give the full pathname of each received file, and,
in case you have trouble finding a downloaded file afterwards, its full path is
also listed in the transaction log (if you kept one), and you can also ask
Kermit where it went with the
<a href="http://www.columbia.edu/kermit/ckermit70.html">WHERE</a> command.

<p>

<dt><tt><b>SET FTP GET-FILETYPE-SWITCHING</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>

<dd>ON by default, causing Kermit to switch automatically into text or binary
mode for each file based on whether its name matches a text pattern or binary
pattern.  Set this OFF, or use a /TEXT, /BINARY, or /TENEX switch to defeat
this feature.  Use SHOW PATTERNS to see the current pattern list.

<p>

<dt><tt><i>[</i> <b>FTP</b> <i>]</i> <b>GET</b> <i>[ switches ] filename [ as-name ]</i></tt></dt>

<dd>Asks the server to send the given file, and if it comes, stores it locally
under the given as-name, if any, otherwise under its original name (modified
according to the selected filename conversion option), in your download
directory, if you have specified one, otherwise in the directory indicated in
the as-name, if any, otherwise in your current directory.  If you accidentally
use a wildcard in the filename ("<tt>get</tt> <tt>*.txt</tt>") the server will
reply with a message like "File not found" (unless there is a file whose name
actually is "<tt>*.txt</tt>").  If FTP GET-FILETYPE-SWITCHING is ON, and in
the absence of any GET switches to override it, the file is transferred in
binary mode if it matches any of Kermit's binary name patterns, and in text
mode if it matches any of Kermit's text name patterns, and in the prevailing
FTP TYPE if it matches none of these patterns.

<p>

<dt><tt><i>[</i> <b>FTP</b> <i>]</i> <b>MGET</b> <i>[ switches ] filespec [ filespec [  filespec [ ... ] ] ]</i></tt></dt>

<dd>Like GET, but for multiple files.  One or more file specifications can be
given, and any or all (or none) of them can contain wildcards <font
color="red">or can be directory names</font>.  The file list may not include
an as-name, but you can still give one with the /AS-NAME: switch.

</dl>
<p>

In both the FTP GET and MGET commands, any filenames that contain spaces
must be enclosed in braces or doublequotes (see <a href="#x5">Section 5</a>
for details).
<p>
FTP downloads may be interrupted just like Kermit transfers.  While the 
transfer is in progress, type:
<p><ul>
<li><tt><b>X</b></tt> to interrupt the current file and go on to the next file.
<li><tt><b>Z</b></tt> (or Control-C) to cancel the current file and all
remaining files.
</ul>
<p>
Before proceeding, a brief word about <i>temporary files</i>.  In FTP
protocol, the MGET command works by requesting a file list from the server,
and then (internally) issuing a GET command (FTP RETR protocol directive)
for each file.  The file list
returned by the server can be any size at all, so in case it is huge, we don't
store it in memory; instead we put it in a temporary file.  For
troubleshooting purposes, you should be aware of two points:
<p>
<ol>
<li>The location of the temporary file is chosen according the TMP or TEMP
environment variables.  If neither of these variables is defined, you might
need to define it.  In case there is not enough space on the indicated
disk or partition for the server's file list, you might need to either clean
up the temporary area, or redefine the environment variable to indicate a
different area that has sufficient space.
<p>
<li>If you want to look at the list yourself, use SET FTP DEBUG ON.  This
tells Kermit to <i>(a)</i> give you the full pathname of the temporary file
at the end of each MGET command, and <i>(b)</i> not to delete it, as it
normally does.
</ol>

<p>
<hr>
<h4><a name="x3.6.1">3.6.1. FTP GET Switches</a></h4>

The following switches are available with FTP GET and MGET:
<p>
<dl>
<dt><tt><b>/TEXT</b></tt></dt>
<dd>Specifies a text-mode transfer.  Overrides the global FTP TYPE setting
and filename pattern-matching for the duration of the current command only, 
All files are downloaded in text mode.  <i>Synonym:</i> <tt><b>/ASCII</b></tt>.
<p>
<dt><tt><b>/BINARY</b></tt></dt>
<dd>Specifies a binary-mode transfer.  Overrides the global FTP TYPE setting
and filename pattern-matching for the duration of the current command only.
All files are downloaded in binary mode.
<p>
<dt><tt><b>/TENEX</b></tt></dt>
<dd>Like /BINARY but
specifies a special binary transfer mode to be used when getting 8-bit
binary files from a 36-bit platform such as TOPS-10, TOPS-20, or TENEX.
All files are downloaded in the special binary mode.
<p>

<dt><tt><b>/RECOVER</b></tt></dt>
<dd>This instructs Kermit to try to recover an incomplete download from the
point of failure.  Works only in binary mode, and only if the server
supports the (not-yet-standard) FTP "REST" directive.  See
<a href="#x3.6.3">Section 3.6.3</a>
for details.  <i>Synonym:</i> <tt><b>/RESTART</b></tt>.
<p>
<dt><tt><b>/FILENAMES:</b><i>{</i><b>CONVERTED,LITERAL</b><i>}</i></tt></dt>
<dd>Overrides the <a href="#ftpfilenames">FTP FILENAMES</a>
(filename conversion) setting for this download only, forcing incoming
filenames to be either converted or taken literally.
<p>
<dt><tt><b>/AS-NAME:</b><i>text</i></tt></dt>
<dd>For GET, this is equivalent to giving an as-name after the filename.
For MGET, this is the only way to specify alternative names for the incoming
files.  With MGET, the /AS-NAME text should (must) contain a Kermit variable,
usually <tt>\v(filename)</tt> or <tt>\v(filenumber)</tt>.  Example:
<p><pre>
  mget /text /as-name:\v(filename).new *.c
</pre><p>
This gets all "<tt>.c</tt>" files and stores them with "</tt>.new</tt>"
appended to their names.
See the <a href="ckermi70.html#x4.1">C-Kermit 7.0 Update Notes</a>
for details.
<p>
<dt><tt><b>/COMMAND</b></tt></dt>
<dd>This specifies that the incoming file is to be written to the standard
input of a command, rather than to a file.  The command name is the as-name
from the GET command or the /AS-NAME argument.  If you need to refer to the
incoming file's name in the command, use <tt>\v(filename)</tt>.  See the
description of the regular Kermit 
<a href="ckermi70.html#x4.2.2">GET /COMMAND</a>
command for details and examples.
<p>
<dt><tt><b>/QUIET</b></tt></dt>
<dd>Transfers the files quietly; don't put up a file-transfer display.
<p>
<dt><tt><b>/ERROR-ACTION:</b><i>{</i><b>QUIT,PROCEED</b><i>}</i></tt></dt>
<dd>This switch affects only MGET.  If an error occurs with a particular file,
this tells whether to go on to the next file (PROCEED) or to stop right
away and fail (QUIT).  The default is PROCEED.
</dl>
<p>
The <b>file selection</b> switches are:
<p>
<dl>
<dt><tt><b>/EXCEPT:{</b><i>pattern</i><b>}</b> <i>or</i>
<b>/EXCEPT:{{</b><i>pattern</i><b>}{</b><i>pattern</i><b>}{...}}</b></tt></dt>
<dd>Exception list for MGET; skip downloading any file whose name matches
any of the given patterns (when using the second format, up to 
<font color="red">64</font> patterns may be specified).
<a href="ckermi70.html#x1.5.4">CLICK HERE</a> for syntax details.
<p>
<dt><tt><b>/SMALLER-THAN:</b><i>number</i></tt></dt>
<dd>Download only files whose size is smaller than the given number of bytes
(octets).  Requires that the FTP server support the SIZE or MLSD directive.
<p>
<dt><tt><b>/LARGER-THAN:</b><i>number</i></tt></dt>
<dd>Download only files whose size is greater than the given number of bytes.
Requires that the FTP server support the SIZE or MLSD directive.
<p>
<dt><tt><b>/NOBACKUPFILES</b></tt></dt>
<dd>During MGET, don't download any files whose names end with backup suffixes
(<tt>.~<i>n</i>~</tt> where <i>n</i> is a number).

<p>

<dt><tt><b>/NODOTFILES</b></tt></dt>

<dd>During MGET, don't download any files whose names begin with period
(<tt>.</tt>).   Equivalent to <tt>/EXCEPT:{.*}</tt>.

<p>

<dt><tt><b>/LISTFILE:</b><i>local-filename</i></tt></dt>
<dd>The given file contains a list of files to GET, one per line.  Filenames
in the listfile can contain wildcard characters in the syntax of the
server.  There is no limit on the number of lines in the listfile.

<p>

<dt><tt><b>/NAMELIST:</b><i>local-filename</i></tt></dt>
<dd>If this switch is given, then instead of actually retrieving the selected
files, the GET command retrieves a list of the names of the files that would
be retrieved, and places it in the specifed file.  The resulting file is an
ordinary text file, with one filename per line, suitable for reading by a
person, or processing by a computer program, including Kermit itself (FOPEN /
FREAD / FWRITE / FCLOSE), and as /FILELIST: file.  If the filename is omitted
or given as "<tt>-</tt>" (dash, hyphen), the list goes to the screen.  NOTE:
if you want a copy of the <i>complete</i> list sent by the server, use
SET FTP DEBUG ON, perform an MGET, and the temporary file containing the list
will be kept rather than deleted (and Kermit tells you its name).
<p>
<dt><tt><b>/UPDATE, /COLLISION:</b><i>keyword</i></tt></dt>
<dd>Explained in <a href="#x3.6.2">Section 3.6.2</a>.

<p>

<dt><tt><b>/RECURSIVE</b></tt></dt>

<dd>This means to try to download an entire directory tree, rather than just
files from a particular directory.  In fact, FTP protocol does not provide
a method to request a recursive download
<font color="red">(unless the server supports MLSD;
see <a href="#x3.11">Section 3.11</a>)</font>, so this works only if the FTP
server does it anyway, without being asked, as some do.  In this case, Kermit
detects that names in the returned file list contain directory separators, and
therefore attempts to create the needed directories as the files arrive.  But
this can work only if the server is on the same kind of platform as the
client, so the pathname syntax can be recognized, and also because the server
does not switch between text and binary mode, which would be vital for
cross-platform transfers.  Use with caution.  <i>Synonym:</i>
<tt><b>/SUBDIRECTORIES</b></tt>.

<p>
<font color="red">

Even when the server does not provide recursive file lists, [M]GET /RECURSIVE
forces Kermit to replicate any directory structure implied or expressed by
the server's file list.  For example:

<p><pre>
  get somepath/somefile
</pre><p>

Gets the file named <i>somefile</i> from the server's <i>somepath</i>
directory and puts it Kermit's current (or download) directory, whereas:

<p><pre>
  get /recursive somepath/somefile
</pre><p>

creates the path locally and then puts the file in it.  Similarly for MGET:

<p><pre>
  mget */data/*
</pre><p>

downloads all the files in all the <i>data</i> subdirectories of all the
subdirectories of the server's current directory and stores them locally
in Kermit's current (or download) directory, whereas:

<p><pre>
  mget /recursive */data/*
</pre><p>

re-creates the server's directory structure locally.

</font>
</dl>
<p>

The FTP protocol does not include explicit mechanisms for recursion, so Kermit
builds upon what is available.  Although an Internet draft describes a
mechanism ("MLSD") that would allow protocol-driven recursion, similar to
Kermit's File Attribute packets (circa 1984), it has not yet attained RFC or
standard status, and servers are not yet widely available that offer this
feature.  In the meantime, the effectiveness of <tt>MGET /RECURSIVE</tt>
depends on the FTP server implementation.  If the server returns a recursive
list in response to the standard NLST command (whose behavior is ill-defined),
Kermit's FTP MGET /RECURSIVE command uses it to re-create the remote directory
tree locally.  

<font color="red">If the server supports MLSD, C-Kermit 8.0.206 and Kermit 95
2.1 and later are able to sense it automatically and use it, as described
below in <a href="#x3.11">Section 3.11</a>.</font>

<p>

The <tt>/BEFORE:</tt>, <tt>/AFTER:</tt>,
<tt>/NOT-BEFORE:</tt>, and <tt>/NOT-AFTER:</tt> switches are not available for
downloading because of the confusion with timezones.
Would the given times be in the local timezone, the server's timezone, or GMT?
The FTP server's directory listings show its own local times but since we
don't know what timezone the server is in, there's no way to reconcile our
local times with the server's.
Similarly, <tt>/PERMISSIONS</tt> can't be preserved in downloads because FTP
protocol provides no means of querying the server for a file's permission.

<p>
<b>Source-file disposition switches:</b>
<p>
<dl>
<dt><tt><b>/DELETE</b></tt></dt>
<dd>Each file that is downloaded successfully is to be deleted from the server.
Requires the appropriate file access rights on the server.
<p>
<dt><tt><b>/SERVER-RENAME-TO:</b><i>template</i></tt></dt>
<dd>Asks the server to rename each (remote) source file immediately after,
and only if, it is sent correctly.  See
<a href="#srvrename">PUT /SERVER-RENAME-TO:</a> for details.
</dl>
<p>
<b>Destination-file disposition switches:</b>
<p>
<dl>
<dt><tt><b>/TO-SCREEN</b></tt></dt>
<dd>Displays the incoming file on the screen rather than storing it on disk.
If this switch is given, the /RENAME-TO and /MOVE-TO switches are ignored,
the file-transfer display is suppressed, and the given file(s) is/are
shown on the screen.  Can be used with /FILTER, e.g.
<p><pre>
  get /text /to-screen /filter:more oofa.txt
</pre><p>
In fact, you should always use /TO-SCREEN with /FILTER or /COMMAND when 
the command would result in displaying the incoming file on the screen;
otherwise C-Kermit would have no way of knowing to suppress its file
transfer display (since it can't be expected to know what the command
or filter does).
<p>
<dt><tt><b>/RENAME-TO:</b><i>template</i></tt></dt>
<dd>Each file that is downloaded is to be renamed as indicated if and only if
it was received completely and without error.  The template can be literal text
or can contain variables that are evaluated for each file.  For MGET, the
text must contain variables; for GET it can be a literal string.  The
<tt>\v(filename)</tt> variable contains the name of the current file, so:
<p><pre>
  ftp mget /rename-to:\v(filename).ok *
</pre>
<p>
causes each file that is successfully downloaded to have "<tt>.ok</tt>"
appended to its name.  For details see
<a href="ckermi70.html#x4.1">Section 4.1</a> of the
<a href="ckermi70.html">C-Kermit 7.0 Update Notes</a>.

<p>
<dt><tt><b>/MOVE-TO:</b><i>text</i></tt></dt>
<dd>Just like <tt>/RENAME-TO:</tt>, except the text denotes the name of a
directory to which successfully downloaded files are to be moved.  If the
directory does not exist, it is created.
<p>
</dl>
<p>
The file transfer display does not show the /MOVE-TO or /RENAME-TO value,
since the incoming file has not yet been moved or renamed.

<p>
<hr>
<h4><a name="x3.6.2">3.6.2. Filename Collisions</a></h4>

What should happen if an incoming file has the same name as an existing file
in the same directory?  By default, Kermit's FILE COLLISION setting applies:
BACKUP, RENAME, UPDATE, DISCARD, etc, as described in
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>.
Kermit's default FILE COLLISION setting is BACKUP (rename the existing file
and store the incoming file under its own name) and therefore this is also the
default FTP collision action.
<p>
The name under which an incoming file is to be stored is determined as
follows:
<p><ul>
<li>If an as-name was given, the as-name is used.  Otherwise:
<p>
<li>If the client and server platforms are alike or 
<a href="#ftpfilenames">FTP FILENAMES</a> is set to
LITERAL (or the /FILENAMES:LITERAL switch was given for this download),
the incoming filename is used literally.  Otherwise:
<p>
<li>The incoming filename is converted to a form that is friendly to the
local platform.  For UNIX, for example, incoming filenames that are all
uppercase (as they might be from, say, VMS or an IBM mainframe) are
converted to lowercase.
</ul><p>
If the resulting name coincides with the name of a local file that already
exists, we have a filename collision.  Collisions are handled according to
the currently selected collision action:
<p>
<dl>
<dt><tt><b>SET FTP COLLISION</b> <i>{</i> <b>BACKUP, RENAME, UPDATE, DISCARD, APPEND, OVERWRITE</b> <i>}</i></tt></dt>
<dd>This establishes a filename collision for FTP, separate from the Kermit
one.  The initial FTP collision setting is inherited from Kermit's FILE
COLLISION setting when the first FTP command is given, but subsequent changes
to Kermit's FILE COLLISION setting do not affect the FTP COLLISION setting.
SHOW FTP tells the current FTP COLLISION setting.
<p>
<dt><tt><b>FTP GET /COLLISION:</b><i>{</i><b>BACKUP,RENAME,UPDATE,DISCARD,APPEND,OVERWRITE</b><i>}</i></tt></dt>
<dd>Overrides the current FTP COLLISION action for this download only.
<p>
<dt><tt><b>FTP GET /UPDATE</b></tt></dt>
<dd>This is equivalent to GET /COLLISION:UPDATE, and is included for symmetry
with PUT /UPDATE
</dl>
<p>
FTP GET /UPDATE and /COLLISION:UPDATE mean to download only those files whose
modification dates on the server are later than those on the client.
Date-time comparisons are done in Coordinated Universal Time (UTC, GMT, ZULU).
<font color="red">The command:
<p>
<blockquote>
<tt>FTP MGET /COLLISION:APPEND /AS-NAME:<i>newfilename</i> *.*</tt>
</blockquote>
<p>
Downloads all matching remote files into a single local file (in whatever
order the server sends them).

</font>
<p>

<hr>
<h4><a name="x3.6.3">3.6.3. Recovery</a></h4>

Recovery is available for downloads too, but there are some differences from
the uploading case described in <a href="#x3.5.3">Section 3.5.3</a>:
<p><ul>
<li>The transfer must be in BINARY mode.  It can not be in text mode, even
if the FTP server is on the same kind of platform as Kermit, and even
if there is no character-set translation.  The original download must also
have been in binary mode.
<p>

<li>The FTP server must support the REST ("restart") directive.  Unfortunately,
this is not a standard command; at this writing, it is described only in
an Internet Draft, not an RFC or Internet Standard, but nevertheless it is
found in several popular FTP servers, such as
<a href="http://www.proftpd.net/">ProFTPD</a>.

</ul>
<p>

Here's how download recovery works:
<p><ul>
<li>Kermit checks for conflicting switches, such as /UPDATE, /COMMAND, or
/FILTER.  If /RECOVER is given with these switches an error occurs.
<p>
<li>The prevailing transfer mode (SET FTP TYPE) must be BINARY.  If it is not,
the /BINARY switch must have been included with the FTP [M]GET command.
</ul>
<p>
If the /RECOVER switch is accepted, then for each selected file:
<p><ul>
<li>A SIZE command is sent for the file (using its remote name).  If the
reply indicates the file was not found, or the SIZE command was not
understood, or any other kind of error, recovery is canceled (i.e. the
entire file is downloaded).
<p>
<li>If the sizes of the two files are identical, the file is not sent.
Otherwise:
<p>
<li>Kermit sends the REST directive to the server, indicating the size of the
local file.  If the server responds affirmatively, Kermit opens the local
file in append mode and appends the incoming data to it.  Otherwise,
recovery is canceled and the entire file is downloaded.
</ul>
<p>

The /RECOVER switch can be included with any FTP GET or MGET command, even if
it specifies a group of files.  This lets you resume an interrupted batch
transfer from where it left off.  The files that were already completely sent
are skipped, the file that was interrupted is recovered, and the remaining
files are uploaded.  BUT... unlike with uploading, where this can be done with
any mixture of text and binary files, when downloading, it can only be done if
all the files are binary.
<p>
It doesn't matter how the original partial file was downloaded -- FTP, Kermit,
HTTP, Zmodem, etc: as long as the preconditions are met, it can be recovered
with FTP [M]GET /RECOVER, or for that matter also with GET /RECOVER (using
Kermit protocol).
<p>
<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.7">3.7. Translating Character Sets</a></h3>

A possibly unique feature of Kermit's FTP client is its ability to convert
character sets when transferring files in text mode, independent of the
capabilites of the FTP server, as well as to translate the character sets of
filenames regardless of transfer mode.  For compatibility with existing FTP
clients, and because there is a certain performance penalty, Kermit won't do
this unless you ask for it.  If you enable this feature, you need to inform
Kermit of the character set (to be) used on the server and in some cases
(explained below) also the local file character set.  This discussion assumes
you know a bit about character sets (as you must if you have to use them);
see Chapter 16 of <a href="ckb2.html"><cite>Using C-Kermit</cite></a>
for a detailed treatment.  The Kermit commands for FTP character-set conversion
are:
<p>
<dl>
<dt><tt><b>SET FTP CHARACTER-SET-TRANSLATION</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>
<dd>Whether to translate character sets when transferring text files with FTP.
OFF by default.  Set this to ON to enable character-set translation
for subsequent FTP uploads and downloads.
<p>
<dt><tt><b>SET FTP SERVER-CHARACTER-SET</b> <i><a href="http://www.columbia.edu/kermit/ckcsets.html">name</a></i></tt></dt>
<dd>Text character set (to be) used by the server.  Most FTP servers are
ignorant of character sets, so all translations are done unilaterally by
Kermit's FTP client.  This means that when downloading files, you must know in
advance the character-set used in the files you are downloading (and in their
names).  When uploading, you must specify the character-set to which local
filenames and text-file contents are to be translated for transmission to the
server.  If you SET FTP CHARACTER-SET-TRANSLATION ON but do not specify an FTP
SERVER-CHARACTER-SET, <a href="http://www.columbia.edu/kermit/unicode.html">
UTF8</a> is used, since this is the new Internet standard international
character set; it is upwards compatible with ASCII and it encompasses most
written languages and therefore does not favor any particular group of people,
as any other default would do.  If you SET FTP SERVER-CHARACTER-SET to
something (anything) when FTP CHARACTER-SET TRANSLATION is OFF, this also sets
the latter ON.

<p>
<dt><tt><b>SET FILE CHARACTER-SET</b> <i><a href="http://www.columbia.edu/kermit/ckcsets.html">name</a></i></tt></dt>
<dd>This is the regular Kermit (non-FTP-specific) command for identifying the
character set (to be) used in local text files and filenames.
</dl>
<p>
<i>TO REITERATE:</i><tt> </tt> If you SET FTP CHARACTER-SET TRANSLATION
ON but do not specify an FTP SERVER-CHARACTER-SET, <b>outbound text files are
converted to UTF-8 and inbound text files are assumed to be UTF-8.</b>  If
this is not appropriate, be sure to also specify the desired FTP
SERVER-CHARACTER-SET.
<p>

You can use "special" (non-ASCII) characters in filenames in all the
client&nbsp;/ server file management commands (FTP MKDIR, RMDIR, DIRECTORY,
VDIRECTORY, DELETE, etc), and also in file-transfer commands.  When giving
commands such as FTP DIR (RDIR) and FTP PWD (RPWD), the reply is translated
too, so you can read it.  In this example, the client and server use entirely
different codes to represent the special characters of German:
<p>
<pre>
  C-Kermit&gt; <u>ftp xyzcorp.de /anonymous</u>
  C-Kermit&gt; <u>set ftp server-character-set latin1</u>
  C-Kermit&gt; <u>set file character-set german</u>
  C-Kermit&gt; <u>rcd St&auml;dte</u>
  C-Kermit&gt; <u>rpwd</u>
  "/pub/ftp/St&auml;dte is current directory"
  C-Kermit&gt; <u>rdir</u>
  -rw-rw----  1 olaf     54018 Jan  6 17:58 Adenb&uuml;ttel.txt
  -rw-rw----  1 ursula     373 Jan  5 15:19 A&szlig;lar.txt
  -rw-rw----  1 gisbert    482 Jan  5 15:20 Blowatz.txt
  -rw-rw----  1 gudrun     124 Jan  5 15:19 B&ouml;blingen.txt
  -rw-rw----  1 olga     14348 Jan  7 14:23 K&ouml;ln.txt
</pre>
<p>

When the client and server file systems use different character sets, you
should take care to use only those characters that the two sets share in
common when creating filenames or text-file contents.  For example, PC code
pages contain a lot line- and box-drawing characters, and sometimes "smart
quotes", etc, that are not found in ISO standard 8-bit character sets.  You
should be especially careful to avoid using such characters in filenames.

<p>
[ <a href="http://www.columbia.edu/kermit/ckcsets.html">C-Kermit Character Sets</a> ]
<hr>
<h4><a name="x3.7.1">3.7.1. Character Sets and Uploading</a></h4>

Kermit's PUT and MPUT commands include full file-scanning capabilities, as
described in 
<a href="#x4">Section 4</a>.
Thus if FTP CHARACTER-SET-TRANSLATION is ON and your
character-set associations are set up appropriately, Kermit automatically
switches on a per-file basis between text and binary mode, and for each text
file between your chosen 7-bit text character set (e.g. ASCII or ISO 646
German), 8-bit text (e.g. Latin-1 or Japanese EUC), UCS-2, and UTF-8, and
converts each of these automatically to the server character-set, and
furthermore automatically differentiates between the Little and Big Endian
forms of UCS-2, always sending in Big Endian form.
<p>
<blockquote>
WARNING: It is not advisable to use UCS-2 (or any Unicode transformation other
than UTF-8) "on the wire", i.e. as a server character set.  Most FTP servers
are not able to cope with it, since it contains lots of 0 (NUL) characters.
If you do use it, Kermit does <i>not</i> translate filenames to or from UCS-2,
for reasons well known to C programmers (for example, UNIX APIs assume
filename strings are NUL-terminated).  <a
href="http://www.columbia.edu/kermit/utf8.html">UTF-8</a> is the
preferred (and standard) Unicode format for the Internet.
</blockquote>
<p>
FTP character-set translations differ from the regular Kermit ones by not
restricting translations to a file-character-set&nbsp;/ transfer-character-set
pair.  You can have Kermit's FTP client translate between any pair of
character sets it knows about.  You can see the list of supported character
sets by typing either of the following:
<p><pre>
  set ftp server-character-set ?
  set file character-set ?
</pre><p>
A typical list looks like this (<a
href="http://www.columbia.edu/kermit/ckcsets.html">CLICK HERE</a> for 
an explanation of the names):
<p><pre>
  C-Kermit&gt;<u>set file char ?</u> One of the following:
   ascii            cp869-greek       hebrew-7         mazovia-pc
   british          cyrillic-iso      hebrew-iso       next-multinational
   bulgaria-pc      danish            hp-roman8        norwegian
   canadian-french  dec-kanji         hungarian        portuguese
   cp1250           dec-multinational iso2022jp-kanji  shift-jis-kanji
   cp1251-cyrillic  dg-international  italian          short-koi
   cp1252           dutch             jis7-kanji       spanish
   cp437            elot927-greek     koi8             swedish
   cp850            elot928-greek     koi8r            swiss
   cp852            euc-jp            koi8u            ucs2
   cp855-cyrillic   finnish           latin1-iso       utf8
   cp858            french            latin2-iso
   cp862-hebrew     german            latin9-iso
   cp866-cyrillic   greek-iso         macintosh-latin
  C-Kermit&gt;
</pre><p>
Thus you can translate not only between private sets (like PC code pages) and
standard ones (like Latin-1) as in Kermit protocol, but also between any given
pair of private sets (e.g. CP852 and Mazovia).  All conversions go through
Unicode as the intermediate character set, resulting in a minimum of character
loss, since Unicode is a superset of all other character sets known to Kermit.
<p>
In addition to the SET commands listed above, the FTP PUT and MPUT commands
include switches that apply only to the current command:
<p>
<dl>
<dt><tt><b>/LOCAL-CHARACTER-SET:</b><i>name</i></tt></dt>
<dt><tt><b>/SERVER-CHARACTER-SET:</b><i>name</i></tt></dt>
<dd>Use these switches to force a particular translation.  These switches
override the global FTP CHARACTER-SET-TRANSLATION and SERVER-CHARACTER-SET
settings and also character-set differentiation by file scanning for the
duration of the PUT or MPUT command.  The file scan is still performed,
however, to determine whether the file is text or binary; thus these
switches do not affect binary files unless you also include the /TEXT
switch to force all files to be treated as text.
</dl>
<p>

In other words, if you include one or both of these switches with a PUT or
MPUT command, they are used.  Similarly, the <tt><b>/TRANSPARENT</b></tt>
switch disables character-set translation for the PUT or MPUT command despite
the prevailing FTP CHARACTER-SET-TRANSLATION and SERVER-CHARACTER-SET
settings.

<p>
When uploading, the FILE CHARACTER-SET setting is ignored unless you have
forced Kermit not to <a href="#x4">scan local files</a> by including a
/TEXT or /BINARY switch with your [M]PUT command, or by disabling automatic
text/binary switching in some other way.
<p>
Examples:
<p>
<ol>
<li>Suppose you have a CP852 (East European) text file that you want to upload
and store in ISO Latin Alphabet 2 encoding:
<p><pre>
  ftp put /local-char:cp852 /server-char:latin2 magyar.txt
</pre><p>
<li>Suppose you always want your text files converted to Latin-2 when uploading
with FTP.  Then put:
<p><pre>
  set ftp server-character-set latin2
</pre><p>
in your Kermit customization file, and then you can omit the
/SERVER-CHARACTER-SET: switch from your FTP PUT commands:
<p><pre>
  ftp put /local-char:cp852 magyar.txt
</pre><p>
<li>Now suppose that all the text files on your PC are written in Hungarian,
but they have a variety of encodings, and you don't want to have to include the
/LOCAL-CHARACTER-SET: switch on every FTP PUT command, or (more to the point)
you want to be able to send a mixture of these files all at once.  Put these
commands in your Kermit customization file:
<p><pre>
  set ftp server-character-set latin2            ; ISO 8859-2
  set file default 7-bit-character-set hungarian ; ISO 646 Hungarian
  set file default 8-bit-character-set cp852     ; PC East European Code Page
</pre><p>
and now PUT and MPUT will automatically detect and switch among ISO 646
Hungarian, Code Page 852, UTF-8, and UCS-2 encodings, translating each one
to Latin-2 for uploading:
<p><pre>
  ftp put *.txt
</pre></ol>
<p>
And since binary files are also detected automatically, the latter can be
simplified to:
<p><pre>
  ftp put *
</pre><p>
even when "*" matches a diverse collection of binary and text files, because
translations are skipped automatically for binary files.
<p>
<hr>
<h4><a name="x3.7.2">3.7.2. Character Sets and Downloading</a></h4>

The commands and switches are the same as for uploading, but automatic
character-set switching works differently, since Kermit can't scan the server
files in advance.  Instead, the transfer mode (text or binary) is based on
the filenames; each name is compared with Kermit's list of text name patterns
and binary name patterns.  If the name matches a binary pattern (for example,
if the filename is <tt>oofa.tar.gz</tt> and one of the filename patterns is
"<tt>*.gz</tt>"), the file is downloaded in binary mode; otherwise if it
matches a text pattern (e.g. <tt>oofa.txt</tt> matches "<tt>*.txt</tt>"), it
is transferred in text ("ascii") mode.  Otherwise, it is transferred in the
prevailing FTP TYPE. 
<p>

In C-Kermit 8.0, the pattern lists used with FTP GET are not the same lists
used with Kermit transfers, and can not be viewed with SHOW PATTERNS, nor
adjusted with ADD and REMOVE TEXT-PATTERNS and BINARY-PATTERNS, or SET FILE
TEXT-PATTERNS and BINARY-PATTERNS.  Configuration of the FTP patterns list
will be added in a future release.

<p>
Examples:
<p>
<dl>
<dt><tt>get /server-char:latin1 /local-char:cp850 Gr&uuml;&szlig;e.txt</tt></dt>
<dd>In this command, the filename contains special characters, which you enter
using whatever character set your local computer uses, in this case PC Code
Page 850 (cp850).  The command tells Kermit (in case it didn't know already
from its FILE CHARACTER-SET setting) that the local character set is cp850
and the server's character-set is ISO 8859-1 Latin Alphabet 1 (latin1).
Kermit translates the filename from cp850 to latin1 and sends the latin1
name to the server.  Since it's a text file (matches "<tt>*.txt</tt>"),
its contents are translated to cp850 on arrival, and it is saved with a
cp850 name.
<p>
<dt><tt>mget /text /server:latin1 /local:utf8 *.txt</tt></dt>
<dd>This command:<ul><li>Tells C-Kermit that the server's files are encoded in
ISO 8859-1 Latin Alphabet 1.
<li>Tells C-Kermit to translate the incoming files into Unicode UTF-8 for
storage.
<li>Asks the server to send all "<tt>.txt</tt>" files in text mode.
</ul>
<p>
<dt><tt>mget /server:latin1 /local:utf8 *</tt></dt>
<dd>Tells Kermit to get <i>all</i> files from the server's directory, switching
between text and binary mode based on the filename.  The names of all the
files are translated (to UTF-8 in this case), but contents are translated
(also to UTF-8) only for text files.
</dl>
<p>
Note that any pair of 8-bit character sets is likely to have some
incompatibilities.  Any characters in the source file that do not have
equivalents in the destination file's character set are converted to question
marks.  This applies to both filenames and to text file contents.
<p>
Also note that the server's ability to accept special characters in filenames
depends on the particular server.  For example:
<p>
<pre>
  get Gr&uuml;&szlig;e.txt
</pre>
<p>
works with WU-FTPD, but:
<p>
<pre>
  mget Gr&uuml;&szlig;*.txt
</pre>
<p>
does not.
<p>

<hr>
<h4><a name="x3.7.3">3.7.3. RFC2640</a></h4>

<a href="ftp://ftp.isi.edu/in-notes/rfc2640.txt"> RFC2640</a>, July 1999,
specifies a method by which the FTP client and server can negotiate the use of
UTF8.  However, RFC2640-capable servers are rare to nonexistent at this
writing, and in any case you don't need them to be able to transfer text in
UTF8.  C-Kermit lets you upload and download text files in any character set
it knows about, converting to or from any other character set it knows about,
without the knowledge, permission, or cooperation of the server, and
regardless of its capabilities.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.8">3.8. FTP Command Shortcuts</a></h3>

C-Kermit's FTP client coexists with other C-Kermit functions by requiring the
"ftp" prefix for each FTP-related command: FTP OPEN, FTP GET, FTP BYE, and so
on.  For interactive use, however, this can be rather awkward and sometimes
surprising, for example when a GET command starts a Kermit GET rather than an
FTP GET.  In fact, many Kermit commands might just as easily apply to an FTP
connection: GET, PUT (SEND), BYE, and CLOSE.  The following command lets you
choose how these commands are interpreted:
<p>
<dl>
<dt><tt><b>SET GET-PUT-REMOTE</b> <i>{</i> <b>AUTO, KERMIT, FTP</b> <i>}</i></tt></dt>
<dd>Controls the orientation of GET, PUT, REMOTE and other file-transfer and
  client/server commands that might apply to either Kermit or FTP.  The
  default setting is AUTO, meaning that these commands apply to FTP if an
  FTP connection is open, and to Kermit otherwise.  KERMIT means they always
  apply to Kermit, FTP means they always apply to FTP.
</dl>
<p>
Here is a complete list of affected commands:
<p><pre>
 <u>Kermit Command</u>               <u>FTP Equivalent</u>
  (none)                       FTP <i>[</i> OPEN <i>]</i>
  LOGIN                        FTP USER
  LOGOUT                       FTP RESET
  BYE                          FTP BYE
  FINISH                       FTP BYE
  CLOSE                        FTP BYE
  HANGUP                       FTP BYE
  BINARY                       FTP TYPE BINARY
  TEXT (or ASCII)              FTP TYPE ASCII
  SEND (or PUT)                FTP PUT
  MSEND (or MPUT)              FTP MPUT
  RESEND                       FTP PUT /RECOVER
  CSEND                        FTP PUT /COMMAND
  GET                          FTP GET
  MGET                         FTP MGET
  REGET                        FTP GET /RECOVER
  REMOTE HELP      (RHELP)     FTP HELP
  REMOTE CD        (RCD)       FTP CD (CWD)
  REMOTE PWD       (RPWD)      FTP PWD
  REMOTE DIRECTORY (RDIR)      FTP DIRECTORY
  REMOTE DELETE    (RDEL)      FTP DELETE
  REMOTE MKDIR     (RMKDIR)    FTP MKDIR
  REMOTE RMDIR     (RRMDIR)    FTP RMDIR
  REMOTE RENAME    (RRENAME)   FTP RENAME
  REMOTE TYPE      (RTYPE)     FTP TYPE
  REMOTE EXIT      (REXIT)     FTP BYE
</pre>
<p>

The commands in the right-hand column always access FTP.  The commands in
the left column can access either Kermit protocol or FTP:

<p>
<ul>

<li>When GET-PUT-REMOTE is set to KERMIT, or to AUTO when there is no FTP
connection, the commands in the left-hand column access Kermit protocol,
and those right-hand column are required for FTP.

<p>

<li>When GET-PUT-REMOTE is set to FTP, or to AUTO when there is an active FTP
connection, the commands in the left-hand column access the FTP connection
and can not be used to access Kermit protocol.  In this case, if you want
to be able to use both Kermit protocol and the FTP connection, you must SET
GET-PUT-REMOTE KERMIT, and then use the FTP commands in the right-hand
column to access the FTP connection.

</ul>
<p>

Note that file-management commands such as DIRECTORY, DELETE, CD, PWD, MKDIR,
RMDIR, HELP, RENAME, COPY, TYPE, and so on, always apply locally, no matter
what kind of connection you have.  This is the opposite of most FTP clients,
where these commands are intended for the server, and require an "L" prefix
for local execution (e.g. "dir" gets a directory listing from the server,
"ldir" gets a local directory listing).  To illustrate with the CD command
and a typical UNIX FTP client:
<p><pre>
 <u>Client</u>   <u>Server</u>      <u>Change Local Directory</u>     <u>Change Remote Directory</u>
  FTP      FTP         lcd                        cd (cwd)
  Kermit   Kermit      cd                         rcd, remote cd
  Kermit   FTP         cd                         ftp cd, rcd, remote cd
</pre><p>
Also note that not all REMOTE commands are useful with FTP, since FTP servers
do not offer the corresponding functions.  These include:
<p><ul>
<li><tt>REMOTE ASSIGN&nbsp;&nbsp;-&nbsp;</tt>FTP servers don't have variables
<li><tt>REMOTE COPY&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;</tt>FTP servers don't copy files
<li><tt>REMOTE HOST&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;</tt>FTP servers don't execute host (shell) commands
<li><tt>REMOTE KERMIT&nbsp;&nbsp;-&nbsp;</tt>FTP servers don't execute Kermit commands
<li><tt>REMOTE PRINT&nbsp;&nbsp;&nbsp;-&nbsp;</tt>FTP servers don't print files
<li><tt>REMOTE QUERY&nbsp;&nbsp;&nbsp;-&nbsp;</tt>FTP servers don't have variables
<li><tt>REMOTE SET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;</tt>FTP servers don't have Kermit settings
<li><tt>REMOTE WHO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;</tt>FTP servers don't send user lists
</ul><p>
Finally note that command shortcuts do not apply to the HELP command.
For help about an FTP command, use (for example) "help ftp delete", not
"help delete" or "help rdelete".
<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.9">3.9. Dual Sessions</a></h3>

You can have an FTP session open at the same time as a regular Kermit SET LINE
or SET HOST (terminal) session.  In this case, the default SET GET-PUT-REMOTE
AUTO setting should ensure that all "two-faced" commands like GET, PUT,
REMOTE, HANGUP, BYE, etc, apply to the Kermit session, and all commands for
the FTP session must include the FTP prefix.  To be absolutely certain, you
can use SET GET-PUT-REMOTE KERMIT.

<p><pre>
  ftp foo.bar.baz.com
  if fail ...
  (log in)
  set host foo.bar.baz.com
  if fail ...
  (log in)
</pre><p>
Now you have both an FTP and Telnet connection to the same host (of course
they could also be to different hosts, and you could also have a direct or
dialed serial connection instead of a Telnet connection).  Now assuming you
have a Kermit server on the far end of the Kermit connection:
<p><pre>
  rcd incoming      ; Changes Kermit server's directory (= REMOTE CD)
  ftp cd incoming   ; Changes FTP server's directory
  put oofa.txt      ; Sends a file on the Kermit connection
  ftp put oofa.txt  ; Sends a file on the FTP connection
  bye               ; Shuts down the Kermit connection
  ftp bye           ; Shuts down the FTP connection
</pre><p>
Note that PUT and SEND are synonyms for both FTP and Kermit connections.
<p>
You can also establish dual sessions on the Kermit command line:
<p><pre>
  kermit -j host1 -9 host2
</pre><p>
This makes a Telnet connection to host1 and an FTP connection to host2.
<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.10">3.10. Automating FTP Sessions</a></h3>

Most of Kermit's scripting features can be used to make and control FTP
sessions: FOR and WHILE loops, IF-ELSE and SWITCH constructions, variables,
arrays, built-in functions, and all the rest.  You can't use INPUT, MINPUT,
OUTPUT, CLEAR, or SCRIPT on an FTP session, but these are not needed since
the FTP protocol is well defined.

<p>

<a href="http://www.columbia.edu/kermit/ftpscripts.html">CLICK HERE</a> for an
FTP scripting tutorial.


<h4><a name="x3.10.1">3.10.1. FTP-Specific Variables and Functions</a></h4>

The following variable tells whether an FTP connection is open:
<p><dl>
<dt><tt><b>\v(ftp_connected)</b></tt></dt>
<dd>1 if there is an active FTP connection, 0 if there isn't.
</dl>
<p>
The FTP OPEN command sets:
<p><dl>
<dt><tt><b>\v(ftp_host)</b></tt>
<dd>The host to which the most recent FTP connection was made.
<p>
<dt><tt><b>\v(ftp_security)</b></tt>
<dd>The security method negotiated for the current FTP session.  The value
is "NULL" when no security is used.  See 
<a href="#x3.2">3.2. Making Secure FTP Connections</a>.
<p>
<dt><tt><b>\v(ftp_server)</b></tt>
<dd>The OS type (UNIX, VMS, etc) of the FTP server host.
</dl>
<p>
The FTP USER command (or FTP OPEN /USER:, or FTP with automatic login) sets:
<p>
<dl>
<dt><tt><b>\v(ftp_loggedin)</b></tt>
<dd>1 if you are logged in to an FTP server, 0 if you are not.
</dl>
<p>
The current COMMAND-PROTECTION-LEVEL and DATA-PROTECTION-LEVEL values are
reflected in:
<p><dl>
<dt><tt><b>\v(ftp_cpl)</b></tt>
<dt><tt><b>\v(ftp_dpl)</b></tt>
<dd>The values are "clear", "confidential", "safe" or "private".  See
<a href="#x3.2">3.2. Making Secure FTP Connections</a>.
</dl>
<p>

The FTP GET-PUT-REMOTE setting is reflected in:
<p><dl>
<dt><tt><b>\v(ftp_getputremote)</b></tt>
<dd>The values are "auto", "ftp", or "kermit".
</dl>
<p>
Every FTP command sets the \v(success) variable, as well as the following
two FTP-specific variables: 
<p><dl>
<dt><tt><b>\v(ftp_code)</b></tt>
<dd>The standardized numeric FTP protocol code from the server's response 
to the last client command, a 3-digit decimal number defined in
<a href="ftp://ftp.isi.edu/in-notes/rfc959.txt"> RFC959</a>.
Briefly:
<p>
1<i>xx</i> = Positive Preliminary Reply<br>
2<i>xx</i> = Positive Completion Reply<br>
3<i>xx</i> = Positive Intermediate Reply<br>
4<i>xx</i> = Transient Negative Completion Reply<br>
5<i>xx</i> = Permanent Negative Completion Reply
<p>
<dt><tt><b>\v(ftp_message)</b></tt>
<dd>The text message, if any, from the server's response to the last
client command.  If the most recent response had multiple lines,
this variable has only the final line.  These messages are not
standardized and vary in format and content from server to server.
<i>Synonym:</i> <b><tt>\v(ftp_msg)</tt></b>.
</dl>   
FTP file transfers set the regular Kermit transfer status variables:
<p><pre>
  \v(cps)         Characters per second of most recent transfer.
  \v(filespec)    File specification used in most recent transfer.
  \v(fsize)       Size of file most recently transferred.
  \v(tfsize)      Total size of file group most recently transferred.
  \v(xferstatus)  Status of most recent transfer (0 = success, 1 = failure).
  \v(tftime)      Elapsed time of most recent transfer, in seconds.
</pre><p>
During an FTP transfer, the per-file variables are:
<p><pre>
  \v(filename)    Name of current file.
  \v(filenumber)  Ordinal file number in group (1, 2, 3, ...)
</pre><p>

<p>
<hr>
<h4><a name="x3.10.2">3.10.2. Examples</a></h4>

Let's begin with a simple example showing how to log in, send some files,
and log out:
<p><pre>
  define error if fail { ftp bye, stop 1 Error: \%1 }
  set transact brief
  log t
  ftp ftp.xyzcorp.com /anonymous
  if fail stop 1 Connection failed
  if not \v(ftp_loggedin) stop 1 Login failed
  ftp cd incoming
  error {ftp cd}
  cd upload
  error {local cd}
  ftp put /delete *
  error {put}
  ftp bye
</pre><p>
First we define an error handling macro to be used after the connection is
made.  Then we set up a brief-format transaction log to keep a record of our
file transfers.  Then we make a connection to the host and log in anonymously.
The "if fail" command checks whether the connection was made.  The "if not"
command checks whether login was successful.  Obviously the script should not
continue unless both tests succeed.
<p>
Next we change to the server's 'incoming' directory and to our own 'upload'
directory, and send all the files that are in it (they can be any mixture of
text and binary files), deleting each source file automatically after it is
successfully uploaded.  Each of these operations is checked with the ERROR
macro, which prevents the script from continuing past a failure.
<p>
Finally we close the FTP session with the "bye" command.
<p>
Just like any other Kermit script, this one can be used in many ways:
<p><ul>
<li>It can be stored in a file, and Kermit can be told to TAKE the file.
<li>In UNIX, it can be a "<a
href="http://www.columbia.edu/kermit/ckscripts.html">kerbang</a>" script and
therefore run directly from the shell prompt or as a cron job.
</ul><p>
We could have used command shortcuts like "rcd", "put", and "bye", but since
they can be ambiguous under certain circumstances, it is better to avoid them
in scripts; they are intended mainly for convenience during interactive use.
However, if you wish to use the shortcuts in a script, you can do it this way
(error handling omitted for brevity):
<p><pre>
  local \%t                       ; Declare a local temporary veriable
  assign \%t \v(ftp_getputremote) ; Save current FTP GET-PUT-REMOTE setting
  set ftp get-put-remote ftp      ; Choose FTP orientation
  ftp xyzcorp.com /anonymous      ; Open an FTP connection
  get oofa.txt                    ; GET a file
  put foo.bar                     ; PUT a file
  rdel yesterday.log              ; Delete a file on the server
  bye                             ; Log out and disconnect from server.
  set ftp get-put-remote \%t      ; Restore previous GET-PUT-REMOTE setting
</pre><p>
Of course, FTP scripts can also be written as macros.  This lets you pass
parameters such as hostnames, usernames, and filenames to them:
<p><pre>
  define doftpget {
      if &#60; \v(argc) 4 end 1 Usage: \%0 host user remotefile [ localfile ]
      ftp \%1 /user:\%2
      if fail end 1 FTP OPEN \%1 failed
      if not \v(ftp_loggedin) end 1 FTP LOGIN failed
      ftp get {\%3} {\%4}
      if fail end 1 FTP GET \%3 failed
      ftp bye
  }
</pre><p>

Add this definition to your Kermit customization file, and it will always be
available when you start Kermit.  This macro lets you download a file with FTP
by giving a single command, e.g.:

<p><pre>
  doftpget xyzcorp.com anonymous oofa.txt
</pre>
<p>
<a href="http://www.columbia.edu/kermit/ftpscript.html">CLICK HERE</a> to
visit the Kermit FTP script-writing tutorial.
<p>
[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x3.11"><font color="red">3.11.
Advanced FTP Protocol Features</a></font></h3>

<font color="red">The remainder of the FTP documention (through the end
of Section 3) is new to C-Kermit 8.0.206, but we leave it in black to prevent
headaches.  Except for titles.</font>

<ul>
<li><a href="#x3.11.1"><font color="red">TERMINOLOGY</font></a>
<li><a href="#x3.11.2"><font color="red">FEATURE NEGOTIATION</font></a>
<li><a href="#x3.11.3"><font color="red">USING MGET: NLST VERSUS MLSD</font></a>
<li><a href="#x3.11.4"><font color="red">EXAMPLES</font></a>
<li><a href="#x3.11.5"><font color="red">REFERENCES</font></a>
</ul>

<p>

The new releases of <a
href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> (8.0.206)
and
<a href="http://www.columbia.edu/kermit/k95.html">Kermit 95</a> (2.1) support
new FTP protocol features from RFC 2389 as well as most of what's in the Elz
and Hethmon <cite>Extensions to FTP</cite> Internet Draft (see <a
href="#x3.11.5">References</a>).  Some of these features, such as SIZE
(request a file's size), MDTM (request file's modification time), and REST
(restart interrupted transfer) have been widely implemented in FTP clients and
servers for years (as well as in the initial release of the Kermit FTP
clients).  Others such as FEAT and MLSD are rarely seen and are new to the
upcoming Kermit releases.  TVFS (Trivial Virtual File Store) is supported
implicitly, and the UTF-8 character-set is already fully supported at the
protocol and data-interchange level.

<p>

For Kermit users, the main benefit of the new FTP protocol extensions is the
ability to do recursive downloads.  But the extensions also introduce
complications and tradeoffs that you should be aware of.  Of course Kermit
tries to "do the right thing" automatically in every case for backwards
compatibility.  But (as noted later) some cases are inherently ambiguous
and/or can result in nasty surprises, and for those situations new commands
and switches are available to give you precise control over Kermit's behavior,
in case the defaults don't produce the desired results.

<h3><hr><a name="x3.11.1"><font color="red">3.11.1. Terminology</font></a></h3>

Command-line FTP clients such as Kermit (as well as the traditional FTP
programs found on Unix, VMS, ..., even Windows) have commands like PUT, MPUT,
GET, MGET, and BYE, which they convert into zero or more FTP protocol
commands, such as NLST, RETR, QUIT.  For clarity, we'll use "command" to refer
to commands given by the user to the FTP client, and "directive" for FTP
protocol commands sent by the FTP client to the FTP server.

<h3><hr><a name="x3.11.2"><font color="red">3.11.2. Feature Negotiation</font></a></h3>

New FTP protocol features are negotiated by the client sending a FEAT
directive and the server responding with a list of (new) features it supports,
or else with an error indication if it does not support the FEAT directive at
all, in which case the client has to guess which new features it supports
(Kermit guesses that it supports SIZE and MDTM but not MLST).  Note that the
MLST feature includes MLSD, which is not listed separately as a feature.

<p>

Guessing is nice when it works, but sometimes it doesn't, and some FTP
servers become confused when you send them a directive they don't
understand, or they do something you didn't want, sometimes to the point of
closing the connection.  For this reason, Kermit lets you override default
or negotiated features with the following new commands:

<p>
<dl>

<dt><tt><b>FTP</b> <i>{</i> <b>ENABLE</b>, <b>DISABLE</b> <i>}</i>
<b>FEAT</b></tt></dt>

<dd>Enables or disables the automatic sending of a FEAT directive upon
connection to an FTP server.  Note that
<tt>FTP&nbsp;<i>[</i>&nbsp;OPEN&nbsp;<i>]</i>&nbsp;/NOINIT</tt> &nbsp;
also inhibits sending the FEAT directive (and several others)
for the connection being OPEN'd, but without necessarily disabling FEAT for
subsequent connections in the same Kermit instance.  FEAT is ENABLED by
default, in which case many FTP servers are likely to reply:

<p>
<blockquote>
<pre>
500 'FEAT': command not understood
</pre>
</blockquote>
<p>
which is normally harmless (but you never know).

<p>

<dt><tt><b>FTP ENABLE</b> <i>{</i> <b>MDTM</b>, <b>MLST</b>, <b>SIZE</b>
<i>}</i></tt></dt>

<dd>Enables the given directive for implicit use by the FTP GET and MGET
commands in case it has been disabled or erroneously omitted by the
server in its FEAT response.  Note: MLSD can be used in the FTP ENABLE
and DISABLE commands as a synonym for MLST.

<p>

<dt><tt><b>FTP DISABLE</b> <i>{</i> <b>MDTM</b>, <b>MLST</b>,
<b>SIZE</b> <i>}</i></tt></dt>

<dd>Disables implicit use of the given directive by GET or MGET in case it
causes problems; for example, because it makes multifile downloads take
too long or the server announces it erroneously or misimplements it.  Use
DISABLE FEAT before making a connection to prevent Kermit from sending the
FEAT directive as part of its initial sequence.  Note that disabling FEAT,
SIZE, or MDTM does not prevent you from executing explicit FTP FEATURES,
FTP SIZE, or FTP MODTIME commands.  Also note that disabling SIZE prevents
PUT /RESTART (recovery of interrupted uploads) from working.

</dl>
<p>


To enable or disable more than one feature, use multiple FTP ENABLE or FTP
DISABLE commands.  The SHOW FTP command shows which features are currently
enabled and disabled.

<p>
<dl>

<dt><tt><b>FTP FEATURES</b></tt></dt>

<dd>This command sends a FEAT directive to the server.  In case you have been
disabling and enabling different features, this resynchronizes Kermit's
feature list with the server's.  If the server does not support the FEAT
directive, Kermit's feature list is not changed.

<p>

<dt><tt><b>FTP OPTIONS</b> <i>directive</i></tt></dt>

<dd>Informational only: the server tells what options, if any, it supports for
the given directive, e.g. MLST.  Fails if the server does not support the OPTS
directive or if the directive for which options are requested is not valid.
The directive is case-insensitive.

<p>

<dt><tt><b>FTP SIZE</b> <i>filename</i></tt></dt>

<dd>Sends a SIZE directive to the server for the given file.  The filename must
not contain wildcards.  The server responds with an error if the file
can't be found, is not accessible, or the SIZE directive is not supported,
otherwise with the length of the file in bytes, which Kermit displays and
also makes available to you in its <tt>\v(ftp_message)</tt> variable.  If the
directive is successful, Kermit (re-)enables it for internal use by the
GET and MGET directives on this connection.

<p>

<dt><tt><b>FTP MODTIME</b> <i>filename</i></tt></dt>

<dd>Works just like the SIZE directive except it sends an MDTM directive.
Upon success, the server sends modification date-time string, which Kermit
interprets for you and also makes available in its <tt>\v(ftp_message)</tt>
variable.

</dl>
<p>

Whenever a SIZE or MDTM directive is sent implicitly and rejected by the
server because it is unknown, Kermit automatically disables it.

<h3><hr><a name="x3.11.3"><font color="red">3.11.3. Using MGET: NLST versus MLSD</font></a></h3>

When you give an MGET command to an FTP client, it sends a request to the
FTP server for a list of files, and then upon successful receipt of the
list, goes through it and issues a RETR (retrieve) directive for each file
on the list (or possibly only for selected files).

<p>

With the new FTP protocol extensions, now there are two ways to get the list
of files: the NLST directive, which has been part of FTP protocol since the
beginning, and the new MLSD directive, which is new and not yet widely
implemented.  When NLST is used and you give a command like
"<tt>mget</tt>&nbsp;<tt>*.txt</tt>", the FTP client sends:

<p>
<blockquote>
<pre>
NLST *.txt
</pre>
</blockquote>
<p>

and the server sends back a list of the files whose names match, e.g.

<p>
<blockquote>
<pre>
foo.txt
bar.txt
baz.txt
</pre>
</blockquote>
<p>

Then when downloading each file, the client sends SIZE (if it wants have a
percent-done display) and MDTM (if it wants to set the downloaded file's
timestamp to match that of the original), as well as RETR (to retrieve the
file).

<p>

But when MLSD is used, the client is not supposed to send the filename or
wildcard to the server; instead it sends an MLSD directive with no argument
(or the name of a directory), and the server sends back a list of all the
files in the current or given directory; then the client goes through the list
and checks each file to see if it matches the given pattern, the rationale
being that the user knows only the local conventions for wildcards and not
necessarily the server's conventions.  So with NLST the server interprets
wildcards; with MLSD the client does.

<p>
<blockquote>
<i>

The interpretation of NLST wildcards by the server is not necessarily required
or even envisioned by the FTP protocol definition (RFC 959), but in practice
most clients and servers work this way.

</i>
</blockquote>
<p>

The principal advantage of MLSD is that instead of sending back a simple
list of filenames, it sends back a kind of database in which each entry
contains a filename together with information about the file: type, size,
timestamp, and so on; for example:

<p>
<blockquote>
<pre>
size=0;type=dir;perm=el;modify=20020409191530; bin
size=3919312;type=file;perm=r;modify=20000310140400; bar.txt
size=6686176;type=file;perm=r;modify=20001215181000; baz.txt
size=3820092;type=file;perm=r;modify=20000310140300; foo.txt
size=27439;type=file;perm=r;modify=20020923151312; foo.zip
<i>(etc etc...)</i>
</pre>
</blockquote>
<p>

(If the format of the file list were the only difference between NLST and
MLSD, the discussion would be finished<tt>:</tt> it would always be better to
use MLSD when available, and the MGET user interface would need no changes.
But there's a lot more to MLSD than the file-list format; read on&hellip;)

<p>

The client learns whether the server supports MLSD in FEAT exchange.  But
the fact that the server supports MLSD doesn't mean the client should always
use it.  It is better to use MLSD:

<p>
<ul>

<li>On connections where the server imposes a time penalty for every command,
e.g. the Red Hat Rawhide server.  With MLSD, the client needs to send
only one command (RETR) per file, whereas NLST requires three (SIZE,
RETR, and MDTM).  Suppose there is a 30-second delay for each command and
1000 files are to be fetched; in that case, MLSD saves 60,000 seconds =
1000 minutes = 16 hours and 40 minutes.

<p>

<li>For recursive downloads since there is no dependable way to download
directory trees with NLST.

</ul>
<p>

But it is better to use NLST:

<p>
<ul>

<li>If you want only a couple short files out of a large directory.  In this
case, NLST is the better choice since the server sends a list of only the
files you want, not a list of (say) a million files, which can make a big
difference on slow connections.  For example, suppose your wildcard matches
three files of 1K each, but the million-file listing is 80MB long, and your
connection is through a modem.  The overhead of using MLSD is practically
infinite.

<p>

<li>If the server supports wildcarding features not known to the client, but
that can be used to achieve desirable effects otherwise unobtainable, such as
"<tt>[dir...]*.txt</tt>" in VMS or AOS/VS "except" clauses.

<p>

<li>If you have been given a wildcard string by an FTP site administrator for
fetching a specific group of files out of a larger directory, e.g.
"<tt>mget</tt>&nbsp;<tt>ck[cuw]*.[cwh]</tt>&nbsp;<tt>makefile</tt>",
that is expected to work with any client (an FTP site administrator can't be
expected to know the wildcard syntax of every FTP client).

</ul>
<p>

But when using MLSD there are complications:

<p>
<ul>

<li>MLSD wants either a blank argument (meaning the current directory) or
else the name of a specific directory.  The client must <i>not</i> send it a
wildcard or a filename.

<p>

<li>But if the user's command is "mget xxx", how does the client know whether
to send "xxx" in the MLSD directive?  It might be the name of a directory
on on the server, in which case it <i>should</i> be sent, or it might be the
name of a file on the server (or a wildcard), in which case it must <i>not</i>
be sent.  Since the client knows its own wildcard syntax, then in most
cases it would be right to send "MLSD" with no argument if xxx is wild,
and to send "MLSD xxx" if it is not.

<p>

<li>But suppose the server's file system allows filename characters that
correspond with the client's wildcard syntax?  For example:
"<tt>[abc]</tt>" could be either a valid VMS directory name or a wildcard
pattern used by the FTP client.  What should the client do with "<tt>mget</tt>
<tt>[abc]</tt>"?  In this case there must be a way for the user to force
sending the MGET argument as the MLSD argument.

<p>

<li>If "xxx" is a regular file in the server's current
directory, "mget xxx" works with NLST but not with MLSD.

</ul>
<p>

To further complicate matters, NLST can (in theory) work just like MLSD: if
sent with a blank argument or a directory name, it is supposed to return a
complete list of files in the current or given directory, which the client can
match locally against some pattern.  It is not known if any FTP server
or client does this but nevertheless, it should be possible since this
behavior can be inferred from RFC 959.

<p>

In view of these considerations, and given the need to preserve the
traditional FTP client command structure and behavior so the software will be
usable by most people:

<p>
<ol>

<li>The MGET command should produce the expected result in the common cases,
regardless of whether NLST or MLSD is used underneath.

<p>

<li>For anomalous cases, the user needs a way to control whether the MGET
argument is sent to the server or kept for local use.

<p>

<li>At the same time, the user might need a way to send a directory name to
the server, independent of any wildcard pattern.

<p>

<li>The user needs a way to force NLST or MLSD for a given MGET command.

</ol>
<p>

By default, Kermit's MGET command uses MLSD if MLST is reported by the server
in its FEAT list.  When MLSD is used, the filespec is sent to the server if it
is not wild (according to Kermit's own definition of "wild" since it can't
possibly know the server's definition).  If the filespec is wild it is held
for local use to select files from the list returned by the server.  If MLST
is <i>not</i> reported by the server or is disabled, Kermit sends the MGET
filespec with the NLST directive.

<p>

The default behavior can be overridden globally with FTP DISABLE MLST, which
forces Kermit to use NLST to get file lists.  And then for situations in which
MLSD is enabled, the following MGET switches can be used to override the
defaults for a specific MGET operation:

<p>
<dl>

<dt><tt><b>/NLST</b></tt></dt>

<dd>Forces the client to send NLST.  Example:
<blockquote>
<pre>
mget /nlst foo.*
</pre>
</blockquote>
<p>

<dt><tt><b>/MLSD</b></tt></dt>

<dd>Forces the client to send MLSD (even if MLST is disabled).  Example:
<blockquote>
<pre>
mget /mlsd foo.*
</pre>
</blockquote>
<p>

<dt><tt><b>/MATCH:</b><i>pattern</i></tt></dt>

<dd>When this switch is given, it forces the client to hold the pattern for
local use against the returned file list.  If a remote filespec is also given
(e.g. the "<tt>blah</tt>" in "<tt>mget</tt> <tt>/match:*.txt</tt>
<tt>blah</tt>"), then it is sent as the NLST or MLSD argument, presumably to
specify the directory whose files are to be listed.  When the
<tt>/MATCH</tt> switch is <i>not</i> given, the MGET filespec is sent to the
server if the directive is NLST or if the filespec is not wild.  Examples:

<p>
<pre>
  <u><i>Command:                   With NLST:     With MLSD:</i></u>
    mget                      NLST           MLSD
    mget *.txt                NLST *.txt     MLSD        
    mget foo                  NLST foo       MLSD foo
    mget /match:*.txt         NLST           MLSD
    mget /match:*.txt foo     NLST foo       MLSD foo
</pre>
</dl>
<p>

In other words, the pattern is always intepreted locally unless MGET uses
NLST and no /MATCH switch was given.

<h3><hr><a name="x3.11.4"><font color="red">3.11.4. Examples</font></a></h3>


<h3><a name="x3.11.4.1"><font color="red">3.11.4.1. Downloading a Single File</font></a></h3>

There are no choices here, just use the FTP GET command.  Kermit always sends
the RETR directive, and possibly SIZE and/or MDTM.  The small advantage of
using MLST in this case is outweighed by the risk and effort of coding a
special case.


<h3><a name="x3.11.4.2"><font color="red">3.11.4.2. Downloading a Group of Files from a Single Directory</font></a></h3>

This case presents tradeoffs, especially on slow connections:

<p>
<ul>

<li>For downloading all or most of the files in a directory, MLSD is better
because it eliminates the need to send SIZE and MDTM for each file.  No
special actions are required in this case; Kermit uses MLSD automatically if
the server supports it (unless you have disabled it).

<p>

<li>For a small number of files from a large directory, NLST is better because
it bypasses downloading of a potentially huge file list prior to the files
themselves.  If you have a connection to a server that supports MLSD, use the
/NLST switch to force NLST:

<p>
<blockquote>
<pre>
mget /nlst t[1234].h
</pre>
</blockquote>
<p>

<li>If the server supports MLSD but does not support separate SIZE or MDTM
directives, and you need the size and/or timestamp information, MLSD is
better; no special actions required.

<p>

<li>If the server supports MLSD but does not support the "size" and "modify"
facts, but it does support the SIZE or MDTM directives, and you need the size
and/or timestamp information, NLST is better.

</ul>


<h3><a name="x3.11.4.3"><font color="red">3.11.4.3. Downloading a Directory Tree</font></a></h3>

MLSD is the only choice for recursive downloads; they rarely, if ever, work
with NLST (the few cases where they do work rely on extra-protocol "secret"
notations for the NLST argument).  No special actions are required to force
MLSD when the server supports it, unless you have disabled it.  Examples:

<p>
<dl>

<dt><tt><b>MGET /RECURSIVE</b></tt></dt>

<dd>This tells the server to send all files and directories in the tree
rooted at its current directory.

<p>

<dt><tt><b>MGET /RECURSIVE *.txt</b></tt></dt>

<dd>This tells the server to send all <tt>*.txt</tt> files in the tree rooted
at its current directory.

<p>

<dt><tt><b>MGET /MLSD /RECURSIVE *.txt</b></tt></dt>

<dd>Same as the previous example but forces Kermit to send MLSD in case it
was disabled, or in case the server is known to support it even though
it did not announce it in its FEAT listing.

<p>

<dt><tt><b>MGET /RECURSIVE /MATCH:*.zip archives</b></tt></dt>
<dd>Tells the server to send all ZIP files in the tree rooted at its
"archives" directory.

<p>

<dt><tt><b>MGET /RECURSIVE /MATCH:* [abc]</b></tt></dt>

<dd>The server is running on VMS and you want it to send all the files in the
directory tree rooted at <tt>[ABC]</tt>.  But since "<tt>[abc]</tt>" looks
just like a wildcard, you have to include a <tt>/MATCH:</tt> switch to force
Kermit to send "<tt>[abc]</tt>" as the MLSD argument.

</dl>
<p>

In all cases in which the /RECURSIVE switch is included, the server's tree is
duplicated locally.

<p>
<blockquote>
<i>

Although MLSD allows recursion and NLST does not, the MLSD specification
places a heavy burden on the client; the obvious, straightforward, and elegant
implementation (depth-first, the one that Kermit currently uses) requires as
many open temporary files as the server's directory tree is deep, and
therefore client resource exhaustion -- e.g. exceeding the maximum number of
open files -- is a danger.  Unfortunately MLSD was not designed with recursion
in mind.  (Breadth-first traversal could be problematic due to lack of
sufficient navigation information.)

</i>
</blockquote>
<p>

Of course all of Kermit's other MGET switches can be used too, e.g. for
finer-grained file selection (by date, size, etc), for moving or renaming
files as they arrive, to override Kermit's automatic per-file text/binary
mode switching, to pass the incoming files through a filter, to convert
text-file character sets, and so on.

<h3><a name="x3.11.4.4"><font color="red">3.11.4.4. NLST/MLSD Summary Table</font></a></h3>

Here's a table summarizing MGET behavior when the server supports both
NLST and MLSD.  /NLST and /MLSD switches are included for clarity to indicate
which protocol is being used, and the expected effects.  In practice you can
omit the /NLST and /MLSD switches and the Kermit client chooses the
appropriate or desired protocol as described above.  Sample commands presume
a Unix file system on the server, but of course the server can have any
file system or syntax at all.

<a name="table"><p></a>
<blockquote>
<table border>
<tr>
<th align="left">User's Command
<th align="left">FTP Sends
<th align="left">Remarks

<tr>
<td valign="top"><tt>mget&nbsp;/nlst</tt>
<td valign="top"><tt>NLST</tt>

<td valign="top">Gets a list of all the files in the server's current and
downloads each file.  The list includes names only, so Kermit also must send
SIZE and MDTM directives if size and timestamp information is required (this
is always true of NLST).  Sending NLST without an argument is allowed by the
RFC959 NLST definition and by the Kermit FTP client, but might not work with
other clients, and also might not work with every server.

<tr>
<td valign="top"><tt>mget&nbsp;/nlst&nbsp;foo</tt>
<td valign="top"><tt>NLST&nbsp;foo</tt>

<td valign="top">If "foo" is a directory, this gets a list of all the files
from the server's "foo" directory and downloads each file; otherwise this
downloads the file named "foo" (if any) from the server's current directory.

<tr>
<td valign="top"><tt>mget&nbsp;/nlst&nbsp;*.txt</tt>
<td valign="top"><tt>NLST&nbsp;*.txt</tt>

<td valign="top">Gets a list of the files in the server's current directory
whose names match the pattern <tt>*.txt</tt>, and then downloads each file
from the list.  Because we are using NLST, we send the filespec
(<tt>*.txt</tt>) to the server and the server interprets any wildcards.

<tr>
<td valign="top"><tt>mget&nbsp;/nlst&nbsp;foo/*.txt</tt>
<td valign="top"><tt>NLST&nbsp;foo/*.txt&nbsp;</tt>

<td valign="top">Gets a list of the files in the server's "foo" directory
whose names match the pattern <tt>*.txt</tt>, and then downloads each file
from the list (server interprets wildcards).

<tr>
<td valign="top"><tt>mget&nbsp;/nlst&nbsp;/match:*.txt</tt>
<td valign="top"><tt>NLST</tt>

<td valign="top">Gets a list of <i>all</i> the files in the server's current
directory and then downloads each one whose name matches the pattern
<tt>*.txt</tt> (client interprets wildcards).

<tr>
<td valign="top"><tt>mget&nbsp;/nlst&nbsp;/match:*.txt&nbsp;foo&nbsp;</tt>
<td valign="top"><tt>NLST&nbsp;foo</tt>

<td valign="top">Gets a list of all the files in the server's "foo"
directory and then downloads each one whose name matches the pattern
<tt>*.txt</tt> (client interprets wildcards).

<tr>
<td valign="top"><tt>mget&nbsp;/mlsd</tt>
<td valign="top"><tt>MLSD</tt>

<td valign="top">Gets a list of all the files from the server's current
directory and then downloads each one.  The list might include size and
timestamp information, in which case Kermit does not need to send SIZE
and MDTM directives for each file (this is always true of MLSD).

<tr>
<td valign="top"><tt>mget&nbsp;/mlsd&nbsp;foo</tt>
<td valign="top"><tt>MLSD&nbsp;foo</tt>

<td valign="top">Gets a list of all the files from the server's "foo"
directory (where the string "foo" does not contain wildcards) and then
downloads each one.  If "foo" is a regular file and not a directory, this
command is supposed to fail, but some servers have been observed that send
the file.

<tr>
<td valign="top"><tt>mget&nbsp;/mlsd&nbsp;*.txt</tt>
<td valign="top"><tt>MLSD</tt>

<td valign="top">Gets a list of <i>all</i> the files from the server's current
directory and then downloads only the ones whose names match the pattern
"<tt>*.txt"</tt>.  Because we are using MLSD and the MGET filespec is wild, we
do <i>not</i> send the filespec to the server, but treat it as though it had
been given in a /MATCH: switch and use it locally to match the names in the
list.

<tr>
<td valign="top"><tt>mget&nbsp;/mlsd&nbsp;foo/*.txt</tt>
<td valign="top"><tt>MLSD</tt>

<td valign="top">This one won't work because MLSD requires that the notions of
server directory and filename-matching pattern be separated.  However, the
client, which can't be expected to know the server's file-system syntax, winds
up sending a request that the server will (or should) reject.

<tr>
<td valign="top"><tt>mget&nbsp;/mlsd&nbsp;/match:*.txt</tt>
<td valign="top"><tt>MLSD</tt>

<td valign="top">Gets a list of all the files from the server's current
directory and then downloads only the ones whose names match the pattern
"<tt>*.txt"</tt> (client interprets wildcards).

<tr>
<td valign="top"><tt>mget&nbsp;/mlsd&nbsp;/match:*.txt&nbsp;foo</tt>
<td valign="top"><tt>MLSD&nbsp;foo</tt>

<td valign="top">If "foo" is a directory on the server, this gets a list of
all the files from the server's "foo" directory and then downloads only the
ones whose names match the pattern "<tt>*.txt"</tt> (client interprets
wildcards).  This leaves the server CD'd to the "foo" directory; there's no
way the client can restore the server's original directory because MLSD
doesn't give that information, and since the client can not be expected to
know the server's file-system syntax, it would not be safe to guess.  If "foo"
is a regular file, MLSD fails.

<tr>
<td valign="top"><tt>mget&nbsp;/mlsd&nbsp;foo&nbsp;bar</tt>
<td valign="top"><tt>MLSD</tt>

<td valign="top">This one is problematic.  You're supposed to be able to give
MGET a list a filespecs; in this case we name two directories.  The client
must change the server's directory to "foo" to get the list of files, and then
the files themselves.  But then it has no way to return to the server's
previous directory in order to do the same for "bar", as explained in the
previous example.


<tr>
<td valign="top"><tt>mget&nbsp;/mlsd&nbsp;/match:*&nbsp;[abc] </tt>
<td valign="top"><tt>MLSD&nbsp;[abc]</tt>

<td valign="top">Including a /MATCH: switch forces <tt>[abc]</tt> to be sent to
the server even though the client would normally think it was a wildcard and
hold it for local interpretation.  In this example, <tt>[abc]</tt> might be
a VMS directory name.

<tr>
<td valign="top"><tt>mget&nbsp;/mlsd&nbsp;/match:*&nbsp;t*.h</tt>
<td valign="top"><tt>MLSD&nbsp;t*.h</tt>

<td valign="top">Contrary to the MLSD specification, some MLSD-capable FTP
servers <i>do</i> interpret wildcards.  This form of
the MGET command can be used to force a wildcard to be sent to the server
for interpretation.

</table>
</blockquote>
<p>

When MLSD is used implicitly (that is, without an /MLSD switch given to force
the use of MLSD) and an MGET command such as "<tt>mget</tt> <tt>foo/*.txt</tt>"
fails, Kermit automatically falls back to NLST and tries again.

<h3><hr><a name="x3.11.5"><font color="red">3.11.5. References</font></a></h3>

<p>
<ol>

<li>Postel, J., and J. Reynolds,
<cite>File Transfer Protocol (FTP)</cite>,
RFC 959, October 1985:
<a href="ftp://ftp.isi.edu/in-notes/rfc959.txt"><tt>ftp://ftp.isi.edu/in-notes/rfc959.txt</tt></a>.

<p>

<li>Hethmon, P, and R. Elz, <cite>Feature negotiation mechanism for the File
Transfer Protocol</cite>, RFC 2389, August 1998:
<a href="ftp://ftp.isi.edu/in-notes/rfc2389.txt"><tt>ftp://ftp.isi.edu/in-notes/rfc2389.txt</tt></a>.

<p>

<li>Elz, R, and P. Hethmon, <cite>Extensions to FTP</cite>, Internet Draft
draft-ietf-ftpext-mlst-16.txt, September 2002:
<a href="http://www.ietf.org/internet-drafts/draft-ietf-ftpext-mlst-16.txt"><tt>http://www.ietf.org/internet-drafts/draft-ietf-ftpext-mlst-16.txt</tt></a>.

<p>

<li><a href="http://www.columbia.edu/kermit/ftpclient.html">The Kermit
FTP Client</a> (overview).

</ol>

<p>

[ <a href="#top">Top</a> ]
[ <a href="#ftp">FTP Top</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x4"><hr>4. FILE SCANNING</a></h2>

A new feature called file scanning is used in various contexts to determine
if a file is text or binary, and if it is text, what kind of text.  The
overhead of file scanning is surprisingly tolerable, usually about a quarter
second per file.  File scanning is now used instead of filename patterns
unless you SET FILE SCAN OFF, which restores the previous behavior.
<p>
The primary benefit of file scanning is in file transfer.  For all practical
purposes, now you can stop worrying about whether a file should be sent in
binary or text mode, or about sending mixtures of text and binary files in a
single operation, or configuring and fine-tuning your lists of binary-file and
text-file name patterns: now it all just works.
<p>
File scanning is done by the file sender, which determines the type of each
file before it sends it and informs the receiver (Kermit or FTP server) of the
type.  File scanning is NOT done by the receiver, because it is the sender's
responsibility to determine each file's type, send the file in the right mode,
and inform the receiver of the mode.  If both transfer partners are capable of
this (or any other) form of automatic text/binary mode switching, then files
can be sent in both directions with no worries about corruption due to
inappropriate transfer mode.  (As noted in
<a href="#x3">Section 3</a>, FTP servers don't do
this, so this discussion does not apply when using Kermit to download from
an FTP server.)
<p>
The rest of this section is mainly for the curious.  If you don't read it and
simply accept all defaults, every file you send should go in the appropriate
mode automatically.  As always, however, for character-set translation to work
for 7- and 8-bit character-set files, the appropriate SET FILE CHARACTER-SET
command(s) must have been executed to identify their encoding (Kermit's
default file character-set is neutral ASCII except on platforms like HP-UX or
DG/UX, where the default file character-set is known).  And of course,
receiving is another matter -- obviously the other Kermit must also send each
file in the appropriate mode.
<p>
Scanning is more reliable than filename patterns simply because filenames are
not reliable indicators of the file's contents.  Classic examples include
"<tt>.doc</tt>" files, which are binary if Microsoft Word documents but text
on most other platforms, and "<tt>.com</tt>" files, which are binary on DOS
and Windows but text on VMS.  Anyway, nobody knows the naming conventions (if
any) of all the applications (and persons!) on your computer.  Scanning, on
the other hand, determines each file's type by inspecting its contents rather
than just looking at its name.
<p>
Also, file patterns -- even when they work as intended -- categorize each file
only as text or binary, whereas file scanning can make finer distinctions:
<p>
<dl>
<dt><tt><b>BINARY</b></tt></dt>
<dd>Binary data, not to be converted in any way.  Examples include binary
machine code (executable programs), graphics images (GIF, JPG, etc),
compressed files (Z, GZ, etc), archives and packages (ZIP, TAR, RPM,
etc), object files and libraries (OBJ, DLL, etc).
<p>
<dt><tt><b>7-BIT TEXT</b></tt></dt>
<dd>Text encoded in a 7-bit character set such as ASCII or one of the ISO
646 national versions.  Kermit has no way to tell which character is
used, only that it's 7-bit text.  Typical examples include program
source code, README files, Perl or Kermit scripts, plain-text email,
HTML, TeX, and various textual encodings of binary files: Hex, Base64,
etc.  When sending such files, the FILE DEFAULT 7BIT-CHARACTER-SET is
used as the file character-set, and then the appropriate transfer
character set is chosen from the associations list (ASSOCIATE, SHOW
ASSOCIATIONS).
<p>
<dt><tt><b>8-BIT TEXT</b></tt></dt>
<dd>Text encoded in an 8-bit character set such as Latin-1, Latin-2,
Latin/Hebrew, Latin/Cyrillic, KOI8, HP-Roman8, JIS X 0208, Code Page
437, or Code Page 1252.  Again, Kermit has no way of knowing which
particular set is in use, only that it's 8-bit text.  When sending such
files, the FILE DEFAULT 8BIT-CHARACTER-SET is used as the file
character-set, and then the appropriate transfer character set is chosen
from the associations list.
<p>
<dt><a name="ucs2"><tt><b>UCS2 TEXT</b></tt></name></dt>
<dd>Unicode in its basic form, 16 bits (2 octets) per character.  When
sending such files, UCS2 is the file character-set and the byte order is
identified automatically; the appropriate transfer character set is chosen
from the associations list.  Normally this would be UTF8.  UTF-16 is not
supported yet; Kermit's Unicode translations are restricted to Plane 0,
the Base Multilingual Plane (BMP).

<p>
<dt><tt><b>UTF8 TEXT</b></tt></dt>
<dd>Unicode in its 8-bit transformation format.  When sending such files,
UTF8 is the file character-set; the appropriate transfer character set
is chosen from the associations list, normally UCS2 or UTF8.
</dl>
<p>
File scanning is available in UNIX C-Kermit, in K-95, and to a limited extent,
in VMS C-Kermit (full scanning is problematic in VMS because even plain-text
files might contain binary record-format information).  The relevant commands
are:
<p>
<dl>
<dt><tt><b>SET TRANSFER MODE</b> <i>{</i> <b>AUTOMATIC, MANUAL</b> <i>}</i><b></b></tt></dt>
<dd>Tells whether the file-transfer mode (text or binary) should be set by
automatic or "manual" means.  AUTOMATIC is the default, which allows any
of the automatic methods that are enabled to do their jobs: FILE SCAN,
FILE PATTERNS, peer recognition, etc.  MANUAL lets you control the transfer
mode with the SET FILE TYPE commands.  As always, /TEXT and /BINARY
switches on your file-transfer commands override all other methods; if
you give one of these switches, scanning is not done.  SHOW TRANSFER
displays the current TRANSFER MODE setting.
<p>
<dt><tt><b>SET FILE SCAN</b> <i>{</i> <b>ON</b> <i>[ number ],</i> <b>OFF</b> <i>}</i><b></b></tt></dt>
<dd>Turns this feature on and off.  It's ON by default.  When OFF, the
previous rules apply (SET FILE PATTERNS, etc).  When ON is given, you
can also specify a number of bytes to be scanned.  The default is
49152 (= 48K).  If a negative number is given, the entire file is scanned,
no matter how big, for maximum certainty (for example, a PostScript file
that appears to be plain text might include an embedded graphic past the
normal scanning limit).  SHOW FILE displays the current FILE SCAN setting.
<p>
<dt><tt><b>SET FILE DEFAULT 7BIT-CHARACTER-SET</b> <i>name</i></tt></dt>
<dd>Tells the 7-bit character-set to use if scanning identifies a 7-bit text
file, e.g. GERMAN.  SHOW FILE displays the current SET FILE DEFAULT
settings.  So does SHOW CHARACTER-SETS.
<p>
<dt><tt><b>SET FILE DEFAULT 8BIT-CHARACTER-SET</b> <i>name</i></tt></dt>
<dd>Tells the 8-bit character-set to use if scanning identifies an 8-bit
text file, e.g. LATIN1.  SHOW FILE and SHOW CHARACTER-SET display this.
<p>
<dt><tt><b>ASSOCIATE FILE-CHARACTER-SET</b> <i>fcs tcs</i></tt></dt>
<dd>When sending files and a file character-set (fcs) is identified by
scanning, this tells C-Kermit which transfer character-set (tcs) to translate
it to.  It also allows C-Kermit to set the appropriate transfer character-set
automatically whenever you give a SET FILE CHARACTER-SET command.
<p>
<dt><tt><b>ASSOCIATE TRANSFER-CHARACTER-SET</b> <i>tcs fcs</i></tt></dt>
<dd>When receivinging files and a file arrives whose transfer character-set
(tcs) is announced by the sender, this command tells C-Kermit which file
character-set (fcs) to translate it to.  It also allows C-Kermit to set
the appropriate file character-set whenever you give a SET TRANSFER
CHARACTER-SET command.
<p>
<dt><tt><b>SET FILE CHARACTER-SET</b> <i>name</i></tt></dt>
<dd>When given for a 7-bit set, also sets FILE DEFAULT 7BIT-CHARACTER-SET to
  the same set.  When given for an 8-bit set, also sets FILE DEFAULT
  8BIT-CHARACTER-SET to the same set.  If an ASSOCIATE FILE-CHARACTER-SET
  command has been given for this set, also sets the corresponding
  transfer character-set.
<p>
<dt><tt><b>DIRECTORY /XFERMODE</b> <i>[ filespec ]</i></tt></dt>
<dd>Performs a file scan of the given files, listing the result for each file.
  If FILE SCAN is OFF but PATTERNS are ON, the result shown according to the
  current FILE TEXT-PATTERNS and BINARY-PATTERNS, and are restricted to
  (B) and (T).  When FILE SCAN is ON, the results are:
<p><pre>
  (B)          Binary
  (T)(7BIT)    Text: 7-bit
  (T)(8BIT)    Text: 8-bit
  (T)(UTF8)    Text: Unicode UTF8
  (T)(UCS2BE)  Text: Unicode UCS2 Big Endian
  (T)(UCS2LE)  Text: Unicode UCS2 Little Endian
</pre>
<p>
  So you can use DIR /XFER to get a preview of how each file in a
  selected group will be transferred.  Everything to the right of the (B)
  or (T) is new.  If FILE SCAN is OFF, you only get the (B) or (T) as
  before.
<p>
  Note: Big and Little Endian refer to the ordering of bytes within a
  computer word.  Big Endian architecture is standard and is used on most
  non-PC computers.  Little Endian architecture is used on PCs.
</dl>
<p>
To illustrate file-transfer with scanning, suppose you have a directory
containing a mixture of text and binary files, and each text file can be
7-bit German ISO 646, 8-bit Latin-1, or Unicode in any of the following forms:
UCS2 Little Endian, UCS2 Big Endian, or UTF8 (<a href="#ucs2">UTF-16</a> is
not supported yet).  Assuming all the built-in defaults are in effect, the
following three commands do the job:
<p><pre>
  set file char german   ; This sets the default for 7-bit text files
  set file char latin1   ; This sets the default for 8-bit text files
  send *
</pre>
<p>
Each file is sent in the appropriate mode (text or binary), with text files
converted to the appropriate transfer character-set and labeled so the
receiver can convert them according to its own local conventions.
<p>
By the way, what if you want to inhibit character-set translation but still
allow automatic text/binary mode switching?  Previously, you could simply SET
TRANSFER CHARACTER-SET TRANSPARENT.  But now with file scanning, the file
and transfer character-sets are set automatically per file.  A new command
was added for this purpose:
<p>
<dl>
<dt><tt><b>SET TRANSFER TRANSLATION</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>
<dd>Enables and disables file-transfer character-set translation.  It is
enabled by default.
</dl>
<p>
When TRANSFER TRANSLATION is OFF but FILE SCAN is ON, files are still
scanned to see if they are text or binary, but no character-set translation
is done when they text: only the normal record-format conversion.
<p>
Like all SET commands, SET TRANSFER TRANSLATION is global and persistent.  You
can also force a particular file-transfer command (SEND, MSEND, GET, RECEIVE,
TRANSMIT, etc) to not translate without affecting the global translation
settings by including the new /TRANSPARENT switch, e.g.
<p><pre>
  send /transparent oofa.txt
</pre>
<p>
<font color="red">As of C-Kermit 8.0.206, SET TRANSFER CHARACTER-SET
TRANSPARENT implies SET TRANSFER TRANSLATION OFF.</font>

<p>

File scanning is also used in the TYPE command.  The source file type and
character set are determined as above, and then the file is automatically
converted to your display character-set, line by line.  In Kermit 95, the
display character-set is Unicode, perhaps converted to your current console
code page; in other versions of C-Kermit, it is your current file
character-set.  Thus if you have the following set appriately:

<p><pre>
  SET FILE CHARACTER-SET (necessary in Unix but not K95)
  SET FILE DEFAULT 7BIT CHARACTER-SET
  SET FILE DEFAULT 8BIT CHARACTER-SET
</pre>
<p>
then you should be able to TYPE any text file and see something reasonable.
For example, in Unix, if your DEFAULT 7BIT-CHARACTER-SET is ITALIAN and your
DEFAULT 8BIT-CHARACTER-SET is LATIN1, and your FILE CHARACTER-SET is LATIN1,
you can TYPE an Italian ISO 646 file, a Latin-1 file, or any kind of Unicode
file, and have it translated automatically to Latin-1 for your display.
<p>
In the GUI version of Kermit 95, you can see
mixtures of many different scripts if the file is UTF8 or UCS2: Roman,
Cyrillic, Hebrew, Greek, Armenian, Georgian, etc, all on the same screen at
once.
<p>
File scanning also adds a new criterion for file selection, i.e. to select
only text (or binary) files.  Several commands now include a new switch,
/TYPE:{BINARY,TEXT,ALL}.  BINARY means select only binary regular files (not
directories).  TEXT means select only text files.  ALL means don't scan;
select all files.  Examples:
<p>
<dl>
<dt><tt><b>SEND /TYPE:BINARY *.*</b></tt></dt>
<dd>Sends only binary files, skipping over text files.
</dl>
<p>
NOTE: File scanning is NOT done when using external protocols (because the
external protocol programs, such as sz, are processing each file, not Kermit).
<p>
<dl>
<dt><tt><b>DIRECTORY /TYPE:TEXT</b></tt></dt>
<dd>Lists only text files but not binary files.
<p>
<dt><tt><b>  DELETE /TYPE:BINARY foo.*</b></tt></dt>
<dd>Deletes all foo.* files that are regular binary files but does not
delete any text files.
<p>
<dt><tt><b>CHMOD /TYPE:BINARY 775 *</b></tt></dt>
<dd>(UNIX) Changes the permissions of all binary files to 775.
</dl>
<p>
When FILE SCAN is OFF and FILE PATTERNS are ON, behavior is as before with
PATTERNS ON, but with some improvements:
<p>
<ul>
<li>Pathnames are now stripped prior to pattern matching.
<li>Backup suffixes (like <tt>.~3~</tt>) are stripped prior to pattern
matching.
</ul>
<p>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x5"><hr>5. FILE AND DIRECTORY NAMES CONTAINING SPACES</a></h2>

Prior to the introduction of the graphical user interface (GUI), it was
inconceivable that file or directory names could contain spaces, because space
is a field delimiter in all command languages.  GUIs, however, use dialog
boxes for filenames, so there is never any question of distinguishing a
filename from adjacent fields -- because there <i>are</i> no adjacent fields
-- and therefore it has become quite common on computers that have GUIs to
have file and directory names composed of multiple words.  Of course this
poses problems for command shells and other text-oriented programs.

<p>

Most command shells address these problems by allowing such names to be
enclosed in doublequotes, e.g.:
<p><pre>
  cd "c:\Program Files"
</pre>
<p>
C-Kermit previously used braces for this:
<p><pre>
  cd {c:\Program Files}
</pre>
<p>
which was not what most people expected.  And even when braces were used,
Kermit had difficulties with completion, file menus, and so forth, within
braced fields.
<p>

C-Kermit 8.0 allows either doublequotes or braces to be used for grouping:

<p><pre>
  send "this file"
  send {this file}
  rename "this file" "that file"
  rename {this file} "that file"
  rename "this file" {that file}
  cd {Program Files}
  cd "Program Files"
</pre>
<p>

Note that the doublequotes or brackets must enclose the whole file or
directory specification:

<p>
<pre>
  "c:\My Directory"
</pre>
<p>

not:

<p>
<pre>
  c:\"My Directory"
</pre>
<p>

In C-Kermit 8.0, you can also use completion on these filenames, in which case
Kermit supplies the quotes (or braces) automatically.  Example (in which the
current directory contains only one file whose name starts with "th" and its
full name is "this file" (without the quotes, but with the space)):

<p><pre>
  cat th&#60;Tab&#62;
</pre>
<p>
Kermit repaints the filename field like this:
<p><pre>
  cat "this file"
</pre>
<p>
That is, it backspaces over the original "th" and then writes the filename
in doublequotes.
<p>
If completion is only partial, Kermit still supplies the quotes, but in this
case also beeps.  To continue the filename, you must first backspace over the
closing quote.  The closing quote is supplied in this case to make sure that
you can see the spaces, especially if they are trailing.  For example, if the
current directory contains two files whose names start with "th", and their
fill names are "this file" and "this other file":
<p><pre>
  cat th&#60;Tab&#62;
</pre>
<p>
Kermit prints:
<p><pre>
  cat "this "&#60;Beep&#62;
</pre>
<p>
If it didn't print the closing quote, you would probably wonder why it was
beeping.
<p>
Also, if you begin a filename field with a doublequote or opening brace,
now you can use completion or get ?-help; this was never possible before.
<p><pre>
 C-Kermit&gt;<u>type "thi?</u> Input file specification, one of the following:
   this file        this other file
 C-Kermit&gt;type "thi_
</pre>
<p>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x6"><hr>6. OTHER COMMAND PARSING IMPROVEMENTS</a></h2>

<h3><a name="x6.1">6.1. Grouping Macro Arguments</a></h2>

Doublequotes now can be used in macro invocations to group arguments
containing spaces, where previously only braces could be used:
<p><pre>
  define xx show args
  xx one "this is two" three
</pre>
<p>
Result:
<p><pre>
  Macro arguments at level 0 (\v(argc) = 4):
   \%0 = xx
   \%1 = one
   \%2 = this is two
   \%3 = three
</pre>
<p>
Also, you can now quote braces and quotes in macro args (this didn't work
before).  Examples:
<p><pre>
  xx "{"  ; The argument is a single left brace
  xx {"}  ; The argument is a doublequote character
</pre>
<p>
In case this new behavior interferes with your scripts, you can restore the
previous behavior with:
<p><pre>
  SET COMMAND DOUBLEQUOTING OFF
</pre>

<h3><a name="x6.2">6.2. Directory and File Name Completion</a></h2>

C-Kermit 8.0 also includes better completion for directory names, e.g. in the
CD command.  If the name typed so far uniquely matches a directory name, it is
completed (as before), but now if the directory contains any subdirectories,
completion is partial (allowing you to supply additional path segments without
backspacing); otherwise it is complete.
<p>
Completion has also been improved for file and directory names that contain
not only spaces (as described above) but also "metacharacters" such as
asterisk (<tt>*</tt>) and tilde (<tt>~</tt>): now the field is repainted if
necessary.  For example, if the current directory contains only one file whose
name contains "blah", then in:
<p><pre>
  type *blah&#60;Tab&#62;
</pre>
<p>
"*blah" is replaced by the filename.  In earlier releases, the part typed so
far was left on the command line (and in the history buffer), so even when the
original command worked, the recalled version would not.  Similarly for
<tt>~</tt> (the nearly-universal Unix notation for username):
<p><pre>
  type ~olga/x&#60;Tab&#62;
</pre>
<p>
is repainted as (e.g.):
<p><pre>
  type /users/home/olga/x(Beep)
</pre>
<p>
Speaking of command history, the new SHOW HISTORY command shows your command
history and recall buffer.  SAVE COMMAND HISTORY saves it into a file of your
choice.

<h3><a name="x6.3">6.3. Passing Arguments to Command Files</a></h2>

The method for passing arguments to command files has been improved.
Prior to C-Kermit 7.0 there was no provision for doing this.  In C-Kermit 7.0,
the TAKE command was changed to allow arguments to be given after the filename:
<p><pre>
  take commandfile <i>arg1 arg2</i> ...
</pre>
<p>

This was accomplished by replacing the <i>current</i> <tt>\%1</tt>,
<tt>\%2</tt>, etc, with the given arguments, since a new set of macro argument
variables is created only when a macro is executed, not a command file.  It is
much more intuitive, however, if arguments to command files worked like those
to macros: the command file sees the arguments as its own <tt>\%1</tt>,
<tt>\%2</tt>, etc, but the caller's variables are not disturbed.  C-Kermit 8.0
accomplishes this by automatically creating an intermediate temporary macro to
start the command file (if any arguments were given), thus creating a new
level of arguments as expected.

<h3><a name="x6.4">6.4. More-Prompting</a></h2>

The familiar <tt>--more?--</tt> prompt that appears at the end of each
screenful of command-response output now accepts a new answer: G (Go)
meaning "show all the rest without pausing and asking me any more questions".
P (Proceed) is a synonym for G.

<h3><a name="x6.5">6.5. Commas in Macro Definitions</a></h2>

As noted in the <a href="ckb2.html">C-Kermit manual</a>, comma is used
to separate commands in a macro definition.  Even when the macro is defined on
multiple lines using curly-brace block-structure notation without commas, the
definition is still stored internally as a comma-separated list of commands.
Therefore special tricks are needed to include a comma in a command.  The
classic example is:

<p>
<pre>
  define foo {
      <i>(some command)</i>
      if fail echo Sorry, blah failed...
  }
</pre>
<p>
This would result in Kermit trying to execute a "blah" command.  This could
always be handled by enclosing the text in braces:
<p>
<pre>
  define foo {
      (some command)
      if fail echo {Sorry, blah failed...}
  }
</pre>
<p>
but doublequotes (more intuitive) should have worked too.  Now they do:
<p>
<pre>
  define foo {
      (some command)
      if fail echo "Sorry, blah failed..."
  }
</pre>

<h3><a name="x6.6">6.6. Arrow Keys</a></h2>

As of version 8.0.201, C-Kermit on most platforms lets you access the command
history buffer with arrow keys, just as you always could with control
characters.  The restrictions are:

<p>
<ol>
<li>Only Up and Down arrow keys are accepted.
<li>Only 7-bit ANSI arrow-key sequences are understood (ESC followed by
<tt>[</tt> or uppercase letter <tt>O</tt>, followed by uppercase letter
<tt>A</tt> or (up) <tt>B</tt> (down).
</ol>
<p>

This change was made to facilitate command recall in Linux-based PDAs
that don't have a Control key, or at least not one that's easily (or always)
accessible, such as the Sharp Zaurus SL5500.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x7"><hr>7. NEW COMMANDS AND SWITCHES</a></h2>

See <a href="#x4">Section 4</a> for more about file scanning and the
<tt>/TYPE:</tt> switch.
<p>
<dl>
<dt><tt><b>ASK[Q]</b> <i>[</i> <b>/TIMEOUT:</b><i>number
<font color="red">/QUIET</font>
 ] variable [ prompt ]</i></tt></dt>

<dd>The new optional <tt>/TIMEOUT:</tt> switch for ASK and ASKQ causes the
command to time out and and fail if no response is given within the specified
number of seconds, 1 or greater (0 or less means no timeout, wait forever).
This works just like SET ASK-TIMER, except its effect is local to the ASK
command with which it is given and it does not disturb the global ask timer
setting.  <font color="red">The new /QUIET switch tells Kermit not to print
an error message if the ASK or ASKQ command times out waiting for a response.
</font>

<p>

<dt><tt><b>CAT</b> <i>filename</i></tt></dt>
<dd>Equivalent to TYPE /NOPAGE.

<p>

<dt><tt><b>CDUP</b></tt></dt>
<dd>Changes Kermit's local working directory to the parent of the current
one.  Equivalent to "<tt>cd</tt> <tt>..</tt>" in UNIX or Windows,
"<tt>cd</tt> <tt>[-]</tt>" in VMS, 
"<tt>cd</tt> <tt>^</tt>" in AOS/VS,
etc; in other words, it's a
platform-independent way of moving one level up in a directory tree.

<p>

<dt><tt><b>CHMOD</b> <i>[ switches ] permission files</i></tt></dt>
<dd>UNIX only.  Sets file permissions for one or more files or directories.
The permission must be given as an octal number, e.g. 664, 755.  Switches:
<tt>/DIRECTORIES</tt>, <tt>/FILES</tt>, <tt>/NOLIST</tt>, <tt>/PAGE</tt>,
<tt>/DOTFILES</tt>, <tt>/LIST</tt>, <tt>/NOPAGE</tt>, <tt>/RECURSIVE</tt>,
<tt>/TYPE:<i>{</i>TEXT,BINARY,ALL<i>}</i>, /SIMULATE</tt>.  The <tt>/TYPE:</tt>
switch allows selection of only text or binary files.  For example, if you
have a mixture of source files and executables, you can use "chmod /files
/type:text 664" to give owner/group read/write and world read permission to
the text files, and "chmod /files /type:binary 775" to give the same plus
execute permission to the executables.  Use <tt>/SIMULATE</tt> to see which
files would be affected, without actually changing their permissions.

<p>
<dt><tt><b>CLEAR KEYBOARD-BUFFER</b></tt></dt>
<dd>Flushes any as-yet unread characters from the keyboard input buffer.
 Useful for flushing typeahead in scripts.
<p>

<dt><font color="red"><tt><b>CONTINUE</b></tt></font></dt>

<dd><font color="red">When given at an interactive command prompt that was
reached by issuing a PROMPT command (described in this section) from a script,
this command returns to the script, continuing its execution at the command
after the PROMPT command.  In this context, CONTINUE is simply a
more-intuitive synonym for END.
</font>

<p>

<dt><tt><b>COPY, RENAME,</b></tt> and <tt><b>TRANSLATE</b></tt></dt>
<dd>These commands now work on file groups if the target filename
is a directory, e.g. "<tt>copy&nbsp;oofa.*&nbsp;..</tt>",
"<tt>rename&nbsp;*&nbsp;~olga/tmp/</tt>"

<p>

<dt><font color="red"><tt><b>COPY /APPEND</b>
<i>source destination</i></tt></font></dt>

<dd><font color="red">The source file specification can now include wildcards,
in which case all of the source files that match will go into the destination
file in alphabetical order by name.
</font>

<p>
<dt><tt><b>DELETE /ASK</b></tt></dt>
<dd>Asks permission to delete each file before deleting it.  In C-Kermit 7.0,
the answers were "yes" (or "ok") and "no".  C-Kermit 8.0 adds "go" (meaning,
delete all the rest without asking) and "quit" (cancel the DELETE command
and return to the prompt).
<p>
<dt><tt><b>DELETE /DIRECTORIES</b></tt></dt>
<dd>Deletes not only files but also directories.
<p>
<dt><tt><b>DELETE /RECURSIVE</b></tt></dt>
<dd>Deletes all files that match the given file specification in the
current (or given) directory and all directories beneath it.
<p>
<dt><tt><b>DELETE /SUMMARY</b></tt></dt>
<dd>Prints only the number of files deleted and total size freed, without
listing each file.
<p>
<dt><tt><b>DELETE /TREE</b></tt></dt>
<dd>Shorthand for DELETE /RECURSIVE /DIRECTORIES /DOTFILES/.
Equivalent to Windows DELTREE or Unix "<tt>rm&nbsp;-Rf</tt>".  If no file
specification is given, the contents of the current directory, plus all of
its subdirectories and their contents, are deleted.
<p>
<dt><tt><b>DELETE /TYPE:BINARY</b></tt></dt>
<dd>Delete only regular binary files (requires FILE SCAN ON).
<p>
<dt><tt><b>DELETE /TYPE:TEXT</b></tt></dt>
<dd>Delete only regular text files (requires FILE SCAN ON).
<p>

<p>
<dt><tt><b>DIRECTORY</b> <i>[ switches ] [ filespec
<font color="red">[ filespec [ filespec ... ] ]</font> ]</i></tt></dt>

<dd><font color="red">The DIRECTORY command now accepts more than one file
specification; e.g. "directory moon.txt sun.doc stars.*".
</font>

<p>

<dt><tt><b>DIRECTORY /NORECURSIVE</b> <i>xxx</i></tt></dt>
<dd>If xxx is a directory name, forces listing of the directory itself
rather than its contents.
<p>
<dt><tt><b>DIRECTORY /FOLLOWLINKS</b> <i>xxx</i></tt></dt>
<dd>(UNIX only) Tells the DIRECTORY command to follow symbolic links.  This
<i>not</i> the default because it can cause endless loops.
<p>
<dt><tt><b>DIRECTORY /NOFOLLOWLINKS</b> <i>xxx</i></tt></dt>
<dd>(UNIX only) Tells the DIRECTORY command not to follow symbolic links,
but rather, merely to list them.
This is the default.
<p>
<dt><tt><b>DIRECTORY /OUTPUT:</b><i>filename</i></tt></dt>
<dd>Sends the results of the DIRECTORY command to the given file.
<p>
<dt><tt><b>DIRECTORY /SUMMARY</b></tt></dt>
<dd>Prints only the number of directories and files and the total size,
without listing each file.
<p>
<dt><tt><b>DIRECTORY /TYPE:</b><i>{</i><b>TEXT,BINARY</b><i>}</i></tt></dt>
<dd>Shows only files of the selected type, based on file scan.
<p>
<dt><tt><b>DIRECTORY /XFERMODE</b></tt></dt>
<dd>Now shows results of file scan (see <a href="#x4">Section 4</a>).
<p>
<dt><tt><b>GREP</b> <i>[ switches ] pattern files</i></tt></dt>
<dd>Similar to Unix grep command: displays file lines that match the
given <a href="#x8.12">pattern</a>.  Switches:
<p>
<dl>
<dt><tt>/COUNT<i>[</i>:<i>variable]</i></tt>
<dd>Don't show the matching lines, just tell how many lines match.  If a
variable name is specified, the count is stored in the given variable.
<dt><tt>/DOTFILES</tt>
<dd>Include files whose names begin with dot.
<dt><tt>/LINENUMBERS</tt>
<dd>Show line numbers of matching lines.
<dt><tt>/NAMEONLY</tt>
<dd>only list
the names of files that contain matching lines, but not the lines themselves.
<dt><tt>/NOBACKUP</tt>
<dd>Skip backup files.
<dt><tt>/NOCASE</tt>
<dd>Ignore alphabetic case while pattern matching.
<dt><tt>/NODOTFILES</tt>
<dd>skip files whose names start with dot (period).
<dt><tt>/NOLIST</tt>
<dd>Suppress output but set SUCCESS or FAILURE according to search result.
<dt><tt>/NOMATCH</tt>
<dd>Look for lines that do <i>not</i> match the pattern.
<dt><tt>/NOPAGE</tt>
<dd>Don't pause between screens of output.
<dt><tt>/OUTPUT:<i>filename</i></tt>
<dd>Write results into the given file.
<dt><tt>/PAGE</tt>
<dd>Pause between screens of output.
<dt><tt>/RECURSIVE</tt>
<dd>Search files in subdirectories too.
<dt><tt>/TYPE:</tt><i>{</i><tt>TEXT,BINARY</tt><i>}</i></tt>
<dd>Search only files of the specified type.
</dl>
<p>
<i>Synonyms:</i> <b>FIND, SEARCH</b>.

<p>
<dt><font color="red"><tt><b>GETOK
/TIMEOUT:</b><i>n</i> <b>/QUIET</b></tt></font></dt>

<dd><font color="red">The new /QUIET switch instructs GETOK, when given
a timeout, not to print an error message if it times out.

</font>

<p>
<dt><tt><b>HEAD</b> <i>[ switches ] filename</i></tt></dt>
<dd>Equivalent to <tt>TYPE /HEAD <i>[ other-switches ] filename</i></tt>.

<p>
<dt><tt><b>HELP DATE</b></tt></dt>
<dd>Explains date-time formats, including timezone notation and delta times.

<p>
<dt><tt><b>HELP FIREWALLS</b></tt></dt>
<dd>Explains the firewall negotiation capabilities of your version of Kermit.

<p>


<dt><font color="red"><tt><b>KCD</b>
<i>[ symbolic-directory-name ]</i></font>
</tt></dt>

<dd><font color="red">Changes Kermit's working directory to the named symbolic
directory, such as such as exedir, inidir, startup, download, or and home.
Type "<tt>kcd</tt>&nbsp;<tt>?</tt>" for a list of symbolic directory names
known to your copy of Kermit, or give the new ORIENTATION command for a more
detailed explanation.  If you give a KCD command without a directory name,
Kermit returns to its "home" directory, which is determined in some way that
depends on the underlying operating system, but which you can redefine with
the (new) SET CD HOME command.  Your home directory is shown by SHOW CD and
it's also the value of the <tt>\v(home)</tt> variable.</font>

<p>
<dt><tt><b>LICENSE</b></tt></dt>
<dd>Displays the C-Kermit license.

<p>

<dt><a name="lcommands"><tt><b>L-commands</b></tt></a></dt>
<dd>When Kermit has a connection to a Kermit or FTP server, file managment
commands such as CD, DIRECTORY, and DELETE might be intended for the local
computer or the remote server.  C-Kermit 8.0.200 and earlier always executes
these commands on the local computer.  If you want them executed by the
remote server, you have to prefix them with REMOTE (e.g. REMOTE CD) or use
special R-command aliases (e.g. RCD = REMOTE CD, RDIR = REMOTE DIR, etc).
But this feels unnatural to FTP users, who expect unprefixed file management
commands to be executed by the remote server, rather than locally.  C-Kermit
8.0.201 adds <i>automatic locus switching</i> to present an FTP-like
interface for FTP connections and the normal Kermit interface for Kermit
connections, and a SET LOCUS command (described below) to control whether
or how this is done.  For when LOCUS is REMOTE, a new set of commands was
added for local management: LCD (Local CD), LDIR (Local DIR), etc.  These
are described below under SET LOCUS.

<p>
<dt><tt><b>MORE</b> <i>filename</i></tt></dt>
<dd>Equivalent to TYPE /PAGE.

<p>

<dt><font color="red"><tt><b>ORIENTATION</b></tt></font></dt>

<dd><font color="red">Displays symbolic directory names and the corresponding
variable names and values.  The symbolic names, such as exedir, inidir,
startup, download, and home, can be used as arguments to the new KCD command.
</font>

<p>

<dt><tt><b>PROMPT</b> <i>[ text ]</i></tt></dt>

<dd>For use in a macro or command file: enters interactive command mode
within the current context (<a href="#x8.1">Section 8.1</a>).  If the optional
<i>text</i> is included, the prompt is set to it.  The text can include
variables, functions, etc, as in the SET PROMPT command.  They are evaluated
each time the prompt is printed.  Unlike the SET PROMPT command, the text
argument applies only to the current command level.  Thus you can have
different prompts at different levels.

<p>

<dt><font color="red"><tt><b>REMOTE SET MATCH</b>
<i>{</i> <b>DOTIFILE</b>, <b>FIFO</b> <i>}</i>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></font></dt>

<dd><font color="red">Allows the client to tell the server whether wildcards
sent to the server should match dot files (files whose names begin with
period) or FIFOs (named pipes).  See SET MATCH.</font>

<p>
<dt><tt><b>SET ATTRIBUTE RECORD-FORMAT</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>
<dd>Allows control of the Kermit's Record-Format attribute.  Set this to
OFF in case incoming file are refused due to unknown or invalid record formats
if you want to accept the file anyway (and, perhaps, postprocess it to fix
its record format).

<p>
<dt><font color="red"><tt><b>SET CD HOME</b>
<i>[ directory ]</i></tt></font></dt>

<dd><font color="red">Specifies the target directory for the CD and KCD
commands, when they are given without an argument, and also sets the
value of the <tt>\v(home)</tt> variable.
</font>

<p>

<dt><tt><b>SET EXIT HANGUP</b> <i>{</i> <b>OFF</b>, <b>ON</b> <i>}</i></tt></dt>
<dd>Normally ON, meaning that when Kermit exits, it also explicitly hangs up
the current SET LINE / SET PORT serial port according to the current
SET MODEM TYPE and SET MODEM HANGUP METHOD, and closes the port device if
it was opened by Kermit in the first place (as opposed to inherited).
SET EXIT HANGUP OFF tells Kermit not to do this.  This can't prevent the
operating system from closing the device when Kermit exits (and it's a "last
close") but if the port or modem have been conditioned to somehow ignore the
close and keep the connection open, at least Kermit itself won't do anything
explicit to hang it up or close it.

<p>
<dt><tt><b>SET FILE EOF</b> <i>{</i> <b>CTRL-Z</b>, <b>LENGTH</b> <i>}</i></tt></dt>
<dd>Specifies the end-of-file detection method to be used by C-Kermit when
sending and receiving text files, and in the TYPE and similar text-file
oriented commands.  The normal and default method is LENGTH.  You can specify
CTRL-Z when handling CP/M or MS-DOS format text files, in which a Ctrl-Z
(ASCII 26) character within the file marks the end of the file.

<p>
<dt><tt><b>SET FILE LISTSIZE</b> <i>number</i></tt></dt>
<dd>Allocates space for the given number of filenames to be filled in by the
wildcard expander.  The current number is shown by SHOW FILE.  If you give
a command that includes a filename containing a wildcard (such as "<tt>*</tt>")
that matches more files that Kermit's list has room for, you can adjust the
list size with this command.

<p>
<dt><tt><b>SET FILE STRINGSPACE</b> <i>number</i></tt></dt>
<dd>Allocates space for the given amount of filename strings for use by
the wildcard expander.  The current number is shown by SHOW FILE.  The
<i>number</i> is the total number of bytes of all the file specifications that
match the given wildcard.

<p>
<blockquote>

If you need to process a bigger list of files than your computer has memory
for, you might be able use an external file list.  The Kermit SEND and the
FTP PUT and GET commands accept a <tt>/LISTFILE:</tt> switch, which gives the
name of a file that contains the list of files to be transferred.  Example
for UNIX:
<p>
<pre>
  !find . -print | grep / > /tmp/names
  ftp put /update /recursive /listfile:/tmp/names
</pre>
</blockquote>
<p>

<dt><a name="setlocus"><tt><b>SET LOCUS</b></a>
<i>{</i> <b>AUTO, LOCAL, REMOTE</b> <i>}</i></tt></dt>

<dd><i>Added in C-Kermit <b>8.0.201</b>.</i> &nbsp; Sets the locus for
unprefixed file management commands such as CD, DIRECTORY, MKDIR, etc.  When
LOCUS is LOCAL these commands act locally and a REMOTE (or R) prefix
(e.g. REMOTE CD, RCD, RDIR) is required to send file management commands to a
remote server.  When LOCUS is REMOTE, an L prefix is required to issue local
file management commands (e.g. LCD, LDIR).  The word LOCAL can't be used as a
prefix since it is already used for declaring local variables.  LOCUS applies
to all types of connections, and thus is orthogonal to SET GET-PUT-REMOTE,
which selects between Kermit and FTP for remote file-transfer and management
commands.  The default LOCUS is AUTO, which means we switch to REMOTE whenever
an FTP connection is made, and to LOCAL whenever a non-FTP connection is made,
and switch back accordingly whenever a connnection is closed.  So by default,
Kermit behaves in its traditional manner unless you make an FTP connection, in
which case it acts like a regular FTP client <tt>(</tt>but better <tt>:-)</tt>
&nbsp; LOCUS applies to the following commands:

<p>
<pre>
  <u>Unprefixed    Remote       Local        Description        </u>
   CD (CWD)      RCD          LCD          Change (Working) Directory
   CDUP          RCDUP        LCDUP        CD Up
   PWD           RPWD         LPWD         Print Working Directory
   DIRECTORY     RDIR         LDIR         Request a directory listinga
   DELETE        RDEL         LDEL         Delete (a) file(s)
   RENEME        RREN         LREN         Rename a file
   MKDIR         RMKDIR       LMKDIR       Create a directory
   RMDIR         RRMDIR       LRMDIR       Remove a directory
</pre>

<p>
<dt><font color="red"><tt><b>SET MATCH</b>
<i>{</i> <b>DOTIFILE</b>, <b>FIFO</b> <i>}</i>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></font></dt>

<dd><font color="red">Whether C-Kermit filename patterns (wildcards) should
match filenames that start with dot (period), or (Unix only) FIFOs (named
pipes).  The defaults are to skip dotfiles in Unix but match them elsewhere,
and to skip FIFOs.  Applies to both interactive use and to server mode, when
the server receives wildcards, e.g. in a GET command.  Also see REMOTE SET
MATCH.</font>

<p>
<dt><tt><b>SET OPTIONS DIRECTORY /DOTFILES</b></tt></dt>

<dd><font color="red">Now works for server listings too (UNIX only).  Give
this command prior to having Kermit enter server mode, and then it will show
files whose names begin with dot (period) when sent a REMOTE DIRECTORY
command.</font>

<p>

<dt><tt><b>SET QUIET ON</b></tt></dt>

<dd><font color="red">(as well as the <tt>-q</tt> command-line option)
Now applies also to:

<ul>
<li>SET HOST connection progress messages.
<li>"Press the X or E key to cancel" file-transfer message.
<li>REMOTE CD response.
<li>REMOTE LOGIN response.
</ul>
</font>


<p>

<dt><font color="red"><tt><b>SET RECEIVE PERMISSIONS</b>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></font></dt>

<dd><font color="red">Tells C-Kermit whether to set the permissions of
incoming files (received with Kermit protocol) from the permissions supplied
in the file's Attribute packet (if any).  Normally ON.  Also see
SET SEND PERMISSIONS.
</font>

<p>

<dt><tt><b>SET ROOT</b> <i>directory</i></tt></dt>
<dd>Like UNIX chroot, without requiring privilege.  Sets the root for file
access, does not allow reference to or creation of files outside the
root, and can't be undone.

<p>

<dt><font color="red"><tt><b>SET SEND PERMISSIONS</b>
<i>{</i> <b>ON, OFF</b> <i>}</i></tt></font></dt>

<dd><font color="red">Tells C-Kermit whether to include file permissions
in the attributes it includes with each file when sending with Kermit protocol.
Also see SET RECEIVE PERMISSIONS.
</font>

<p>

<dt><tt><b>SET TCP</b> <i>{</i> <b>HTTP-PROXY, SOCKS-SERVER</b> <i>}</i>
<font color="red"><b>/USER:</b><i>name</i> <b>/PASSWORD:</b><i>text</i></tt>
</font></dt>

<dd><font color="red">These commands now allow specification of username
and password.</font>


<p>
<dt><tt><b>SET TERMINAL . . .</b></tt></dt>
<dd><i>(See <a href="#x12">Section 12</a>.)</i>

<p>
<dt><tt><b>SET TRANSFER MESSAGE</b> <i>[ text ]</i></tt></dt>
<dd>Sets an initial text message to be displayed in the file-transfer display.
The transfer message is automatically deleted once used, so must be set
each time a message a desired.  Any variables in the message are evaluated
at the time the SET command is given.  If the optional text is omitted,
any transfer message that is currently set is removed.  <i>Synonym:</i>
<tt><b>SET XFER MSG</b></tt>.
SHOW TRANSFER displays it if it has been set but not yet used.

<p>

<dt><tt><b>SHOW COMMUNICATIONS</b></tt></dt>
<dd>In C-Kermit 8.0, SHOW COMMUNICATIONS, when given in remote mode (i.e.
before any connection has been established), tells the typical dialout device
name for the particular platform on which it's running (e.g. <tt>TXA0:</tt>
for VMS, or <tt>/dev/cua0p0</tt> for HP-UX).  On Unix platforms, it also tells
the name of the lockfile directory.  This way, you have an idea of what the
SET LINE device name should look like, and if the SET LINE command fails, you
know the name of the directory or device that is protected against you.

<p>

<dt><a name="showvar"><tt><b>SHOW VARIABLES</b>
<i>[ name [ name [ ... ] ] ]</i></tt></a></dt>

<dd>In C-Kermit 8.0.201 you can request values of a list of built-in
(<tt>\v(<i>xxx</i>)</tt>) variables.  Each <i>name</i> is a pattern, as
before, but now it a free pattern rather than an anchored one (explained in
<a href="#x8.12">Section 8.12</a>) so now "show var date time" shows the
values of all variables whose names include the strings "date" or "time".

<p>

<dt><tt><b>TAIL</b> <i>[ switches ] filename</i></tt></dt>
<dd>Equivalent to <tt>TYPE /TAIL <i>[ other-switches ] filename</i></tt>.

<p>

<dt><tt><b>TRANSMIT /NOECHO</b> <i>[ other switches ] filename</i></tt></dt>
<dd>The /NOECHO switch is equivalent to giving the command SET TRANSMIT ECHO
OFF prior to the TRANSMIT command, except the switch affects only the command
with which it was given and does not affect the prevailing global setting.
<p>

<dt><tt><b>TRANSMIT /NOWAIT</b> <i>[ other switches ] filename</i></tt></dt>
<dd>The /NOWAIT switch is equivalent to giving the command SET TRANSMIT
PROMPT 0 prior to the TRANSMIT command, except the switch affects only the
command with which it was given and does not affect the prevailing global
setting.
<p>

<dt><tt><b>TRANSMIT /NOWAIT /NOECHO /BINARY</b> <i>[ other switches ] filename</i></tt></dt>

<dd>When the TRANSMIT command is given with the /NOWAIT, /NOECHO, and /BINARY
switches, this activates a special "blast the whole file out the
communications connection all at once" mode that Kermit didn't have prior
to version 8.0.  There has been increasing demand for this type of
transmission with the advent of devices that expect image (e.g. <tt>.JPG</tt>)
or sound (e.g. <tt>.MP3</tt>) files as raw input.  The obvious question is:
how does the receiving device know when it has the whole file?  This depends
on the device, of course; usually after a certain amount of time elapses with
nothing arriving, or else when Kermit hangs up or closes the connection.

<p>

<dt><tt><b>TYPE /CHARACTER-SET:</b><i>name</i></tt></dt>
<dd>Allows you to specify the character set in which the file to be typed
is encoded.
<p>
<dt><tt><b>TYPE /NUMBER</b></tt></dt>
<dd>Adds line numbers.
<p>
<dt><tt><b>TYPE /OUTPUT:</b><i>filename</i></tt></dt>
<dd>Sends the results of the TYPE command to the given file.
<p>
<dt><tt><b>TYPE /TRANSLATE-TO:</b><i>name</i></tt></dt>
<dd>Used in conjunction with <tt>TYPE /CHARACTER-SET:<i>xxx</i></tt>; allows
you to specify the character set in which the file is to be displayed.
<p>
<dt><tt><b>TYPE /TRANSPARENT</b></tt></dt>
<dd>Used to disable character-set translation in the TYPE command, which
otherwise can take place automatically based on file scanning, even when
<tt>/CHARACTER-SET</tt> and <tt>/TRANSLATE-TO</tt> switches are not given.
<p>
<dt><tt><b>VOID</b> <i>text</i></tt></dt>
<dd>Parses the text, evaluating any backslash items in it (such as function
calls) but doesn't do anything further, except possibly printing error
messages.  Useful for invoking functions that have side effects without using
or printing their direct results, e.g. "<tt>void \fsplit(\%a,&#38;a)</tt>".
</dl>

<h3>Symbolic Links in UNIX</h3>

The UNIX versions of C-Kermit have had <tt>/FOLLOWLINKS</tt> and
<tt>/NOFOLLOWLINKS</tt> switches added to several commands to control 
the treatment of symbolic links.  Different commands deal differently with
symbolic links:
<p>
<dl>
<dt><b>Kermit <tt>SEND</tt></b>, <b><tt>FTP MPUT</tt></b></dt>
<dd><tt>/NOFOLLOWLINKS</tt> is the default, which means symbolic links are
skipped entirely.  The alternative, <tt>/FOLLOWLINKS</tt>, should be used with
caution, since an innocent link might point to a whole file system, or it
might cause a loop.  There is no way in Kermit or FTP protocol to send the
link itself.  We either skip them or follow them; we can't duplicate them.
<p>
<dt><b><tt>DIRECTORY</tt></b></dt>
<dd><tt>/NOFOLLOWLINKS</tt> is the default, which means the DIRECTORY command
lists symbolic links in a way that shows they are links, but it does not
follow them.  The alternative, <tt>/FOLLOWLINKS</tt>, follows links and gives
information about the linked-to directories and files.
<p>
<dt><b><tt>DELETE</tt></b>, <b><tt>RMDIR</tt></b></dt>
<dd>The DELETE command does not have link-specific switches.  DELETE never
follows links.  If you tell Kermit to delete a symbolic link, it deletes the
link itself, not the linked-to file.  Ditto for RMDIR.
<p>
<dt><b><tt>COPY</tt></b></dt>
<dd>The COPY command behaves just like the UNIX cp command; it always
follows links.
<p>
<dt><b><tt>RENAME</tt></b></dt>
<dd>The RENAME command behaves just like the UNIX mv command; it operates
on links directly rather than following.
</dl>
<p>


[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x8"><hr>8. OTHER SCRIPTING IMPROVEMENTS</a></h2>

<h3><a name="x8.1">8.1. Performance and Debugging</a></h3>

A command cache for frequently used commands plus some related optimizations
increases the speed of compute-bound scripts by anywhere from 50% to 1000%.

<p>

The new PROMPT command can be used to set breakpoints for debugging scripts.
If executed in a command file or macro, it gives you an interactive command
prompt in the current context of the script, with all its variables,
arguments, command stack, etc, available for examination or change, and the
ability to resume the script at any point (END resumes it, Ctrl-C or STOP
cancels it and returns to top level).

<p>

The new Ctrl-C trapping feature (<a href="#x8.14">Section 8.14</a>) lets you
intercept interruption of scripts.  This can be used in combination with the
PROMPT command to debug scripts.  Example:

<p>
<pre>
define ON_CTRLC {
    echo INTERRUPTED BY CTRL-C...
    echo The command stack has not yet been rolled back:
    show stack
    echo Type Ctrl-C again or use the END command to return to top level.
    prompt Debug>
}
</pre>
<p>
Adding this ON_CTRL definition to your script lets you interrupt it at any
point and get prompt that is issued at the current command level, so you can
query local variables, etc.


<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x8.2">8.2. Using Macros as Numeric Variables</a></h3>

A macro is a way to assign a value to a name, and then use the name to refer
to the value.  Macros are used in two ways in Kermit: as "subroutines" or
functions composed of Kermit commands, which are executed, or as variables to
hold arbitrary values -- text, numbers, filenames, etc.

<p>

When a macro is to be executed, its name is given as if it were a C-Kermit
command, optionally preceded by the word "do".  When a macro is used as a
variable, it must be "escaped" with <tt>\m(</tt><i>xxx</i><tt>)</tt> (or
equivalent function, e.g. <tt>\s(</tt><i>xxx</i><tt>)</tt>,
<tt>\:(</tt><i>xxx</i><tt>)</tt>, <tt>\fdefinition(</tt><i>xxx</i><tt>))</tt>,
where <i>xxx</i> is the macro name, for example:
<p><pre>
  define filename /usr/olga/oofa.txt
  send \m(filename)
</pre>
<p>
Of course variables can also hold numbers:
<p><pre>
  define size 17
  declare \&#38;a[\m(size)]
  ...
  define index 3
  if ( == \m(index) 3 ) echo The third value is: \&#38;a[\m(index)]
  evaluate index (\m(index) * 4)
  if ( &#62; \m(index) \m(size) ) echo Out of range!
</pre>
<p>

But these are contexts in which only numbers are valid.  C-Kermit 8.0 has been
changed to treat non-escaped non-numeric items in strictly numeric contexts as
macro names.  So it is now possible (but not required) to omit the
<tt>\m(...)</tt> notation and just use the macro name in these contexts:
<p><pre>
  define size 17
  declare \&#38;a[size]
  ...
  define index 3
  if ( == index 3 ) echo The third value is: \&#38;a[index]
  evaluate index (index * 4)
  if ( &#62; index size ) echo Out of range!
</pre>
<p>

This is especially nice for loops that deal with arrays.  Here, for example,
is a loop that reverses the order of the elements in an array.  Whereas
formerly it was necessary to write:
<p><pre>
  .\%n ::= \fdim(&#38;a)
  for \%i 1 \%n/2 1 {
      .tmp := \&#38;a[\%n-\%i+1]
      .\&#38;a[\%n-\%i+1] := \&#38;a[\%i]
      .\&#38;a[\%i] := \m(tmp)
  }
</pre>
<p>

Recoding this to use macro names "<tt>i</tt>" and "<tt>n</tt>" instead of the
backslash variables <tt>\%i</tt> and <tt>\%n</tt>, we have:
<p><pre>
  .n ::= \fdim(&#38;a)
  for i 1 n/2 1 {
      .tmp := \&#38;a[n-i+1]
      .\&#38;a[n-i+1] := \&#38;a[i]
      .\&#38;a[i] := \m(tmp)
  }
</pre>
<p>

which reduces the backslash count to less than half.  The final statement
in the loop could be written "<tt>.\&#38;a[i] ::= tmp</tt>" if the array
contained only numbers (since <tt>::=</tt> indicates arithmetic expression
evaluation).
<p>

Also, now you can use floating-point numbers in integer contexts (such as
array subscripts), in which case they are truncated to an integer value (i.e.
the fractional part is discarded).
<p>

Examples of numeric contexts include:
<p>
<ul>
<li>Array subscripts.
<li>Any numeric function argument.
<li>Right-hand side of <tt>::=</tt> assignments.
<li>EVALUATE command or <tt>\fevaluate()</tt> function expression.
<li>The INCREMENT or DECREMENT by-value.
<li><tt>IF =</tt>, <tt>&#62;</tt>, <tt>&#60;</tt>, <tt>!=</tt>,
<tt>&#62;=</tt>, and <tt>&#60;=</tt> comparands.
<li>The IF number construct.
<li>FOR-loop variables.
<li>STOP, END, and EXIT status codes.
<li>The INPUT timeout value.
<li>PAUSE, WAIT, SLEEP, MSLEEP intervals.
<li>The SHIFT argument.
<li>Numeric switch arguments, e.g. TYPE /WIDTH:number, SEND /LARGER:number.
<li>SCREEN MOVE-TO row and column number.
<li>Various SET DIAL parameters (timeout, retry limit, etc).
<li>Various SET SEND or RECEIVE parameters (packet length, window size, etc).
<li>Various other SET parameters.
</ul>
<p>
and:
<p>
<ul>
<li>S-Expressions (explained in <a href="#x9">Section 9</a>).
</ul>
<p>
Macro names used in numeric contexts must not include mathematical operators.
Although it is legal to create a macro called "foo+bar", in a numeric context
this would be taken as the sum of the values of "foo" and "bar".  Any such
conflict can be avoided, of course, by enclosing the macro name in
<tt>\m(...)</tt>.

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x8.3">8.3. New IF Conditions</a></h3>

Several new IF conditions are available:
<p>
<dl>
<dt><tt><b>IF DECLARED</b> <i>arrayname</i></tt></dt>
<dd>Explained in <a href="#x8.6">Section 8.6</a>.
<p>
<dt><tt><b>IF KBHIT</b></tt></dt>
<dd>Allows a script to test whether a key was pressed without actually
trying to read it.
<p>
<dt><tt><b>IF KERBANG</b></tt>  (Unix only)</dt>
<dd>True if Kermit was started from a Kerbang script.  This is useful for
knowing how to interpret the <tt>\&#38;@[]</tt> and <tt>\&#38;_[]</tt>
argument vector arrays, and under what conditions to exit.
<p>
<dt><tt><b>IF INTEGER</b> <i>n</i></tt></dt>
<dd>This is just a synonym for IF NUMERIC, which is true if <i>n</i> contains
only digits (or, if <i>n</i> is a variable, its value contains only digits).
</dl>
<p>

By contrast, <tt>IF FLOAT <i>n</i></tt> succeeds if <i>n</i> is a
floating-point number OR an integer (or a variable with floating-point or
integer value).  Therefore, IF FLOAT should be used whenever any kind of
number is acceptable, whereas IF INTEGER (or IF NUMERIC) when only an integer
can be used.

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x8.4">8.4. The ON_UNKNOWN_COMMAND Macro</a></h3>

The new ON_UNKNOWN_COMMAND macro, if defined, is executed whenever you give
a command that is not known to C-Kermit; any operands are passed as arguments.
Here are some sample definitions:
<p><pre>
  DEF ON_UNKNOWN_COMMAND telnet \%1 ; Treat unknown commands as hostnames
  DEF ON_UNKNOWN_COMMAND dial \%1   ; Treat unknown commands phone numbers
  DEF ON_UNKNOWN_COMMAND take \%1   ; Treat unknown commands as filenames
  DEF ON_UNKNOWN_COMMAND !\%*       ; Treat unknown commands as shell commands
</pre>

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x8.5">8.5. The SHOW MACRO Command</a></h3>

The SHOW MACRO command has been changed to accept more than one macro name:
<p><pre>
  (setq a 1 b 2 c 3)
  show mac a b c
  a = 1
  b = 2
  c = 3
</pre>
<p>
An exact match is required for each name (except that case doesn't matter).
If you include wildcard characters, however, a pattern match is performed:
<p><pre>
  show mac [a-c]*x
</pre>
<p>
shows all macros whose names start with a, b, or c, and end with x.

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x8.6">8.6. Arrays</a></h3>

A clarification regarding references to array names (as opposed to array
elements): You can use array-name "abbreviations" like &#38;a only in contexts
that expect array names, like ARRAY commands or array-name function arguments
such as the second argument of <tt>\fsplit()</tt>.  In a LOCAL statement,
however, you have to write <tt>\&#38;a[]</tt>, since "<tt>local &#38;a</tt>"
might refer to a macro named "<tt>&#38;a</tt>".
<p>
In function arguments, however, you MUST use the abbreviated form:
<tt>\fsplit(\%a,&#38;a)</tt> or <tt>\fsplit(\%a,&#38;a[])</tt>.  If you
include the backslash (as in "<tt>\fsplit(\%a,\&#38;a[])</tt>") a parse error
occurs.
<p>
Here are the new array-related commands:
<p>
<dl>
<dt><tt><b>IF DECLARED</b> <i>arrayname</i></tt></dt>
<dd>Allows a script to test whether an array has been declared.  The arrayname
can be a non-array backslash variable such as <tt>\%1</tt> or
<tt>\m(<i>name</i>)</tt>, in which case it is evaluated first, and the result
is treated as the array name.  Otherwise, arrayname is treated as in the ARRAY
commands: it can be <tt>a</tt>,
<tt>&#38;a</tt>,
<tt>&#38;a[]</tt>,
<tt>\&#38;a</tt>,
<tt>\&#38;a[]</tt>,
<tt>\&#38;a[3]</tt>,
<tt>\&#38;a[3:9]</tt>,
etc, with the appropriate results in each case.  <i>Synonym:</i>
<tt><b>IF DCL</b></tt>.
<p>
<dt><tt><b>UNDECLARE</b> <i>arrayname</i></tt></dt>
<dd>UNDECLARE is a new top-level command to undeclare an array.  Previously
this could only be done with "<tt>declare</tt> <tt>\&#38;a[0]</tt>" (i.e.
re-declare the array with a dimension of 0).
<p>
<dt><tt><b>ARRAY LINK</b> <i>linkname arrayname</i></tt></dt>
<dd>Creates a symbolic link from the array named by linkname (which must be
the name of an array that is not yet declared in the current context) to the
array named by arrayname (which must the name of a currently declared
array that is not itself a link, or a variable containing the name of such
an array).  The two names indicate the same array: if you change an array
element, the change is reflected in the link too, and vice versa.  If you
undeclare the link, the real array is unaffected.  If you undeclare the real
array, all links to it disappear.  If you resize an array (directly or
through a link), all links to it are updated automatically.
</dl>
<p>
Array links let you pass array names as arguments to macros.  For example,
suppose you had a program that needed to uppercase all the elements of
different arrays at different times.  You could write a macro to do this, with
the array name as an argument.  But without array links, there would be no way
to refer to the argument array within the macro.  Array links make it easy:
<p><pre>
  define arrayupper {
      local \&#38;e[] \%i
      array link \&#38;e[] \%1
      for i 1 \fdim(&#38;e) 1 { .\&#38;e[i] := \fupper(\&#38;e[i]) }
  }
  declare \&#38;a[] = these are some words
  arrayupper &#38;a
  show array &#38;a
</pre>
<p>
The macro declares the array link LOCAL, which means it doesn't conflict with
any array of the same name that might exist outside the macro, and that the
link is destroyed automatically when the macro exits.  This works, by the way,
even if the link name and the macro argument name are the same, as long as the
link is declared LOCAL.
<p>
As noted, you can't make a link to a nonexistent array.  So when writing a
macro whose job is to create an array whose name is passed as an argument, you
must declare the array first (the size doesn't matter as long as it's greater
than 0).  Example:
<p><pre>
  define tryme {                ; Demonstration macro
      local \&#38;e[]               ; We only need this inside the macro
      array link \&#38;e[] \%1      ; Make local link
      shift                     ; Shift argument list
      void \fsplit(\%*,&#38;e)      ; Split remainder of arg list into array
  }
  declare \&#38;a[1]                ; Declare target array in advance
  tryme &#38;a here are some words  ; Invoke the macro with array name and words
  show array a                  ; See the results
</pre>
<p>
One final improvement allows the macro itself to declare the array (this was
not possible in earlier Kermit releases): if the array name in the DECLARE
command is a variable (and not an array name), or includes variables, the
resulting value is used as the array name.  So:
<p><pre>
  define tryme {                ; Demonstration macro
      declare \%1[1]            ; Preliminary declaration for target array
      local \&#38;e[]               ; We only need this inside the macro
      array link \&#38;e[] \%1      ; Make local link
      shift                     ; Shift argument list
      void \fsplit(\%*,&#38;e)      ; Split remainder of arg list into array
  }
  tryme &#38;a here are some words  ; Invoke the macro with array name and words
  show array a                  ; See the results
</pre>
<p>
The SHOW ARRAY command now indicates whether an array name is a link.
<p>
Also see the descriptions of <a href="#fjoin"><tt>\fjoin()</tt></a>
and <a href="#fsplit"><tt>\fsplit()</tt></a>, plus
<a href="#x8.10">Section 8.10</a> on the
MINPUT command, which shows how an entire array (or segment of it) can be used
as the MINPUT target list.

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]

<hr>
<h3><a name="x8.7">8.7. New or Improved Built-in Variables and Functions</a></h3>

The following new built-in variables are available:
<p><pre>
  \v(buildid)       A date string like "20000808" indicating when C-Kermit was built.
  \v(ftime)         Current time, secs since midnight, including fraction of second.
  \v(iprompt)       The current SET PROMPT value
  \v(sexp)          The most recent S-Expression (see <a href="#x9">Section 9</a>)
  \v(sdepth)        The current S-Expression invocation depth (<a href="#x9">Section 9</a>)
  \v(svalue)        The value of the most recent S-Expression (<a href="#x9">Section 9</a>)
<p>
  \v(ftp_code)      Most recent FTP response code (<a href="#x3">Section 3</a>)
  \v(ftp_connected) FTP connection status (<a href="#x3">Section 3</a>)
  \v(ftp_cpl)       FTP Command Protection Level (<a href="#x3.2">Section 3.2</a>)
  \v(ftp_dpl)       FTP Data Protection Level (<a href="#x3.2">Section 3.2</a>)
  \v(ftp_getputremote) The current SET GET-PUT-REMOTE setting (<a href="#x3.8">Section 3.8</a>) 
  \v(ftp_host)      Name or IP address of FTP server (<a href="#x3">Section 3</a>)
  \v(ftp_loggedin)  FTP login status (<a href="#x3">Section 3</a>)
  \v(ftp_message)   Most recent FTP response message (<a href="#x3">Section 3</a>)
  \v(ftp_security)  FTP Security method (<a href="#x3.2">Section 3.2</a>)
  \v(ftp_server)    OS type of FTP server (<a href="#x3">Section 3</a>)
<p>
  \v(http_code)       Most recent HTTP response code 
  \v(http_connected)  HTTP connection status
  \v(http_host)       Name or IP address of HTTP server
  \v(http_message)    Most recent HTTP response message
  \v(http_security)   TLS cipher used to secure the HTTP session
<p>
  \v(hour)            Hour of the day, 0 to 23.
  \v(timestamp)       Equivalent to "\v(ndate) \v(time)".
<font color="red">
  \v(log_debug)       Current debug log file, if any.
  \v(log_packet)      Current packet log file, if any.
  \v(log_session)     Current session log file, if any.
  \v(log_transaction) Current transaction log file, if any.
  \v(log_connection)  Current connection log file, if any.
</font></pre>
<p>
The following new or improved built-in functions are available:
<p><pre>
  \fcmdstack()            Allows programmatic access to the command stack.
  \fcvtdate()             <a href="#x8.13">Section 8.13</a>
  \fdelta2secs()          <a href="#x8.13">Section 8.13</a>
  \fdostounixpath(s1)     Converts a DOS filename to Unix format.
  \fsplit()               Now allows grouping/nesting in source string.
  \fword()                Allows the same grouping and nesting.
  \fjoin(&#38;a,s1,n1,n2)     Copies an array into a single string.
  \fsubstitute(s1,s2,s3)  Substitutes characters within a string.
  \freplace()             Has new 4th "occurrence" argument.
  \fcvtdate()             Now accepts several format options.
  \fsexpression()         Evaluates an S-Expression (explained in <a href="#x9">Section 9</a>).
  \ftrim(), \fltrim()     Now trim CR and LF by default, as well as SP and Tab.
  \funixtodospath(s1)     Converts a Unix filename to DOS format.
  \fkeywordval(s1,c1)     Assigns values to keywords (macros) (explained below).
</pre>
<p>

Most functions that have "2" in their names to stand for the word "2" can
now also be written with "to", e.g. "<tt>\fdelta2secs()</tt>,"
<tt>\fdeltatosecs()</tt>."

<h3><a name="x8.7.1">8.7.1. The <tt>\fkeywordval()</tt> Function</a></h3>

<tt><a name="fkeywordval">\fkeywordval(<i>s1,c1</i>)</a></tt> is new.  Given a
string <i>s1</i> of the form "<i>name=value</i>", it creates a macro with the
given name and assigns it the given value.  If no value appears after the
equal sign, any existing macro of the given name is undefined.  Blanks are
automatically trimmed from around the name and value.  The optional <i>c1</i>
parameter is the assignment operator character, equal sign (<tt>=</tt>) by
default.  This function is handy for processing keyword parameters or any
other form of parameter-value pair.  Suppose, for example, you want to write
a macro that accepts keyword parameters rather than positional ones:

<p>
<pre>
  define MYDIAL {
      local \%i modem hangup method device speed number
      def number 5551234          ; Assign default parameter values
      def speed 57600
      def modem usrobotics
      def hangup rs232
      def method tone
      def country 1
      for \%i 1 \v(argc)-1 1 {    ; Parse any keyword parameters...
	  if not \fkeywordval(\&_[\%i]) end 1 Bad parameter: "\&_[\%i]"
      }
      set dial country \m(country)
      set modem type \m(modem)
      set modem hang \m(hangup)
      set dial method \m(tone)
      set line \m(device)
      if fail stop 1
      set speed \m(speed)
      if fail stop 1
      show comm
      set dial display on
      dial \m(number)
      if success connect
  }
</pre>
<p>

In this example, all the defaults are set up inside the macro, and therefore
it can be invoked with no parameters at all.  But if you want to have the
macro dial a different number, you can supply it as follows:

<p>
<pre>
  mydial number=7654321
</pre>
<p>

You can supply any number of keyword parameters, and you can give
them in any order:

<p>
<pre>
  mydial number=7654321 hangup=modem speed=115200
</pre>

<h3><a name="x8.7.2">8.7.2. The <tt>\fsplit()</tt>,
<tt>\fjoin()</tt>, and <tt>\fword()</tt> Functions</a></h3>

<tt><a name="fjoin">\fjoin(<i>&#38;a,s1,n1,n2</i>)</a></tt> is also new; it
creates a string from an array (or a piece of one).  <tt>&#38;a</tt> is the
name of the array (a range specifier can be included); <i>s1</i> is a
character or string to separate each element in the result string (can be
omitted, in which case the elements are not separated at all), and <i>n1</i>
is a grouping mask, explained below.  If <i>s1</i> is empty or not specified,
the array elements are separated with spaces.  If you want the elements
concatenated with no separator, include a nonzero <i>n2</i> argument.  Given
the array:

<p><pre>
  declare \&#38;a[] = 0 1 2 3 4 5 6 7 8 9
</pre>
<p>
you can get effects like this:
<p><pre>
  \fjoin(&#38;a)      0 1 2 3 4 5 6 7 8 9
  \fjoin(&#38;a,:)    0:1:2:3:4:5:6:7:8:9
  \fjoin(&#38;a,{,})  0,1,2,3,4,5,6,7,8,9
  \fjoin(&#38;a,...)  0...1...2...3...4...5...6...7...8...9
  \fjoin(&#38;a,,,1)  0123456789
</pre>
<p>
<tt><a name="fsplit">\fsplit()</a></tt>, <tt>\fword()</tt>,
<tt>\fstripb()</tt>, and <tt>\fjoin()</tt> accept a "grouping mask"
argument, <i>n1</i>, which is a number from 0 to 63, in which:
<p><pre>
   1 = "" doublequotes
   2 = {} braces
   4 = '' singlequotes
   8 = () parentheses
  16 = [] square brackets
  32 = &#60;&#62; angle brackets
</pre>
<p>
These can be OR'd (added) together to make any number 0-63 (-1 is treated the
same as 63, 0 means no grouping).  If a bit is on, the corresponding kind of
grouping is selected.  (If more than 1 bit is set for \fjoin(), only the
lowest-order one is used.)
<p>
If you include the same character in the grouping mask and the include list,
the grouping mask takes precedence.  Example:
<p><pre>
  def \%a  a "b c d" e
  \fsplit(\%a,&#38;a[],,,-1)  = 3  &#60;-- <i>doublequote used for grouping</i>
  \fsplit(\%a,&#38;a[],,",-1) = 3  &#60;-- <i>doublequote still used for grouping</i>
</pre>
<p>
Nesting of matched left and right grouping characters (parentheses, braces,
and brackets, but not quotes) is recognized.  Example:
<p><pre>
  def \%a a (b c &#60;d e [f g {h i} j k] l m&#62; n o) p
  \fsplit(\%a,&#38;a,,,0)  = 16 (no grouping)
  \fsplit(\%a,&#38;a,,,2)  = 15 (braces only)
  \fsplit(\%a,&#38;a,,,16) = 11 (square brackets only)
  \fsplit(\%a,&#38;a,,,32) =  7 (angle brackets only)
  \fsplit(\%a,&#38;a,,,63) =  3 (all)
  \fsplit(\%a,&#38;a,,,-1) =  3 (all)
</pre>
<p>
<tt>\fsplit()</tt> and <tt>\fjoin()</tt> are "reciprocal" functions.  You can
split a string up into an array and join it back into a new string that is
equivalent, as long as <tt>\fsplit()</tt> and <tt>\fjoin()</tt> are given
equivalent grouping masks, except that the type of braces might change.
Example:
<p><pre>
  def \%a a {b c [d e] f g} "h i" j &#60;k l&#62; m
  echo STRING=[\%a]
  echo WORDS=\fsplit(\%a,&#38;a,,,-1)
  show array a
  asg \%b \fjoin(&#38;a,{ },2)
  echo JOIN  =[\%b]
  echo WORDS=\fsplit(\%b,&#38;b,,,-1)
  show array b
</pre>
<p>
The arrays a and b are identical.  The strings a and b are as follows:
<p><pre>
  \%a: a {b c [d e] f g} "h i" j &#60;k l&#62; m
  \%b: a {b c [d e] f g} {h i} j {k l} m
</pre>
<p>
It is possible to quote separator grouping characters with backslash to
override their grouping function.  And of course to include backslash itself
in the string, it must be quoted too.  Furthermore, each backslash must be
doubled, so the command parser will still pass one backslash to
<tt>\fsplit()</tt> for each two that it sees.  Here are some examples using
<tt>\fsplit()</tt> with a grouping mask of 8 (treat parentheses as grouping
characters).
<p><pre>
  <u>String                 </u> <u>Result</u>
    a b c d e f             6
    a b\\ c d e f           5
    a b (c d e) f           4
    a b \\(c d e\\) f       6
    a b \\\\(c d e\\\\) f   7
</pre>
<p>
<tt>\fsplit()</tt> has also been changed to create its array (if one is given)
each time it is called, so now it can be conveniently called in a loop without
having to redeclare the array each time.

<p>

Incidentally...  Sometimes you might want to invoke <tt>\fsplit()</tt> in a
situation where you don't care about its return value, e.g. when you just want
to fill the array.  Now you can "call" <tt>\fsplit()</tt> or any other
function with the new <a href="#x8.7.4">VOID command</a>:

<p><pre>
  void \fsplit(\%a,&#38;a)
</pre>

<p>

<tt>\fsplit()</tt> and <tt>\fjoin()</tt> also accept a new, optional 6th
argument, an <i>options flag</i>, a number that can specify a number of
options.  So far there is just one option, whose value is 1:
<p>
<dl>
<dt><tt><i>separator-flag</i></tt></dt>
<dd>Normally separators are collapsed.  So, for example, 
<p><pre>
  \fword(Three        little          words,2)
</pre>
<p>
returns "little" (the second word).  Space is a separator, but there are
multiple spaces between each word.  If the value 1 is included in the option
flag, however, each separator counts.  If two separators are adjacent, an
empty word is produced between them.  This is useful for parsing (e.g.)
comma-separated lists exported from databases or spreadsheets.
</dl>

<h3><a name="x8.7.3">8.7.3. The <tt>\fcmdstack()</tt> Function</a></h3>

The new <tt>\fcmdstack()</tt> function gives access to the command stack:
<dl>
<dt><tt>\fcmdstack(<i>n1,n2</i>)</tt>
<dd>Arguments: n1 is the command stack level.  If omitted, the current level,
<tt>\v(cmdlevel)</tt>, is used.  n2 is a function code specifying the desired
type  of information:<pre>
  0 (default) = name of object at level n1.
  1 (nonzero) = object type (0 = prompt; 1 = command file; 2 = macro).
</pre>
The default for n2 is 0.
</dl>
<p>
The name associated with prompt is "(prompt)".  Here's a loop that can be
included in a macro or command file to show the stack (similar to what the
SHOW STACK command does):
<p><pre>
  for \%i \v(cmdlevel) 0 -1 {
      echo \%i. [\fcmdstack(\%i,1)] \fcmdstack(\%i,0)
  }
</pre>
<p>

In this connection, note that <tt>\v(cmdfile)</tt> always indicates the most
recently invoked active command file (if any), even if that file is executing
a macro.  Similarly, <tt>\v(macro)</tt> indicates the most recently invoked
macro (if any), even if the current command source is not a macro.  The name
of the "caller" of the currently executing object (command file or macro) is:

<p><pre>
  \fcmdstack(\v(cmdlevel)-1)
</pre>
<p>
and its type is:
<p><pre>
  \fcmdstack(\v(cmdlevel)-1,1)
</pre>
<p>
To find the name of the macro that invoked the currently executing object,
even if one or more intermediate command files (or prompting levels) are
involved, use a loop like this:
<p><pre>
  for \%i \v(cmdlevel)-1 0 -1 {
      if = \fcmdstack(\%i,1) 2 echo CALLER = \fcmdstack(\%i,0)
  }
</pre>
<p>
Of course if you make a macro to do this, the macro must account for its
own additional level:
<p><pre>
  define CALLER {
      for \%i \v(cmdlevel)-2 0 -1 {
          if = \fcmdstack(\%i,1) 2 return \fcmdstack(\%i,0)
      }
      return "(none)"
  }
</pre>
<p>
The built-in variable <tt>\v(cmdsource)</tt> gives the current command source
as a word ("prompt", "file", or "macro").

<h3><a name="x8.7.4">8.7.4. The VOID Command</a></h3>

VOID is like ECHO in that all functions and variables in its argument text are
evaluated. but it doesn't print anything (except possibly an error message if
a function was invocation contained or resulted in any errors).  VOID sets
FAILURE if it encounters any errors, SUCCESS otherwise.

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>

<h3><a name="x8.8">8.8. The RETURN and END Commands</a></h3>

The execution of a macro is terminated in any of the following ways:
<p>
<ul>
<li>With an <tt>END <i>[ number [ message ] ]</i></tt> command.  If a number
is given, the macro succeeds if the number is 0, and fails if it is not zero;
if a number is not given, the macro succeeds.
<p>
<li>With a <tt>STOP</tt> command, which works just like END except it peels
back the command stack all the way to top level.
<p>
<li>With a <tt>RETURN</tt> <i>[ text ]</i></tt> command, in which case the
macro always succeeds.
<p>
<li>By running out of commands to execute, in which case the macro succeeds
or fails according the most recently executed command that sets success
or failure.
</ul>
<p>
The same considerations apply to command files invoked by the TAKE command.
<p>
If a macro does not execute any commands that set success or failure, then
invoking the macro does not change the current SUCCESS/FAILURE status.  It
follows, then, that the mere invocation of a macro does not change the
SUCCESS/FAILURE status either.  This makes it possible to write macros to
react to the status of other commands (or macros), for example:
<p><pre>
  define CHKLINE {
      if success end 0
      stop 1 SET LINE failed - please try another device.
  }
  set modem type usrobotics
  set line /dev/cua0
  chkline
  set speed 57600
  dial 7654321
</pre>
<p>
By the way, none of this is news.  But it was not explicitly documented
before, and C-Kermit 7.0 and earlier did not always handle the RETURN
statement as it should have.

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x8.9">8.9. UNDEFINing Groups of Variables</a></h3>

The UNDEFINE command, which previously accepted one variable name, now
accepts a list of them, and also accepts wildcard notation to allow deletion
of variables that match a given pattern.
<p>
<dl>
<dt><tt><b>UNDEFINE</b> <i>[ switches ] name [ name [ name [ ... ] ] ]</i></tt></dt>
<dd>Undefines the variables whose names are given.  Up to 64 names may be
given in one UNDEFINE command.
</dl>
<p>
If you omit the switches and include only one name, the UNDEFINE command
works as before.
<p>
Switches include:
<p>
<dl>
<dt><tt><b>/MATCHING</b></tt></dt>
<dd>Specifies that the names given are to treated as patterns rather than
literal variable names.  Note: pattern matching can't be used with array
references; use the ARRAY command to manipulate arrays and subarrays.
<p>
<dt><tt><b>/LIST</b></tt></dt>
<dd>List the name of each variable to be undefined, and whether it was
undefined successfully ("ok" or "error"), plus a summary count at the end.
<p>
<dt><tt><b>/SIMULATE</b></tt></dt>
<dd>List the names of the variables that would be deleted without actually
deleting them.  Implies /LIST.
</dl>
<p>
The UNDEFINE command fails if there were any errors and succeeds otherwise.
<p>
The new <tt><b>_UNDEFINE</b></tt> command is like UNDEFINE, except the names
are assumed to be variable names themselves, which contain the names (or parts
of them) of the variables to be undefined.  For example, if you have the
following definitions:
<p><pre>
  define \%a foo
  define foo This is some text
</pre>
<p>
then:
<p><pre>
  undef \%a
</pre>
<p>
undefines the variable <tt>\%a</tt>, but:
<p><pre>
  _undef \%a
</pre>
<p>
undefines the macro foo.
<p>
Normal Kermit patterns are used for matching; metacharacters include asterisk,
question mark, braces, and square brackets.  Thus, when using the /MATCHING
switch, if the names of the macros you want to undefine contain any of these
characters, you must quote them with backslash to force them to be taken
literally.  Also note that <tt>\%*</tt> is not the name of a variable; it is a
special notation used within a macro for "all my arguments".  The command
"<tt>undef /match \%*</tt>" deletes all <tt>\%<i>x</i></tt> variables, where x
is <tt>0..9</tt> and <tt>a..z</tt>.  Use "<tt>undef /match \%[0-9]</tt>" to
delete macro argument variables or "<tt>undef /match \%[i-n]</tt>"  to delete
a range of <tt>\%<i>x</i></tt> variables.

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x8.10">8.10. The MINPUT Command</a></h3>

The MINPUT command can be used to search the incoming data stream for several
targets simultaneously.  For example:
<p><pre>
  MINPUT 8 one two three
</pre><p>
waits up to 8 seconds for one of the words "one", "two", or "three" to
arrive.  Words can be grouped to indicate targets that contain spaces:
<p><pre>
  MINPUT 8 nineteeen twenty "twenty one"
</pre><p>
And of course you can also use variables in place of (or as part of) the
target names:
<p><pre>
  MINPUT 8 \%a \&#38;x[3] \m(foo)
</pre><p>
Until now you had to know the number of targets in advance when writing the
MINPUT statement.  Each of the examples above has exactly three targets.
<p>
But suppose your script needs to look for a variable number of targets.  For
this you can use arrays and <tt>\fjoin()</tt>, described in
<a href="#x8.7">Section 8.7</a>.  Any number of
<tt>\fjoin()</tt> invocations can be included in the MINPUT target list, and
each one is expanded into the appropriate number of separate targets each time
the MINPUT command is executed.  Example:
<p><pre>
  declare \&#38;a[10] = one two three
  minput 10 foo \fjoin(&#38;a) bar
</pre>
<p>
This declares an array of ten elements, and assigns values to the first three
of them.  The MINPUT command looks for these three (as well as the words
"foo" and "bar").  Later, if you assign additional elements to the array, the
same MINPUT command also looks for the new elements.
<p>
If an array element contains spaces, each word becomes a separate target.
To create one target per array element, use <tt>\fjoin()</tt>'s grouping
feature:
<p><pre>
  dcl \&#38;a[] = {aaa bbb} {ccc ddd} {xxx yyy zzz}

  minput 10 \fjoin(&#38;a)     &#60;-- 7 targets
  minput 10 \fjoin(&#38;a,,2)  &#60;-- 3 targets
</pre>

<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>

<h3><a name="x8.11">8.11. Learned Scripts</a></h3>

C-Kermit now includes a simple script recorder that monitors your commands,
plus your actions during CONNECT mode, and automatically generates a script
program that mimics what it observed.  You should think of this feature as a
script-writing ASSISTANT since, as you will see <a href="#scriptedit">later in
this section</a>, the  result generally needs some editing to make it both
secure and flexible.  The script recorder is controlled by the new LEARN
command:
<p>
<dl>
<dt><tt><b>LEARN</b> <i>[</i> <b>/ON /OFF /CLOSE</b> <i>] [ filename ]</i></tt></dt>
<dd>If you give a filename, the file is opened for subsequent recording.
The /ON switch enables recording to the current file (if any); /OFF
disables recording.  /CLOSE closes the current script recording file
(if any).  If you give a filename without any switches, /ON is assumed.
</dl>
<p>
The /OFF and /ON switches let you turn recording off and on during a session
without closing the file.
<p>
When recording:
<p>
<ul>
<li>All commands that you type (or recall) at the prompt are recorded in
the file except:
<ul>
<p>
<li>LEARN commands are not recorded.
<li>The CONNECT command is not recorded.
<li>The TELNET command is converted to SET HOST /NETWORK:TCP.
</ul>
<p>
<li>Commands obtained from macros or command files are not recorded.
<p>
<li>During CONNECT:
<p>
<ul>
<li>Every line you type is converted to an OUTPUT command.
<li>The last prompt before any line you type becomes an INPUT command.
<li>Timeouts are calculated automatically for each INPUT command.
<li>A PAUSE command is inserted before each OUTPUT command just to be safe.
</ul>
</ul>
<p>
Thus the script recorder is inherently line-oriented.  It can't be used to
script character-oriented interactions like typing Space to a "More?"  prompt
or editing a text file with VI or EMACS.
<p>

But it has advantages too; for example it takes control characters into
account that might not be visible to you otherwise, and it automatically
converts control characters in both the input and output streams to the
appropriate notation.  It can tell, for example that the "<tt>$&nbsp;</tt>"
prompt on the left margin in UNIX is really <tt>{\{13}\{10}$&nbsp;}</tt>,
whereas in VMS it might be <tt>{\{13}\{10}\{13}$&nbsp;}</tt>.  These sequences
are detected and recorded automatically.

<p>

<a name="scriptedit">A learned script</a> should execute correctly when you
give a TAKE command for it.  However, it is usually appropriate to edit the
script a bit.  The most important change would be to remove any passwords from
it.  For example, if the script contains:

<p><pre>
  INPUT 9 {\{13}\{10}Password: }
  IF FAIL STOP 1 INPUT timeout
  PAUSE 1
  OUTPUT bigsecret\{13}
</pre>
<p>
you should replace this by something like:
<p><pre>
  INPUT 9 {\{13}\{10}Password: }
  IF FAIL STOP 1 INPUT timeout
  ASKQ pswd Please type your password:
  PAUSE 1
  OUTPUT \m(pswd)\{13}
</pre>
<p>
The LEARN command can't do this for you since it knows nothing about
"content"; it only knows about lines and can't be expected to parse or
understand them -- after all, the Password prompt might be in some other
language.  So remember: if you use to LEARN command to record a login script,
be sure edit the resulting file to remove any passwords.  Also be sure to
delete any backup copies your editor or OS might have made of the file.
<p>
Other manual adjustments might also be appropriate:
<p>
<ul>
<li>If the target of an INPUT command can vary, you can replace the INPUT
command with MINPUT and the appropriate target list, and/or the target
with a <tt>\fpattern()</tt>.  For example, suppose you are dialing a number
that can be answered by any one of 100 terminal servers, whose prompts are
<tt>ts-00&#62;</tt>, <tt>ts-01&#62;</tt>, <tt>ts-02&#62;</tt>, ...
<tt>ts-99&#62;</tt>.  The script records a particular one of these, but you
want it to work for all of them, so change (e.g.):
<p><pre>
  INPUT 10 ts-23&#62;  ; or whatever
</pre>
<p>
to:
<p><pre>
  INPUT 10 \fpattern(ts-[0-9][0-9]&#62;)
</pre>
<p>
<li>The INPUT timeout values are conservative, but they are based only on
a single observation; you might need to tune them.
<p>
<li>The PAUSE commands might not be necessary, or the PAUSE interval might
need adjustment.
<p>
<li>In case you made typographical errors during recording, they are
incorporated in your script; you can edit them out if you want to.
</ul>
<p>
Here is a sample script generated by Kermit ("<tt>learn</tt>
<tt>vms.ksc</tt>") in which a Telnet connection is made to a VMS computer, the
user logs in, starts Kermit on VMS, sends it a file, and then logs out:
<p><pre>
  ; Scriptfile: vms.ksc
  ; Directory:  /usr/olga
  ; Recorded:   20001124 15:21:23

  SET HOST /NETWORK:TCP vms.xyzcorp.com
  IF FAIL STOP 1 Connection failed

  INPUT 7 {\{13}\{10}\{13}Username: }
  IF FAIL STOP 1 INPUT timeout
  PAUSE 1
  OUTPUT olga\{13}
  INPUT 3 {\{13}\{10}\{13}Password: }
  IF FAIL STOP 1 INPUT timeout
  PAUSE 1
  OUTPUT secret\{13}
  INPUT 18 {\{13}\{10}\{13}$ }
  IF FAIL STOP 1 INPUT timeout
  PAUSE 1
  OUTPUT set default [.incoming]\{13}
  INPUT 12 {\{13}\{10}\{13}$ }
  IF FAIL STOP 1 INPUT timeout
  PAUSE 1
  OUTPUT kermit\{13}
  INPUT 15 {\{13}\{10}\{13}ALTO:[OLGA.INCOMING] C-Kermit&gt;}
  IF FAIL STOP 1 INPUT timeout
  PAUSE 1
  OUTPUT receive\{13}
  send myfile.txt

  INPUT 18 {\{13}\{10}\{13}ALTO:[OLGA.INCOMING] C-Kermit&gt;}
  IF FAIL STOP 1 INPUT timeout
  PAUSE 1
  OUTPUT exit\{13}
  INPUT 6 {\{13}\{10}\{13}$ }
  IF FAIL STOP 1 INPUT timeout
  PAUSE 1
  OUTPUT logout\{13}
  close
  exit
</pre>
<p>
The commands generated by Kermit during CONNECT (INPUT, IF FAIL, PAUSE, and
OUTPUT) have uppercase keywords; the commands typed by the user are in
whatever form the user typed them (in this case, lowercase).
<p>
[ <a href="#top"><b>Top</b></a> ] 
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>

<h3><a name="x8.12">8.12. Pattern Matching</a></h3>

A pattern is a character string that is used to match other strings.  Patterns
can contain <i>metacharacters</i> that represent special actions like "match
any single character", "match zero or more characters", "match any single
character from a list", and so on.  The best known application of patterns is
in file specifications that contain wildcards, as in "<tt>send</tt>
<tt>*.txt</tt>", meaning "send all files whose names end with <tt>.txt</tt>".

<p>
Patterns are also used in increasingly many other ways, to the extent it is
useful to point out certain important distinctions in the ways in which they
are used:
<p>
<dl>
<dt><i>Anchored Patterns</i></dt>
<dd>If an anchored pattern does not begin with "<tt>*</tt>", it must match the
beginning of the string, and if it does not end with "<tt>*</tt>", it must
match the end of the string.  For example, the anchored pattern "<tt>abc</tt>"
matches only the string "<tt>abc</tt>", not "<tt>abcde</tt>" or
"<tt>xyzabc</tt>" or "<tt>abcabc</tt>".  The anchored pattern "<tt>abc*</tt>"
matches any string that <i>starts</i> with "<tt>abc</tt>"; the anchored pattern
"<tt>*abc</tt>" matches any string that <i>ends</i> with "<tt>abc</tt>"; the
anchored pattern "<tt>*abc*</tt>" matches any string that contains
"<tt>abc</tt>" (including any that start and/or end with it).

<p>
<dt><i>Floating Patterns</i></dt>
<dd>A floating pattern matches any string that contains a substring that
matches the pattern.  In other words, a floating pattern has an implied
"<tt>*</tt>" at the beginning and end.  You can anchor a floating pattern
to the beginning by starting it with "<tt>^</tt>", and you can anchor it
to the end by ending it with "<tt>$</tt>" (see examples below).
<p>

<dt><i>Wildcards</i></dt>
<dd>A wildcard is an anchored pattern that has the additional property that
"<tt>*</tt>" does not match directory separators.
</dl>

<p>

This terminology lets us describe Kermit's commands with a bit more precision.
When a pattern is used for matching filenames, it is a wildcard, except in the
<tt>TEXT-PATTERNS</tt> and <tt>BINARY-PATTERNS</tt> lists and
<tt>/EXCEPT:</tt> clauses, in which case directory separators are not
significant (for example, a <tt>BINARY-PATTERN</tt> of "<tt>*.exe</tt>"
matches any file whose name ends in <tt>.exe</tt>, no matter how deeply it
might be buried in subdirectories.  When Kermit parses a file specification
directly, however, it uses the strict wildcard definition.  For example,
"<tt>send a*b</tt>" sends all files whose names start with "<tt>a</tt>" and
end with "<tt>b</tt>" in the current directory, and not any files whose names
end with "<tt>b</tt>" that happen to be in subdirectories whose names start
with "<tt>a</tt>".  And as noted, wildcards are anchored, so "<tt>delete
foo</tt>" deletes the file named "<tt>foo</tt>", and not all files whose names
happen to contain "<tt>foo</tt>".

<p>

Most other patterns are anchored.  For example:
<p><pre>
  if match abc bc ...
</pre>
<p>
does not succeed (and you would be surprised if it did!).  In fact, the only
floating patterns are the ones used by commands or functions that search for
patterns in files, arrays, or strings.  These include:
<p>
<ul>
<li>The GREP and TYPE /MATCH commands.
<li>The <tt>\fsearch()</tt>, <tt>\frsearch()</tt>, and <tt>\farraylook()</tt>
functions.
</ul>
<p>
Thus these are the only contexts in which explicit anchors ("<tt>^</tt>" and
"<tt>$</tt>") may be used:
<p>
<dl>
<dt><tt>grep abc *.txt</tt>
<dd>Prints all lines containing "<tt>abc</tt>" in all files whose names
end with "<tt>.txt</tt>".
<p>
<dt><tt>grep ^abc *.txt</tt>
<dd>Prints all lines that start with "<tt>abc</tt>" in all
"<tt>.txt</tt>" files.
<p>
<dt><tt>grep abc$ *.txt</tt>
<dd>Prints all lines that end with "<tt>abc</tt>" in all
"<tt>.txt</tt>" files.
<p>
<dt><tt>grep ^a*z$ *.txt</tt>
<dd>Prints all lines that start with "<tt>a</tt>" and end with
"<tt>z</tt>" in all "<tt>.txt</tt>" files.
</dl>
<p>
Similarly for <tt>TYPE /PAGE</tt>, <tt>/fsearch()</tt>, <tt>/frsearch()</tt>,
and <tt>\farraylook()</tt>.

<p>
Here is a brief summary of anchored and floating pattern equivalences:
<p><pre>
  <u>Anchored</u>   <u>Floating</u>
    abc       ^abc$
    *abc      abc$
    abc*      ^abc
    *abc*     abc
</pre>

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>

<h3><a name="x8.13">8.13. Dates and Times</a></h3>

C-Kermit's comprehension of date-time formats is considerably expanded in
version 8.0.  Any command that reads dates, including the <tt>DATE</tt>
command itself, or any switch, such as the <tt>/BEFORE:</tt> and
<tt>/AFTER:</tt> switches, or any function such as <tt>\fcvtdate()</tt>, now
can understand dates and times expressed in any ISO 8601 format, in Unix
"asctime" format, in FTP MDTM format, and in practically any format used in
RFC 822 or RFC 2822 electronic mail, with or without timezones, and in a great
many other formats as well.  HELP DATE briefly summarizes the
acceptable date-time formats.

<p>

Furthermore, C-Kermit 8.0 includes a new and easy-to-use form of date-time
arithmetic, in which any date or time can be combined with a "delta time",
to add or subtract the desired time interval (years, months, weeks, days,
hours, minutes, seconds) to/from the given date.  And new functions are
available to compare dates and to compute their differences.

<p>

As you can imagine, all this requires quite a bit of "syntax".  The basic
format is:

<p>
<pre>
  <i>[ date ] [ time ] [ delta ]</i>
</pre>
<p>

Each field is optional, but in most cases (depending on the context) there
must be at least one field.  If a date is given, it must come first.
If no date is given, the current date is assumed.  If no time is given, an
appropriate time is supplied depending on whether a date was supplied.  If no
delta is given, no arithmetic is done.  If a delta is given without a date or
time, the current date and time are used as the base.

<p>

Date-time-delta fields are likely to contain spaces (although they need not;
space-free forms are always available).  Therefore, in most contexts -- and
notably as switch arguments -- date-time information must be enclosed in
braces or doublequotes, for example:

<p>
<pre>
  send /after:"8-Aug-2001 12:00 UTC" *.txt
</pre>
<p>

Kermit's standard internal format for dates and times is:
<p>
<pre>
  <i>yyyymmdd hh:mm:ss</i>
</pre>
<p>
for example:
<p>
<pre>
  20010208 10:28:01
</pre>
<p>

Date-times can always be given in this format.  yyyy is the 4-digit year,
mm is the two-digit month (1-12; supply leading zero for Jan-Sep), dd is the
2-digit day (leading zero for 1-9), hh is the hour (0-23), mm the minute
(0-59), ss the second (0-59), each with leading zero if less than the field
width.  The date and time can be separated by a space, an underscore, a colon,
or the letter T.  The time is in 24-hour format.  Thus the various quantites
are at the following fixed positions:
<p>
<pre>
<u><i>Position</i></u>  <u><i>Contents                    </i></u>
   1-4    Year   (4 digits, 0000-9999)
   5-6 	  Month  (2 digits, 1-12)
   7-8 	  Day    (2 digits, 1-31) 
   9   	  Date-Time Separator (space, :, _, or the letter T) 
  10-11	  Hour   (2 digits, 0-23)
  12   	  Hour-Minute Separator (colon) 
  13-14	  Minute (2 digits, 0-59)
  15   	  Minute-Second Separator (colon)
  16-17	  Second (2 digits, 0-59)
</pre>
<p>
Example:

<p>
<pre>
  19800526 13:07:12  <i>26 May 1980, 13:07:12 (1:07:12PM)</i>
</pre>
<p>

This is the format produced by the DATE command and by any function that
returns a date-time.  It is suitable for lexical comparison and sorting, and
for use as a date-time in any Kermit command.  When this format is given as
input to a command or function, various date-time separators (as noted) are
accepted:

<p>
<pre>
  19800526 13:07:12  <i>26 May 1980, 13:07:12 (1:07:12PM)</i>
  20010208_10:28:35  <i>2 February 2001, 10:28:35 AM</i>
  18580101:12:00:00  <i>1 January 1858, noon</i>
  20110208T00:00:00  <i>2 February 2011, midnight</i>
</pre>
<p>

Certain other special date-time formats that are encountered on computer
networks are recognized:

<p>
<dl>
<dt><i>Asctime Format</i><dt>
<dd>This is a fixed format used by Unix, named after Unix's <tt>asctime()</tt>
("ASCII time") function.  It is always exactly 24 characters long.
Example: <tt>  Fri Aug 10 16:38:01 2001</tt>
<p>

<dt><i>Asctime with Timezone</i><dt>
<dd>This is like Asctime format, but includes a 3-character timezone between
the time and year.  It is exactly 28 characters long.  Example:
<tt>   Fri Aug 10 16:38:01 GMT 2001</tt>
<p>

<dt><i>E-Mail Format</i></dt>

<dd>E-mail date-time formats are defined in
<a href="ftp://ftp.isi.edu/in-notes/rfc2822.txt">RFC 2822</a> with a fair
amount of flexibility and options.  The following
examples are typical of e-mails and HTTP (web-page) headers:
<pre>
  Sat, 14 Jul 2001 11:49:29                <i>(No timezone)</i>
  Fri, 24 Mar 2000 14:19:59 EST            <i>(Symbolic timezone)</i>
  Tue, 26 Jun 2001 10:19:45 -0400 (EDT)    <i>(GMT Offset + comment)</i>
</pre>
<p>

<dt><i>FTP MDTM Format</i><dt>
<dd>This is the date-time format supplied by FTP servers that support the
(not yet standard but widely used nevertheless) MDTM command, by which the FTP
client asks for a file's modification time:
<p>
<pre>
  <i>yyyymmddhhmmss[.ffff]</i>
</pre>
<p>
where yyyy is the 4-digit year, mm is the 2-digit month, and so on, exactly
14 digits long.  An optional fractional part (fraction of second) may also be
included, separated by a decimal point (period).  Kermit rounds to the nearest
second.  Example:
<p>
<pre>
  20020208102835.515                       <i>(8 February 2002 10:28:36 AM)</i>
</pre>
<p>
</dl>

<h4><a name="x8.13.1">8.13.1.  The Date</a></h4>

The <i>date</i>, if given, must precede the time and/or delta, and
can be in many, many formats.  For starters, you can use several
symbolic date names in place of actual dates:

<p>
<dl>
<dt><b><tt>NOW</tt></b></dt>
<dd>This is replaced by the current date and time.  The time can not be
overriden (if you want to supply a specific time, use <tt>TODAY</tt>
rather than <tt>NOW</tt>).
<p>


<dt><b><tt>TODAY</tt></b></dt>
<dd>This is replaced by the current date and a default time of 00:00:00
is supplied, but can be overridden by a specific time; for example, if
today is 8 February 2002, then "<tt>TODAY</tt>" is
"<tt>20020802&nbsp;00:00:00</tt>" 
but "<tt>TODAY&nbsp;10:28</tt>" is "<tt>20020802&nbsp;10:28:00</tt>".
<p>

<dt><b><tt>TOMORROW</tt></b></dt>
<dd>Like <tt>TODAY</tt>, but one day later (if
today is 8 February 2002, then "<tt>TOMORROW</tt>" is
"<tt>20020803&nbsp;00:00:00</tt>" 
but "<tt>TOMORROW 16:30</tt>" is "<tt>20020803&nbsp;16:30:00</tt>").
<p>

<dt><b><tt>YESTERDAY</tt></b></dt>
<dd>Like <tt>TODAY</tt>, but one day earlier.

<p>

<dt><b><tt>MONDAY, TUESDAY, WEDNESDAY, ..., SUNDAY</tt></b></dt>
<dd>The date on the given day of the week, today or later.  A default time
of 00:00:00 is supplied but can be overridden.  Example:
"<tt>SATURDAY 12:00</tt>" means next Saturday (or today, if today is Saturday)
at noon.
</dl>
<p>

You can give an explicit date in almost any conceivable format,
but there are some rules:
<p>
<ul>
<li>If a date is given, it must have three fields: day, month, and year;
the order can vary (except that the month can not be last).
<li>If names are used for days, months, etc, they must be English.
<li>The year must lie between 0000 and 9999, inclusive.
<li>All calendar calculations use Gregorian dating, so calculated dates
for years prior to 1582 (or later, depending on the country) will not agree
with historical dates.  Other forms of dating (e.g. Hebrew, Chinese) are not
supported.
</ul>
<p>

Various date-field separators are accepted: hyphen, slash, space, underscore,
period.  The same field separator (if any) must be used in both places; for
example 18-Sep-2001 but not 18-Sep/2001.  Months can be numeric (1-12) or
English names or abbreviations.  Month name abbreviations are normally three
letters, e.g. Apr, May, Jun, Jul.  Capitalization doesn't matter.

<p>
Here are a few examples:
<p>
<pre>
  18 Sep 2001                              <i>(English month, abbreviated)</i>
  18 September 2001                        <i>(English month, spelled out)</i>
  2001 Sept 18                             <i>(Year, month, day)</i>
  18-Sep-2001                              <i>(With hyphens)</i>
  18/09/2001                               <i>(All numeric with slashes)</i>
  18.09.2001                               <i>(Ditto, with periods)</i>
  18_09_2001                               <i>(Ditto, with underscores)</i>
  09/18/2001                               <i>(See below)</i>
  2001/09/18                               <i>(See below)</i>
  September 18, 2001                       <i>(Correspondence style)</i>
  Sep-18-2001                              <i>(Month-day-year)</i>
  20010918                                 <i>(Numeric, no separators)</i>
</pre>

<p>

You can also include the day of the week with a specific date, in which case
it is accepted (if it is a valid day name), but not verified to agree with
the given date:
<p>
<pre>
  Tue, 18 Sep 2001                         <i>(Abbreviated, with comma)</i>
  Tue,18 Sep 2001                          <i>(Comma but no space)</i>
  Tue 18 Sep 2001                          <i>(Abbreviated, no comma)</i>
  Tuesday 18 Sep 2001                      <i>(Spelled out)</i>
  Tuesday, 18 Sep 2001                     <i>(etc)</i>
  Friday, 18 Sep 2001                      <i>(Accepted even if not Friday)</i>
</pre>
<p>

In all-numeric dates with the year last, such as 18/09/2001, Kermit identifies
the year because it's 4 digits, then decides which of the other two numbers is
the month or day based on its value.  If both are 12 or less and are unequal,
the date is ambiguous and is rejected.  In all-numeric dates with the year
first, the second field is always the month and the third is the day.  The
month never comes last.  A date with no separators is accepted only if it is
all numeric and has exactly eight digits, and is assumed to be in
<i>yyyymmdd</i> format.

<p>
<pre>
  20010918                                 <i>(18-Sep-2001 00:00:00)</i>
</pre>
or 14 digits (as in FTP MDTM format):
<p>
<pre>
  20010918123456                           <i>(18-Sep-2001 12:34:56)</i>
</pre>
<p>

You can always avoid ambiguity by putting the year first, or by
using an English, rather than numeric, month.  A date such as 09/08/2001
would be ambiguous but 2001/09/08 is not, nor is 09-Aug-2001.

<p>

Until the late 1990s, it was common to encounter <b>2-digit years</b>, and
these are found to this day in old e-mails and other documents.  Kermit
accepts these dates if they have English months, and interprets them according
to the windowing rules of <a href="ftp://ftp.isi.edu/in-notes/rfc2822.txt">RFC
2822</a>: "If a two digit year is encountered whose value is between 00 and
49, the year is interpreted by adding 2000, ending up with a value between
2000 and 2049.  If a two digit year is encountered with a value between 50 and
99, or any three digit year is encountered, the year is interpreted by adding
1900."

<p>

If you need to specify a year prior to 1000, use leading zeros to ensure
it is not misinterpreted as a "non-Y2K-compliant" modern year:
<p>
<pre>
  7-Oct-77                                 <i>(19771007 00:00:00)</i>
  7-Oct-0077                               <i>(00771007 00:00:00)</i>
</pre>

<h4><a name="x8.13.2">8.13.2.  The Time</a></h4>

The basic time format is <tt><i>hh:mm:dd</i></tt>; that is hours, minutes,
seconds, separated by colons, perhaps with an optional fractional second
separated by a decimal point (period).  The hours are in 24-hour format; 12 is
noon, 13 is 1pm, and so on.  Fields omitted from the right default to zero.
Fields can be omitted from the left or middle by including the field's
terminating colon.  Examples:
<p>
<pre>
  11:59:59                                 <i>(11:59:59 AM)</i>
  11:59                                    <i>(11:59:00 AM)</i>
  11                                       <i>(11:00:00 AM)</i>
  11:59:59.33                              <i>(11:59:59 AM)</i>
  11:59:59.66                              <i>(Noon)</i>
  03:21:00                                 <i>(3:21:00 AM)</i>
  3:21:00                                  <i>(3:21:00 AM)</i>  
  15:21:00                                 <i>(3:21:00 PM)</i>
  :21:00                                   <i>(00:21:00 AM)</i>
  ::01                                     <i>(00:00:01 AM)</i>
  11::59                                   <i>(11:00:59 AM)</i>
</pre>
<p>
Leading zeros can be omitted, but it is customary and more readable to
keep them in the minute and second fields:
<p>
<pre>
  03:02:01                                 <i>(03:02:01 AM)</i>
  3:02:01                                  <i>(03:02:01 AM)</i>
  3:2:1                                    <i>(03:02:01 AM)</i>
</pre>
<p>

AM/PM notation is accepted if you wish to use it:
<p>
<pre>
  11:59:59                                 <i>(11:59:59 AM)</i>
  11:59:59AM                               <i>(11:59:59 AM)</i>
  11:59:59A.M.                             <i>(11:59:59 AM)</i>
  11:59:59am                               <i>(11:59:59 AM)</i>
  11:59:59a.m.                             <i>(11:59:59 AM)</i>
  11:59:59PM                               <i>(11:59:59 PM = 23:59:59)</i>
  11:59:59P.M.                             <i>(11:59:59 PM = 23:59:59)</i>
  11:59:59pm                               <i>(11:59:59 PM = 23:59:59)</i>
  11:59:59p.m.                             <i>(11:59:59 PM = 23:59:59)</i>
</pre>
<p>
You can omit the colons if you wish, in which case Kermit uses the following
rules to interpret the time:
<p>
<ol>
<li>6 digits is hh:mm:ss, e.g. 123456 is 12:34:56.
<li>5 digits is h:mm:ss, e.g. 12345 is 1:23:45.
<li>4 digits is hh:mm, e.g. 1234 is 12:34.
<li>3 digits is h:mm, e.g. 123 is 1:23.
<li>2 digits is hh, e.g. 12 is 12:00.
<li>1 digit is h (the hour), e.g. 1 is 1:00.
</ol>
<p>
Examples:
<p>
<pre>
  1                                        <i>(01:00:00 AM)</i>
  10                                       <i>(10:00:00 AM)</i>
  230                                      <i>(02:30:00 AM)</i>
  230pm                                    <i>(02:30:00 PM = 14:30:00)</i>
  1115                                     <i>(11:15:00 AM)</i>
  2315                                     <i>(11:15:00 PM = 23:15:00 PM)</i>
  23150                                    <i>(02:31:50 AM)</i>
  231500                                   <i>(23:15:00 PM)</i>
</pre>

<h4><a name="x8.13.3">8.13.3.  Time Zones</a></h4>

If a time is given, it can (but need not) be followed by a time zone
designator.  If no time zone is included, the time is treated as local time
and no timezone conversions are performed.

<p>

The preferred time zone designator is the UTC Offset, as specified in
<a href="ftp://ftp.isi.edu/in-notes/rfc2822.txt">RFC 2822</a>: a plus sign or
minus sign immediately followed by exactly four decimal digits, signifying
the difference in hh (hours) and mm (minutes) from Universal Coordinated Time
(UTC, also known as Greenwich Mean Time, or GMT), with negative numbers to
the West and positive numbers to the East.  For example:

<p>
<pre>
  Fri, 13 Jul 2001 12:54:29 -0700
</pre>
<p>

indicates a local time of 12:54:29 that is 07 hours and 00 minutes
behind (less than, East of) Universal Time.  The space is optional, so the
example could also be written as:

<p>
<pre>
  Fri, 13 Jul 2001 12:54:29-0700
</pre>
<p>


The following symbolic time zones are also accepted, as specified by
<a href="ftp://ftp.isi.edu/in-notes/rfc2822.txt">RFC 2822</a> and/or in
ISO 8601:
<p>
<pre>
  GMT  =  +0000       Greenwich Mean Time
  Z    =  +0000       Zulu (Zero Meridian) Time
  UTC  =  +0000       Universal Coordinated Time
  UT   =  +0000       Universal Time
  EDT  =  -0400       Eastern (USA) Daylight Time
  EST  =  -0500       Eastern (USA) Standard Time
  CDT  =  -0500       Central (USA) Daylight Time
  CST  =  -0600       Central (USA) Standard Time
  MDT  =  -0600       Mountain (USA) Daylight Time
  MST  =  -0700       Mountain (USA) Standard Time
  PDT  =  -0700       Pacific (USA) Daylight Time
  PST  =  -0800       Pacific (USA) Standard Time
</pre>
<p>

Note that GMT, Z, UTC, and UT all express the same concept: standard (not
daylight) time at the Zero Meridian.  UTC, by the way, is an international
standard symbol and does not correspond to the order of the English words,
Universal Coordinated Time, but it happens to have the same initial letters as
these words.  Of course hundreds of other symbolic timezones and variations
exist, but they are not standardized, and are therefore not supported by
Kermit.

<p>

When a time zone is included with a time, the time is converted to local
time.  In case the conversion crosses a midnight boundary, the date is
adjusted accordingly.  Examples converting to EST (Eastern USA Standard Time =
<tt>-</tt>0500):

<p>
<pre>
 11:30:00      =  11:30:00
 11:30:00 EST  =  11:30:00
 11:30:00 GMT  =  06:30:00
 11:30:00 PST  =  14:30:00
 11:30:00Z     =  06:30:00
 11:30PM GMT   =  18:30:00
 11:30 -0500   =  11:30:00
 11:30 -0800   =  08:30:00
 11:30 +0200   =  04:30:00
</pre>
<p>

Unlike most of Kermit's other date-time conversions, timezone knowledge
(specifically, the offset of local time from UTC) is embodied in the
underlying operating system, not in Kermit itself, and any conversion errors
in this department are the fault of the OS.  For example, most UNIX
platforms do not perform conversions for years prior to 1970.

<h4><a name="x8.13.4">8.13.4.  Delta Time</a></h4>

Date/time expressions can be composed of a date and/or time and a delta
time, or a delta time by itself.  When a delta time is given by itself, it
is relative to the current local date and time.  Delta times have the
following general format:
<p>
<pre>
  <i>{</i>+,-<i>}[number units][hh[:mm[:ss]]]</i>
</pre>
<p>

In other words, a delta time always starts with a plus or minus sign, which is
followed by a "part1", a "part2", or both.  The "part1", if given, specifies a
number of days, weeks, months, or years; "part2" specifies a time in
<tt><i>hh:mm:ss</i></tt> notation.  In arithmetic terms, these represents some
number of days or other big time units, and then a fraction of a day expressed
as hours, minutes, and seconds; these are to be added to or subtracted from
the given (or implied) date and time.  The syntax is somewhat flexible, 
as shown by the following examples:
<p>
<pre>
  +1 day                <i>(Plus one day)</i>
  +1day                 <i>(Ditto)</i>
  +1d                   <i>(Ditto)</i>
  + 1 day               <i>(Ditto)</i>
  + 1 day 3:00          <i>(Plus one day and 3 hours)</i>
  +1d3:00               <i>(Ditto)</i>
  +1d3                  <i>(Ditto)</i>
  +3:00:00              <i>(Plus 3 hours)</i>
  +3:00                 <i>(Ditto)</i>
  +3                    <i>(Ditto)</i>
  +2 days               <i>(Plus 2 days)</i>
  -12 days 7:14:22      <i>(Minus 12 days, 7 hours, 14 minutes, and 22 seconds)</i>
</pre>
<p>

The words "week", "month", and "year" can be used like "day" in the examples
above.  A week is exactly equivalent to 7 days.  When months are specified,
the numeric month number of the date is incremented or decremented by the given
number, and the year and day adjusted accordingly if necessary (for example,
31-Jan-2001 +1month = 03-Mar-2001 because February does not have 31 days).
When years are specified, they are added or subtracted to the base year.
Examples (assuming the current date is 10-Aug-2001 and the current time is
19:21:11):

<p>
<pre>
  18-Sep-2001 +1day              <i>(20010918 00:00:00)</i>
  today +1day                    <i>(20010811 00:00:00)</i>
  now+1d                         <i>(20010811 19:21:11)</i>
  + 1 day                        <i>(20010811 19:21:11)</i>
  + 1 day 3:14:42                <i>(20010811 22:35:54)</i>
  + 7 weeks                      <i>(20010928 19:21:11)</i>
  +1d3:14:42                     <i>(20010811 22:35:54)</i>
  +1w3:14:42                     <i>(20010817 22:35:54)</i>
  +1m3:14:42                     <i>(20010910 22:35:54)</i>
  +1y3:14:42                     <i>(20020810 22:35:54)</i>
  2 feb 2001 + 10 years          <i>(20110208 00:00:00)</i>
  2001-02-08 +10y12              <i>(20110208 12:00:00)</i>
  31-dec-1999 23:59:59+00:00:01  <i>(20000101 00:00:00)</i>
  28-feb-1996 +1day              <i>(19960229 00:00:00) (leap year)</i>
  28-feb-1997 +1day              <i>(19970301 00:00:00) (nonleap year)</i>
  28-feb-1997 +1month            <i>(19970328 00:00:00)</i>
  28-feb-1997 +1month 11:59:59   <i>(19970328 11:59:59)</i>
  28-feb-1997 +20years           <i>(20170228 00:00:00)</i>
  28-feb-1997 +8000years         <i>(99970228 00:00:00)</i>
</pre>	
<p>

For compatibility with VMS, the following special delta-time format is also
accepted:

<p>
<pre>
  +<i>number</i>-<i>hh:mm:ss</i>
  -<i>number</i>-<i>hh:mm:ss</i>
</pre>
<p>
(no spaces).  The hyphen after the number indicates days.  It corresponds
exactly to the Kermit notation:
<p>
<pre>
  +<i>number</i><big>d</big><i>hh:mm:ss</i>
  -<i>number</i><big>d</big><i>hh:mm:ss</i>
</pre>
<p>
The following forms all indicate exactly the same date and time:
<p>
<pre>
  18-Sep-2001 12:34:56 +1-3:23:01
  18-Sep-2001 12:34:56 +1d3:23:01
  18-Sep-2001 12:34:56 +1 day 3:23:01
</pre>
<p>
and mean "add a day plus 3 hours, 23 minutes, and 1 second" to the given date.

<p>

Note that delta times are not at all the same as UTC offsets; the former
specifies an adjustment to the given date/time and the latter specifies that
the local time is a particular distance from Universal Time, for example:
<p>
<pre>
  11-Aug-2001 12:34:56 -0800          <i>(20010811 16:34:56 -- UTC Offset)</i>
  11-Aug-2001 12:34:56 -08:00         <i>(20010811 04:34:56 -- Delta time)</i>
</pre>
<p>

If you give a time followed by a modifer that starts with a <tt>+</tt> or
<tt>-</tt> sign, how does Kermit know whether it's a UTC offset or a delta
time?  It is treated as a UTC offset if the sign is followed by exactly four
decimal digits; otherwise it is a delta time.  Examples (for USA Eastern
Daylight Time):

<p>
<pre>
  11-Aug-2001 12:34:56 -0800          <i>(20010811 16:34:56 -- UTC Offset)</i>
  11-Aug-2001 12:34:56 -08:00         <i>(20010811 04:34:56 -- Delta time)</i>
  11-Aug-2001 12:34:56 -800           <i>(20010811 04:34:56 -- Delta time)</i>
  11-Aug-2001 12:34:56 -8             <i>(20010811 04:34:56 -- Delta time)</i>
</pre>
<p>

The first example says that at some unknown place which is 8 hours ahead of
Universal Time, the time is 12:34:56, and this corresponds to 16:34:56 in
Eastern Daylight time.  The second example says to subtract 8 hours from the
local time.  The third and fourth are delta times because, even though a colon
is not included, the time does not consist of exactly 4 digits.

<p>

When a delta time is written <i>after</i> a timezone, however, there is no
ambiguity and no syntax distinction is required:

<p>
<pre>
  11-Aug-2001 12:34:56 -0800 -0800    <i>(20010811 08:34:56)</i>
  11-Aug-2001 12:34:56 -0800 -08:00   <i>(Ditto)</i>
  11-Aug-2001 12:34:56 -08:00 -08:00  <i>(Illegal)</i>
</pre>
<p>

<h4><a name="x8.13.5">8.13.5.  The DATE Command</a></h4>

Obviously a great many combinations of date, time, time zone, and delta time
are possible, as well as many formatting options.  The purpose of all this
flexibility is to comply with as many standards as possible -- Internet RFCs,
ISO standards, and proven corporate standards -- as well as with notations
commonly used by real people, in order that dates and times from the widest
variety of sources can be assigned to a variable and used in any date-time
field in any Kermit command.

<p>

You can test any date-and/or-time format with the DATE command, which converts
it to standard yyyymmdd hh:mm:ss format if it is understood, or else gives an
explicit error message (rather than just "BAD DATE" as in previous C-Kermit
releases) to indicate what is wrong with it.  Examples (on Tuesday, 31 July
2001 in New York City, Eastern Daylight Time, UTC -0400):
<p>
<pre>
  <u>DATE command argument</u>                   <u>Result           </u>
  12:30                                   20010731 12:30:00
  12:30:01                                20010731 12:30:01
  12:30:01.5                              20010731 12:30:02
  1230                                    20010731 12:30:00
  230                                     20010731 02:30:00
  230+1d                                  20010801 02:30:00
  230+1d3:00                              20010801 05:30:00
  20010718 19:21:15                       20010718 19:21:15
  20010718_192115                         20010718 19:21:15
  20010718T192115                         20010718 19:21:15
  18 Jul 2001 +0400                       20010717 23:59:59
  18 Jul 2001 192115                      20010718 19:21:15
  18 Jul 2001 192115.8                    20010718 19:21:16
  18-Jul-2001T1921                        20010718 19:21:00
  18-Jul-2001 1921Z                       20010718 15:21:00
  18-Jul-2001 1921 GMT                    20010718 15:21:00
  18-Jul-2001 1921 UTC                    20010718 15:21:00
  18-Jul-2001 1921 Z                      20010718 15:21:00
  18-Jul-2001 1921Z                       20010718 15:21:00
  18-Jul-2001 1921 -04:00:00              20010718 19:21:00
  21-Jul-2001_08:20:00am                  20010721 08:20:00
  21-Jul-2001_8:20:00P.M.                 20010721 20:20:00
  Fri Jul 20 11:26:25 2001                20010720 11:26:25
  Fri Jul 20 11:26:25 GMT 2001            20010720 07:26:25
  Sun, 9 Apr 2000 06:46:46 +0100          20000409 01:46:46
  Sunday, 9 Apr 2000 06:46:46 +0100       20000409 01:46:46
  now                                     20010731 19:41:12
  today                                   20010731 00:00:00
  today 09:00                             20010731 09:00:00
  tomorrow                                20010801 00:00:00
  tomorrow 09:00                          20010801 09:00:00
  tomorrow 09:00 GMT                      20010801 05:00:00
  yesterday                               20010730 00:00:00
  yesterday 09:00                         20010730 09:00:00
  + 3 days                                20010803 00:00:00
  +3 days                                 20010803 00:00:00
  +3days                                  20010803 00:00:00
  + 3days                                 20010803 00:00:00
  + 3 days 09:00                          20010803 09:00:00
  + 2 weeks                               20010814 00:00:00
  + 1 month                               20010831 00:00:00
  - 7 months                              20001231 00:00:00
  + 10 years                              20110731 00:00:00
  friday                                  20010803 00:00:00
  saturday                                20010804 00:00:00
  sunday                                  20010805 00:00:00
  monday                                  20010806 00:00:00
  tuesday                                 20010731 00:00:00
  wednesday                               20010801 00:00:00
  thursday                                20010802 00:00:00
  friday 07:00                            20010803 07:00:00
  thursday 1:00pm                         20010802 13:00:00
  thursday 1:00pm GMT                     20010802 09:00:00
  Thu, 10 Nov 94 10:50:47 EST             19941110 10:50:47
  Fri, 20 Oct 1995 18:35:15 -0400 (EDT)   19951020 18:35:15
  31/12/2001                              20011231 00:00:00
  12/31/2001                              20011231 00:00:00
  2001-July-20                            20010720 00:00:00
  2001-September-30                       20010930 00:00:00
  30-September-2001                       20010930 00:00:00
  Sep 30, 2001 12:34:56                   20010930 12:34:56
  September 30, 2001                      20010930 00:00:00
  September 30, 2001 630                  20010930 06:30:00
  September 30 2001 630                   20010930 06:30:00
  Sep-30-2001 12:34:59                    20010930 12:34:59
  20010807113542.014                      20010807 11:35.42
  20010807113542.014Z                     20010807 07:35:42
</pre>
<p>

<h4><a name="x8.13.6">8.13.6.  New Date-Time Functions</a></h4>

In the following descriptions, date-time function arguments are the
same free-format date-time strings discussed above, with the same defaults
for missing fields.  They are automatically converted to standard format
internally prior to processing.

<p>

<dl>
<dt><tt><b>\fcvtdate(</b><i>d1</i><b>)</b></tt></tt>
<dd>Converts the date-time <i>d1</i> to standard format and local time.
This function is not new, but now it accepts a wider range of argument
formats that can include timezones and/or delta times.

<p>


<dt><tt><b>\futcdate(</b><i>d1</i><b>)</b></tt></tt>

<dd>Converts the date-time <i>d1</i> to Universal Coordinated Time (UTC), also
known as GMT or Zulu or Zero-Meridian time.  The default <i>d1</i> is NOW.
If <i>d1</i> is a valid date-time, the UTC result is returned in standard
format, <tt><i>yyyymmdd&nbsp;hh:ss:mm</i></tt>.

<p>
<dt><tt><b>\fcmpdates(</b><i>d1</i><b>,</b><i>d2</i><b>)</b></tt></tt>
<dd>Compares two free-format date-times, <i>d1</i> and <i>d2</i>, and, if
both arguments are valid, returns a number:
-1 if <i>d1</i> is earlier than (before) <i>d2</i>;
0 if  <i>d1</i> is the same as <i>d2</i>;
1 if <i>d1</i> is later than (after) <i>d2</i>.
<p>
<dt><tt><b>\fdiffdates(</b><i>d1</i><b>,</b><i>d2</i><b>)</b></tt></tt>
<dd>Computes the difference between two free-format date-times, <i>d1</i> and
<i>d2</i>.  If both arguments are valid, returns a delta time which is
negative if <i>d1</i> is earlier than (before) <i>d2</i> and positive
otherwise.  If <i>d1</i> and <i>d2</i> are equal, the result is
"<tt>+0:00</tt>".  Otherwise, the result consists of the number of days,
hours, minutes, and seconds that separate the two date-times.  If the
number of days is zero, it is omitted.  If the number of days is nonzero
but the hours, minutes, and seconds are all zero, the time is omitted.
if the seconds are zero, they are omitted.
<p>
<dt><tt><b>\fdelta2secs(</b><i>dt</i><b>)</b></tt></tt>
<dd>Converts a delta time to seconds.  For example, "<tt>+1d00:00:01</tt>"
to 86401.  Valid delta times must start with a <tt>+</tt> or <tt>-</tt> sign.
Days are accepted as time units, but not years, months, or weeks.  If the
result would overflow a computer long word (as would happen with 32-bit
long words when the number of days is greater than 24854), the function fails.
</dl>
<p>
<i>HINT:</i> Although Kermit has a number of built-in date and time
variables, it doesn't have a single one suitable for writing a timestamp.
For this you would normally use something like "<tt>\v(ndate) \v(time)</tt>".
But <tt>\fcvtdate()</tt> (with no arguments) is equivalent: it returns the
current date and time in <tt><i>yyyymmdd&nbsp;hh:mm:ss</i></tt> format,
suitable for time stamping.

<h4><a name="x8.13.7">8.13.7.  Date-Time Programming Examples</a></h4>

Here's a macro that converts any date-time to UTC,
which you might use if C-Kermit didn't already have a <tt>\futcdate()</tt>
function:
<p>
<pre>
  define utcdate {
      .local := \fcvtdate(\%*)                 ; 1.
      .tmp := \fcvtdate(\m(local)UTC)          ; 2.
      .offset := \fdiffdate(\m(local),\m(tmp)) ; 3.
      .utc := \fcvtdate(\m(local)\m(offset))   ; 4.
      sho mac utc                              ; 5.
  }
</pre>
<p>

Brief explanation: Line 1 converts the macro argument, a free-format
date-time, to standard-format local time.  Line 2 appends the "UTC" timezone
to the local time and converts the result to local time.  In other words, we
take the same time as the local time, but pretend it's UTC time, and convert
it to local time.  For example, if New York time is 4 hours ahead of UTC, then
6:00pm New York time is 2:00pm UTC.  Line 3 gets the difference of the two
results (e.g. "+04:00").  Line 4 appends the difference (delta time) to the
local time, and converts it again, whic adds (or subtracts) the UTC offset to
the given time.  Line 5 displays the result.

<p>

Here's a script that opens a web page, gets its headers into an array,
scans the array for the "Last-Modified:" header, and inteprets it:

<pre>
  http open www.columbia.edu
  if fail stop 1 HTTP OPEN failed
  http /array:a head index.html /dev/null
  if fail stop 1 HTTP GET failed
  show array a
  for \%i 1 \fdim(&a) 1 {
      .\%x := \findex(:,\&a[\%i])
      if not \%x continue
      .tag := \fleft(\&a[\%i],\%x-1)
      .val := \fltrim(\fsubstr(\&a[\%i],\%x+1))
      if ( eq "\m(tag)" "Last-Modified" ) {
          echo HTTP Date: \m(val)
          .rdate := \fcvtdate(\m(val))
          echo {Standard Date (local): \m(rdate)}
          echo {Standard Date (UTC):   \futcdate(\m(rdate))}
          break
      }
  }
  http close
</pre>
<p>
The result:
<p>
<pre>
  HTTP Date: Mon, 13 Aug 2001 20:05:42 GMT
  Standard Date (local): 20010813 16:05:42
  Standard Date (UTC):   20010813 20:05:42
</pre>
<p>
As you can see, Kermit had no trouble decoding the date-time-string from the
website, converting to local time, and converting back to UTC with no
conflicts or loss of information.  If it had been in any other known format,
the result would have been the same.

<p>

Now suppose we want to download the web page only if it is newer than
our local copy.  The <tt>\fdate(<i>filename</i>)</tt> function (which
returns the modification date-time of the given file) and the
new <tt>\fcmpdates()</tt> function make it easy.  Insert the following
just before the <tt>BREAK</tt> statement:

<p>
<pre>
  if ( < 0 \fcmpdates(\m(rdate),\fdate(index.html)) ) {
     echo GETTING index.html...
     http get index.html index.html
     if success echo HTTP GET OK
  } else {
     echo index.html: no update needed
  }
  http close
  exit
</pre>
<p>

This says, "if 0 is less than the comparison of the remote file date
and the local file date, get the remote file, otherwise skip it."  And it
automatically reconciles the time-zone difference (if any).

<p>

It would be nice to be able to extend this script into a general-purpose
website updater, but unfortunately HTTP protocol doesn't provide any mechanism
for the client to ask the server for a list of files, recursive or otherwise.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]
<hr>

<h3><a name="x8.14">8.14. Trapping Keyboard Interruption</a></h3>

Normally when you type Ctrl-C and Kermit is in command mode (as opposed to
CONNECT mode) with COMMAND INTERRUPTION ON (as it is unless you have set it
OFF), Kermit interrupts any command that is currently in progress, and if a
command file or macro is executing, rolls the command stack back to top level,
closing all open command files, deactivating all macros, deallocating all
local variables and arrays, and leaving you at the command prompt.

<p>

Suppose, however, you want certain actions to occur when a script is
interrupted; for example, closing open files, writing log entries, or
displaying summary results.  You can do this by defining a macro named
ON_CTRLC.  When Ctrl-C is detected, and a macro with this name is defined,
Kermit executes it <i>from the current command level</i>, thus giving it full
access to the environment in which the interruption occurred, including local
variables and open files.  Only when the ON_CTRLC macro completes execution
is the command stack rolled back to top level.

<p>

Once the ON_CTRLC macro is defined, it can be executed only once.  This is to
prevent recursion if the user types Ctrl-C while the ON_CTRLC macro is
executing.  If you type Ctrl-C while the Ctrl-C macro is active, this does not
start a new copy of ON_CTRLC; rather, it returns to the top-level command
prompt.  After the ON_CTRLC macro returns, it has been removed from the macro
table so if you want to use it again or install a different Ctrl-C trap, you
must execute a new DEFINE ON_CTRLC command.  In any case, as always when you
interrupt a script with Ctrl-C, its completion status is FAILURE.

<p>

Normally the ON_CTRLC macro would be defined in the command file or macro to
which it applies, and should be declared LOCAL.  This way, if the command file
or macro completes successfully without being interrupted, the ON_CTRLC
definition disappears automatically.  Otherwise the definition would still be
valid and the macro would be executed, probably out of context, the next time
you typed Ctrl-C.

<p>

Here's a simple example of a command file that sets a Ctrl-C trap for itself:

<p>
<pre>
  local on_ctrlc              ; Make Ctrl-C trap local to this command file.
  define on_ctrlc {           ; Define the ON_CTRLC macro.
      echo Interrupted at \v(time).
      echo Iterations: \%n
  }
  xecho Type Ctrl-C to quit
  for \%n 1 999 1 {           ; Prints a dot every second until interrupted.
      sleep 1
      xecho .
  }
  echo Finished normally at \v(time) ; Get here only if not interrupted.
  decrement \%n
  echo Iterations: \%n
</pre>
<p>

This prints a summary no matter whether it completes normally or is
interrupted from the keyboard.  In both cases the trap is automatically
removed afterwards.

<p>

For an example of how to use ON_CTRLC to debug scripts,
see <a href="#x8.1">Section 8.1</a>.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x9"><hr>9. S-EXPRESSIONS</a></h2>

This section is primarily for those who want to write calculation-intensive
scripts, especially if they require floating-point arithmetic, and/or for
those who are familiar with the LISP programming language.
<p>
Ever since C-Kermit version 5 was released in 1988, scripting has been one of
its major attractions, and arithmetic is a key part of it.  Versions 5 and 6
included integer arithmetic only, using traditional algebraic notation, e.g.:
<p><pre>
  echo \fevaluate(3*(2+7)/2)
  13
</pre>
<p>
C-Kermit 7.0 added support for floating-point arithmetic, but only through
function calls:
<p><pre>
  echo \fppdivide(\ffpmultiply(3.0,\fpadd(2.0,7.0)),2.0)
  13.5
</pre>
<p>
C-Kermit 8.0 introduces a third form of arithmetic that treats integers and
floating-point numbers uniformly, is easier to read and write, and executes
very quickly:
<p><pre>
  (/ (* 3 (+ 2 7)) 2)
  13.5
</pre>
<p>
But first some background.
<p>
The Kermit command and scripting language differs from true programming
languages (such as C or Fortran) in many ways; one of the most prominent
differences is the way in which variables are distinguished from constants.
In a command language, words are taken literally; for example, the Unix shell:
<p><pre>
  cat foo.bar
</pre>
<p>
displays the file named foo.bar.  Whereas in a programming language like C,
words are assumed to be variables:
<p><pre>
  s = foo.bar;    /* Assigns the value of foo.bar to the variable s */
</pre>
<p>
To make a programming language take words literally, you have to quote or
"escape" them:
<p><pre>
  s = "foo.bar";  /* Assigns a pointer to the string "foo.bar" to the variable s */
</pre>
<p>
The opposite holds for command languages: to get them to treat a word as
a variable rather than a constant, you have to escape them.  For example,
in the Unix shell:
<p><pre>
  foo=123         ; Assign value 123 to variable foo.
  echo foo        ; Prints "foo"
  echo $foo       ; Prints "123"
</pre>
<p>
And in Kermit:
<p><pre>
  define foo 123  ; Assign value 123 to variable foo.
  echo 123        ; This prints "123".
  echo foo        ; This prints "foo".
  echo \m(foo)    ; This prints "123".
</pre>
<p>
In other words, character strings (such as "foo" above) are interpreted as
literal strings, rather than variable names, except in special commands like
DEFINE that deal specifically with variable names (or in numeric contexts as
explained in <a href="#x8.2">Section 8.2</a>).  The special "escape" character
(dollar sign (<tt>$</tt>) for the shell, backslash (<tt>\</tt>) for Kermit)
indicates that a variable is to be replaced by its value.
<p>

The requirement to escape variable names in command languages normally does
not impose any special hardship, but can add a considerable notational burden
to arithmetic expressions, which are typically full of variables.  Especially
in Kermit when floating point numbers are involved, where you must use special
<tt>\ffp<i>xxx</i>()</tt> functions, e.g. "<tt>\fpadd(\m(a),\m(b))</tt>" rather
than the simple "<tt>+</tt>" operator to add two floating-point numbers
together, because the original arithmetic handler doesn't support floating
point (this might change in the future).  To illustrate, the general formula
for the area of a triangle is:

<p><pre>
  sqrt(s * (s - a) * (s - b) * (s - c))
</pre>
<p>
where a, b, and c are the lengths of the triangle's three sides and:
<p><pre>
  s = (a + b + c) / 2
</pre>
<p>
Except in special cases (e.g. a = 3, b = 4, c = 5), the result has a
fractional part so the computation must be done using floating-point
arithmetic.  We can create a Kermit 7.0 function for this as follows:
<p><pre>
  def area {
      local s t1 t2 t3
      assign s \ffpdiv(\ffpadd(\ffpadd(\%1,\%2),\%3),2.0)
      assign t1 \ffpsub(\m(s),\%1)
      assign t2 \ffpsub(\m(s),\%2)
      assign t3 \ffpsub(\m(s),\%3)
      return \ffpsqrt(\ffpmul(\m(s),\ffpmul(\m(t1),\ffpmul(\m(t2),\m(t3)))))
  }
</pre>
<p>
But as you can see, this is rather cumbersome.  Note, in particular, that
arithmetic functions like <tt>\ffpadd()</tt>, <tt>\ffpmul()</tt>, etc, take
exactly two operands (like their symbolic counterparts <tt>+</tt> and
<tt>*</tt>), so obtaining the product of three or more numbers (as we do in
this case) is awkward.
<p>
Using the alternative S-Expression notation, we can reduce this to a form that
is both easier to read and executes faster (the details are explained later):
<p><pre>
  def newarea {
      (let s (/ (+ \%1 \%2 \%3) 2.0))
      (sqrt (* s (- s \%1) (- s \%2) (- s \%3)))
  }
</pre>
<p>

In both examples, the <tt>\%1..3</tt> variables are the normal Kermit macro
arguments, referenced by the normal escaping mechanism.  For increased
readability, we can also assign the macro arguments <tt>\%1</tt>,
<tt>\%2</tt>, and <tt>\%3</tt> to the letters a, b, and c corresponding to our
formula:

<p><pre>
def newarea {
    (let a \%1 b \%2 c \%3)
    (let s (/ (+ a b c) 2.0))
    (sqrt (* s (- s a) (- s b) (- s c)))
}
</pre>
<p>
And now the Kermit function reads almost like the original formula.  Here
Kermit behaves more like a regular programming language.  In an S-Expression,
macro names need not be escaped when they are used as the names of numeric
variables.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.1">9.1. What is an S-Expression?</a></h3>

The S-Expression concept is borrowed from the Lisp programming language.
"S-Expression" is short for Symbolic Expression (itself sometimes shortened
to SEXP).  S-Expressions provide a kind of Alternative Mini-Universe within
the Kermit command language when the regular rules don't apply, a universe
enclosed in parentheses.
<p>
C-Kermit does not pretend to be a full Lisp interpreter; only the arithmetic
parts of Lisp have been incorporated: S-Expressions that operate on numbers
and return numeric values (plus extensibility features described in
<a href="#x9.8">Section 9.8</a>, which allow some degree of string processing).
<p>
An S-Expression is a list of zero or more items, separated by spaces, within
parentheses.  Examples:
<p><pre>
  ()
  (1)
  (a)
  (+ a 1)
  (* 2 a b)
</pre>
<p>
If the S-Expression is empty, it has the NIL (empty) value.  If it is not
empty and the first item is an operator (such as <tt>+</tt> or <tt>*</tt>),
there can be zero or more subsequent items, called the operands:
<p><pre>
  (+ 1 2)
</pre>
<p>
Here the operator is "+" and the operands are "1" and "2", and the value of
the S-Expression is the value of the operation (in this case 3).  The operator
always comes first, which is different from the familiar algebraic notation;
this because S-Expression operators can have different numbers of operands:
<p><pre>
  (+ 1)
  (+ 1 2)
  (+ 1 2 3 4 5 6 7 8 9)
</pre>
<p>
If the first item in the S-Expression is not an operator, then it must be a
variable or a number (or a macro; see <a href="#x9.8">Section 9.8</a>), and
the S-Expression can only contain one item; in this case, the S-Expression's
value is the value of the variable or number:
<p><pre>
  (a)
  (3)
</pre>
<p>
Operands can be numbers, variables that have numeric values, functions that
return numbers, or other S-Expressions.  To illustrate an S-Expression within
an S-Expression, observe that:
<p><pre>
  (+ 1 2)
</pre>
<p>
is equivalent to any of the following (plus an infinite number of others):
<p><pre>
  (+ 1 (+ 1 1))
  (+ (- 3 2) (/ 14 (+ 3 4)))
</pre>
<p>
S-Expressions can be nested to any reasonable level; for example, the value of
the following S-Expression is 64:
<p><pre>
  (- (* (+ 2 (* 3 4)) (- 9 (* 2 2))) 6)
</pre>
<p>
Operators have no precedence, implied or otherwise, since they can't be mixed.
The only exceptions are unary <tt>+</tt> and <tt>-</tt>, which simply indicate
the sign of a number:
<p><pre>
  (* 3 -1)
</pre>
<p>
Order of evaluation is specified entirely by parentheses, which are
required around each operator and its operands:
<tt>(+&nbsp;a&nbsp;(*&nbsp;b&nbsp;c))</tt>
instead of
<tt>(a&nbsp;+&nbsp;b&nbsp;*&nbsp;c)</tt>.
<p>
S-Expressions provide a simple and isolated environment in which Kermit's
macro names can be used without the <tt>\m(...)</tt> escaping that is normally
required.  Given:
<p><pre>
  define a 1
  define b 2
  define c 3
</pre>
<p>
Then:
<p><pre>
  (+ \m(a) \m(b) \m(c))
</pre>
<p>
is equivalent to:
<p><pre>
  (+ a b c)
</pre>
<p>
Within an S-Expression, as in other strictly numeric contexts (<a
href="#x8.2">Section 8.2</a>), any operand that starts with a letter is
treated as a Kermit macro name.  In this context, abbreviations are not
accepted; variable names must be spelled out in full.  Alphabetic case is not
significant; "a" and "A" are the same variable, but both are different from
"area".
<p>
Of course, regular Kermit variables and functions can be used in S-Expressions
in the normal ways:
<p><pre>
  (* \v(math_pi) (^ \%r 2))             ; Area of a circle with radius \%r
  (+ \fjoin(&#38;a))                        ; Sum of all elements of array \&#38;a[]
</pre>

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.2">9.2. Integer and Floating-Point-Arithmetic</a></h3>

Normally, if all numbers in an S-Expression are integers, the result is an
integer:
<p><pre>
  (+ 1 1)                               ; Result is 2
  (/ 9 3)                               ; Result is 3
</pre>
<p>
If any of the operands is floating point, however, the result is also
floating point:
<p><pre>
  (+ 1 1.0)                             ; Result is 2.0
  (/ 9.0 3)                             ; Result is 3.0
</pre>
<p>
If all the operands are integers but the result has a fractional part,
the result is floating point:
<p><pre>
  (/ 10 3)                              ; Result is 3.333333333333333
</pre>
<p>
To force an integer result in such cases, use the TRUNCATE operator:
<p><pre>
  (truncate (/ 10 3))                   ; Result is 3
</pre>
<p>
Similarly, to force a computation to occur in floating point, you can
coerce one of its operands to FLOAT:
<p><pre>
  (+ 1 (float 1))                       ; Result is 2.0
</pre>
<p>
The result is also floating point if the magnitude of any integer operand,
intermediate result, or the result itself, is larger than the maximum for the
underlying machine architecture:
<p><pre>
  (^ 100 100)
</pre>
<p>
If the result is too large even for floating-point representation, "Infinity"
is printed; if it is too small to be distinguished from 0, 0.0 is returned.
<p>
Large numbers can be used and large results generated, but they are accurate
only to the precision of the underlying machine.  For example, the result of:
<p><pre>
 (+ 111111111111111111111 222222222222222222222)
</pre>
<p>
should be 333333333333333333333, but 333333333333333300000.0 is produced
instead if the machine is accurate to only about 16 decimal digits, even with
coercion to floating-point.  The order of magnitude is correct but the least
significant digits are wrong.  The imprecise nature of the result is indicated
by the "<tt>.0</tt>" at the end.  Contrast with:
<p><pre>
 (+ 111111111 222222222)
</pre>
<p>
which produces an exact integer result.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.3">9.3. How to Use S-Expressions</a></h3>

S-Expressions may be given as commands to C-Kermit.  Any command whose
first character is "<tt>(</tt>" (left parenthesis) is interpreted as an
S-Expression.
<p>
If you enter an S-Expression at the <tt>C-Kermit&#62;</tt> prompt, its result
is printed:
<p><pre>
  C-Kermit&gt;(/ 10.0 3)
   3.333333333333333
  C-Kermit&gt;
</pre>
<p>
If an S-Expression is executed within a macro or command file, its value is
not printed.  However, you can control the printing action with:
<p>
<dl>
<dt><tt><b>SET SEXPRESSION ECHO</b> <i>{</i> <b>AUTO, ON, OFF</b> <i>}</i></tt></dt>
<dd>AUTO is the default, meaning print the value at top level only;
ON means always print the value; OFF means never print it.
</dl>
<p>
In any case, the value of the most recent S-Expression (and the S-Expression
itself) may be accessed programmatically through the following variables:
<p>
<dl>
<dt><tt>\v(sexpression)</tt></dt>
<dd>The S-Expression most recently executed.
<p>
<dt><tt>\v(svalue)</tt></dt>
<dd>The value of the S-Expression most recently executed.
</dl>
<p>
Besides issuing S-Expressions as commands in themselves, you can also execute
them anywhere within a Kermit command, but in this case they must be enclosed
in a function call (otherwise they are taken literally):
<p>
<dl>
<dt><tt>\fsexpression(s)</tt></dt>
<dd>The argument "s" is an S-Expression; the outer parentheses may be omitted.
The value of the S-Expression is returned.  Note that since S-Expressions
usually contain spaces, some form of grouping or quoting might be needed in
some contexts:
<p><pre>
  echo \fsexpression((+ 1 1))            ; Outer parentheses may be included
  echo \fsexpr(+ 1 1)                    ; Outer parentheses may be omitted
  echo Value = "\fsexp(+ 1 a)"           ; Can be embedded in strings
  echo Value = \&#38;a[\fsexp(/ b 2)]        ; Can be used in array subscripts
  if = {\fsexp(+ 1 1)} 2 {               ; Braces needed here for grouping
      echo One plus one still equals two
  }
</pre>
</dl>
<p>
The IF statement illustrates how to use S-Expressions as (or in) IF or WHILE
conditions:
<p>
<ul>
<li>Although S-Expressions and IF conditions are similar in appearance, they
are not interchangeable.  Therefore you must use <tt>\fsexpr()</tt> to let
Kermit know it's an S-Expression rather than a regular IF condition, or a
boolean or algebraic expression within an IF condition.
<p>
<li>In contexts where a single "word" is expected, you must enclose the
<tt>\fsexp()</tt> invocation in braces if the S-Expression contains spaces (and
most of the do).
</ul>
<p>
If an S-Expression is the last command executed in a macro, its value becomes
the return value of the macro; no RETURN command is needed.  Example:
<p><pre>
  def newarea {
      (let s (/ (+ \%1 \%2 \%3) 2.0))
      (sqrt (* s (- s \%1) (- s \%2) (- s \%3)))
  }
</pre>
<p>
This is equivalent to (but more efficient than):
<p><pre>
  def newarea {
      (let s (/ (+ \%1 \%2 \%3) 2.0))
      return \fsexp(sqrt (* s (- s \%1) (- s \%2) (- s \%3)))
  }
</pre>
<p>
When an S-Expression is entered as a command -- that is, the first nonblank
character of the command is a left parenthesis -- then it is allowed to span
multiple lines, as many as you like, until the first left parenthesis is
matched:
<p><pre>
  (let s (/
          (+
           \%1
           \%2
           \%3
           )
          2.0
          )
       )
  (sqrt (*
         s
         (- s \%1)
         (- s \%2)
         (- s \%3)
         )
        )
</pre>
<p>
The S-Expression concept lends itself easily to embedding and recursion, but
the depth to which recursion can occur is limited by the resources of the
computer (memory size, address space, swap space on disk) and other factors.
There is no way that C-Kermit can know what this limit is, since it varies not
only from computer to computer, but also from moment to moment.  If resources
are exhausted by recursion, C-Kermit simply crashes; there's no way to trap
this error.  However, you can set a depth limit on S-Expressions:
<p>
<dl>
<dt><tt><b>SET SEXPRESSION DEPTH-LIMIT</b> <i>number</i></tt></dt>
<dd>Limits the number of times the S-Expression reader can invoke itself
without returning to the given number.  The default limit is 1000.
This limit applies to S-Expressions embedded within other S-Expressions
as well as to S-Expressions that invoke recursive macros.  If the limit
is exceeded, Kermit prints "?S-Expression depth limit exceeded" and
returns to its prompt.  More about recursion in
<a href="#x9.8">Section 9.8</a>.
</dl>
<p>
You can also test the depth programmatically:
<p>
<dl>
<dt><tt>\v(sdepth)</tt></dt>
<dd>The current S-Expression invocation depth.  The depth includes both nesting
level and recursion.  For example, in:
<tt>(foo&nbsp;(foo&nbsp;(foo&nbsp;(foo&nbsp;(foo)))))</tt>, the innermost
<tt>(foo)</tt> is at depth 5.
</dl>
<p>
Help, completion, and syntax checking are not available within an S-Expression.
If you type ? within an S-Expression, it says:
<p><pre>
  C-Kermit&gt;(? S-Expression ("help sexp" for details)
</pre>
<p>
As it says, typing "help sexp" will display a brief help text.
<p>
The SHOW SEXPRESSION command displays current SET SEXPRESSION settings and
related information.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.4">9.4. Summary of Built-in Constants and Operators</a></h3>

Three constants are built in:
<p>
<ul>
<li><b>PI</b>, whose value is the value of pi (the quotient of circumference
of any circle and its diameter, 3.141592653...) to the underlying machine's
precision;
<p>
<li><b>T</b>, which always has the value 1, which signifies truth in Kermit
logical expressions or S-Expressions;
<p>
<li><b>NIL</b>, which always has the empty value, and can serve as a False
truth value.
</ul>
<p>
These constants are specific to S-Expressions and are not visible outside them.
They may not be used as the target of an assignment.  So, for example:
<p><pre>
  (setq t 0)   <i>Fails</i>
  assign t 0   <i>Succeeds but this is not the same T!</i>
</pre>
<p>
<b>E</b> (the base of natural logarithms, 2.7182818184...) is not built in
since it is not intrinsic in most Lisp dialects.  If you want E to be the base
of natural logarithms you can:
<p><pre>
  (setq e (exp 1))
</pre>
<p>
Operators are either symbols (such as "<tt>+</tt>") or words.  Words must be
spelled out in full, not abbreviated.  Differences of alphabetic case are
ignored.
<p>
The most basic operation in S-Expressions is evaluation:
<p>
<dl>
<dt><tt><b>EVAL</b> <i>[ s-expression or variable or number [ another [ another ... ] ] ]</i></tt></dt>
<dd>Evaluates its operands and returns the value of the last one evaluated.
  Examples:
<p><pre>
  (eval)                                <i>0</i>
  (eval 1)                              <i>1</i>
  (eval a)                              <i>value of a</i>
  (eval (+ 1 a))                        <i>value of a+1</i>
  (eval (setq a 1) (setq b (+ a 0.5))   <i>value of b (= a+0.5)</i>
</pre>
<p>
  You can use "<tt>.</tt>" as a shorthand for EVAL:
<p><pre>
  (.)
  (. 1)
  (. a)
  (. (+ 1 a))
  (. (setq a 1) (setq b (+ a 0.5))
</pre>
</dl>
<p>
Opposite of EVAL is the operator that suppresses evaluation of its operand:
<p>
<dl>
<dt><tt><b>QUOTE</b> <i>item</i></tt></dt>
<dd>The value (quote item) is "item".  If the item is itself an S-Expression,
  the result is the S-Expression with the outer parentheses stripped.
  Examples:
<p><pre>
  (quote)                               <i>(illegal)</i>
  (quote a)                             <i>a</i>
  (quote hello)                         <i>hello</i>
  (quote (this is a string))            <i>this is a string</i>
  (quote this is a string)              <i>(illegal)</i>
</pre>
<p>
A shorthand notation is also accepted for quoting:<br>
<tt>'a</tt> is equivalent to <tt>(quote a)</tt>.  And therefore:<br>
<tt>'(a b c)</tt> is equivalent to <tt>(quote (a b c))</tt>.<br>
More about quoting in <a href="#x9.8">Section 9.8</a>.
<p>
<dt><tt><b>STRING</b> <i>item</i></tt></dt>
<dd>Is a combination of EVAL and QUOTE.  It evaluates the item as an
S-Expression, and then puts quotes around the result (more about this
in <a href="#x9.8">Section 9.8</a>).
</dl>
<p>
The following operators assign values to variables:
<p>
<dl>
<dt><tt><b>SETQ</b> <i>[ variable [ value [ variable [ value [ ... ] ] ] ] ]</i></tt></dt>
<dd>Applies to global variables.  For each variable given: if a <value> is not
given, the variable is undefined.  If a value is given, assigns the value
to the variable.  The value may be a number, a variable, or anything that
resolves to a number including an S-Expression.  Returns the value of the
last assignment.  Examples:
<p><pre>
  (setq)             <i>Does nothing, returns NIL.</i>
  (setq a)           <i>Undefines a, returns NIL.</i>
  (setq a 1)         <i>Assigns 1 to a, returns 1.</i>
  (setq a 1 b 2)     <i>Assigns 1 to a, 2 to b, returns 2.</i>
  (setq a 1 b 2 c)   <i>Assigns 1 to a, 2 to b, undefines c, returns NIL.</i>
</pre>
</dl>
<p>
To undefine a variable that is not the final one in the list, give it a value
of "<tt>()</tt>" or NIL:
<p><pre>
  (setq a () b 2)    <i>Undefines a, assigns 2 to b, returns 2.</i>
  (setq a nil b 2)   <i>Ditto.</i>
</pre>
<p>
Note that a variable can be used right away once it has a value:
<p><pre>
  (setq a 1 b a)     <i>Assigns 1 to a, the value of a (1) to b, returns 1.</i>
</pre>
<p>
The results of SETQ (when used with macro names) can be checked conveniently
with SHOW MACRO, e.g:
<p><pre>
  show mac a b c
</pre>
<p>
<dl>
<dt><tt><b>LET</b> <i>[ variable [ value [ variable [ value [ ... ] ] ] ] ]</i></tt></dt>
<dd>Like SETQ, but applies to local variables.  Note that "local" is used in
the Kermit sense, not the Lisp sense; it applies to the current Kermit
command level, not to the current S-Expression.
</dl>
<p>
If you want to use SETQ or LET to assign a value to a backslash variable
such as <tt>\%a</tt> or <tt>\&#38;a[2]</tt>, you must double the backslash:
<p><pre>
  (setq \\%a 3)
  (setq \\%b (+ \%a 1))
  (setq \\&#38;a[2] (setq (\\%c (+ \%a \%b))))
</pre>
<p>
In other words:
<p>
<ul>
<li>Double the backslash when you want to indicate the variable's NAME;
<li>Don't double the backslash when you want its VALUE.
</ul>
<p>
See <a href="#x9.6">Section 9.6</a> for a fuller explanation of variable
syntax and scope.
<p>
Here's a summary table of arithmetic operators; in the examples, a is 2
and b is -1.3:
<p><pre>
  <u><i>Operator</i></u>  <u><i>Description</i>                        </u>    <u><i>Example</i>       </u>    <u><i>Result</i></u>
  +         Adds all operands (0 or more)          (+ a b)           0.7
  -         Subtracts all operands (0 or more)     (- 9 5 2 1)       1
  *         Multiplies all operands (0 or more)    (* a (+ b 1) 3)  -1.80
  /         Divides all operands (2 or more)       (/ b a 2)        -0.325
  ^         Raise given number to given power      (^ 3 2)           9
  ++        Increments variables                   (++ a 1.2)        3.2
  --        Decrements variables                   (-- a)            1
  ABS       Absolute value of 1 operand            (abs (* a b 3))   7.8
  MAX       Maximum of all operands (1 or more)    (max 1 2 3 4)     4
  MIN       Minimum of all operands (1 or more)    (min 1 2 3 4)     1
  MOD (%)   Modulus of all operands (1 or more)    (mod 7 4 2)       1
  FLOAT     Convert an integer to floating-point   (float 1)         1.0
  TRUNCATE  Integer part of floating-point operand (truncate 3.333)  3
  CEILING   Ceiling of floating-point operand      (ceiling 1.25)    2
  FLOOR     Floor of floating-point operand        (floor 1.25)      1
  ROUND     Operand rounded to nearest integer     (round 1.75)      2
  SQRT      Square root of 1 operand               (sqrt 2)          1.414..
  EXP       e (2.71828..) to the given power       (exp -1)          0.367..
  SIN       Sine of angle-in-radians               (sin (/ pi 2))    1.0
  COS       Cosine of angle-in-radians             (cos pi)         -1.0
  TAN       Tangent of angle-in-radians            (tan pi)          0.0
  LOG       Natural log (base e) of given number   (log 2.7183)      1.000..
  LOG10     Log base 10 of given number            (log10 1000)      3.0
</pre>
<p>

The <tt>++</tt> and <tt>--</tt> operators are also assignment operators and
work just like SETQ and LET in their interpretations of operators and
operands, but:

<p>
<ul>
<li>Each target variable must already be defined and have a numeric value;
<li>The assignment value is the amount by which to increment or decrement
the variable.
<li>If an assignment value is not given, 1 is used.
</ul>
<p>
If you include more than one variable-value pair in a <tt>++</tt> or
<tt>--</tt> expression, every variable (except, optionally, the last) must be
followed by a value.
Examples:
<p><pre>
  (++ a)                Equivalent to (setq a (+ a 1)) and to (++ a 1)
  (++ a 2)              Equivalent to (setq a (+ a 2))
  (-- a (* 2 pi))       Equivalent to (setq a (- a (* 2 pi)))
  (++ a 1 b 1 c 1 d)    Equivalent to four SETQs incrementing a,b,c,d by 1.
</pre>
<p>
Another group of operators forms the predicates.  These return a "truth
value", in which 0 (or NIL) is false, and 1 or any other nonzero number is
true.
<p><pre>
  <u><i>Operator</i></u>  <u><i>Description</i>                        </u>    <u><i>Example</i>       </u>    <u><i>Result</i></u>
  = (or ==) Operands are equal                     (= 1 1.0)         1
  !=        Operands are not equal                 (!= 1 1.0)        0
  &#60;         Operands in strictly ascending order   (< 1 2 3)         1
  &#60;=        Operands in ascending order            (<= 1 1 2 3)      1
  &#62;         Operands in strictly descending order  (> 3 2 1)         1
  &#62;=        Operands in descending order           (<= 3 3 2 1)      1
  AND (&#38;&#38;)  Operands are all true                  (and 1 1 1 1 0)   0
  OR  (||)  At least one operand is true           (or 1 1 1 1 0)    1
  XOR       Logical Exclusive OR                   (xor 3 1)         0
  NOT (!)   Reverses truth value of operand        (not 3)           0
</pre>
<p>
The Exclusive OR of two values is true if one value is true and the other
value is false.
<p>
And another group operates on bits within an integer word:
<p><pre>
  <u><i>Operator</i></u>  <u><i>Description</i>                        </u>    <u><i>Example</i>       </u>    <u><i>Result</i></u>
  &#38;         Bitwise AND                            (&#38; 7 2)           2
  |         Bitwise OR                             (| 1 2 3 4)       7
  #         Bitwise Exclusive OR                   (# 3 1)           2
  ~         Reverses all bits                      (~ 3)            -4
</pre>
<p>
These operators coerce their operands to integer by truncation if necessary.
The result of bit reversal is hardware dependent.
<p>
The final category of operator works on truth values:
<p><pre>
  <u><i>Operator</i></u>  <u><i>Description</i>                        </u>    <u><i>Example</i>       </u>    <u><i>Result</i></u>
  IF        Conditional evaluation                 (if (1) 2 3)      2
</pre>
<p>
<dl>
<dt><tt><b>IF (</b><i>predicate</i><b>) (</b><i>s1</i><b>)</b> <i>[</i> <b>(</b><i>s2</i><b>)</b> <i>]</i></tt></dt>
<dd>The IF operator is similar to Kermit's IF command.  If the predicate is
true (i.e. evaluates to a nonzero number), the first S-Expression (s1) is
evaluated and its value is returned.  Otherwise, if (s2) is given, it is
evaluated and its value returned; if (s2) is not given, nothing happens
and the NIL (empty) value is returned.
</dl>
<p>
You can group multiple expressions in the s2 and s2 expressions using EVAL
(or "<tt>.</tt>"):
<p><pre>
  (if (&#60; a 0) (eval (setq x 0) (setq y 0)) (eval (setq x a) (setq y b)))
</pre>
<p>
or equivalently:
<p><pre>
  (if (&#60; a 0) (. (setq x 0) (setq y 0)) (. (setq x a) (setq y b)))
</pre>
<p>
Each operator has its own requirement as to number and type of operands.
In the following table, "number" means any kind of number -- integer or
floating-point -- or a variable, function, macro, or S-Expression that returns
a number; "vname" means variable name, "fpnumber" means a floating-point
number (or anything that resolves to one), and "integer" means integer (or
anything that resolves to one).  "truthvalue" means anything that resolves to
a value of zero or an empty value (which indicates false) or a nonzero value
(which indicates true).  "any" means any kind of value, including none at all.
<p>
<pre>
  <u><i>Operator</i></u>  <u><i>Number of operands</i></u>   <u><i>Type of operands</i></u>    <u><i>Returns</i></u>
  EVAL  (.) 0 or more            S-Expression        Last value (default NIL)
  STRING    1                    S-Expression        string
  QUOTE (') 1                    word                string
  SETQ      0 or more            vname value pairs   Last value (default NIL)
  LET       0 or more            vname value pairs   Last value (default NIL)
  +         0 or more            number              number     (default 0)
  -         0 or more            number              number     (default 0)
  *         0 or more            number              number     (see note (1))
  /         2 or more            number              number
  ^         2 or more            number              number
  ++        1 or more            vname value pairs   Result of last increment
  --        1 or more            vname value pairs   Result of last decrement
  ABS       1                    number              number
  MAX       1 or more            number              number
  MIN       1 or more            number              number
  MOD (%)   2                    number              number
  FLOAT     1                    number              fpnumber
  TRUNCATE  1                    number              integer
  CEILING   1                    number              integer
  FLOOR     1                    number              integer
  ROUND     1                    number              integer
  SQRT      1                    number              fpnumber
  EXP       1                    number              fpnumber
  SIN       1                    number              fpnumber
  COS       1                    number              fpnumber
  TAN       1                    number              fpnumber
  LOG       1                    number              fpnumber
  LOG10     1                    number              fpnumber
  = (==)    1 or more            number              truthvalue
  !=        1 or more            number              truthvalue
  &#60;         1 or more            number              truthvalue
  &#60;=        1 or more            number              truthvalue
  &#62;         1 or more            number              truthvalue
  &#62;=        1 or more            number              truthvalue
  AND (&#38;&#38;)  1 or more            truthvalue          truthvalue
  OR  (||)  1 or more            truthvalue          truthvalue
  XOR       2                    truthvalue          truthvalue
  NOT (!)   1                    truthvalue          truthvalue
  &#38;         1 or more            number (see note 2) integer
  |         1 or more            number (see note 2) integer
  #         2                    number (see note 2) integer
  ~         1                    number (see note 2) integer
  IF        2 or 3               truthvalue,any,any  any
</pre>
<p>
Operators that don't require any arguments return the default values shown.
<p>
<ol>
<li>The value of "*", when used as an operator, is initially "1" and the value
of the most recent S-Expression thereafter, as in Franz Lisp.  This is
handy when doing a series of calculations by hand:
<p><pre>
  C-Kermit&gt;(* 13272.42 0.40)
   5308.968
  C-Kermit&gt;(/ * 2)
   2654.4840
  C-Kermit&gt;
</pre>
<p>
<li>The bitwise operators coerce their operands to integer by truncation.
</ol>

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.5">9.5. Variables</a></h3>


As noted elsewhere in this discussion, all backslash items (variables such as
\%a, macro parameters such as \%1, array elements such as \&#38;a[\%i],
built-in variables such as \v(ndate), built-in functions such as \fjoin(),
macro names enclosed in \m(), \s(), or \:(), etc) are evaluated at "top level"
before the S-Expression is sent to the S-Expression reader.  To use a
backslash variable as the target of an assignment (e.g. by SETQ, LET, ++, or
--), you must double the backslash, e.g. (setq \\%r 1234).  This is discussed
at greater length in the next section.
<p>
Thus S-Expression reader generally deals only with macro names (not backslash
items) as variables.  It is important to understand how the reader handles
macro names.  There are fundamentally two kinds of S-Expressions: those that
contain a single element, such as:
<p><pre>
  (foo)
</pre>
<p>
and those that contain more than one element:
<p><pre>
  (foo a b c)
</pre>
<p>
If an S-Expression contains only one element, and it is the name of a macro,
the macro's definition is examined.  If the definition is a number (integer or
floating-point, positive or negative), then this becomes the value of the
expression.  If the definition starts with ' (apostrophe), then the quoted
word or string is the value of the expression (explained in 
<a href="#x9.8">Section 9.8</a>).
Otherwise, the macro is assumed to be composed of Kermit commands (possibly
including S-Expressions), which are executed.  If the macro has a RETURN
value, or it executes an S-Expression as its last command, the result becomes
the value of the S-Expression; otherwise the result is empty.
<p>
For S-Expressions that contain more than one element, and the first element is
the name of a macro, then this macro is executed with the arguments that are
given, after the arguments are evaluated by the S-Expression reader.
Likewise, If the first element is a built-in operator, then it is applied to
the operands after they are evaluated.  In both cases, each operand is fed to
the S-Expression reader recursively for evaluation.  If an operand is a number
or a quoted string, it is used as-is.  But if it's a macro name, this
degenerates into the first case, and the previous paragraph applies.
<p>
Examples:
<p><pre>
  define foo 123
  (foo)                                <i>Result: 123</i>
  define foo 'abc
  (foo)                                <i>Result: abc</i>
  define foo '(one two three)
  (foo)                                <i>Result: one two three</i>
  define foo return \frandom(1000)
  (foo)                                <i>Result: 713 (or other number)</i>
  define foo (+ a b)
  (foo)                                <i>Result: The sum of a and b</i>
</pre>
<p>
A more difficult example:
<p><pre>
  define foo abc
  (foo)                                <i>Result: ???</i>
</pre>
<p>
The result in the last example depends on the definition of abc:
<p>
<ul>
<li>If it has no definition, an error occurs; otherwise:
<p>
<li>If the definition is an S-Expression, the result is the
S-Expression's value; otherwise:
<p>
<li>If the definition consists of Kermit commands, they are executed.
But in this case "<tt>(foo)</tt>" produces the empty result, because it
doesn't RETURN anything.
</ul>
<p>
The use of macros as S-Expression operators is described in
<a href="#x9.8">Section 9.8</a>.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.6">9.6. Assignments and Scope</a></h3>

The assignment operators SETQ and LET apply to global and local variables,
respectively.  SETQ and LET are standard Lisp operators adapted to Kermit
scoping rules.  When the operands are numeric or arithmetic, SETQ is
equivalent to Kermit's EVALUATE command:
<p><pre>
  (setq a (+ 1 2))
  evaluate a 1 + 2
</pre>
<p>
When the operand is a string, SETQ is equivalent to DEFINE:
<p><pre>
  (setq a '(this is a string))
  define a this is a string
</pre>
<p>
In the first case, both statements create a macro named "a" with a value of 3.
But in neither case is the macro "a" necessarily global.  If either of these
commands executes in an environment (i.e. macro invocation level) where a
"local a" command has been given, the "a" macro is global to that environment,
but is not visible outside it.
<p>
LET is equivalent to the Kermit LOCAL command, followed by the corresponding
EVALUATE:
<p><pre>
  (let a (+ 1 2))
</pre>
<p>
is equivalent to:
<p><pre>
  local a
  evaluate a 1 + 2
</pre>
<p>
Again, "local" in this context applies to the Kermit macro invocation stack,
not to the S-Expression nesting level.  To illustrate, recall our "newarea"
macro:
<p><pre>
def newarea {
    (let a \%1 b \%2 c \%3)
    (let s (/ (+ a b c) 2.0))
    (sqrt (* s (- s a) (- s b) (- s c)))
}
</pre>
<p>
Because SETQ and LET expressions return a value, they can be placed within
a larger S-Expression.  In this case we can replace the first reference to
the "s" variable by its defining expression:
<p><pre>
def newarea {
    (let a \%1 b \%2 c \%3)
    (sqrt (* (let s (/ (+ a b c) 2.0)) (- s a) (- s b) (- s c)))
}
</pre>
<p>
This would not work if LET were local to the S-Expression, but it works
nicely in the context of Kermit macros.  The previous definition is equivalent
to:
<p><pre>
def newarea {
    local a b c s
    (setq a \%1 b \%2 c \%3)
    (sqrt (* (setq s (/ (+ a b c) 2.0)) (- s a) (- s b) (- s c)))
}
</pre>
<p>
In both cases, the variables a, b, c, and s are local to the "newarea" macro,
and global within it.
<p>
Multiple assignments can be handled in several ways.  Here is the obvious way
to initialize a series of variables to the same value:
<p><pre>
  (setq a 0)
  (setq b 0)
  (setq c 0)
  (setq s 0)
</pre>
<p>
Here is a more compact and efficient way of doing the same thing:
<p><pre>
  (setq a 0 b 0 c 0 s 0)
</pre>
<p>
However, in case the value was more complex, it's better to put only one copy
of it in the S-Expression; in this case we rely on the fact that SETQ returns
the value of its last assignment:
<p><pre>
  (setq a (setq b (setq c (setq s (* x (^ y 2))))))
</pre>
<p>
Similarly, to set a series of variables to x, x+1, x+2, ...
<p><pre>
  (setq c (+ (setq b (+ (setq a (+ (setq s x) 1)) 1)) 1))
</pre>
<p>
In the last example, you can see why "last" does not always correspond to
"rightmost" (the leftmost variable "c" is assigned last).
<p>
If you are working with backslash variables like <tt>\%a</tt> or array elements
like \&#38;a[1], remember two rules:
<ol>
<li>Don't put spaces inside array brackets.
<li>You must double the backslash when using SETQ, LET, <tt>++</tt>, or
<tt>--</tt> to assign a value to a backslash variable.
</ol>
<p>
Examples of assigning to a backslash variable:
<p><pre>
  (setq x 1)
  (setq \\%a 0)
  (setq \\&#38;a[x+1] 1)
  (++ \\%x)
  (-- \\&#38;a[x+2])
</pre>
<p>
Examples of referring to a backslash variable's value:
<p><pre>
  (setq a (+ \%a 1))
  (setq b (+ \%a \&#38;a[1]))
  (++ a \%x)
  (-- b \&#38;a[1])
</pre>
<p>
The special notation is required because all backslashed items
(<tt>\%x</tt> variables,
array elements, built-in
<tt>\v(xxx)</tt> variables, and 
<tt>\fxxx()</tt> function invocations)
are evaluated in a single pass BEFORE the S-Expression is executed; any other
approach would result in unacceptable performance.  So, for example, in:
<p><pre>
  declare \&#38;a[] = 1 2 3
  define \%x 4
  define \%y 0
  (setq \\%y (+ \%x \&#38;a[1]))
</pre>
<p>
the S-Expression becomes:
<p><pre>
  (setq \%y (+ 4 1))
</pre>
<p>
before it is sent to the S-Expression evaluator.  If the backslash had not
been doubled on the assignment target, the result would have been:
<p><pre>
  (setq 0 (+ 4 1))
</pre>
<p>
which is illegal because you can't assign a value to a number.  Conversely,
if backslashes were doubled on right-hand-side values:
<p><pre>
  (setq \\%y (+ \\%x \\&#38;a[1])
</pre>
<p>
this too, would give an error (<tt>not numeric - "\%x"</tt>).
<p>
If you omit the double backslash in the assignment target, the result depends
on whether the variable already has a value:
<p><pre>
  (setq \%a (* 3 3))
</pre>
<p>
If <tt>\%a</tt> has a non-numeric single-word value, then this becomes the
name of the variable that is assigned by SETQ.  To illustrate:
<p><pre>
  define \%a foo
  echo \%a
  foo
  (setq \%a (* 3 3))
  echo \%a
  foo
  show macro foo
  foo = 9
</pre>
<p>
If \%a has no value, a numeric value, or a multiword value, an "invalid
assignment" error occurs.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.7">9.7. Conditional Expressions</a></h3>

The IF operator provides a compact form of decision-making within
S-Expressions.  An IF expression can stand wherever a number might stand, as
long is it returns a number.  Here's a quick way to obtain the average value
of all the elements in an array that contains only numbers:
<p><pre>
  (/ (+ \fjoin(&#38;a)) (float \fdim(&#38;a)))
</pre>
<p>
This results in a "Divide by zero" error if the array is empty.  If you want
to define the average value of an empty array to be 0 instead of getting an
error, you can use IF to check the array size:
<p><pre>
  (if \fdim(&#38;a) (/ (+ \fjoin(&#38;a)) (float \fdim(&#38;a))) 0)
</pre>
<p>
or equivalently:
<p><pre>
  (if (not \fdim(&#38;a)) 0 (/ (+ \fjoin(&#38;a)) (float \fdim(&#38;a))))
</pre>
<p>
Of course, IF can fit anywhere else into an S-Expression:
<p><pre>
  (setq a (+ b (if (&#60; c 0) 0 c)
</pre>
<p>
and the IF expression can be as complex as you like:
<p><pre>
  (setq a (+ b (if (and (or (> x 0) (> y 0)) (&#60; c 0) (> d 1) (!= e 0)) 1 0)))
</pre>
<p>
and the "then" and "else" parts can contain multiple S-Expressions enclosed
within (EVAL ...):
<p><pre>
  (if x (eval (...) (...) (...)) (eval (...) (...) (...)))
</pre>
<p>
AND and OR operators are guaranteed to "short circuit".  If any operand of AND
is false, none of the subsequent operands is evaluated; likewise, if an OR
operand is true, no further operands are evaluated.
<p>
Bear in mind that the S-Expression IF is not the same as Kermit IF; the
condition is only allowed to be an S-Expression or a variable or number, not
the whole list of possibilities you see when you type "if ?" at the
<tt>C-Kermit&#62;</tt>
prompt.  But keep reading...

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.8">9.8. Extensibility</a></h3>

To extend the capabilities of S-Expressions, you can use Kermit macro names
as operators, with the following limitations:
<p>
<ul>
<li>The macro must not have the same name as a built-in operator.
<li>You must use the full macro name, not an abbreviation.
</ul>
<p>
And with the following enhancement:
<p>
<ul>
<li>If the last statement executed by the macro is an S-Expression, its value
is returned automatically.  In other words:
</ul>
<p><pre>
  define bump (++ \%1)
</pre>
<p>
is equivalent to:
<p><pre>
  define bump return \fsexpression(++ \%1)
</pre>
<p>

Here's an example in which we define a FIBONACCI operator that returns the
<i>n</i>th element, <i>n</i> &#62; 0, of the Fibonacci series, 0 1 1 2 3 5 8
13 21 34 55, . . ., in which the first element is 0, the second is 1, and each
subsequent element is the sum of the two before it.  This series was devised
by Leonardo Pisano, Filius Bonacci (Fibonacci for short) in 1202 to describe
how fast rabbits can breed, and also forms the basis for the Golden Mean, the
branching behavior of plants, the spiral of a nautilus shell, etc.

<p>
We can write a FIBONACCI function as a macro easily with S-Expressions:
<p><pre>
  define FIBONACCI {
      (if (&#60; \%1 3) (- \%1 1) (+ (fibonacci (- \%1 2)) (fibonacci (- \%1 1))))
  }
</pre>
<p>
You can read this as:
<p><blockquote>
If the argument (<tt>\%1</tt>) is less than 3, return the argument minus 1; otherwise:<br>
return the sum of fibonacci<tt>(</tt><i>argument</i> - 2<tt>)</tt>
and fibonacci<tt>(</tt><i>argument</i> - 1<tt>)</tt>
</blockquote>
<p>
Note that a RETURN statement is not needed, since S-Expressions automatically
set the return value of their containing macros.
<p>
For comparison, here's how it would be coded without S-Expressions:
<p><pre>
  define FIBONACCI {
      if &#60; \%1 3 return \feval(\%1-1)
      return \feval(\fexec(fibonacci \feval(\%1-2)) -
           + \fexec(fibonacci \feval(\%1-1)))
  }
</pre>
<p>
Now we can use the FIBONACCI function (whichever way you write it) just as if
it were a built-in operator:
<p><pre>
  (fibonacci 6)
</pre>
<p>
Or:
<p><pre>
  (setq a 10)
  (fibonacci a)
</pre>
<p>
Within S-Expressions only (not outside them), S-Expressions themselves can be
used as macro arguments:
<p><pre>
  (setq a 2 b 4)
  (setq x (fibonacci (* a b )))
</pre>
<p>
The value of the S-Expression (in this case "8"), and not the S-Expression
itself, is sent to the macro.
<p>
Your macro is responsible for argument validation and error handling.  A
robust Fibonacci macro would be more like this:
<p><pre>
  define FIBONACCI {
      if &#60; \v(argc) 2 end 1 ?\%0: Missing argument
      if &#62; \v(argc) 2 end 1 ?\%0: Too many arguments
      if not integer \%1 end 1 ?\%0: Integers only
      if &#60; \%1 1 end 1 ?\%0: Argument out of range
      (if (&#60; \%1 2) (\%1) (+ (fibonacci (- \%1 2)) (fibonacci (- \%1 1))))
  }
</pre>
<p>

Recall that "<tt>END <i>nonzero-number [ message ]</i></tt>" causes a macro
invocation to fail.  When the macro is the operator in an S-Expression, this
makes the S-Expression fail too.  Also note that our Fibonacci macro is just
an illustration, not a practical example.  Since it is recursive (calls
itself), it won't work for large arguments because the call stack can exceed
available memory.  See <a href="#x9.9.2">Section 9.9.2</a> for a practical
alternative.

<p>

Kermit macros, when used as S-Expression operators, can do anything at all
except initiate file transfers: they can print messages on the screen, read
and write files, interact with the user, and so on.  For example, here's a
macro ASKME that asks you to enter a number, makes sure that you did, and then
returns its value for use in the S-Expression:
<p><pre>
  define ASKME {
      local \%n
      while true {
          ask \%n { Number: }
          if not def \%n continue
          if not numeric \%n {
              echo Not numeric - "\%n"
              continue
          }
          break
      }
      return \%n
  }
  (setq a (* 2 (askme)) ; Get number from user, double it, assign result to a.
</pre>
<p>
Here's a macro you can use to validate that a number is in a given range:
<p><pre>
  define inrange {
      if != \v(argc) 4 end 1 ?\%0: Wrong number of arguments
      if ( &#60; \%1 \%2 || &#62; \%1 \%3 ) return 0
      return 1
  }
</pre>
<p>
The first argument is the number to be checked, the second is the minimum
acceptable value, the third is the maximum.  You can use this (for example)
in IF conditions:
<p><pre>
  define yes echo \%1 IS OK
  define no echo \%1 IS NOT OK

  (setq a -1 b 999)
  (if (inrange a 0 100) (yes a) (no a))
  (if (inrange b -1000 +1000) (yes b) (no b))
</pre>
<p>
This is just an illustration, of course; there's already a built-in operator
to let you do range checking without help from macros:
<p><pre>
  (if (&#60;= 0 a 100) (yes a) (no a))
  (if (&#60;= -1000 b +1000) (yes b) (no b))
</pre>
<p>
To send string parameters to a macro, some kind of quoting is required to tell
the S-Expression parser to take a given "word" literally rather than replacing
it by its value.  For this we use the Lisp QUOTE operator:
<p><pre>
  define length return \flength(\%1)
  (length (quote abcdefghijklmnopqrstuvwxyz))
  26
</pre>
<p>
This causes the string "abcdefghijklmnopqrstuvwxyz" to be sent literally to
the LENGTH macro.  Kermit, like Lisp, also offers a shortcut for QUOTE, that
lets us quote a word by prefixing it with a single quote (<tt>'</tt>)
character, also called apostophe (ASCII 39):
<p><pre>
  (length 'abcdefghijklmnopqrstuvwxyz)
  26
</pre>
<p>
The two forms are equivalent.
<p>
How the macro treats its arguments is up to the macro.  In the example above,
the argument is treated as a literal string.  However, it can also be treated
as a variable name:
<p><pre>
  define string This is a string
  define length return \flength(\m(\%1))
  (length 'string)
  16
</pre>
<p>

Note the construct <tt>\m(\%1)</tt>.  This means "the value of the macro whose
name is the value of </tt>\%1</tt>".  The value of <tt>\%1</tt> in this case
is the word "string", and the value of the macro whose name is "string" is
"This is a string".

<p>
What if the macro takes multiple arguments, or a variable number of them?
Here's a simple macro that prints a phrase that includes its arguments:
<p><pre>
  define complain echo It's too \%*!
</pre>
<p>
(Recall that <tt>\%*</tt> means "all arguments".)
<p>
It can be called in the traditional way:
<p><pre>
  complain hot                       <i>Result: "It's too hot!"</i>
  complain cold and wet              <i>Result: "It's too cold and wet!"</i>
</pre>
<p>
Or from an S-Expression if you quote the arguments:
<p><pre>
  (complain 'hot)                    <i>Result: "It's too hot!"</i>
  (complain 'cold 'and 'wet)         <i>Result: "It's too cold and wet!"</i>
</pre>
<p>
To group multiple words into a single argument, use parentheses:
<p><pre>
  (complain (quote (cold and wet)))  <i>Result: "It's too cold and wet!"</i>
  (complain '(cold and wet))         <i>Result: "It's too cold and wet!"</i>
</pre>
<p>
Note the difference:
<p><pre>
  (complain 'cold 'and 'wet)         <i>Three arguments</i>
  (complain '(cold and wet))         <i>One argument</i>
</pre>
<p>

Since the COMPLAIN macro uses <tt>\%*</tt> to refer to all its arguments, no
matter how many, it doesn't care which form you use.  But it makes a
difference in cases where the macro refers to its arguments individually.

<p>
To illustrate, let's consider a macro that receives the name of a macro and
its argument list and executes it with its arguments, without knowing how many
arguments there are.  The following LOOP macro is used to execute the given
macro with the given argument list the requested number of times:
<p><pre>
  def loop { local i, for i 1 \%1 1 do \%2 \%3 }
</pre>
<p>

Within the LOOP macro, the first argument (<tt>\%1</tt>) is the loop count,
<tt>\%2</tt> is the macro name, and <tt>\%3</tt> is the argument list.  When
the LOOP macro is invoked traditionally like this:

<p><pre>
  loop 3 complain hot
</pre>
<p>
it prints "It's too hot!" three times.  To invoke it from an S-Expression,
you must quote both the macro name as well as the argument, since in this
case the macro name itself is an argument:
<p><pre>
  (loop 3 'complain 'hot)
</pre>
<p>
Now what if you need to send different or variable numbers of arguments to the
LOOP macro?  The LOOP macro can handle it already, provided you group the
arguments into LOOP's third argument (<tt>\%3</tt>).  In Kermit syntax, without
grouping:
<p><pre>
  loop 3 complain cold and wet
</pre>
<p>
prints "It's too cold!" three times ("and wet" is lost); but with grouping
(either of the following two forms):
<p><pre>
  loop 3 complain {cold and wet}
  loop 3 complain "cold and wet"
</pre>
<p>
the LOOP macro prints "It's too cold and wet!" three times as desired.
<p>
To do the same thing in an S-Expression, just use the Lisp forms of quoting
instead of the Kermit forms; the following two are equivalent:
<p><pre>
  (loop 3 'complain (quote (cold and wet)))
  (loop 3 'complain '(cold and wet))
</pre>
<p>
Here's a similar example in which we write a macro that shows both the name
and the value of one or more other macros, whose names are given as arguments
(similar to "show macro"):
<p><pre>
  define display {
      local \%i
      for \%i 1 \v(argc)-1 1 {
          echo \&#38;_[\%i] = \m(\&#38;_[\%i])
      }
  }
</pre>
<p>
(Recall that <tt>\&#38;_[]</tt> is the macro's argument vector array,
equivalent to <tt>\%1</tt>, <tt>\%2</tt>, ...)  The DISPLAY macro can be used
in S-Expressions like this:
<p><pre>
  (setq a 1 b 2 c 3)
  (display 'a 'b 'c 'd)
</pre>
<p>
which prints:
<p><pre>
  a = 1
  b = 2
  c = 3
  d =
</pre>
<p>
The names must be quoted to prevent their evaluation before they are sent to
the macro.  This ability to pass variables "by name" to macros, rather than by
value, lets you write macros that change the values of argument variables.
For example, here's a macro that doubles the value of its argument variable:
<p><pre>
  define double (++ \%1 \%1)
</pre>
<p>
which you can call like this:
<p><pre>
  (setq a 12)
  (double 'a)
</pre>
<p>
In the macro, <tt>\%1</tt> is replace by the variable name "<tt>a</tt>";
"<tt>(++ a a)</tt>" adds "<tt>a</tt>"
to itself, and sets the value of "<tt>a</tt>" to the result.
<p>
There are no built-in operators other than QUOTE, <tt>'</tt>, and STRING for
handling strings in S-Expressions, but using just these, plus macros that use
Kermit's regular string-handling features, you can easily extend S-Expressions
to do string manipulation:
<p><pre>
  define len return \flen(\%1)               <i>Returns length of argument string</i>
  define cap return \fupper(\%1)             <i>Uppercase argument string</i>
  define rev return \freverse(\%1)           <i>Reverses argument string</i>
  define sub return \fsubstr(\%1,\%2,\%3)    <i>Returns substring of arg string</i>

  (len '(this is a string))                  <i>Result: 16</i>
  (rev '(this is a string))                  <i>Result: gnirts a si siht</i>
  (rev (cap '(this is a string)))            <i>Result: GNIRTS A SI SIHT</i>
  (sub (rev (cap '(this is a string))) 5 9)  <i>Result: TS A SI S</i>
</pre>
<p>
You can assign a string to a macro name as follows:
<p><pre>
  (setq foo '(this is a string)))
  (setq foo (quote (this is a string))))
</pre>
<p>
The two are exactly equivalent.  In both cases, the macro "foo" has the
value:
<p><pre>
  '(this is a string)
</pre>
<p>
so when it is retrieved it can be identified as a string rather than a
number or commands to be executed.  Thus:
<p><pre>
  (setq foo (quote (this is a string))))
  show macro foo
  foo = '(this is a string)
  (foo)
  this is a string
</pre>
<p>

Note the different results for "<tt>show</tt> <tt>macro</tt> <tt>foo</tt>" and
"<tt>(foo)</tt>".  The former shows the internal definition; the latter
evaluates the variable, which removes the quoting.  And perhaps more
important, note that if the apostrophe and surrounding parentheses were not
stored as part of the definition, <tt>(foo)</tt> would try to execute "this is
a string" as a command.

<p>
Given the assignment above, the following work as expected:
<p><pre>
  (len foo)                                  <i>Result: 16</i>
  (rev foo)                                  <i>Result: gnirts a si siht</i>
  (rev (cap foo))                            <i>Result: GNIRTS A SI SIHT</i>
  (sub (rev (cap foo)) 5 8)                  <i>Result: TS A SI S</i>
</pre>
<p>
Note that, unlike built-in S-Expression operators that return numbers or truth
values, these operators return strings.  If you want to assign their return
values to other variables, you can do so:
<p><pre>
  (setq bar (rev (cap foo)))                 <i>Result: GNIRTS A SI SIHT</i>
</pre>
<p>
But now the S-Expression processor doesn't know the value of "bar" is supposed
to be a string, rather than a macro to execute.  For this you need one final
special operator, STRING.  The STRING operator takes an S-Expression as an
operand, evaluates it, and then returns its value enclosed in <tt>'()</tt>, so
you can use the value as a string is subsequent S-Expressions.  Use STRING for
referencing macros that return strings:
<p><pre>
  (setq bar (string (rev (cap foo))))        <i>Result: '(GNIRTS A SI SIHT)</i>
</pre>
<p>
STRING is like QUOTE, except that it evaluates its operand before applying
the quoting, rather than taking the operand literally.
<p>
To reference backslash variables or functions that return string values,
you must use the regular quoting mechanisms:
<p><pre>
  (setq time '(\v(time)))
  (setq date '(\v(date)))
  assign \%r this is a string
  (setq s1 '(\%r))
</pre>
<p>
That's because backslash items are evaluated BEFORE the S-Expression parser
ever sees them, and the values of <tt>\v(time)</tt> and so on are not valid
S-Expressions, so STRING won't like them.
<p>
Finally a brief word on the touchy topic of quoting.  Suppose you want to
include (say) literal parentheses in a string that will later be processed by
the S-Expression reader (or <tt>\fsplit()</tt> or <tt>\fword()</tt>).
Normally, you can't do this because parentheses are meaningful in these
contexts.  To defeat the normal parsing rules, you can quote the parentheses
with backslash.  However, due to the many levels of string processing
involved, a surprisingly large amount of backslashes might be required, for
example:
<p><pre>
  (setq s '(a b (c d) \\\\\\\\\\\\\\\\(e f (g h) x\\\\\\\\\\\\\\\\) j k))
</pre>
<p>
This is nearly impossible to explain(*).  Instead, just remember two points:
<p>
<ul>
<li>In situations like this, it's better to use DEFINE to create the string,
rather than SETQ.  The example above requires only double backslashes
when DEFINE is used:
<p><pre>
  define s '(a b (c d) \\(e f (g h) x\\j k))
</pre>
<p>
<li>The level of quoting depends on how many levels of evaluation the string
must pass through, which is not always obvious.  However, the number of
backslashes required in any given situation is always a power of 2.  So
if 1 doesn't work, try 2; if 2 doesn't work, try 4; if 4 doesn't work,
try 8, 16, 32, and so on.
</ul>
<p>
Considerations like this apply in any scripting language (shell, Tcl, Perl,
Python, etc).  The situation is known as "Quoting Hell".
<p>
(*) If you really want an explanation, here it is:
<p>
<ul>
<li>Every SEXP has its backslash items evaluated in a single pass at top
level before being passed to the SEXP reader, so <tt>\%1</tt>,
<tt>\v(ftime)</tt>, etc, can 
be evaluated up front, freeing the SEXP reader of having to know about
such things, which in turn makes it much more efficient.  Therefore one
level of quoting is lost right away, and therefore you must double each
backslash that is to be used as a quote.
<p>
<li>When the SEXP reader sees '<tt>\</tt>', it treats it as a quote; discards
it and keeps the next character.  Thus '<tt>\\</tt>' becomes '<tt>\</tt>'.
This would be the end of it, except that:
<p>
<li>The SEXP reader must call itself recursively on its operands, so we must
double any quotes in the operands: <tt>2^2 = 4</tt>.
<p>
<li>If the result is to be passed as an argument to a macro, the backslashes
must again be doubled, because the macro processor evaluates the arguments
before sending them to the macro: <tt>2^3 = 8</tt>.
<p>
<li>If the macro itself is to see the quotes, rather than just the result of
the quoting, the quotes must be doubled again: <tt>2^4 = 16</tt>.
</ul>
<p>
Moral: To create string constants in which grouping characters must be quoted,
use DEFINE rather than SETQ.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.9">9.9. Examples</a></h3>

<h4><a name="x9.9.1">9.9.1. Statistics</a></h4>

The following program computes statistics -- means, maxima, mimima, variance,
standard deviation, and correlation -- from data stored in parallel arrays,
<tt>\&#38;x[]</tt> and <tt>\&#38;y[]</tt>, which can contain any mixture of
integer and floating-point numbers: positive, negative, or zero.  Array setup
and validation are not shown.  Except for the traditional FOR loop and
printing the results at the end, the entire computation is done with
S-Expressions:

<p><pre>
; Initialize sums, maxima, minima, and number of elements

  (setq xsum 0 ysum 0 xsum2 0 ysum2 0 xysum 0)
  (setq xmin (setq xmax \&#38;x[1]) ymin (setq ymax \&#38;y[1]))
  (setq n \fdim(&#38;x))

; Loop through elements and accumulate sums, maxima, and minima

  for i 1 n 1 {
      (setq x \&#38;x[i] y \&#38;y[i])                    ; Notational convenience
      (setq xmax (max xmax x) ymax (max ymax y))  ; X and Y maxima
      (setq xmin (min xmin x) ymin (min ymin y))  ; X and Y minima
      (++ xsum x ysum y)                          ; X and Y sums
      (++ xsum2 (^ x 2) ysum2 (^ y 2))            ; Sum of X and Y squares
      (++ xysum (* x y))                          ; Sum of XY products
  }

; Calculate results

  (setq xmean (/ xsum n) ymean (/ ysum n))        ; Mean X and Y
  (setq xss (- xsum2 (/ (^ xsum 2) n)))           ; Intermediate values
  (setq yss (- ysum2 (/ (^ ysum 2) n)))
  (setq xyss (- xysum (/ (* xsum ysum) n)))
  (setq xvar (/ xss n) yvar (/ yss n))            ; X and Y variance
  (setq sdx (sqrt xvar) sdy (sqrt yvar))          ; Std deviation in X and Y
  (setq tmp (* xss yss))
  (setq cc (if tmp (/ xyss (sqrt tmp)) 1.0))      ; Correlation coefficient
  show macro xmean ymean xvar yvar sdx sdy cc     ; Print the results
</pre>
<p>
The final "if tmp" check accounts for the possibility that both arrays contain
all 0's.  Results can also be printed with "<tt>echo CC = \m(cc)</tt>", or any
other desired way.  Interestingly, if we had not needed the sum of the squares
and products, we could have obtained the sums, maxima, and minima of the X's
and Y's without a loop like this:
<p><pre>
  (setq xsum (+ \fjoin(&#38;x)) ysum (+ \fjoin(&#38;y))
  (setq xmax (max \fjoin(&#38;x)) ymax (max \fjoin(&#38;y))
  (setq xmin (min \fjoin(&#38;x)) ymin (min \fjoin(&#38;y))
</pre>
<p>
Any Kermit function that returns numbers or lists of numbers can be included
in an S-Expression as an operand.

<p>
<hr>
<h4><a name="x9.9.2">9.9.2. Practical Fibonacci Series</a></h4>

The recursive Fibonacci example given previously is simple and elegent, but
not very useful since it causes memory occupation to grow each time it calls
itself, until eventually both physical memory and disk swap space are filled
and the program crashes.  Even for small arguments, like 17, execution time
can be prohibitive:
<p><pre>
  (setq t1 \v(ftime))
  (setq result (fibonacci 17))
  (setq t2 (- \v(ftime) t1))
  echo FIBONACCI(17) = \m(result): TIME = \ffpround(t2,3)
</pre>
<p>
prints (on a certain rather slow computer):
<p><pre>
  FIBONACCI(17) = 987: TIME = 27.544
</pre>
<p>
Any recursive function can be recoded iteratively.  The result is not as
pretty, but execution is far less expensive:
<p><pre>
  define FIBONACCI {
      local i n r s
      (setq n \%1 r 1 s 0)
      if &#60; n 3 return \fsexp(-- n)
      for i 3 n 1 { (setq tmp r r (+ r s) s tmp) }
      (r)
  }
</pre>
<p>
Here's the result on the same computer for the same argument of 17:
<p><pre>
  FIBONACCI(17) = 987: TIME = 0.125
</pre>
<p>
(220 times faster.)  Execution time increases proportionally to the size of
the argument in the iterative case, whereas in the recursive case it goes up
geometrically, quickly reaching infinity.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.10">9.10. Differences from Algebraic Notation</a></h3>

In C-Kermit:
<p>
<ul>
<li>Algebraic notation uses infix operators and normal rules of operator
precedence, with parentheses used to force exceptions to the rules; many
operations can be included in an expression.  S-Expressions use prefix
operators with no intrinsic precedence; each operation is enclosed in
parentheses, and the arrangement of parentheses determines precedence.
<p>
<li>Algebraic infix operators require two operands; S-Expression prefix
operators can accept a variable number of operands.
<p>
<li>You can use algebraic notation anywhere that C-Kermit accepts a number,
e.g. "<tt>echo</tt> <tt>\&#38;a[((1+1)*2-1]</tt>", but you can use
S-Expressions only as top-level commands.  You can, however, use either
algebraic or S-Expressions anywhere at all by enclosing them in
<tt>\fevaluate()</tt> or <tt>\fsexpression()</tt>, respectively.
<p>
<li>You can use any mixture of integer and floating-point numbers in
S-Expressions, but only integers are permitted in algebraic expressions.
Outside of S-Expressions, floating point arithmetic is supported only
by <tt>\ffp...()</tt> function calls.
<p>
<li>Operators and operands in S-Expressions must be separated by spaces,
e.g. "<tt>(+ a b)</tt>".  Spaces are not required in algebraic expressions:
"<tt>((a+b)*c)</tt>".
<p>
<li>When assigning values to backslash variables (such as <tt>\%x</tt> or
<tt>\&#38;a[2]</tt>) using SETQ or LET, you must double the backslash.
</ul>

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents"><b>Contents</b></a> ] 
[ <a href="http://www.columbia.edu/kermit/ckermit.html"><b>C-Kermit Home</b></a> ]
[ <a href="http://www.columbia.edu/kermit/index.html"><b>Kermit Home</b></a> ]
<hr>
<h3><a name="x9.11">9.11. Differences from Lisp</a></h3>

<ul>
<li>Kermit has a lot of built-in operators not found in Lisp: <tt>++</tt>,
<tt>^</tt>, etc.
<p>
<li>Most dialects of real Lisp do not allow S-Expressions that don't start
with an operator, for example:
<p><pre>
  (a)
</pre>
<p>
This expression can cause an error in Lisp (even if "<tt>a</tt>" has a value),
but is acceptable in Kermit, where it returns the value of the variable
"<tt>a</tt>".  Similarly, <tt>(1)</tt> returns the value "1".
<p>
<li>In real Lisp, EVAL requires exactly one operand.  In Kermit, it can
have 0, 1, 2, or more operands.  It returns the value of the last operand
evaluated.
<p>
<li>Real Lisp SETQ and LET usually require an even number of operands.
Kermit allows an odd number, in which case the last (or only) variable
is undefined (i.e. deleted, destroyed).
<p>
<li>Kermit does not support ratios such as "7/8".  Some Lisp dialects accept
ratios as numbers, and generate ratios when told to divide two integers
whose quotient is not a whole number; e.g. in Common Lisp:
<p><pre>
  [13] USER(37): (/ (+ 1 2 3 4) 3)
  10/3
  [13] USER(38):
</pre>
<p>
<li>The result of <tt>(/ 10 3)</tt> is 3.333....  Some Lisp dialects truncate
the result to 3 since both operands are integers, some don't; some give the
result as a ratio.  C-Kermit always gives a floating point result when
there is a fractional part.  If you want an integer result, you can use
TRUNCATE, FLOOR, or CEILING, e.g. <tt>(truncate (/ 10 3))</tt>.
<p>
<li>There is currently no "bignum" support.  Large numbers can be used and
large results generated, but (as noted in <a href="#x9.2">Section 9.2</a>)
they are accurate only to the precision of the underlying machine.
<tt>\v(math_precision)</tt> gives the machine precision as a number of decimal
digits, e.g. 16.
<p>
<li>Scientific notation for floating-point numbers is not supported.  If the
magnitude of a number is greater than the precision of the underlying
hardware, the less-significant digits are shown but their values are
meaningless.  If it the number is too small to be represented
internally, it is shown as "<tt>0.0</tt>".
<p>
<li>Many Lisp features are omitted: List processing (CAR, CDR, etc),
DEFUN, Lisp-specific control structures, and so on.
</ul>
<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x10"><hr>10. FILE TRANSFER</a></h2>

New commands and switches:

<p>
<dl>
<dt><font color="red"><tt><b>SET TRANSFER REPORT</b>
<i>{</i> <b>OFF, ON</b> <i>}</i></tt></font><dt>

<dd><font color="red">Enables or disables the (new) one-line message printed
by Kermit after a remote-mode file transfer to indicate the source and
destination file, complete with path, to let you know where the file went.
</font>

<p>

<dt><tt><b>SEND /TYPE:</b><i>{</i><b>TEXT,BINARY</b><i>}</i></tt></dt>
<dd>Sends only files of the given type (see <a href="#x4">Section 4</a>).
<p>

<dt><tt><b>SEND /NOFOLLOWLINKS:</b></tt></dt>
<dd>(UNIX only) Skip over symbolic links rather than following them
(default).  This applies to wildcard and/or recursive SENDs; if a single
filename is given, and it happens to be a symbolic link, the file it points
to is sent.
<p>

<dt><tt><b>SEND /FOLLOWLINKS:</b></tt></dt>
<dd>(UNIX only) Follow (resolve) symbolic links.  Watch out for circular
links, endless loops, etc.

<p>



<dt><tt><b>SET SEND I-PACKETS</b> <i>{</i> <b>OFF, ON</b> <i>}</i></tt></dt>
<dd>When sending commands to a Kermit server, this tells whether command
packets should be preceded by an I (information) packet, which is used
to synchronize parameters prior to executing the command.  Normally ON.
The only reason to set this OFF is for communicating with buggy Kermit
servers that misbehave when an I packet is sent to them.  There is also
a SET RECEIVE I-PACKETS command, but presently it has no effect.
<p>
<dt><tt><b>SET TRANSFER MESSAGE</b> <i>[ text ]</i></tt></dt>
<dd>Sets an initial message to be shown in the Last Message field of the
fullscreen file-transfer display.
<p>
<dt><tt><b>SET TRANSFER TRANSLATION</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>
<dd>Inhibits or re-enables text-file transfer character-set translation
globally.
<p>
<dt><tt><i>{</i> <b>SEND, MSEND, GET, RECEIVE</b> <i>}</i><b> /TRANSPARENT</b></tt></dt>
<dd>Inhibits character-set translation for this transfer only.
<p>
<dt><tt><i>{</i> <b>GET, RECEIVE</b> <i>}</i><b> /PIPES:</b><i>{</i><b>ON,OFF</b><i>}</i></tt></dt>
<dd>Overrides global TRANSFER PIPES setting for this transfer only; ON
allows incoming files with names like "<tt>!tar xf -</tt>" to be opened as
pipelines rather than regular files.
</dl>
<p>

The following new "hot keys" are available when Kermit's file-transfer
display is visible:

<p>

<tt>&nbsp;&nbsp;D:&nbsp;</tt>Turn on debugging, open "debug.log" if not already open.<br>
<tt>&nbsp;&nbsp;d:&nbsp;</tt>Turn off debugging but leave log open (if it was open).<br>
<tt>&nbsp;&nbsp;T:&nbsp;</tt>Turn on debug-log timestamps.<br>
<tt>&nbsp;&nbsp;t:&nbsp;</tt>Turn off debug-log timestamps.

<p>

Other improvements:
<ul>
<li>SET FILE DOWNLOAD-DIRECTORY now works for external protocols (e.g. sz/rz)
too.
<li>Improved automatic per-file text/binary switching, described in
<a href="#x4">Section 4</a>.
<li>When sending a file group (e.g. "<tt>send</tt> <tt>*.*</tt>"), failure to
open a file is no longer fatal; now C-Kermit simply goes ahead to the next
file. 
<li>Transaction log entries are now made for external protocols too.
</ul>
<p>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x11"><hr>11. MODEMS AND DIALING</a></h2>

In C-Kermit 8.0, the default modem type for dialing has changed from
NONE (= DIRECT, meaning no modem) to GENERIC.  This change should have no
impact on direct connections.  For dialing, it means that, unless you 
SET MODEM TYPE to a specific type, such as USROBOTICS or CONEXANT, Kermit
assumes:
<p>
<ol>
<li>The modem uses the Hayes AT command set.
<li>The modem supports error correction, data compression, and 
hardware flow control and is already configured to use them.
</ol>

<p>

In fact, Kermit assumes the modem is completely configured, and therefore
does not send it an initialization string or any configuration commands.
Instead, it sends only the simplest and most portable commands:

<p>
<tt>&nbsp;&nbsp;ATQ0V1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>Give dial result codes.<br>
<tt>&nbsp;&nbsp;ATDT<i>number</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>Dial the number.
<p>
(or ATD or ATDP, as appropriate).

<p>

The new defaults work for direct connections and for most modern modems on
most platforms, and they work much faster than "full-treatment" dialing.  If
the new defaults don't work for you, or if you need to perform explicit modem
configuations or interactions, then set a specific modem type and use the SET
MODEM and SET DIAL commands as documented in <cite>Using C-Kermit</cite>.

<p>
<blockquote>
<i>WARNING:</i> Don't use the generic modem on hosts that do not support
RTS/CTS flow control.  If Xon/Xoff is in use on the serial port, you'll need
to select a particular modem type so Kermit knows what command to give it
to enable Xon/Xoff flow control between itself and your serial port.
</blockquote>

<p>
The following new modem types were added in C-Kermit 8.0:
<p>
<tt>&nbsp;&nbsp;lucent:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>Lucent Venus chipset<br>
<tt>&nbsp;&nbsp;pctel:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>PCTel V.90 chipset<br>
<tt>&nbsp;&nbsp;conexant:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>Conexant (ex-Rockwell) modem family<br>
<tt>&nbsp;&nbsp;zoom-v32bis:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>New name for "Zoom"<br>
<tt>&nbsp;&nbsp;zoom-v34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>Zoom V.34<br>
<tt>&nbsp;&nbsp;zoom-v90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>Zoom V.90 56K<br>
<tt>&nbsp;&nbsp;zoom-v92:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>Zoom V.92 with V.44 data compression<br>
<tt>&nbsp;&nbsp;zoltrix-v34:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>New name for "zoltrix"<br>
<tt>&nbsp;&nbsp;zoltrix-hsp-v90:&nbsp;</tt>Synonym for PCTel<br>
<tt>&nbsp;&nbsp;zoltrix-hcf-v90:&nbsp;</tt>Synonym for ITU-T-V250<br>
<tt>&nbsp;&nbsp;smartlink-v90:&nbsp;&nbsp;&nbsp;</tt>Synonym for usrobotics (same chipset)<br>
<tt>&nbsp;&nbsp;acer-v90:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>Synonym for Rockwell-v90<br>
<p>
New DIAL-related variables:
<p>
<tt>&nbsp;&nbsp;\v(dm_hf)</tt>:&nbsp;&nbsp;Dial modifier: Wait for Hook-Flash.<br>
<tt>&nbsp;&nbsp;\v(dm_wb)</tt>:&nbsp;&nbsp;Dial modifier: Wait for Bong.
<p>

Finally, if dialing fails, Kermit now prints a context-sensitive hint
suggesting possible reasons and remedies.

<p>

<a name="callerid"></a>
<i>Added in C-Kermit <b>8.0.201</b>:</i> &nbsp; Rudimentary support for
<b>Caller ID</b>, for use with the ANSWER command.  If the modem reports
Caller ID information, Kermit stores it in variables that you can access after
the call is answered:

<p>
<pre>
  \v(callid_date)   The date of the call
  \v(callid_time)   The time of the call
  \v(callid_name)   The name of the caller
  \v(callid_nmbr)   The telephone number of the caller
  \v(callid_mesg)   A message
</pre>
<p>

The format of these items depends on the originating and answering phone
companies and the modems and their configuration.

<p>

Not very many modems support Caller ID, and those that do (a) tend to have
it disabled by default, and (b) use different commands to enable it.  A
quick survey shows of some current models shows:

<p>
<pre>
   - USR V.90:      No
   - ITU-T V.250:   No
   - Lucent Venus:  No
   - Diamond Supra: #CID=1
   - Rockwell 56K:  #CID=1
   - PCTEL:         #CID=1
   - Zoltrix:       +VCID=1
   - Conexant:      +VCID=1
</pre>
<p>

To use Kermit's Caller ID feature, you have to set the modem to wait for
at least two rings before answering, and you have to give the command to
enable Caller ID; for example (after choosing a modem with SET MODEM TYPE):

<p>
<pre>
  set modem command autoanswer on ATS0=2#CID=1\{13}
  set modem command autoanswer on ATS0=2+VCID=1\{13}
</pre>
<p>

These commands can be undone with:

<p>
<pre>
  set modem command autoanswer on ATS0=1#CID=0\{13}
  set modem command autoanswer on ATS0=1+VCID=0\{13}
</pre>
<p>

Kermit presently has no built-in knowledge of the Caller ID capabilities
or commands of the modems in its database.

<P>

Since the variables can be accessed only after the call is answered, the
only way to refuse a call is to answer it, inspect the variables, and then
hang it up if desired.

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x12"><hr>12. TERMINAL CONNECTION</a></h2>

Now that 7-bit connections are no longer the norm, the default terminal
bytesize (also called "data size" or "word size") in C-Kermit 8.0 is 8 bits,
rather than 7 bits as it was in C-Kermit 7.0 and earlier:
<p>
<dl>
<dt><a name="setescape"><tt><b>SET ESCAPE</b> <i>character</i></tt></a></dt>

<dd>This command, which specifies your CONNECT-mode escape character, allows
you to specify any ASCII control character in a variety of formats.  C-Kermit
8.0.201 now also lets you specify any 8-bit value, 128-255, as the escape
character.  In the SET ESCAPE command, you can type the 8-bit character
literally or you can enter its numeric code.  Here are examples that you
can enter from a terminal or console that uses the ISO Latin-1 character set:

<p>
<pre>
  C-Kermit&gt; <u>set escape &#195;</u>
  C-Kermit&gt; <u>set escape 195</u>
  C-Kermit&gt; <u>show escape</u>
   Escape character: Code 195 (&#195;): enabled
  C-Kermit&gt;
</pre>
<p>

Both of these commands set the escape character value to 195 (decimal), which
happens to be uppercase letter A with Tilde in Latin-1.  SHOW ESCAPE and
SHOW TERMINAL show the value, as does the CONNECT message.

<p>

<dt><tt><b>SET TERMINAL AUTODOWNLOAD ERROR</b>
<i>{</i> <b>STOP, CONTINUE</b> <i>}</i></tt></dt>

<dd>When Kermit has a terminal connection to another computer, and a file
transfer is initiated automatically because a Kermit packet was received in
CONNECT mode (i.e. in the terminal screen), this command tells what Kermit
should do if the transfer fails.  The default is to STOP, which leaves Kermit
in command mode with its file-transfer display showing, so you can see that
the transfer failed and why.  If you SET TERMINAL AUTODOWNLOAD ERROR CONTINUE,
this causes Kermit to return automatically to its terminal screen (i.e. resume
its CONNECT session) as if the transfer had succeeded; this can be desirable
if the entire session is under control of a host-based script.

<p>

<dt><tt><b>SET TERMINAL BYTESIZE</b> <i>{</i> <b>7, 8</b> <i>}</i></tt></dt>
<dd>The byte size to use during CONNECT and INPUT command execution, which
can be more restrictive than the bytesize implied by the current PARITY
setting, but not less restrictive.  In C-Kermit 7.0 and earlier,
the terminal bytesize was 7 by default to protect against the likelihood
that parity was in use on the connection without the user's knowledge.  When
the terminal bytesize is 8 (as it is in C-Kermit 8.0 and later), the user
will see garbage in this (increasingly unlikely) situation.  Note that 8 data
bits are required for most character sets other than ASCII: Latin-1, UTF-8,
and so on.
</dl>
<p>
A new command has been added to produce timestamped session logs:
<p>
<dl>
<dt><tt><b>SET TERMINAL SESSION-LOG TIMESTAMPED-TEXT</b></tt></dt>
<dd>Records the terminal session in text mode (like 
SET TERMINAL SESSION-LOG TEXT) but adds a timestamp at the beginning of
each line.  The timestamp format is
<i>hh</i><tt>:</tt><i>mm</i><tt>:</tt><i>ss</i><tt>.</tt><i>nnn</i>,
and indicates the time at which the first character of the line appeared.
</dl>
<p>

In most UNIX versions (those built with the <tt>select()</tt>-capable CONNECT
module -- pretty much all the ones that have or could have TELNET included),
an idle timeout feature has been added:

<p>
<dl>
<dt><tt><b>SET TERMINAL IDLE-TIMEOUT</b> <i>number</i></tt></dt>
<dd>If the number is not 0, then Kermit is to take an action when the given
amount of time passes with no activity during CONNECT mode.  If the number is
positive it is the maximum number of idle seconds; if number is negative it
represents milliseconds (thousandths of seconds).  If 0 is given as the
number, there are no idle timeouts.  Synonym: <b><tt>SET TERMINAL
IDLE-LIMIT</tt></b>.
<p>
<dt><tt><b>SET TERMINAL IDLE-ACTION</b>
<i>{</i> <b>RETURN, HANGUP, EXIT, OUTPUT</b> <i>[ string ] }</i></tt></dt>
<dd>The action to be taken upon an idle timeout in CONNECT mode.
RETURN to the prompt, HANGUP the connection, EXIT from Kermit, or OUTPUT
the given string (if no string is given, a NUL (ASCII 0) character is sent).
<p>
<dt><tt><b>SET TERMINAL IDLE-ACTION</b>
<i>{</i> <b>TELNET-NOP, TELNET-AYT</b><i> }</i></tt></dt>
<dd>Actions that can be selected on Telnet connections only, that might be
useful if idle limits are enforced by the Telnet server or in the TCP/IP
protocol: TELNET-NOP sends a "NO Operation" (do-nothing) command, which causes
no response from the server; TELNET-AYT sends an "Are You There" message to
the server, which should make the server send back a message.  Neither of
these actions interferes with your remote session.

</dl>
<p>

SET TERMINAL IDLE-ACTION is useful for connections to hosts or services
that automatically log you out after a certain amount of idle time, e.g.:
<p>
<pre>
  set term idle-timeout 300
  set term idle-action output \32
</pre>
<p>
sends a space (as if you had pressed the space bar) every 300 seconds (five
minutes) while there is no activity (32 is the ASCII code for space).

<p>
When C-Kermit returns from CONNECT to command mode, the reason for the
transition is given in a new variable, <tt>\v(cx_status)</tt>:
<p>
<tt>&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;</tt>No CONNECT command given yet.<br>
<tt>&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;</tt>User escaped back manually.<br>
<tt>&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;</tt>A trigger string was encountered.<br>
<tt>&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;</tt>IKSD entered server mode.<br>
<tt>&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;</tt>Application Program Command received from host.<br>
<tt>&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;</tt>Idle timeout.<br>
<tt>&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;</tt>Telnet protocol error.<br>
<tt>&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;</tt>Keystroke macro.<br>
<tt>&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;</tt>Time limit exceeded.<br>
<tt>&nbsp;100&nbsp;&nbsp;</tt>Internal error.<br>
<tt>&nbsp;101&nbsp;&nbsp;</tt>Carrier required by not detected.<br>
<tt>&nbsp;102&nbsp;&nbsp;</tt>I/O error on connection.<br>
<tt>&nbsp;103&nbsp;&nbsp;</tt>Disconnected by host.<br>
<tt>&nbsp;104&nbsp;&nbsp;</tt>Disconnected by user.<br>
<tt>&nbsp;105&nbsp;&nbsp;</tt>Session limit exceeded.<br>
<tt>&nbsp;106&nbsp;&nbsp;</tt>Rejected due to Telnet policy.<br>
<tt>&nbsp;107&nbsp;&nbsp;</tt>Received kill signal.
<p>
Values 100 and above indicate there is no connection.


<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x13"><hr>13. CHARACTER SETS</a></h2>

See the section on <a href="#x4">file scanning</a> above, and
the section on character-set conversion in
<a href="#x3.7">FTP</a>.  Also:
<p>
<ul>
<li>True support for CP1252 (rather than treating it as Latin-1).
<li>Proper handling of C1 values when converting ISO 8-bit text to UTF-8.
<li>TYPE /CHARACTER-SET: /TRANSLATE-TO: allows specific translations.
<li>The TRANSLATE command now works on multiple files.
<li>K_CHARSET environment variable to set the file character-set.
<li>SET TRANSFER TRANSLATION OFF.
<li>FTP client character-set translation (<a href="#x3.7">Section 3.7</a>).
</ul>
<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x14"><hr>14. DIALOUT FROM TELNET TERMINAL SERVERS</a></h2>

For years, C-Kermit has supported dialing out from Telnet modem servers (also
called reverse terminal servers or access servers), but until now there was no
way for Kermit to control the communication parameters (speed, parity, etc) on
the serial port of the terminal server; it had to use whatever was there.

<p>

But now, if you make a connection to a server that supports the Telnet Com
Port Control Option, 
<a href="ftp://ftp.isi.edu/in-notes/rfc2217.txt">RFC 2217</a>, you have the
same degree of control as you would have over a serial port on the computer
where Kermit is running: SET SPEED, SET FLOW, SET PARITY, SET STOP-BITS, SHOW
COMM, WAIT, SET CARRIER-WATCH, the modem-signal variables, sending Break, and
so on, apply to the connection between the terminal server and the modem.

<p>

For example, using a Cisco Access Server 2509, where specifying a TCP port in
the 6000's selects a serial port that can be used for dialing out:
<p><pre>
  set host xxx 6001      ; xxx is the IP hostname or address of the server
  (log in if necessary)  ; With a script or by hand
  set modem type usr     ; Tell Kermit what kind of modem it has
  set speed 57600        ; This affects the server's port
  set flow rts/cts       ; Ditto
  dial 7654321
</pre>
<p>

The modem server might or might not require a login sequence.  It might also
allow for automatic authentication, e.g. via Kerberos tickets.  NOTE: If the
modem server requires a login sequence, then REDIAL might not work as expected.

<p>

When you have a Telnet Com Port connection, your SET SPEED and SET FLOW
options change automatically to reflect the capabilities of the server, rather
than those of your local computer.

<p>

See the configuration manual for your server for additional information.  For
example, how to set up the server to drop the Telnet connection automatically
when the telephone call is hung up (e.g. "autohangup" on Cisco models).

<p>

For a Linux-based Telnet Com-Port server, click the Srdird link:

<p>

[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="ftp://kermit.columbia.edu/kermit/sredird/">Sredird</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x15"><hr>15. COPING WITH BROKEN KERMIT PARTNERS</a></h2>

There are lots of faulty Kermit protocol implementations out there, found
mainly in 3rd-party products ranging from communications software packages
to file-transfer functions imbedded within devices.  This topic is covered
<a href="ckermi70.html#x4.22">HERE</a> for C-Kermit 7.0, but C-Kermit 8.0
adds some additional tricks.
<p>
<dl>
<dt><tt><b>SET ATTRIBUTE RECORD-FORMAT</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>
<dd>Allows control of the Kermit's Record-Format attribute.  Set this to
OFF in case incoming file are refused due to unknown or invalid record formats
if you want to accept the file anyway.
<p>
<dt><tt><b>SET SEND I-PACKETS</b> <i>{</i> <b>ON, OFF</b> <i>}</i></tt></dt>
<dd>A Kermit server is supposed to accept I-packets; this is how the client
lets the server know its capabilities and preferences before sending a
command.  Apparently there is at least one Kermit server implementation that
does not accept I-packets, and does not properly respond with an Error packet
if it gets one.  To get around such situations in C-Kermit 8.0, you can use
SET SEND I-PACKETS OFF to inhibit the sending of I packets.  In this case, the
client must be able to adjust to the server's configuration, rather than the
other way around as we are used to.
<p>
<dt><tt><b>SET PROTOCOL KERMIT {} {} {}</b></tt></dt>
<dd>C-Kermit 6.0 and later automatically send "autoupload" and "autodownload"
commands when in local mode and you give a file transfer command.  For
example, if you tell kermit to "<tt>send oofa.txt</tt>", Kermit sends
"kermit -r" and a carriage return, in case you had forgotten to start Kermit
on the far end and told it to receive a file.  If a Kermit program had already
been started on the far end, it should harmlessly absorb this string.  However,
some Kermit programs violate the Kermit protocol definition and treat such
strings as Kermit packets even though they are not.  In such cases, give
this command to set the Kermit protocol autoupload and download strings to
nothing, which tells Kermit not to send them.  (This is not a new feature,
but it was not previously included in the "Coping" section of the
documentation.)
</dl>

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x16"><hr>16. NEW COMMAND-LINE OPTIONS</a></h2>

<tt>kermit</tt> <tt>-h</tt> Now prints a complete listing of its command-line
options, rather than an abbreviated list squeezed into a 24x80 space.

<p>

<tt>-dd</tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug, like <tt>-d</tt> but adds timestamps</br>
<tt>--version</tt>&nbsp;&nbsp;Shows C-Kermit version number.<br>
<tt>--noperms</tt>&nbsp;&nbsp;Equivalent to SET ATTRIBUTE PROTECTION OFF.
<p>
Kermit now accepts a selection of URLs (Universal Resource Locators) as its
first command-line argument.  These are:
<p>
<dl>
<dt><tt>telnet:<i>hostname</i></tt>
<dd>Makes a Telnet connection to the given host (IP hostname or address).
<p>
<dt><tt>ftp://<i>[user[:password]@]hostname[/path...]</i></tt>
<dd>Makes an FTP connection to the given host (IP hostname or address).
If a username is given, Kermit tries to log you in; if a password is given,
it is used; if not, you are prompted for one.  If no username is given,
an anonymous login is performed.  If a pathname is included, Kermit tries
to GET the given file.  See <a href="#x3.1.3">Section 3.1.3</a> for details.
<p>
<dt><tt>ftps://<i>[user[:password]@]hostname[/path...]</i></tt>
<dd>Makes a secure FTP connection over SSL.
<p>
<dt><tt>telnets://<i>[user[:password]@]hostname</i></tt>
<dd>Makes a secure Telnet connection over SSL.
<p>

<dt><tt>kermit://<i>[user[:password]@]hostname[/path...]</i></tt>
<dd>Makes a connection to an
<a href="http://www.columbia.edu/kermit/cuiksd.html">Internet Kermit
Server</a>.

<p>
<dt><tt>http://<i>[user[:password]@]hostname[/path...]</i></tt>
<dd>Makes a connection to Web server.
<p>
<dt><tt>https://<i>[user[:password]@]hostname[/path...]</i></tt>
<dd>Makes a connection to secure Web server.
</dl>
<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]

<h2><a name="x17"><hr>17. LOGS</a></h2>

In C-Kermit 8.0, we make an effort to keep passwords out of the debug log.
This can never be 100% effective, but it's better than before, when there
were no precautions at all.  Whenever Kermit knows it's prompting for,
parsing, or transmitting a password, it temporarily turns off logging and then
turns it back on afterwards.  This keeps the debug log password-free in most
common cases, but there can be no guarantees.

<p>

As noted elsewhere, the new "<tt>-dd</tt>" command-line option selects a
timestamped debug log (equivalent to "set debug timestamps on", "log debug
debug<tt>.</tt>log").
<p>
C-Kermit 8.0 also supports a new timestamped session log via
"set session-log timestamped-text", "log session".
<p>

There have been requests for other kinds of logs, for example a command log.
These might be added at some point.  One person wanted to be able to log
commands with timestamps, but only commands issued at the prompt, not commands
from files or macros, and also wanted a header line at the beginning showing
the date, user, and host.  This can be done as follows:

<p>
<pre>
  .filename := \v(home)commands.log  ; (for example)
  fopen /write \%c \m(filename)
  if success {
      fwrite /line \%c \v(date): User=\v(user) Host=\v(host)
      fclose \%c
      set debug timestamps on
      log debug {| grep "CMD(P)" >> \m(filename)} append
  }
</pre>

<p>
[ <a href="#top">Top</a> ]
[ <a href="#contents">Contents</a> ]
[ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit Home</a> ]
[ <a href="http://www.columbia.edu/kermit/index.html">Kermit Home</a> ]
<hr>
C-Kermit 8.0 Update Notes /
<a href="http://www.columbia.edu/kermit/index.html">The Kermit Project</a> /
Columbia University /
24 Oct 2002
</body></html>
