<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN//2.0"> 
<html><head></tt>
<title>CKERMIT70.HTM - C-Kermit 7.0 Update Notes</title>
</head>
<body bgcolor="#ffffff" text="#000000">
<a name="top"></a>
[ <a href="#contents">Contents</a> ] [ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ] [ <a href="index.html">Kermit Home</a> ]

<h1>Supplement to <cite>Using C-Kermit</cite>, Second Edition</h1>
<h2>For C-Kermit 7.0</h2>
<p><pre>
<i>As of C-Kermit version:</i>  <b>7.0.196</b>
<i>This file last updated:</i>  <b>8 February 2000</b>

<i>Authors:</i> Frank da Cruz and Christine M. Gianone
<i>Address:</i> The Kermit Project
         Columbia University
         612 West 115th Street
         New York NY 10025-7799
         USA
<i>Fax:</i>     +1 (212) 662-6442
<i>E-Mail:</i>  <a href="mailto:kermit-support@columbia.edu">kermit-support@columbia.edu</a>
Web:     <a href="http://www.columbia.edu/kermit/">http://www.columbia.edu/kermit/</a>
Or:      <a href="http://www.kermit-project.org/">http://www.kermit-project.org/</a>
Or:      <a href="http://www.columbia.nyc.ny.us/kermit/">http://www.columbia.nyc.ny.us/kermit/</a>
</pre><p>
<hr>
<h3>NOTICES</h3>

<dl>
<dt>This document:
<dd>Copyright &copy; 1997, 2000, Frank da Cruz and Christine M. Gianone.
All rights reserved.
<p>
<dt>Kermit 95:
<dd>Copyright &copy; 1995, 2000, Trustees of Columbia University in the City of
New York.  All rights reserved.
<p>
<dt>C-Kermit:
<dd>Copyright &copy; 1985, 2000,<br>
Trustees of Columbia University in the City of New York.
All rights reserved.  See the C-Kermit <a href="ftp://kermit.columbia.edu/kermit/f/COPYING.TXT">COPYING.TXT</a> file or the
copyright text in the
<a href="ftp://kermit.columbia.edu/kermit/f/ckcmai.c">ckcmai.c</a>
module for disclaimer and permissions.
</dl>
<p><dl>
<dt>When Kerberos(TM) and/or SRP(TM) (Secure Remote Password) and/or SSL
protocol are included:
<dd>Portions Copyright &copy; 1990, Massachusetts Institute of Technology.<br>
Portions Copyright &copy; 1991, 1993 Regents of the University of California.<br>
Portions Copyright &copy; 1991, 1992, 1993, 1994, 1995 by AT&T.<br>
Portions Copyright &copy; 1997, Stanford University.<br>
Portions Copyright &copy; 1995-1997,
Eric Young <tt>&#60;eay@cryptosoft.com&#62;</tt>.
</dl>
<p>
For the full text of the third-party copyright notices, see
<a href="#xv">Appendix V</a>.
<p>
<hr>
<h3>WHAT IS IN THIS FILE</h3>

This file lists changes made to C-Kermit since the second edition of the book
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>
was published and C-Kermit 6.0 was released in November 1996.
Use this file as a supplement to the second edition of <cite>Using
C-Kermit</cite> until
the third edition is published some time in 2000.  If the "most recent update"
shown above is long ago, contact Columbia University to see if there is a
newer release.

<p>

For further information, also see the
<a href="ftp://kermit.columbia.edu/kermit/f/ckcbwr.txt"><tt>CKCBWR.TXT</tt></a>
("C-Kermit beware") file for
hints, tips, tricks, restrictions, frequently asked questions, etc, plus the
system-specific "beware file", e.g. 
<a href="ftp://kermit.columbia.edu/kermit/f/ckubwr.txt"><tt>CKUBWR.TXT</tt></a>
for UNIX,
<a href="ftp://kermit.columbia.edu/kermit/f/ckvbwr.txt"><tt>CKVBWR.TXT</tt></a>
for VMS,
etc, and also any system-specific update files such as
<tt>KERMIT95.HTM</tt>
for Kermit 95
(in the <tt>DOCS\MANUAL\</tt> subdirectory of your K95 directory).

<p><blockquote><i>

This Web-based copy of the C-Kermit 7.0 update notes supersedes the
plain-text</i> <tt>CKERMIT2.TXT</tt> <i>file.  All changes after 19 January
2000 appear only here in the Web version.  If you need an up-to-date
plain-text copy, use your Web browser to save this page as plain text.

</i>
</blockquote>
<p>
<hr>
<h3>ABOUT FILENAMES</h3>

In this document, filenames are generally shown in uppercase, but on file
systems with case-sensitive names such as UNIX, OS-9, and AOS/VS, lowercase
names are used:
<a href="ftp://kermit.columbia.edu/kermit/f/ckubwr.txt"><tt>ckubwr.txt</tt></a>,
<a href="ftp://kermit.columbia.edu/kermit/f/ckermit70.txt"><tt>ckermit70.txt</tt></a>,
etc.
<p>
<hr>
<h3>ADDITIONAL FILES</h3>
<p>
Several other files accompany this new Kermit release:
<p><dl>
<dt><tt>SECURITY.TXT</tt>
<dd>Discussion of Kermit's new authentication and encryption features:
<ul><li><a href="ftp://kermit.columbia.edu/kermit/f/security.txt">Plain-text version</a>
<li><a href="security.html">HTML (hypertext) version</a>
</ul>
<p>

<dt><tt>IKSD.TXT</tt>
<dd>How to install and manage an Internet Kermit Service Daemon.
<ul><li><a href="ftp://kermit.columbia.edu/kermit/f/iksd.txt">Plain-text version</a>
<li><a href="iksd.html">HTML (hypertext) version</a>
</ul>
Also see <a href="cuiksd.html">cuiksd.htm</a> for instructions for use.

<p>
<dt><tt>TELNET.TXT</tt>
<dd>A thorough presentation of Kermit's new advanced Telnet features and
controls.
<ul><li><a href="ftp://kermit.columbia.edu/kermit/f/telnet.txt">Plain-text version</a>
<li><a href="telnet.html">HTML (hypertext) version</a>
</ul>
</dl>
<p>
<hr>

<h3>THE NEW C-KERMIT LICENSE</h3>

The C-Kermit license was rewritten for version 7.0 to grant automatic
permission to packagers of free operating-system distributions to include
C-Kermit 7.0.  Examples include Linux (GNU/Linux), FreeBSD, NetBSD, etc.
The new license is in the
<a href="ftp://kermit.columbia.edu/kermit/f/COPYING.TXT">COPYING.TXT</a>
file, and is also displayed by C-Kermit
itself when you give the VERSION or COPYRIGHT command.  The new C-Kermit
license does not apply to
<a href="http://www.columbia.edu/kermit/k95.html">Kermit 95</a>.
<p>
<hr>

<h3>ACKNOWLEDGMENTS</h3>

Thanks to Jeff Altman, who joined the Kermit Project in 1995, for much of what
you see in C-Kermit 7.0, especially in the networking and security areas, and
his key role in designing and implementing the Internet Kermit Service Daemon.
And special thanks to Lucas Hart for lots of help with the VMS version; to
Peter Eichhorn for continuous testing on the full range of HP-UX versions and
for a consolidated set of HP-UX makefile targets; and to
Colin Allen,
Mark Allen,
Roger Allen,
Ric Anderson,
William Bader,
Mitch Baker,
Mitchell Bass,
Nelson Beebe,
Gerry Belanger,
Jeff Bernsten,
Mark Berryman,
John Bigg,
Volker Borchert,
Jonathan Boswell,
Tim Boyer,
Frederick Bruckman,
Kenneth Cochran,
Jared Crapo,
Bill Delaney,
Igor Sobrado Delgado,
Clarence Dold,
Joe Doupnik,
John Dunlap,
Max Evarts,
Patrick French,
Carl Friedberg,
Carl Friend,
Hirofumi Fujii,
Andrew Gabriel,
Gabe Garza,
Boyd Gerber,
David Gerber,
George Gilmer,
Hunter Goatley,
DJ Hagberg,
Kevin Handy,
Andy Harper,
Randolph Herber,
Sven Holstr&ouml;m,
Michal Jaegermann,
Graham Jenkins,
Dick Jones,
Terry Kennedy,
Robert D Keys,
Nick Kisseberth,
Igor Kovalenko,
David Lane,
Adam Laurie,
Jeff Liebermann,
Eric Lonvick,
Hoi Wan Louis,
Arthur Marsh,
Gregorie Martin,
Peter Mauzey,
Dragan Milicic,
Todd Miller,
Christian Mondrup,
Daniel Morato,
Dat Nguyen,
Herb Peyerl,
Jean-Pierre Radley,
Steve Rance,
Stephen Riehm,
Nigel Roles,
Larry Rosenman,
Jay S Rouman,
David Sanderson,
John Santos,
Michael Schmitz,
Steven Schultz,
Bob Shair,
Richard Shuford,
Fred Smith,
Michael Sokolov,
Jim Spath,
Peter Szell,
Ted T'so,
Brian Tillman,
Linus Torvalds,
Patrick Volkerding,
Martin Vorl&auml;nder,
Steve Walton,
Ken Weaverling,
John Weekley,
Martin Whitaker,
Jim Whitby,
Matt Willman,
Joellen Windsor,
Farrell Woods,
and many others for
binaries, hosting, reviews, suggestions, advice, bug reports, and all the rest
over the 3+ year C-Kermit 7.0 development cycle.  Thanks to Russ Nelson and
the board of the Open Software Initiative
(<a href="http://www.opensource.org">http://www.opensource.org</a>) for their
cooperation in developing the new C-Kermit license and to the proprietors of
those free UNIX distributions that have incorporated C-Kermit 7.0 for their
cooperation and support, especially FreeBSD's J&ouml;rg Wunsch.

<p>
<hr>

<h3>NOTE TO KERMIT 95 USERS</h3>

Kermit 95 and C-Kermit share the same command and scripting language,
the same Kermit file-transfer protocol implementation, and much else
besides.

<p>

Like the book
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>,
this file concentrates on the aspects of
C-Kermit that are common to all versions: UNIX, VMS, Windows, OS/2, VOS,
AOS/VS, etc.  Please refer to your Kermit 95 documentation for information
that is specific to Kermit 95.

<p>

C-Kermit 7.0 corresponds to Kermit 95 1.1.19.

<p>
<hr>

<h3>C-KERMIT VERSIONS AND VERSION NUMBERS</h3>

"C-Kermit" refers to all the many programs that are compiled in whole or in
part from common C-language source code, comprising:
<p>
<ul>
<li>A Kermit file transfer protocol module
<li>A command parser and script execution module
<li>A modem-dialing module
<li>A network support module
<li>A character-set translation module.
</ul>
<p>
and several others.  These "system-independent" modules are combined with
system-dependent modules for each platform to provide the required
input/output functions, and also in some cases overlaid with an alternative
user interface, such as Macintosh Kermit's point-and-click interface, and in
some cases also a terminal emulator, as Kermit 95.
<p>
The C-Kermit version number started as 1.0, <tt>...</tt> 3.0, 4.0, 4.1 and then
(because of confusion at the time with Berkeley UNIX 4.2), 4B, 4C, and so on,
with the specific edit number in parentheses, for example 4E(072) or 5A(188).
This scheme was used through 5A(191), but now we have gone back to the
traditional numbering scheme with decimal points:
<i>major</i><tt>.</tt><i>minor</i><tt>.</tt><i>edit</i>; for
example 7.0.196.  Internal version numbers (the <tt>\v(version)</tt> variable),
however, are compatible in C-Kermit 5A upwards.
<p>
Meanwhile, C-Kermit derivatives for some platforms (Windows, Macintosh) might
go through several releases while C-Kermit itself remains the same.  These
versions have their own platform-specific version numbers, such as Kermit 95
1.1.1, 1.1.2, and so on.
<p>
C-Kermit Version History:
<p><pre>
  1.0       1981-1982         Command-line only, 4.2 BSD UNIX only
  2.0       (*)               (who remembers...)
  3.0       May 1984          Command-line only, supports several platforms
  4.0-4.1   Feb-Apr 1985 (*)  First interactive and modular version
  4C(050)   May 1985
  4D(060)   April 1986
  4E(066)   August 1987       Long packets
  4E(068)   January 1988
  4E(072)   January 1989
  4F(095)   August 1989 (*)   Attribute packets
  5A(188)   November 1992     Scripting, TCP/IP, sliding windows (1)
  5A(189)   September 1993    Control-char unprefixing
  5A(190)   October 1994      Recovery
  5A(191)   April 1995        OS/2 only
  6.0.192   September 1996    Intelligent dialing, autodownload, lots more (2)
  6.1.193   1997-98 (*)       Development only
  6.1.194   June 1998         K95 only - switches, directory recursion, more
  7.0.195   August 1999       IKSD + more (CU only as K95 1.1.18-CU)
  7.0.196   1 January 2000    Unicode, lots more
</pre><p>
(*) Never formally released (4.0 was a total rewrite)<br>
(1) <cite>Using C-Kermit</cite>, 1st Edition<br>
(2) <cite>Using C-Kermit</cite>, 2nd Edition<br>
<p>
<hr>
<h2><a name="contents">CONTENTS</a></h2>
<pre>
 I.  <a href="#xi">C-KERMIT DOCUMENTATION</a>

 II. <a href="#xii">NEW FEATURES</a>

     (0) <a href="#x0">INCOMPATIBILITIES WITH PREVIOUS RELEASES</a>
     (1) <a href="#x1">PROGRAM AND FILE MANAGEMENT AND COMMANDS</a>
         1.0.  <a href="#x1.0">Bug fixes</a>
         1.1.  <a href="#x1.1">Command Continuation</a>
         1.2.  <a href="#x1.2">Editor Interface</a>
         1.3.  <a href="#x1.3">Web Browser and FTP Interface</a>
         1.4.  <a href="#x1.4">Command Editing</a>
         1.5.  <a href="#x1.5">Command Switches</a>
               1.5.1. <a href="#x1.5.1">General Switch Syntax</a>
               1.5.2. <a href="#x1.5.2">Order and Effect of Switches</a>
               1.5.3. <a href="#x1.5.3">Distinguishing Switches from Other Fields</a>
               1.5.4. <a href="#x1.5.4">Standard File Selection Switches</a>
               1.5.5. <a href="#x1.5.5">Setting Preferences for Different Commands</a>
         1.6.  <a href="#x1.6">Dates and Times</a>
         1.7.  <a href="#x1.7">Partial Completion of Keywords</a>
         1.8.  <a href="#x1.8">Command Recall</a>
         1.9.  <a href="#x1.9">EXIT Messages</a>
         1.10. <a href="#x1.10">Managing Keyboard Interruptions</a>
         1.11. <a href="#x1.11">Taming the Wild Backslash -- Part Deux</a>
	       1.11.1. <a href="#x1.11.1">Background</a>
	       1.11.2. <a href="#x1.11.2">Kermit's Quoting Rules</a>
               1.11.3. <a href="#x1.11.3">Passing DOS Filenames from Kermit to Shell Commands</a>
	       1.11.4. <a href="#x1.11.4">Using Variables to Hold DOS Filenames</a>
	       1.11.5. <a href="#x1.11.5">Passing DOS Filenames as Parameters to Macros</a>
	       1.11.6. <a href="#x1.11.6">Passing DOS File Names from Macro Parameters to the DOS Shell</a>
               1.11.7. <a href="#x1.11.7">Passing DOS Filenames to Kermit from the Shell</a>
         1.12. <a href="#x1.12">Debugging</a>
         1.13. <a href="#x1.13">Logs</a>
         1.14. <a href="#x1.14">Automatic File-Transfer Packet Recognition at the Command Prompt</a>
         1.15. <a href="#x1.15">The TYPE Command</a>
         1.16. <a href="#x1.16">The RESET Command</a>
         1.17. <a href="#x1.17">The COPY and RENAME Commands</a>
         1.18. <a href="#x1.18">The MANUAL Command</a>
         1.19. <a href="#x1.19">String and Filename Matching Patterns</a>
         1.20. <a href="#x1.20">Multiple Commands on One Line</a>
         1.21. <a href="#x1.21">What Do I Have?</a>
         1.22. <a href="#x1.22">Generalized File Input and Output</a>
	       1.22.1. <a href="#x1.22.1">Why Another I/O System?</a>
	       1.22.2. <a href="#x1.22.2">The FILE Command</a>
	       1.22.3. <a href="#x1.22.3">FILE Command Examples</a>
	       1.22.4. <a href="#x1.22.4">Channel Numbers</a>
	       1.22.5. <a href="#x1.22.5">FILE Command Error Codes</a>
	       1.22.6. <a href="#x1.22.6">File I/O Variables</a>
	       1.22.7. <a href="#x1.22.7">File I/O Functions</a>
	       1.22.8. <a href="#x1.22.8">File I/O Function Examples</a>
         1.23. <a href="#x1.23">The EXEC Command</a>
         1.24. <a href="#x1.24">Getting Keyword Lists with '?'</a>
     (2) <a href="x2">MAKING AND USING CONNECTIONS</a>
         2.0. <a href="#x2.0">SET LINE and SET HOST Command Switches</a>
	 2.1. <a href="#x2.1">Dialing</a>
	      2.1.1. <a href="#x2.1.1">The Dial Result Message</a>
	      2.1.2. <a href="#x2.1.2">Long-Distance Dialing Changes</a>
	      2.1.3. <a href="#x2.1.3">Forcing Long-Distance Dialing</a>
	      2.1.4. <a href="#x2.1.4">Exchange-Specific Dialing Decisions</a>
	      2.1.5. <a href="#x2.1.5">Cautions about Cheapest-First Dialing</a>
	      2.1.6. <a href="#x2.1.6">Blind Dialing (Dialing with No Dialtone)</a>
              2.1.7. <a href="#x2.1.7">Trimming the Dialing Dialog</a>
              2.1.8. <a href="#x2.1.8">Controlling the Dialing Speed</a>
              2.1.9. <a href="#x2.1.9">Pretesting Phone Number Conversions</a>
              2.1.10. <a href="#x2.1.10">Greater Control over Partial Dialing</a>
              2.1.11. <a href="#x2.1.11">New DIAL-related Variables and Functions</a>
              2.1.12. <a href="#x2.1.12">Increased Flexibility of PBX Dialing</a>
              2.1.13. <a href="#x2.1.13">The DIAL macro - Last-Minute Phone Number Conversions</a>
              2.1.14. <a href="#x2.1.14">Automatic Tone/Pulse Dialing Selection</a>
              2.1.15. <a href="#x2.1.15">Dial-Modifier Variables</a>
              2.1.16. <a href="#x2.1.16">Giving Multiple Numbers to the DIAL Command</a>
	 2.2. <a href="#x2.2">Modems</a>
	      2.2.1. <a href="#x2.2.1">New Modem Types</a>
	      2.2.2. <a href="#x2.2.2">New Modem Controls</a>
	 2.3. <a href="#x2.3">TELNET and RLOGIN</a>
              2.3.0. <a href="#x2.3.0">Bug Fixes</a>
	      2.3.1. <a href="#x2.3.1">Telnet Binary Mode Bug Adjustments</a>
	      2.3.2. <a href="#x2.3.2">VMS UCX Telnet Port Bug Adjustment</a>
	      2.3.3. <a href="#x2.3.3">Telnet New Environment Option</a>
	      2.3.4. <a href="#x2.3.4">Telnet Location Option</a>
              2.3.5. <a href="#x2.3.5">Connecting to Raw TCP Sockets</a>
              2.3.6. <a href="#x2.3.6">Incoming TCP Connections</a>
	 2.4. <a href="#x2.4">The EIGHTBIT Command</a>
	 2.5. <a href="#x2.5">The Services Directory</a>
         2.6. <a href="#x2.6">Closing Connections</a>
	 2.7. <a href="#x2.7">Using C-Kermit with External Communication Programs</a>
              2.7.0. <a href="#x2.7.0">C-Kermit over tn3270 and tn5250</a>
	      2.7.1. <a href="#x2.7.1">C-Kermit over Telnet</a>
	      2.7.2. <a href="#x2.7.2">C-Kermit over Rlogin</a>
              2.7.3. <a href="#x2.7.3">C-Kermit over Serial Communication Programs</a>
	      2.7.4. <a href="#x2.7.4">C-Kermit over Secure Network Clients</a>
	      2.7.4.1. <a href="#x2.7.4.1">SSH</a>
	      2.7.4.2. <a href="#x2.7.4.2">SSL</a>
	      2.7.4.3. <a href="#x2.7.4.3">SRP</a>
	      2.7.4.4. <a href="#x2.7.4.4">SOCKS</a>
              2.7.4.5. <a href="#x2.7.4.5">Kerberos and SRP</a>
         2.8. <a href="#x2.8">Scripting Local Programs</a>
         2.9. <a href="#x2.9">X.25 Networking</a>
              2.9.1. <a href="#x2.9.1">IBM AIXLink/X.25 Network Provider Interface for AIX</a>
              2.9.2. <a href="#x2.9.2">HP-UX X.25</a>
         2.10. <a href="#x2.10">Additional Serial Port Controls</a>
         2.11. <a href="#x2.11">Getting Access to the Dialout Device</a>
         2.12. <a href="#x2.12">The Connection Log</a>
         2.13. <a href="#x2.13">Automatic Connection-Specific Flow Control Selection</a>
         2.14. <a href="#x2.14">Trapping Connection Establishment and Loss</a>
         2.15. <a href="#x2.15">Contacting Web Servers with the HTTP Command</a>
     (3) <a href="#x3">TERMINAL CONNECTION</a>
         3.1. <a href="#x3.1">CONNECT Command Switches</a>
         3.2. <a href="#x3.2">Triggers</a>
         3.3. <a href="#x3.3">Transparent Printing</a>
         3.4. <a href="#x3.4">Binary and Text Session Logs</a>
     (4) <a href="#x4">FILE TRANSFER AND MANAGEMENT</a>
         4.0. <a href="#x4.0">Bug Fixes, Minor Changes, and Clarifications</a>
	 4.1. <a href="#x4.1">File-Transfer Filename Templates</a>
	 4.1.1. <a href="#x4.1.1">Templates in the As-Name</a>
	 4.1.2. <a href="#x4.1.2">Templates on the Command Line</a>
	 4.1.3. <a href="#x4.1.3">Post-Transfer Renaming</a>
	 4.2. <a href="#x4.2">File-Transfer Pipes and Filters</a>
         4.2.1. <a href="#x4.2.1">Introduction</a>
	 4.2.1.1. <a href="#x4.2.1.1">Terminology</a>
	 4.2.1.2. <a href="#x4.2.1.2">Notation</a>
	 4.2.1.3. <a href="#x4.2.1.3">Security</a>
	 4.2.2. <a href="#x4.2.2">Commands for Transferring from and to Pipes</a>
	 4.2.2.1. <a href="#x4.2.2.1">Sending from a Command</a>
	 4.2.2.2. <a href="#x4.2.2.2">Receiving to a Command</a>
	 4.2.3. <a href="#x4.2.3">Using File-Transfer Filters</a>
	 4.2.3.1. <a href="#x4.2.3.1">The SEND Filter</a>
	 4.2.3.2. <a href="#x4.2.3.2">The RECEIVE Filter</a>
	 4.2.4. <a href="#x4.2.4">Implicit Use of Pipes</a>
	 4.2.5. <a href="#x4.2.5">Success and Failure of Piped Commands</a>
         4.2.6. <a href="#x4.2.6">Cautions about Using Pipes to Transfer Directory Trees</a>
	 4.2.7. <a href="#x4.2.7">Pipes and Encryption</a>
         4.2.8. <a href="#x4.2.8">Commands and Functions Related to Pipes</a>
	 4.2.8.1. <a href="#x4.2.8.1">The OPEN !READ and OPEN !WRITE Commands</a>
	 4.2.8.2. <a href="#x4.2.8.2">The REDIRECT Command</a>
         4.2.8.3. <a href="#x4.2.8.3">Receiving Mail and Print Jobs</a>
	 4.2.8.4. <a href="#x4.2.8.4">Pipe-Related Functions</a>
         4.3. <a href="#x4.3">Automatic Per-File Text/Binary Mode Switching</a>
	 4.3.1. <a href="#x4.3.1">Exceptions</a>
	 4.3.2. <a href="#x4.3.2">Overview</a>
	 4.3.3. <a href="#x4.3.3">Commands</a>
	 4.3.4. <a href="#x4.3.4">Examples</a>
         4.4. <a href="#x4.4">File Permissions</a>
	 4.4.1. <a href="#x4.4.1">When ATTRIBUTES PROTECTION is OFF</a>
	 4.4.1.1. <a href="#x4.4.1.1">Unix</a>
	 4.4.1.2. <a href="#x4.4.1.2">VMS</a>
	 4.4.2. <a href="#x4.4.2">When ATTRIBUTES PROTECTION is ON</a>
	 4.4.2.1. <a href="#x4.4.2.1">System-Specific Permissions</a>
	 4.4.2.1.1. <a href="#x4.4.2.1.1">UNIX</a>
	 4.4.2.1.2. <a href="#x4.4.2.1.2">VMS</a>
	 4.4.2.2. <a href="#x4.4.2.2">System-Independent Permissions</a>
         4.5. <a href="#x4.5">File Management Commands</a>
         4.5.1. <a href="#x4.5.1">The DIRECTORY Command</a>
         4.5.2. <a href="#x4.5.2">The CD and BACK Commands</a>
         4.5.2.1. <a href="#x4.5.2.1">Parsing Improvements</a>
         4.5.2.2. <a href="#x4.5.2.2">The CDPATH</a>
	 4.5.3. <a href="#x4.5.3">Creating and Removing Directories</a>
	 4.5.4. <a href="#x4.5.4">The DELETE and PURGE Commands</a>
         4.6. <a href="#x4.6">Starting the Remote Kermit Server Automatically</a>
         4.7. <a href="#x4.7">File-Transfer Command Switches</a>
         4.7.1. <a href="#x4.7.1">SEND Command Switches</a>
         4.7.2. <a href="#x4.7.2">GET Command Switches</a>
         4.7.3. <a href="#x4.7.3">RECEIVE Command Switches</a>
         4.8. <a href="#x4.8">Minor Kermit Protocol Improvements</a>
	 4.8.1. <a href="#x4.8.1">Multiple Attribute Packets</a>
	 4.8.2. <a href="#x4.8.2">Very Short Packets</a>
         4.9. <a href="#x4.9">Wildcard / File Group Expansion</a>
	 4.9.1. <a href="#x4.9.1">In UNIX C-Kermit</a>
	 4.9.2. <a href="#x4.9.2">In Kermit 95</a>
	 4.9.3. <a href="#x4.9.3">In VMS, AOS/VS, OS-9, VOS, etc.</a>
         4.10. <a href="#x4.10">Additional Pathname Controls</a>
         4.11. <a href="#x4.11">Recursive SEND and GET: Transferring Directory Trees</a>
	 4.11.1. <a href="#x4.11.1">Command-Line Options</a>
	 4.11.2. <a href="#x4.11.2">The SEND /RECURSIVE Command</a>
	 4.11.3. <a href="#x4.11.3">The GET /RECURSIVE Command</a>
	 4.11.4. <a href="#x4.11.4">New and Changed File Functions</a>
	 4.11.5. <a href="#x4.11.5">Moving Directory Trees Between Like Systems</a>
	 4.11.6. <a href="#x4.11.6">Moving Directory Trees Between Unlike Systems</a>
         4.12. <a href="#x4.12">Where Did My File Go?</a>
         4.13. <a href="#x4.13">File Output Buffer Control</a>
         4.14. <a href="#x4.14">Improved Responsiveness</a>
         4.15. <a href="#x4.15">Doubling and Ignoring Characters for Transparency</a>
         4.16. <a href="#x4.16">New File-Transfer Display Formats</a>
         4.17. <a href="#x4.17">New Transaction Log Formats</a>
         4.17.1. <a href="#x4.17.1">The BRIEF Format</a>
         4.17.2. <a href="#x4.17.2">The FTP Format</a>
         4.18. <a href="#x4.18">Unprefixing NUL</a>
         4.19. <a href="#x4.19">Clear-Channel Protocol</a>
         4.20. <a href="#x4.20">Streaming Protocol</a>
	 4.20.1. <a href="#x4.20.1">Commands for Streaming</a>
	 4.20.2. <a href="#x4.20.2">Examples of Streaming</a>
	 4.20.2.1. <a href="#x4.20.2.1">Streaming on Socket-to-Socket Connections</a>
	 4.20.2.2. <a href="#x4.20.2.2">Streaming on Telnet Connections</a>
         4.20.2.3. <a href="#x4.20.2.3">Streaming with Limited Packet Length</a>
         4.20.2.4. <a href="#x4.20.2.4">Streaming on Dialup Connections</a>
         4.20.2.5. <a href="#x4.20.2.5">Streaming on X.25 Connections</a>
         4.20.3. <a href="#x4.20.3">Streaming - Preliminary Conclusions</a>
         4.21. <a href="#x4.21">The TRANSMIT Command</a>
	 4.22. <a href="#x4.22">Coping with Faulty Kermit Implementations</a>
	 4.22.1. <a href="#x4.22.1">Failure to Accept Modern Negotiation Strings</a>
	 4.22.2. <a href="#x4.22.2">Failure to Negotiate 8th-bit Prefixing</a>
	 4.22.3. <a href="#x4.22.3">Corrupt Files</a>
	 4.22.4. <a href="#x4.22.4">Spurious Cancellations</a>
	 4.22.5. <a href="#x4.22.5">Spurious Refusals</a>
	 4.22.6. <a href="#x4.22.6">Failures during the Data Transfer Phase</a>
	 4.22.7. <a href="#x4.22.7">Fractured Filenames</a>
	 4.22.8. <a href="#x4.22.8">Bad File Dates</a>
         4.23. <a href="#x4.23">File Transfer Recovery</a>
         4.24. <a href="#x4.24">FILE COLLISION UPDATE Clarification</a>
         4.25. <a href="#x4.25">Autodownload Improvements</a>
     (5) <a href="#x5">CLIENT/SERVER</a>
         5.0. <a href="#x5.0">Hints</a>
	 5.1. <a href="#x5.1">New Command-Line Options</a>
	 5.2. <a href="#x5.2">New Client Commands</a>
	 5.3. <a href="#x5.3">New Server Capabilities</a>
         5.3.1. <a href="#x5.3.1">Creating and Removing Directories</a>
         5.3.2. <a href="#x5.3.2">Directory Listings</a>
         5.4. <a href="#x5.4">Syntax for Remote Filenames with Embedded Spaces</a>
         5.5. <a href="#x5.5">Automatic Orientation Messages upon Directory Change</a>
	 5.6. <a href="#x5.6">New Server Controls</a>
	 5.7. <a href="#x5.7">Timeouts during REMOTE HOST Command Execution</a>
     (6) <a href="#x6">INTERNATIONAL CHARACTER SETS</a>
         6.0. <a href="#x6.0">ISO 8859-15 Latin Alphabet 9</a>
         6.1. <a href="#x6.1">The HP-Roman8 Character Set</a>
         6.2. <a href="#x6.2">Greek Character Sets</a>
         6.3. <a href="#x6.3">Additional Latin-2 Character Sets</a>
         6.4. <a href="#x6.4">Additional Cyrillic Character Sets</a>
         6.5. <a href="#x6.5">Automatic Character-Set Switching</a>
         6.6. <a href="#x6.6">Unicode</a>
	 6.6.1. <a href="#x6.6.1">Overview of Unicode</a>
	 6.6.2. <a href="#x6.6.2">UCS Byte Order</a>
	 6.6.2. <a href="#x6.6.2">UCS Transformation Formats</a>
	 6.6.3. <a href="#x6.6.3">Conformance Levels</a>
	 6.6.4. <a href="#x6.6.4">Relationship of Unicode with Kermit's Other Character Sets</a>
	 6.6.5. <a href="#x6.6.5">Kermit's Unicode Features</a>
	 6.6.5.1. <a href="#x6.6.5.1">File Transfer</a>
	 6.6.5.2. <a href="#x6.6.5.2">The TRANSLATE Command</a>
	 6.6.5.3. <a href="#x6.6.5.3">Terminal Connection</a>
	 6.6.5.4. <a href="#x6.6.5.4">The TRANSMIT Command</a>
	 6.6.5.5. <a href="#x6.6.5.5">Summary of Kermit Unicode Commands</a>
         6.7. <a href="#x6.7">Client/Server Character-Set Switching</a>
     (7) <a href="#x7">SCRIPT PROGRAMMING</a>
         7.0. <a href="#x7.0">Bug Fixes</a>
         7.1. <a href="#x7.1">The INPUT Command</a>
	 7.1.1. <a href="#x7.1.1">INPUT Timeouts</a>
	 7.1.2. <a href="#x7.1.2">New INPUT Controls</a>
	 7.1.3. <a href="#x7.1.3">INPUT with Pattern Matching</a>
	 7.1.4. <a href="#x7.1.4">The INPUT Match Result</a>
	 7.2. <a href="#x7.2">New or Improved Built-In Variables</a>
	 7.3. <a href="#x7.3">New or Improved Built-In Functions</a>
         7.4. <a href="#x7.4">New IF Conditions</a>
         7.5. <a href="#x7.5">Using More than Ten Macro Arguments</a>
         7.6. <a href="#x7.6">Clarification of Function Call Syntax</a>
         7.7. <a href="#x7.7">Autodownload during INPUT Command Execution</a>
         7.8. <a href="#x7.8">Built-in Help for Functions.</a>
	 7.9. <a href="#x7.9">Variable Assignments</a>
	 7.9.1. <a href="#x7.9.1">Assignment Operators</a>
	 7.9.2. <a href="#x7.9.2">New Assignment Commands</a>
	 7.10. <a href="#x7.10">Arrays</a>
	 7.10.1. <a href="#x7.10.1">Array Initializers</a>
	 7.10.2. <a href="#x7.10.2">Turning a String into an Array of Words</a>
	 7.10.3. <a href="#x7.10.3">Arrays of Filenames</a>
	 7.10.4. <a href="#x7.10.4">Automatic Arrays</a>
	 7.10.5. <a href="#x7.10.5">Sorting Arrays</a>
	 7.10.6. <a href="#x7.10.6">Displaying Arrays</a>
         7.10.7. <a href="#x7.10.7">Other Array Operations</a>
         7.10.8. <a href="#x7.10.8">Hints for Using Arrays</a>
         7.10.9. <a href="#x7.10.9">Do-It-Yourself Arrays</a>
         7.10.10. <a href="#x7.10.10">Associative Arrays</a>
         7.11. <a href="#x7.11">OUTPUT Command Improvements</a>
         7.12. <a href="#x7.12">Function and Variable Diagnostics</a>
         7.13. <a href="#x7.13">Return Value of Macros</a>
         7.14. <a href="#x7.14">The ASSERT, FAIL, and SUCCEED Commands.</a>
         7.15. <a href="#x7.15">Using Alarms</a>
         7.16. <a href="#x7.16">Passing Arguments to Command Files</a>
         7.17. <a href="#x7.17">Dialogs with Timed Responses</a>
         7.18. <a href="#x7.18">Increased Flexibility of SWITCH Case Labels</a>
         7.19. "<a href="#x7.19">Kerbang" Scripts</a>
         7.20. <a href="#x7.20">IF and XIF Statement Syntax</a>
         7.20.1. <a href="#x7.20.1">The IF/XIF Distinction</a>
         7.20.2. <a href="#x7.20.2">Boolean Expressions (The IF/WHILE Condition)</a>
         7.21. <a href="#x7.21">Screen Formatting and Cursor Control</a>
         7.22. <a href="#x7.22">Evaluating Arithmetic Expressions</a>
         7.23. <a href="#x7.23">Floating-Point Arithmetic</a>
         7.24. <a href="#x7.24">Tracing Script Execution</a>
         7.25. <a href="#x7.25">Compact Substring Notation</a>
         7.26. <a href="#x7.26">New WAIT Command Options</a>
         7.26.1. <a href="#x7.26.1">Waiting for Modem Signals</a>
         7.26.2. <a href="#x7.26.2">Waiting for File Events</a>
         7.27. <a href="#x7.27">Relaxed FOR and SWITCH Syntax</a>
     (8) <a href="#x8">USING OTHER FILE TRANSFER PROTOCOLS</a>
     (9) <a href="#x9">COMMAND-LINE OPTIONS</a>
         9.0. <a href="#x9.0">Extended-Format Command-Line Options</a>
	 9.1. <a href="#x9.1">Command Line Personalities</a>
	 9.2. <a href="#x9.2">Built-in Help for Command Line Options</a>
	 9.3. <a href="#x9.3">New Command-Line Options</a>
    (10) <a href="#x10">C-KERMIT AND G-KERMIT</a>

III. <a href="#xiii">APPENDICES</a>

III.1. <a href="#xiii.1">Character Set Tables</a>
III.1.1. <a href="#xiii.1.1">The Hewlett Packard Roman8 Character Set</a>
III.1.2. <a href="#xiii.1.2">Greek Character Sets</a>
III.1.2.1. <a href="#xiii.1.2.1">The ISO 8859-7 Latin / Greek Alphabet</a>
III.1.2.2. <a href="#xiii.1.2.2">The ELOT 927 Character Set</a>
III.1.2.3. <a href="#xiii.1.2.3">PC Code Page 869</a>
III.2. <a href="#xiii.2">Updated Country Codes</a>

IV. <a href="#xiv">ERRATA &#38; CORRIGENDA: Corrections to "Using C-Kermit" 2nd Edition.</a>
V. <a href="#xv">ADDITIONAL COPYRIGHT NOTICES</a>
</pre><p>
<hr>
<h2><a name="#xi">I. C-KERMIT DOCUMENTATION</a></h2>

The user manual for C-Kermit is:
<p><blockquote>
Frank da Cruz and Christine M. Gianone, 
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>, Second Edition,
Digital Press /  Butterworth-Heinemann, Woburn, MA, 1997, 622 pages,
ISBN 1-55558-164-1.
</blockquote>
<p>
<a href="http://www.columbia.edu/kermit/ckbreviews.html">CLICK HERE</a> for
reviews.
<p>

The present document is a supplement to <cite>Using C-Kermit</cite> 2nd Ed,
not a replacement for it.

<p>
US single-copy price: $44.95; quantity discounts available.  Available in
bookstores or directly from Columbia University:

<p><pre>
  The Kermit Project
  Columbia University
  612 West 115th Street
  New York NY  10025-7799
  USA
  Telephone: +1 (212) 854-3703
  Fax:       +1 (212) 663-8202
</pre><p>

Domestic and overseas orders accepted.  Price: US $44.95 (US, Canada, and
Mexico).  Shipping: $4.00 within the USA; $15.00 to all other countries.
Orders may be paid by MasterCard or Visa, or prepaid by check in US dollars.
Add $65 bank fee for checks not drawn on a US bank.  Do not include sales
tax.  Inquire about quantity discounts.

<p>
You can also order by phone from the publisher, Digital Press /
<a href="http://www.bhusa.com">Butterworth-Heinemann</a>, with MasterCard,
Visa, or American Express:
<p><pre>
  +1 800 366-2665   (Woburn, Massachusetts office for USA &#38; Canada)
  +44 1865 314627   (Oxford, England distribution centre for UK &#38; Europe)
  +61 03 9245 7111  (Melbourne, Vic, office for Australia &#38; NZ)
  +65 356-1968      (Singapore office for Asia)
  +27 (31) 2683111  (Durban office for South Africa)
</pre><p>

A
<a href="http://www.columbia.edu/kermit/manuals.html#ckde">German-language</a>
edition of the First Edition is also available:
<p><blockquote>
Frank da Cruz and Christine M. Gianone, <cite>C-Kermit - Einf&uuml;hrung und
Referenz</cite>, Verlag Heinz Heise, Hannover, Germany (1994).
ISBN 3-88229-023-4.  Deutsch von Gisbert W. Selke.  Price: DM 88,00.
Verlag Heinz Heise GmbH &#38; Co. KG, Helstorfer Strasse 7, D-30625 Hannover.
Tel. +49 (05 11) 53 52-0, Fax. +49 (05 11) 53 52-1 29.
</blockquote><p>

The
<a href="http://www.columbia.edu/kermit/manuals.html#ktb">
Kermit file transfer protocol</a> is specified in:
<p><blockquote>
Frank da Cruz, <cite>Kermit, A File Transfer Protocol</cite>, Digital Press,
Bedford, MA, 1987, 379 pages, ISBN 0-932376-88-6.
US single-copy price: $39.95.  Availability as above.
</blockquote><p>

News and articles about Kermit software and protocol are published
periodically in the journal,
<a href="http://www.columbia.edu/kermit/news.html"><cite>Kermit News</cite></a>.  Subscriptions are free;
contact Columbia University at the address above.
<p>
Online news about Kermit is published in the
<a href="news:comp.protocols.kermit.announce">comp.protocols.kermit.announce</a>
and <a href="news:comp.protocols.kermit.misc">comp.protocols.kermit.misc</a>
newsgroups.
<p>
<hr>

<h2><a name="xii">II. NEW FEATURES</a></h2>

Support for the Bell Labs Plan 9 operating system was added to version 6.0
too late to be mentioned in the book (although it does appear on the cover).
<p>
Specific changes and additions are grouped together by major topic, roughly
corresponding to the chapters of <a href="ckb2.html"><cite>Using C-Kermit</cite></a>.

<p>
<hr>
<h3><a name="x0">0. INCOMPATIBILITIES WITH PREVIOUS RELEASES</a></h3>
<ol>
<li>C-Kermit 7.0 uses FAST Kermit protocol settings by default.  This includes
"unprefixing" of certain control characters.  Because of this, file transfers
that worked with previous releases might not work in the new release (but it
is more likely that they will work, and much faster).  If a transfer fails,
you'll get a context-sensitive hint suggesting possible causes and cures.
Usually SET PREFIXING ALL does the trick.
<p>
<li>C-Kermit 7.0 transfers files in BINARY mode by default.  To restore the
previous behavior, put SET FILE TYPE TEXT in your C-Kermit initialization
file.
<p>
<li>No matter whether FILE TYPE is BINARY or TEXT by default, C-Kermit 7.0 now
switches between text and binary mode automatically on a per-file basis
according to various criteria, including (a) which kind of platform is on the
other end of the connection (if known), (b) the version of Kermit on the other
end, and (c) the file's name (see
<a href="#x4">Section 4</a>, especially <a href="#x4.3">4.3</a>).  To disable
this automatic switching and restore the earlier behavior, put SET TRANSFER
MODE MANUAL in your C-Kermit initialization file.  To disable automatic
switching for a particular transfer, include a /TEXT or /BINARY switch with
your SEND or GET command.

<p>

<li>The RESEND and REGET commands automatically switch to binary mode;
previously if RESEND or REGET were attempted when FILE TYPE was TEXT, these
commands would fail immediately, with a message telling you they work only
when the FILE TYPE is BINARY.  Now they simply do this for you.  See
<a href="#x4.23">Section 4.23</a> for additional (important) information.

<p>

<li>SET PREFIXING CAUTIOUS and MINIMAL now both prefix linefeed (10 and 138)
in case rlogin, ssh, or cu are "in the middle", since otherwise
<tt>&#60;LF&#62;~</tt> might
appear in Kermit packets, and this would cause rlogin, ssh, or cu to
disconnect, suspend,escape back, or otherwise wreck the file transfer.  Xon
and Xoff are now always prefixed too, even when Xon/Xoff flow control is not
in effect, since unprefixing them has proven dangerous on TCP/IP connections.

<p>

<li>In UNIX, VMS, Windows, and OS/2, the DIRECTORY command is built into
C-Kermit itself rather than implemented by running an external command or
program.  The built-in command might not behave the way the platform-specific
external one did, but many options are available for customization.  Of course
the underlying platform-specific command can still be accessed with "!", "@",
or "RUN" wherever the installation does not forbid.  In UNIX, the "ls" command
can be accessed directly as "ls" in C-Kermit.  See 
<a href="#x4.5.1">Section 4.5.1</a> for details.

<p>

<li><tt>SEND ?</tt> prints a list of switches rather than a list of filenames.
If you want to see a list of filenames, use a (system-dependent) construction
such as <tt>SEND ./?</tt> (for UNIX, Windows, or OS/2), <tt>SEND []?</tt>
(VMS), etc.  See 
<a href="#x1.5">Sections 1.5</a> and <a href="#x4.7.1">4.7.1</a>.

<p>

<li>In UNIX, OS-9, and Kermit 95, the wildcard characters in previous versions
were <tt>*</tt> and <tt>?</tt>.  In C-Kermit 7.0 they are <tt>*</tt>,
<tt>?</tt>, <tt>[</tt>, <tt>]</tt>, <tt>{</tt>, and <tt>}</tt>, with dash used
inside <tt>[]</tt>'s to denote ranges and comma used inside <tt>{}</tt> to
separate list elements.  If you need to include any of these characters
literally in a filename, precede each one with backslash (<tt>\</tt>).  See
<a href="#x4.9.">Section 4.9.</a>

<p>

<li>SET QUIET <i>{</i> ON, OFF <i>}</i> is now on the command
stack, just like SET INPUT CASE, SET COUNT, SET MACRO ERROR, etc, as described
on p.458 of
<a href="ckb2.html"><cite>Using
C-Kermit</cite></a>,
2nd Edition.  This allows any macro or command file to SET QUIET ON or OFF
without worrying about saving and restoring the global QUIET value.  For
example, this lets you write a script that tries SET LINE on lots of devices
until it finds one free without spewing out loads of error messages, and also
without disturbing the global QUIET setting, whatever it was.

<p>

<li>Because of the new "<tt>.</tt>" operator (which introduces assignments),
macros whose names begin with "<tt>.</tt>" can not be invoked "by name".
However, they still can be invoked with DO.

<p>

<li>The syntax of the EVALUATE command has changed.  See 
<a href="#x7.9.2">Section 7.9.2</a>.  To restore the previous syntax, use SET
EVALUATE OLD.

<p>

<li>The <tt>\v(directory)</tt> variable now includes the trailing directory
separator; in previous releases it did not.  This is to allow constructions
such as:
<p><pre>
  cd \v(dir)data.tmp
</pre><p>
to work across platforms that might have different directory notation, such
as UNIX, Windows, and VMS.

<p>
<li>Prior to C-Kermit 7.0, the FLOW-CONTROL setting was global and sticky.
In C-Kermit 7.0, there is an array of default flow-control values for each
kind of connection, that are applied automatically at SET LINE/PORT/HOST time.
Thus a SET FLOW command given before SET LINE/PORT/HOST is likely to be undone.
Therefore SET FLOW can be guaranteed to have the desired effect only if given
after the SET LINE/PORT/HOST command.

<p>

<li>Character-set translation works differently in the TRANSMIT command when
(a) the file character-set is not the same as the local end of the terminal
character-set, or (b) when the terminal character-set is TRANSPARENT.
</ol>

<p>
<hr>
<h3><a name="x1">1. PROGRAM AND FILE MANAGEMENT AND COMMANDS</a></h3>
<h3><a name="x1.0">1.0. Bug Fixes</a></h3>
<p>
The following patches were issued to correct bugs in C-Kermit 6.0.  These are
described in detail in the 6.0 PATCHES file.  All of these fixes have been
incorporated in C-Kermit 6.1 (never released except as K95 1.1.16-17) and 7.0.
<p><pre>
 0001   All UNIX         C-Kermit mishandles timestamps on files before 1970
 0002	Solaris 2.5++    Compilation error on Solaris 2.5 with Pro C
 0003	All VMS          CKERMIT.INI Fix for VMS
 0004	VMS/VAX/UCX 2.0  C-Kermit 6.0 can't TELNET on VAX/VMS with UCX 2.0
 0005	All              C-Kermit Might Send Packets Outside Window
 0006	All              MOVE from SEND-LIST does not delete original files
 0007	Solaris 2.5++    Higher serial speeds on Solaris 2.5
 0008   All              C-Kermit application file name can't contain spaces
 0009   AT&#38;T 7300 UNIXPC setuid and hardware flow-control problems
 0010   Linux on Alpha   Patch to make ckutio.c compile on Linux/Alpha
 0011   OS-9/68000 2.4   Patch to make ck9con.c compile on OS-9/68000 2.4
 0012   MW Coherent 4.2  Patches for successful build on Coherent 4.2
 0013   SINIX-Y 5.43     "delay" variable conflicts with &#60;sys/clock.h&#62;
 0014   VMS/VAX/CMU-IP   Subject: Patches for VAX/VMS 5.x + CMU-IP
 0015   All              XECHO doesn't flush its output
 0016   VMS              CD and other directory operations might not work
 0017   Linux 1.2.x++    Use standard POSIX interface for high serial speeds
 0018   UNIX             SET WILDCARD-EXPANSION SHELL dumps core
 0019   All              Hayes V.34 modem init string problem
 0020   All              READ command does not fail if file not open
 0021   All              Problems with long function arguments
 0022   All              Certain \function()s can misbehave
 0023   All              X MOD 0 crashes program
 0024   All              Internal bulletproofing for lower() function
 0025   OpenBSD          Real OpenBSD support for C-Kermit 6.0
 0026   All              Incorrect checks for macro/command-file nesting depth
 0027   All              ANSWER doesn't automatically CONNECT
 0028   All              Overzealous EXIT warning
 0029   All              OUTPUT doesn't echo when DUPLEX is HALF
 0030   All              Minor problems with REMOTE DIRECTORY/DELETE/etc
 0031   All              CHECK command broken
 0032   All              Problem with SET TRANSMIT ECHO
 0033   UNIX, VMS, etc   HELP SET SERVER says too much
 0034   All              READ and !READ too picky about line terminators
 0035   All              END from inside SWITCH doesn't work
 0036   All              Problem telnetting to multihomed hosts
 0037   All              Redirection failures in REMOTE xxx &#62; file
</pre><p>
REDIRECT was missing in many UNIX C-Kermit implementations; in version 7.0,
it should be available in all of them.
<p>
<hr>
<h3><a name="x1.1">1.1. Command Continuation</a></h3>
<p>
Comments that start with ";" or "#" can no longer be continued.  In:
<p><pre>
  ; this is a comment -
  echo blah
</pre><p>
the ECHO command will execute, rather than being taken as a continuation of
the preceding comment line.  This allows easy "commenting out" of commands
from macro definitions.
<p>
However, the text of the COMMENT command can still be continued onto
subsequent lines:
<p><pre>
  comment this is a comment -
  echo blah
</pre><p>
As of version 6.0, backslash is no longer a valid continuation character.
Only hyphen should be used for command continuation.  This is to make it
possible to issue commands like "cd a:\" on DOS-like systems.
<p>
As of version 7.0:
<p><ul>
<li>You can quote a final dash to prevent it from being a continuation
character:
<p><pre>
  echo foo\-
</pre><p>
This prints "<tt>foo-</tt>".  The command is not continued.
<p>
<li>You can enter commands such as:
<p><pre>
  echo foo - ; this is a comment
</pre><p>
interactively and they are properly treated as continued commands.
Previously this worked only in command files.
</ul>
<p>
<hr>
<h3><a name="x1.2">1.2. Editor Interface</a></h3>
<dl>
<dt><b>SET EDITOR</b> <i>name [ options ]</i>
<dd>Lets you specify a text-editing program.  The <i>name</i> can be a fully
specified pathname like /usr/local/bin/emacs19/emacs, or it can be the
name of any program in your PATH, e.g. "set editor emacs".  In VMS, it
must be a DCL command like "edit", "edit/tpu", "emacs", etc.  If an
environment variable EDITOR is defined when Kermit starts, its value is
the default editor.  You can also specify options to be included on the
editor command line.  Returns to Kermit when the editor exits.
<p>
<dt><b>EDIT</b> <i>[ filename ]</i>
<dd>If the EDIT command is given without a filename, then if a previous
filename had been given to an EDIT command, it is used; if not, the editor is
started without a file.  If a filename is given, the editor is started on that
file, and the filename is remembered for subsequent EDIT commands.
<p>
<dt><b>SHOW EDITOR</b>
<dd>Displays the full pathname of your text editor, if any, along with any
command line options, and the file most recently edited (and therefore the
default filename for your next EDIT command).
</dl>
<p>
Related variables: <tt>\v(editor)</tt>, <tt>\v(editopts)</tt>,
<tt>\v(editfile)</tt>.
<p>
<hr>
<h3><a name="x1.3">1.3. Web Browser and FTP Interface</a></h3>
<p>
C-Kermit includes an FTP command, which simply runs the FTP program; C-Kermit
does not include any built-in support for Internet File Transfer Protocol,
nor any method for interacting directly with an FTP server.  In version 7.0,
however, C-Kermit lets you specify your FTP client:
<p>
<dl><dt><b>SET FTP-CLIENT</b> <i>[ name [ options ] ]</i>
<dd>The <i>name</i> is the name of the FTP executable.  In UNIX, Windows, or
OS/2, it can be the filename of any executable program in your PATH (e.g.
"<tt>ftp.exe</tt>" in Windows, "<tt>ftp</tt>" in UNIX); elsewhere (or if you
do not have a PATH definition), it must be the fully specified pathname of the
FTP program.  If the name contains any spaces, enclose it braces.  Include any
options after the filename; these depend the particular ftp client.
</dl>
<p>
The Web browser interface is covered in the following subsections.
<p>
<hr>
<h4><a name="x1.3.1">1.3.1. Invoking your Browser from C-Kermit</a></h4>
<p><dl>
<dt><b>BROWSE</b> <i>[ url ]</i>
<dd>Starts your preferred Web browser on the URL, if one is given, otherwise
on the most recently given URL, if any.  Returns to Kermit when the browser
exits.
<p>
<dt><b>SET BROWSER</b> <i>[ name [ options ] ]</i>
<dd>Use this command to specify the name of your Web browser program, for
example: "set browser lynx".  The <i>name</i> must be in your PATH, or else
it must be a fully specified filename; in VMS it must be a DCL command.
<p>
<dt><b>SHOW BROWSER</b>
<dd>Displays the current browser, options, and most recent URL.
</dl>
<p>
Related variables: <tt>\v(browser)</tt>, <tt>\v(browsopts)</tt>,
<tt>\v(browsurl)</tt>.
<p>
Also see <a href="#x2.15">Section 2.15</a>: Contacting Web Servers with the
HTTP Command.
<p>
<hr>
<h4><a name="x1.3.2">1.3.2. Invoking C-Kermit from your Browser</a></h4>
<p>
The method for doing this depends, of course, on your browser.  Here are
some examples:
<p><dl>
<dt><b>Netscape on UNIX (X-based)</b>
<dd>In the Options-&#62;Applications section, set your Telnet application to:
<p><pre>
  xterm -e /usr/local/bin/kermit/kermit -J %h %p
</pre><p>
(replace "<tt>/usr/local/bin/kermit/kermit</tt>"
by C-Kermit's actual pathname).
<tt>-J</tt> is C-Kermit's command-line option to "be like Telnet";
<tt>%h</tt> and <tt>%p</tt>
are Netscape placeholders for hostname and port.
<p>
<dt><b>Lynx on UNIX</b>
<dd>As far as we know, this can be done only at compile time.  Add the
following line to the Lynx <tt>userdefs.h</tt> file before building the Lynx
binary:
<p><pre>
  #define TELNET_COMMAND "/opt/bin/kermit -J"
</pre><p>
And then add lines like the following to the <tt>Lynx.cfg</tt> file:
<p><pre>
  DOWNLOADER:Kermit binary download:/opt/bin/kermit -i -V -s %s -a %s:TRUE
  DOWNLOADER:Kermit text download:/opt/bin/kermit -s %s -a %s:TRUE

  UPLOADER:Kermit binary upload:/opt/bin/kermit -i -r -a %s:TRUE
  UPLOADER:Kermit text upload:/opt/bin/kermit -r -a %s:TRUE
  UPLOADER:Kermit text get:/opt/bin/kermit -g %s:TRUE
  UPLOADER:Kermit binary get:/opt/bin/kermit -ig %s:TRUE
</pre></dl>

But none of the above is necessary if you make C-Kermit your default Telnet
client, which you can do by making a symlink called 'telnet' to the C-Kermit
7.0 binary.  See <a href="#x9.1">Section 9.1</a> for details.

<p>
<hr>
<h3><a name="x1.4">1.4. Command Editing</a></h3>
<p>
Ctrl-W ("Word delete") was changed in 7.0 to delete back to the previous
non-alphanumeric, rather than all the way back to the previous space.
<p>
<hr>
<h3><a name="x1.5">1.5. Command Switches</a></h3>
<p>
As of version 7.0, C-Kermit's command parser supports a new type of field,
called a "switch".  This is an optional command modifier.

<h4><a name="x1.5.1">1.5.1. General Switch Syntax</a></h4>

A switch is a keyword beginning with a slash (/).  If it takes a value, then
the value is appended to it (with no intervening spaces), separated by a colon
(:) or equal sign (=).  Depending on the switch, the value may be a number,
a keyword, a filename, a date/time, etc.  Examples:
<p><pre>
  send oofa.txt                              ; No switches
  send /binary oofa.zip                      ; A switch without a value
  send /protocol:zmodem oofa.zip             ; A switch with a value (:)
  send /protocol=zmodem oofa.zip             ; A switch with a value (=)
  send /text /delete /as-name:x.x oofa.txt   ; Several switches
</pre><p>
Like other command fields, switches are separated from other fields, and from
each other, by whitespace, as shown in the examples just above.  You can not
put them together like so:
<p><pre>
  send/text/delete/as-name:x.x oofa.txt
</pre><p>
(as you might do in VMS or DOS, or as we might once have done in TOPS-10 or
TOPS0-20, or PIP).  This is primarily due to ambiguity between "/" as switch
introducer versus "/" as UNIX directory separator; e.g. in:
<p><pre>
  send /delete/as-name:foo/text oofa.txt
</pre><p>
Does "foo/text" mean the filename is "foo" and the transfer is to be in
text mode, or does it mean the filename is "foo/text"?  Therefore we require
whitespace between switches to resolve the ambiguity.  (That's only one of
several possible ambiguities -- it is also conceivable that a file called
"text" exists in the path "/delete/as-name:foo/").
<p>
In general, if a switch can take a value, but you omit it, then either a
reasonable default value is supplied, or an error message is printed:
<p><pre>
  send /print:-Plaserwriter oofa.txt         ; Value included = print options
  send /print oofa.txt                       ; Value omitted, OK
  send /mail:kermit@columbia.edu oofa.txt    ; Value included = address
  send /mail oofa.txt                        ; Not OK - address required
  ?Address required
</pre><p>
Context-sensitive help (?) and completion (Esc or Tab) are available in the
normal manner:
<p><pre>
  C-Kermit&#62; <u>send /pr?</u> Switch, one of the following:
    /print /protocol
  C-Kermit&#62; send /pr<u>o&#60;ESC&#62;</u>tocol:<u>?</u>  File-transfer protocol,
   one of the following:
    kermit   xmodem   ymodem   ymodem-g   zmodem
  C-Kermit&#62; send /protocol:<u>k&#60;TAB&#62;</u>ermit
</pre><p>
If a switch takes a value and you use completion on it, a colon (:) is printed
at the end of its name to indicate this.  If it does not take a value, a space
is printed.
<p>
Also, if you type ? in a switch field, switches that take values are shown
with a trailing colon; those that don't take values are shown without one.
<p>
<hr>
<h4><a name="x1.5.2">1.5.2. Order and Effect of Switches</a></h4>
<p>
The order of switches should not matter, except that they are evaluated from
left to right, so if you give two switches with opposite effects, the
rightmost one is used:
<p><pre>
  send /text /binary oofa.zip                ; Sends oofa.zip in binary mode.
</pre><p>
Like other command fields, switches have no effect whatsoever until the
command is entered (by pressing the Return or Enter key).  Even then, switches
affect only the command with which they are included; they do not have global
effect or side effects.
<p>
<hr>
<h4><a name="x1.5.3">1.5.3. Distinguishing Switches from Other Fields</a></h4>
<p>
All switches are optional.  A command that uses switches lets you give any
number of them, including none at all.  Example:
<p><pre>
  send /binary oofa.zip
  send /bin /delete oofa.zip
  send /bin /as-name:mupeen.zip oofa.zip
  send oofa.zip
</pre><p>
But how does Kermit know when the first "non-switch" is given?  It has been
told to look for both a switch and for something else, the data type of the
next field (filename, number, etc).  In most cases, this works well.  But
conflicts are not impossible.  Suppose, for example, in UNIX there was a file
named "text" in the top-level directory.  The command to send it would be:
<p><pre>
  send /text
</pre><p>
But C-Kermit would think this was the "/text" switch.  To resolve the
conflict, use braces:
<p><pre>
  send {/text}
</pre><p>
or other circumlocutions such as "<tt>send //text</tt>", "<tt>send
/./text</tt>", etc.
<p>
The opposite problem can occur if you give an illegal switch that happens
to match a directory name.  For example:
<p><pre>
  send /f oofa.txt
</pre><p>
There is no "<tt>/f</tt>" switch (there are several switches that begin with
"<tt>/f</tt>", so "<tt>/f</tt>" is ambiguous).  Now suppose there is an
"<tt>f</tt>" directory in the root directory; then this command would be
interpreted as:
<p><blockquote>
Send all the files in the "<tt>/f</tt>" directory,
giving each one an as-name of "<tt>oofa.txt</tt>".
</blockquote>
<p>

This could be a mistake, or it could be exactly what you intended; C-Kermit
has no way of telling the difference.  To avoid situations like this, spell
switches out in full until you are comfortable enough with them to know the
minimum abbreviation for each one.  <i>Hint:</i> use <tt>?</tt> and completion
while typing switches to obtain the necessary feedback.

<p>
<hr>
<h4><a name="x1.5.4">1.5.4. Standard File Selection Switches</a></h4>

The following switches are used on different file-oriented commands (such as
SEND, DIRECTORY, DELETE, PURGE) to refine the selection of files that match
the given specification.
<p><dl>
<dt><b>/AFTER:</b><i>date-time</i>
<dd>Select only those files having a date-time later than the one given.
See 
<a href="#x1.6">Section 1.6</a> for date-time formats.  Synonym: <b>/SINCE</b>.
<p>
<dt><b>/NOT-AFTER:</b><i>date-time</i>
<dd>Select only those files having a date-time not later than (i.e. earlier or
equal to) the one given.  Synonym: <b>/NOT-SINCE</b>.
<p>
<dt><b>/BEFORE:</b><i>date-time</i>
<dd>Select only those files having a date-time earlier than the one given.
<p>
<dt><b>/NOT-BEFORE:</b><i>date-time</i>
<dd>Select only those files having a date-time not earlier than (i.e. later or
equal to) the one given.
<p>
<dt><b>/DOTFILES</b>
<dd>UNIX and OS-9 only: The filespec is allowed to match files whose names
    start with (dot) period.  Normally these files are not shown.
<p>
<dt><b>/NODOTFILES</b>
<dd>(UNIX and OS-9 only) Don't show files whose names start with dot (period).
    This is the opposite of /DOTFILES, and is the default.  Note that when a
    directory name starts with a period, the directory and (in recursive
    operations) all its subdirectories are skipped.
<p>
<dt><b>/LARGER-THAN:</b><i>number</i>
<dd>Only select files larger than the given number of bytes.
<p>
<dt><b>/SMALLER-THAN:</b><i>number</i>
<dd>Only select files smaller than the given number of bytes.
<p>
<dt><b>/EXCEPT:</b><i>pattern</i>
<dd>Specifies that any files whose names match the pattern, which can be a
regular filename, or may contain "*" and/or "?" metacharacters (wildcards),
are not to be selected.  Example:
<p><pre>
  send /except:*.log *.*
</pre><p>
sends all files in the current directory except those with a filetype of
".log".  Another:
<p><pre>
  send /except:*.~*~ *.*
</pre><p>
sends all files except the ones that look like Kermit or EMACS backup
files (such as "<tt>oofa.txt.~17~</tt>") (of course you can also use the
/NOBACKUP switch for this).
<p>
The pattern matcher is the same one used by IF MATCH <i>string</i> <i>pattern</i>
(<a href="#x7.4">Section 7.4</a>), so you can test your patterns using IF
MATCH.  If you need to match a literal * or ? (etc), precede it by a backslash
(\).  If the pattern contains any spaces, it must be enclosed in braces:
<p><pre>
  send /except:{Foo bar} *.*
</pre><p>
The pattern can also be a list of up to 8 patterns.  In this case, the
entire pattern must be enclosed in braces, and each sub-pattern must also
be enclosed in braces; this eliminates the need for designating a
separator character, which is likely to also be a legal filename character
on some platform or other, and therefore a source of confusion.  You may
include spaces between the subpatterns but they are not necessary.  The
following two commands are equivalent:
<p><pre>
  send /except:{{ck*.o} {ck*.c}} ck*.?
  send /except:{{ck*.o}{ck*.c}} ck*.?
</pre><p>
If a pattern is to include a literal brace character, precede it with
"<tt>\</tt>".
Also note the apparent conflict of this list format and the string-list
format described in 
<a href="#x4.9.1">Section 4.9.1</a>.  In case you want to include a wildcard
string-list with braces on its outer ends as an /EXCEPT: argument, do it
like this:
<p><pre>
  send /except:{{{ckuusr.c,ckuus2.c,ckuus6.c}}} ckuus*.c
</pre></dl>

<p>
<hr>
<h4><a name="x1.5.5">1.5.5. Setting Preferences for Different Commands</a></h4>

Certain oft-used commands offer lots of switches because different people
have different requirements or preferences.  For example, some people want
to be able to delete files without having to watch a list of the deleted
files scroll past, while others want to be prompted for permission to delete
each file.  Different people prefer different directory-listing styles.  And
so on.  Such commands can be tailored with the SET OPTIONS command:
<p><dl>
<dt><b>SET OPTIONS</b> <i>command [ switch [  switch [ ... ] ] ]</i>
<dd>Sets each switch as the default for the given command, replacing the
"factory default".  Of course you can also override any defaults established
by the SET OPTIONS command by including the relevant switches in the
affected command any time you issue it.
<p>
<dt><b>SHOW OPTIONS</b>
<dd>Lists the commands that allows option-setting, and the options currently
in effect, if any, for each.  Switches that have synonyms are shown under
their primary name; for example. /LOG and /VERBOSE are shown as /LIST.
</dl>
<p>
Commands for which options may be set include DIRECTORY, DELETE, PURGE,
and TYPE.  Examples:
<p><pre>
  SET OPTIONS DIRECTORY /PAGE /NOBACKUP /HEADING /SORT:DATE /REVERSE
  SET OPTIONS DELETE /LIST /NOHEADING /NOPAGE /NOASK /NODOTFILES
  SET OPTIONS TYPE /PAGE
</pre><p>
Not necessarily all of a command's switches can be set as options.  For
example, file selection switches, since these would normally be different for
each command.
<p>
Put the desired SET OPTIONS commands in your C-Kermit customization file for
each command whose default switches you want to change every time you run
C-Kermit.

<p>
<hr>
<h3><a name="x1.6">1.6. Dates and Times</a></h3>

Some commands and switches take date-time values, such as:
<p><pre>
  send /after:{8-Feb-2000 10:28:01}
</pre><p>
Various date-time formats are acceptable.  The rules for the date are:
<p><ul>
<li>The year must have 4 digits.
<li>If the year comes first, the second field is the month.
<li>The day, month, and year may be separated by spaces, /, -, or underscore.
<li>The month may be numeric (1 = January) or spelled out or abbreviated in
English.
</ul><p>
If the date-time string contains any spaces, it must be enclosed in braces.
Examples of legal dates:
<p><pre>
                           <u>Interpretation:</u>
  2000-Feb-8                8 February 2000
  {2000 Feb 8}              8 February 2000
  2000/Feb/8                8 February 2000
  2000_Feb_8                8 February 2000
  2000-2-8                  8 February 2000
  2000-02-08                8 February 2000
  8-Feb-2000                8 February 2000
  08-Feb-2000               8 February 2000
  12/25/2000                25 December 2000
  25/12/2000                25 December 2000
</pre><p>
The last two examples show that when the year comes last, and the month is
given numerically, the order of the day and month doesn't matter as long as
the day is 13 or greater (mm/dd/yyyy is commonly used in the USA, whereas
dd/mm/yyyy is the norm in Europe).  However:
<p><pre>
  08/02/2000                Is ambiguous and therefore not accepted.
</pre><p>
If a date is given, the time is optional and defaults to 00:00:00.  If the
time is given with a date, it must follow the date, separated by space, /, -,
or underscore, and with hours, minutes, and seconds separated by colon (:).
Example:
<p><pre>
  2000-Feb-8 10:28:01       Represents 8 February 2000, 10:28:01am
</pre><p>
If a date is not given, the current date is used and a time is required.
<p>
Time format is hh:mm:ss or hh:mm or hh in 24-hour format, or followed by "am"
or "pm" (or "AM" or "PM") to indicate morning or afternoon.  Examples of times
that are acceptable:
<p><pre>
                           <u>Interpretation:</u>
  3:23:56                    3:23:56am
  3:23:56am                  3:23:56am
  3:23:56pm                  3:23:56pm = 15:23:56
 15:23:56                    3:23:56pm = 15:23:56
  3:23pm                     3:23:00pm = 15:23:00
  3:23PM                     3:23:00pm = 15:23:00
  3pm                        3:00:00pm = 15:00:00
</pre><p>
Examples of legal date-times:
<p><pre>
  send /after:{8 Feb 2000 10:28:01}
  send /after:8_Feb_2000_10:28:01
  send /after:8-Feb-2000/10:28:01
  send /after:2000/02/08/10:28:01
  send /after:2000/02/08_10:28:01
  send /after:2000/02/08_10:28:01am
  send /after:2000/02/08_10:28:01pm
  send /after:2000/02/08_10:28pm
  send /after:2000/02/08_10pm
  send /after:10:00:00pm
  send /after:10:00pm
  send /after:10pm
  send /after:22
</pre><p>
Finally, there is a special all-numeric format you can use:
<p><pre>
  yyyymmdd hh:mm:ss
</pre><p>
For example:
<p><pre>
  20000208 10:28:01
</pre><p>
This is Kermit's standard date-time format (based on ISO 8601), and is
accepted (among other formats) by any command or switch that requires a
date-time, and is output by any function whose result is a calendar date-time.
<p>
There are no optional parts to this format and it must be exactly 17
characters long, punctuated as shown (except you can substitute underscore
for space in contexts where a single "word" is required).  The time is in
24-hour format (23:00:00 is 11:00pm).  This is the format returned by
<tt>\fdate(<i>filename</i>)</tt>, so you can also use constructions like this:
<p><pre>
  send /after:\fdate(oofa.txt)
</pre><p>
which means "all files newer than oofa.txt".
<p>
Besides explicit dates, you can also use the any of the following shortcuts:
<dl>
<dt><b>TODAY</b>
<dd>Stands for the current date at 00:00:00.
<p>
<dt><b>TODAY 12:34:56</b>
<dd>Stands for the current date at the given time.
<p>
<dt><b>YESTERDAY</b>
<dd>Stands for yesterday's date at 00:00:00.  A time may also be given.
<p>
<dt><b>TOMORROW</b>
<dd>Stands for tomorrow's date at 00:00:00.  A time may also be given.
<p>
<dt><tt><b>+</b> </tt><i>number {</i> <b>DAYS, WEEKS, MONTHS, YEARS</b> <i>} [ time ]</i>
<dd>Is replaced by the future date indicated, relative to the current date.
If the time is omitted, 00:00:00 is used.  Examples: +3days, +2weeks,
+1year, +37months.
<p>
<dt><tt><b>-</b> </tt><i>number {</i> <b>DAYS, WEEKS, MONTHS, YEARS</b> <i>} [ time ]</i><p>
<dd>Is replaced by the past date indicated, relative to the current date.
If the time is omitted, 00:00:00 is used.
</dl>
<p>
The time can be separated from the date shortcut by any of the same separators
that are allowed for explicit date-times: space, hyphen, slash, period, or
underscore.  In switches and other space-delimited fields, use non-spaces
to separate date/time fields, or enclose the date-time in braces, e.g.:
<p><pre>
  purge /before:-4days_12:00:00
  purge /before:{- 4 days 12:00:00}
</pre><p>
Of course you can also use variables:
<p><pre>
  define \%n 43
  purge /before:-\%ndays_12:00:00
</pre><p>
Shortcut names can be abbreviated to any length that still distinguishes them
from any other name that can appear in the same context, e.g. "TOD" for today,
"Y" for yesterday.  Also, the special abbreviation "wks" is accepted for
WEEKS, and "yrs" for "YEARS".
<p>
(To see how to specify dates relative to a specific date, rather than the
current one, see the
<a href="#mjd"><tt>\fmjd()</tt> function description</a> below.)
<p>
You can check date formats with the DATE command.  DATE by itself prints the
current date and time in standard format: yyyymmdd hh:mm:ss.  DATE followed by
a date and/or time (including shortcuts) converts it to standard format if it
can understand it, otherwise it prints an error message.
<p>
The following variables and functions deal with dates and times; any function
argument designated as "date-time" can be in any of the formats described
above.
<p><dl>
<dt><b><tt>\v(day)</tt></b>
<dd>The first three letters of the English word for the current day of the
week, e.g. "Wed".
<p>
<dt><tt><b>\fday(</b><i>date-time</i><b>)</b></tt>
<dd>The first three letters of the English word for day of the week of
the given date.  If a time is included, it is ignored.  Example:
<tt>\fday(8 Feb 1988)</tt> = "Mon".
<p>
<dt><b><tt>\v(nday)</tt></b>
<dd>The numeric day of the week: 0 = Sunday, 1 = Monday, ..., 6 = Saturday.
<p>
<dt><tt><b>\fnday(</b><i>date-time</i><b>)</b></tt>
<dd>The numeric day of the week for the given date.  If a time is included, it
is ignored.  Example: \fnday(8 Feb 1988) = "1".
<p>
<dt><b><tt>\v(date)</tt></b>
<dd>The current date as dd mmm yyyy, e.g. "08 Feb 2000" (as in this example,
a leading zero is supplied for day-of-month less than 10).
<p>
<dt><b><tt>\v(ndate)</tt></b>
<dd>The current date in numeric format: yyyymmdd, e.g. "20000208".
<p>
<dt><b><tt>\v(time)</tt></b>
<dd>The current time as hh:mm:ss, e.g. "15:27:14".
<p>
<dt><tt><b>\ftime(</b><i>time</i><b>)</b></tt>
<dd>The given free-format date and/or time (e.g. "3pm") returns the time
(without the date) converted to hh:mm:ss 24-hour format, e.g. "15:00:00"
(the date, if given, is ignored).
<p>
<dt><b><tt>\v(ntime)</tt></b>
<dd>The current time as seconds since midnight, e.g. "55634".
<p>
<dt><b><tt>\v(tftime)</tt></b>
<dd>The elapsed time of the most recent file-transfer operation in seconds.
<p>
<dt><b><tt>\v(intime)</tt></b>
<dd>The elapsed time for the most recent INPUT command to complete, in
milliseconds.
<p>
<dt><tt><b>\fntime(</b><i>time</i><b>)</b></tt>
<dd>The given free-format date and/or time is converted to seconds since
midnight (the date, if given, is ignored).  This function replaces
<tt>\ftod2secs()</tt>, which is now a synonym for <tt>\fntime()</tt>.
Unlike <tt>\ftod2secs()</tt>,
<tt>\fntime()</tt> allows a date to be included, and it allows the time to be
in free format (like 3pm), and it allows the amount of time to be more than
24 hours.  E.g. <tt>\fntime(48:00:00) = 172800</tt>.  Example of use:
<pre>
  set alarm \fntime(48:00:00) ; set alarm 48 hours from now.
</pre>
<p>
<dt><tt><b>\fn2time(</b><i>seconds</i><b>)</b></tt>
<dd>The given number of seconds is converted to hh:mm:ss format.
<p>
<dt><tt><b>\fdate(</b><i>filename</i><b>)</tt></b>
<dd>Returns the modification date-time of the given file in standard format:
<tt><i>yyyymmdd hh:mm:ss</i></tt>.
<p>
<dt><tt><b>\fcvtdate(</b><i>date-time</i><b>)</b></tt>
<dd>Converts a free-format date and/or time to Kermit standard format:
<tt><i>yyyymmdd hh:mm:ss</i></tt>.  If no argument is given, returns the
current date-time in standard format.  If a date is given but no time, the
converted date is returned without a time.  If a time is given with no date,
the current date is supplied.  Examples:
<pre>
  \fcvtdate(4 Jul 2000 2:21:17pm) = 20000704 14:21:17
  \fcvtdate() = 20000704 14:21:17 <i>(on 4 Jul 2000 at 2:21:17pm).</i>
  \fcvtd(4 Jul 2000) = 20000704
  \fcvtd(6pm) = 20000704 18:00:00 <i>(on 4 Jul 2000 at 6:00pm).</i>
</pre><p>
<dt><tt><b>\fdayofyear(</b><i>date-time</i><b>)</b></tt>
<dt><tt><b>\fdoy(</b><i>date-time</i><b>)</b></tt>
<dd>Converts a free-format date and/or time to <tt><i>yyyyddd</i></tt>, where
<tt><i>ddd</i></tt> is the 3-digit day of the year, and 1 January is Day 1.
If a time is included with 
the date, it is returned in standard format.  If a date is included but no
time, the date is returned without a time.  If a time is given with no date,
the time is converted and the current date is supplied.  If no argument is
given, the current date-time is returned.  Synonym: <tt>\fdoy()</tt>.
Examples:
<p><pre>
  \fddayofyear(4 Jul 2000 2:21:17pm) = 2000185 14:21:17
  \fdoy() = 2000185 14:21:17 <i>(on 4 Jul 2000 at 2:21:17pm).</i>
  \fdoy(4 Jul 2000) = 2000185
  \fdoy(6pm) = 2000185 18:00:00 <i>(on 4 Jul 2000 at 6:00pm).</i>
</pre></dl>
<p>
Note: The yyyyddd day-of-year format is often erroneously referred to as a
<b>Julian date</b>.  However, a true Julian date is a simple counting number,
the number of days since a certain fixed day in the past.  
<a href="#mjd"><tt>See \fmjd()</tt> below</a>.
<p><dl>
<dt><tt><b>\fdoy2date(</b><i>date-time</i><b>)</b></tt>
<dd>Converts a date or date-time in day-of-year format to a standard format
date.  A yyyyddd-format date must be supplied; time is optional.  The
given date is converted to yyyymmdd format.  If a time is given, it is
converted to 24-hour format.  Examples:
<p><pre>
  \fdoy2date(2000185) = 20000704
  \fdoy2(2000185 3pm) = 20000704 15:00:00
</pre><p>
<dt><a name="mjd"><tt><b>\fmjd(</b><i>date-time</i><b>)</b></tt></a>
<dd>Converts free-format date and/or time to a <b>Modified Julian Date</b>
(MJD), the number of days since 17 Nov 1858 00:00:00.  If a time is given, it
is ignored.  Examples:
<p><pre>
  \fmjd(4 Jul 2000) = 50998
  \fmjd(17 Nov 1858) = 0
  \fmjd(16 Nov 1858) = -1
</pre><p>
<dt><b><tt>\fmjd2date(<i>mjd</i>)</tt></b>
<dd>Converts an MJD (integer) to standard date format, yyyymmdd:
<p><pre>
  \fmjd2(50998) = 4 Jul 1998
  \fmjd2(0) = 17 Nov 1858
  \fmjd2(-1) = 16 Nov 1858
  \fmjd2(-365) = 17 Nov 1857
</pre></dl>
<p>

MJDs are normal integers and, unlike DOYs, may be added, subtracted, etc, with
each other or with other integers, to obtain meaningful results.  For example,
to find out the date 212 days ago:
<p><pre>
  echo \fmjd2date(\fmjd()-212)
</pre><p>
Constructions such as this can be used in any command where a date-time
is required, e.g.:
<p><pre>
  send /after:\fmjd2date(\fmjd()-212)
</pre><p>
to send all files that are not older than 212 days (this is equivalent to
"send /after:-212days").
<p>
MJDs also have other regularities not exhibited by other date formats.  For
example, <tt>\fmodulus(\fmjd(<i>any-date</i>),7)</tt> gives the day of the
week for any date (where 4=Sun, 5=Mon, <tt>...</tt>, 3=Sat).  (However, it is
easier to use <tt>\fnday()</tt> for this purpose, and it gives the more
conventional result of 0=Sun, 1=Mon, <tt>...</tt>,
6=Sat).
<p>

Note that if MJDs are to be compared, they must be compared numerically (IF
&#60;, =, &#62;) and not lexically (IF LLT, EQUAL, LGT), whereas DOYs must be
compared lexically if they include a time (which contains ":" characters);
however, if DOYs do not include a time, they may also be compared numerically.

<p>

In any case, lexical comparison of DOYs always produces the appropriate
result, as does numeric comparison of MJDs.

<p>

The same comments apply to sorting.  Also note that DOYs are fixed length, but
MJDs can vary in length.  However, all MJDs between 3 April 1886 and 30 Aug
2132 are 5 decimal digits long.  (MJDs become 6 digits long on 31 Aug 2132,
and 7 digits long on 13 Oct 4596).

<p>
<hr>
<h3><a name="x1.7">1.7. Partial Completion of Keywords</a></h3>

Partial completion of keywords was added in C-Kermit 7.0.  In prior versions,
if completion was attempted (by pressing the Esc or Tab key) on a string that
matched different keywords, you'd just get a beep.  Now Kermit completes up to
the first character where the possibly matching keywords differ and then
beeps.  For example:
<p><pre>
  C-Kermit&#62; <u>send /n&#60;Tab&#62;</u>
</pre><p>
which matches /NOT-BEFORE and /NOT-AFTER, now completes up to the dash:
<p><pre>
  C-Kermit&#62; <u>send /n&#60;Tab&#62;</u>ot-&#60;Beep&#62;
</pre><p>
Partial completion works for filenames too (as it has for some years).

<p>
<hr>
<h3><a name="x1.8">1.8. Command Recall</a></h3>

C-Kermit has had a command history buffer for some time, which could be
scrolled interactively using control characters or (in Kermit 95 only) arrow
keys.  Version 7.0 adds a REDO command that allows the most recent command
matching a given pattern to be re-executed:
<p><dl>
<dt><i>{</i> <b>REDO, RR, <tt>^</tt></b> <i>} [ pattern ]</i>
<dd>Search the command history list for the most recent command that matches
the given pattern, and if one is found, execute it again.
</dl>
<p>

The pattern can be a simple string (like "send"), in which case the last SEND
command is re-executed.  Or it can contain wildcard characters "*" and/or "?",
which match any string and any single character, respectively (note that "?"
must be preceded by backslash to override its normal function of giving help),
and in most C-Kermit versions may also include <tt>[]</tt> character lists and
<tt>{}</tt> string lists (see <a href="#x4.9">Section 4.9</a>).
<p>
The match works by appending "*" to the end of the given pattern (if you
didn't put one there yourself).  Thus "redo *oofa" becomes "redo *oofa*" and
therefore matches the most recent command that contains "oofa" anywhere within
the command.  If you want to inhibit the application of the trailing "*",
e.g. to force matching a string at the end of a command, enclose the pattern
in braces:
<p><pre>
  redo {*oofa}
</pre><p>
matches the most recent command that ends with "oofa".
<p>
REDO commands themselves are not entered into the command history list.  If no
pattern is given, the previous (non-REDO) command is re-executed.  The REDOne
command is reinserted at the end of the command history buffer, so the command
scrollback character (Ctrl-P, Ctrl-B, or Uparrow) can retrieve it.
<p>
Examples:
<p><pre>
  C-Kermit&#62; <u>echo foo</u>
  foo
  C-Kermit&#62; <u>show alarm</u>
  (no alarm set)
  C-Kermit&#62; <u>echo blah</u>
  blah
  C-Kermit&#62; <u>redo</u>          ; Most recent command
  blah
  C-Kermit&#62; <u>redo s</u>        ; Most recent command starting with "s"
  (no alarm set)
  C-Kermit&#62; <u>redo echo f</u>   ; Most recent command starting with "echo f"
  foo
  C-Kermit&#62; <u>redo *foo</u>     ; Most recent command that has "foo" in it
  foo
  C-Kermit&#62; <u><i>&#60;Ctrl-P&#62;</i></u>      ; Scroll back
  C-Kermit&#62; <u>echo foo</u>      ; The REDOne command is there
  C-Kermit&#62; <u>redo {*foo}</u>   ; Most recent command that ends with "foo"
  foo
  C-Kermit&#62;
</pre><p>
Since REDO, REDIAL, and REDIRECT all start the same way, and RED is the
designated non-unique abbreviation for REDIAL, REDO must be spelled out in
full.  For convenience, RR is included as an invisible easy-to-type synonym
for REDO.  You can also use the "^" character for this:
<p><pre>
  C-Kermit&#62; <u>^</u>             ; Most recent command
  C-Kermit&#62; <u>^ s</u>           ; Most recent command starting with "s"
  C-Kermit&#62; <u>^s</u>            ; Ditto (space not required after "^").
  C-Kermit&#62; <u>^*foo</u>         ; Most recent command that has "foo" in it.
  C-Kermit&#62; <u>^{*foo}</u>       ; Most recent command ends with "foo".
</pre><p>
Unlike the manual command-history-scrolling keys, the REDO command can be
used in a script, but it's not recommended (since the command to be REDOne
might not be found, so if the REDO command fails, you can't tell whether it
was because REDO failed to find the requested command, or because the command
was found but it failed).

<p>
<hr>
<h3><a name="x1.9">1.9. EXIT Messages</a></h3>

The EXIT and QUIT commands now accept an optional message to be printed.
This makes the syntax of EXIT and QUIT just like END and STOP:
<p>
<i>{</i> <b>EXIT, QUIT, END, STOP</b> <i>} [ status-code [ message ] ]</i>
<p>
where <i>status-code</i> is a number (0 indicating success, nonzero indicating
failure).  This is handy in scripts that are never supposed to enter
interactive mode:
<p><pre>
  dial 7654321
  if fail exit 1 Can't make connection - try again later.
</pre><p>
Previously this could only be done in two steps:
<p><pre>
  dial 7654321
  xif fail { echo Can't make connection - try again later, exit 1 }
</pre><p>
A status code must be included in order to specify a message.  In the case
of EXIT and QUIT, the default status code is contained in the variable
<tt>\v(exitstatus)</tt>, and is set automatically by various events (file
transfer failures, etc; it can also be set explicitly with the SET EXIT STATUS
command).  If you want to give an EXIT or QUIT command with a message, but
without changing the exit status from what it normally would have been, use
the <tt>\v(exitstatus)</tt> variable, e.g.:
<p><pre>
   exit \v(existatus) Goodbye from \v(cmdfile).
</pre><p>
The EXIT status is returned to the system shell or whatever other process
invoked C-Kermit, e.g. in UNIX:
<p><pre>
  C-Kermit&#62; <u>exit 97 bye bye</u>
  bye bye
  $ <u>echo $?</u>
  97
  $
</pre>

<p>
<hr>
<h3><a name="x1.10">1.10. Managing Keyboard Interruptions</a></h3>

When C-Kermit is in command or file-transfer mode (as opposed to CONNECT
mode), it can be interrupted with Ctrl-C.  Version 7.0 adds the ability to
disarm the Ctrl-C interrupt:
<p><dl>
<dt><b>SET COMMAND INTERRUPT </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>COMMAND INTERRUPT is ON by default, meaning the Ctrl-C can be used to
  interrupt a command or a file transfer in progress.  Use OFF to disable
  these interruptions, and use it with great caution for obvious reasons.
<p>
<dt><b>SET TRANSFER INTERRUPT </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>This can be used to disable keyboard interruption of file transfer when
  C-Kermit is in local mode, or to re-enable it after it has been disabled.
  This applies to the X, Z, E, and similar keys as well as to the system
  interrupt character, usually Ctrl-C.  This is distinct from SET TRANSFER
  CANCELLATION, which tells whether packet mode can be exited by sending a
  special sequence of characters.
</dl>
<p>
Several other commands can be interrupted by pressing any key while they are
active.  Version 7.0 adds the ability to disable this form of interruption
also:
<p><dl>
<dt><b>SET INPUT CANCELLATION </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Whether an INPUT command in progress can be interrupted by pressing a key.
  Normally ON.  Setting INPUT CANCELLATION OFF makes INPUT commands
  uninterruptible except by Ctrl-C (unless COMMAND INTERRUPTION is also OFF).
<p>
<dt><b>SET SLEEP CANCELLATION </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Whether a SLEEP, PAUSE, or WAIT command in progress can be interrupted by
  pressing a key.  Normally ON.  Setting SLEEP CANCELLATION OFF makes these
  commands uninterruptible except by Ctrl-C (unless COMMAND INTERRUPTION is
  also OFF).  Synonyms: SET PAUSE CANCELLATION, SET WAIT CANCELLATION.
</dl><p>
So to make certain a script is not interruptible by the user, include these
commands:
<p><pre>
  SET TRANSFER INTERRUPT OFF
  SET SLEEP CANCELLATION OFF
  SET INPUT CANCELLATION OFF
  SET COMMAND INTERRUPTION OFF
</pre><p>
Make sure to turn them back on afterwards if interruption is to be
re-enabled.
<p>
When a PAUSE, SLEEP, WAIT, or INPUT command is interrupted from the keyboard,
the new variable <tt>\v(kbchar)</tt> contains a copy of the (first) character
that was 
typed and caused the interruption, provided it was not the command interrupt
character (usually Ctrl-C).  If these commands complete successfully or time
out without a keyboard interruption, the <tt>\v(kbchar)</tt> variable is empty.
<p>
The <tt>\v(kbchar)</tt> variable (like any other variable) can be tested with:
<p><pre>
  if defined \v(kbchar) <i>command</i>
</pre><p>
The <i>command</i> is executed if the variable is not empty.
<p>
The <tt>\v(kbchar)</tt> variable can be reset with WAIT 0 (PAUSE 0, SLEEP 0,
etc).

<p>
<hr>
<h3><a name="x1.11">1.11. Taming The Wild Backslash -- Part Deux</a></h3>

<a href="ckb2.html"><cite>Using C-Kermit</cite></a>, 2nd Edition, contains a brief section, "Taming the Wild
Backslash", on page 48, which subsequent experience has shown to be inadequate
for Kermit users intent on writing scripts that deal with Windows, DOS, and
OS/2 filenames, in which backslash (\) is used as the directory separator.
This section fills in the blanks.

<h4><a name="x1.11.1">1.11.1. Background</a></h4>

The Kermit command language shares a certain unavoidable but annoying
characteristic with most other command languages that are capable of string
replacement, namely the necessity to "quote" certain characters when you want
them to be taken literally.  This is a consequence of the facts that:
<p><ol>
<li>One or more characters must be set aside to denote replacement, rather
than acting as literal text.
<li>We have only 96 printable characters to work with in ASCII, which is
still the only universally portable character set.
<li>There is no single printable character that is unused everywhere.
<li>Variables are not restricted to certain contexts, as they are
in formal programming languages like C and Fortran, but can appear
anywhere at all within a command, and therefore require special syntax.
</ol>
<p>
Thus there can be conflicts.  To illustrate, the standard UNIX shell uses
dollar sign ($) to introduce variables.  So the shell command:
<p><pre>
  echo $TERM
</pre><p>
displays the value of the TERM variable, e.g. vt320.  But suppose you want to
display a real dollar sign:
<p><pre>
  echo The price is $10.20
</pre><p>
This causes the shell to evaluate the variable "<tt>$1</tt>", which might or might not
exist, and substitute its value, e.g.:
<p><pre>
  The price is 0.20
</pre><p>
(in this case the <tt>$1</tt> variable had no value.)  This is probably not
what you wanted.  To force the dollar sign to be taken literally, you must
apply a "quoting rule", such as "precede a character by backslash (<tt>\</tt>)
to force the shell to take the character literally":
<p><pre>
  echo The price is \$10.20
  The price is $10.20
</pre><p>
But now suppose you want the backslash AND the dollar sign to be taken
literally:
<p><pre>
  echo The price is \\$10.20
</pre><p>
This doesn't work, since the first backslash quotes the second one, thereby
leaving the dollar sign unquoted again:
<p><pre>
  The price is \0.20
</pre><p>
Quoting the dollar sign requires addition of a third backslash:
<p><pre>
  echo The price is \\\$10.20
  The price is \$10.20
</pre><p>
The first backslash quotes the second one, and the third backslash quotes
the dollar sign.
<p>
Every command language -- all UNIX shells, VMS DCL, DOS Batch, AOS/VS CLI, etc
etc -- has similar rules.  UNIX shell rules are probably the most complicated,
since many printable characters -- not just one -- are special there: dollar
sign, single quote, double quote, backslash, asterisk, accent grave, number
sign, ampersand, question mark, parentheses, brackets, braces, etc --
practically every non-alphanumeric character needs some form of quoting if it
is to be taken literally.  And to add to the confusion, the UNIX shell offers
many forms of quoting, and many alternative UNIX shells are available, each
using slightly different syntax.

<p>
<hr>
<h4><a name="x1.11.2">1.11.2. Kermit's Quoting Rules</a></h4>

Kermit's basic quoting rules are simple by comparison (there are, of course,
additional syntax requirements for macro definitions, command blocks, function
calls, etc, but they are not relevant here).
<p>
The following characters are special in Kermit commands:
<p>
<dl>
<dt><b>Backslash (<tt>\</tt>)</b>
<dd>Introduces a variable, or the numeric representation of a special
character, or a function, or other item for substitution.  If the backslash is
followed by a digit or by any of the following characters:
<p><pre>
  x, o, d, m, s, f, v, $, %, &#38;, :, {
</pre><p>
this indicates a special substitution item; otherwise the following
character is to be taken literally (exceptions: \ at end of line is taken
literally; \n, \b, and \n are special items in the OUTPUT command only).
<p>
<dt><b>Semicolon (<tt>;</tt>)</b>
<dd>(Only when at the beginning of a line or preceded by at least one space
or tab)  Introduces a comment.
<p>
<dt><b>Number sign (<tt>#</tt>)</b>
<dd>(Only when at the beginning of a line or preceded by at least one space
or tab)  Just like semicolon; introduces a comment.
<p>
<dt><b>Question mark (<tt>?</tt>)</b>
<dd>(Only at the command prompt - not in command files or macros)  Requests
context-sensitive help.
</dl><p>
To force Kermit to take any of these characters literally, simply precede it
by a backslash (<tt>\</tt>).
<p>
Sounds easy!  And it is, except when backslash also has a special meaning to
the underlying operating system, as it does in DOS, Windows, and OS/2, where
it serves as the directory separator in filenames such as:
<p><pre>
  D:\K95\KEYMAPS\READ.ME
</pre><p>
Using our rule, we would need to refer to this file in Kermit commands as
follows:
<p><pre>
  D:\\K95\\KEYMAPS\\READ.ME
</pre><p>
But this would not be obvious to new users of Kermit software on DOS, Windows,
or OS/2, and it would be annoying to seasoned ones.  Thus MS-DOS Kermit and
Kermit 95 go to rather extreme lengths to allow the more natural notation, as
in:
<p><pre>
  send d:\k95\keymaps\read.me
</pre><p>
The reason this is tricky is that we also need to allow for variables and
other expressions introduced by backslash in the same command.  For example,
suppose <tt>\%a</tt> is a variable whose value is "oofa" (without the quotes).
What does the following command do?
<p><pre>
  send d:\%a
</pre><p>
Does it send the file named "oofa" in the current directory of the D: disk, or
does it send a file named "%a" in the root directory of the D: disk?  This is
the kind of trouble we get into when we attempt to bend the rules in the
interest of user friendliness.  (The answer is: if the variable \%a has
definition that is the name of an existing file, that file is sent; if a file
d:\%a exists, it is sent; otherwise if both conditions are true, the variable
takes precedence, and the literal filename can be forced by quoting: \\%a.)
<p>
In Kermit 95 (but not MS-DOS Kermit), we also bend the rules another way by
allowing you to use forward slash (/) rather than backslash (\) as the
directory separator:
<p><pre>
  send d:/k95/keymaps/read.me
</pre><p>
This looks more natural to UNIX users, and in fact is perfectly acceptable to
the Windows 95/98/NT and OS/2 operating systems on the API level.  BUT (there
is always a "but") the Microsoft shell, COMMAND.COM, for Windows 95/98 and NT
does not allow this notation, and therefore it can not be used in any Kermit
command -- such as RUN -- that invokes the Windows command shell AND your
command shell is COMMAND.COM or any other shell that does not allow forward
slash as directory separator (some alternative shells do allow this).
<p><blockquote>
  NOTE: There exists a wide variety of alternative shells from third
  parties that do not have this restriction.  If you are using a shell
  that accepts forward slash as a directory separator, you can stop
  reading right now -- UNLESS (there is always an "unless") you want your
  scripts to be portable to systems that have other shells.  Also note
  that some Windows shells might actually REQUIRE forward slashes
  (instead of backslashes) as directory separators; we do not treat this
  situation below, but the treatment is obvious -- use slash rather
  backslash as the directory separator.
</blockquote>

<p>
<hr>
<h4><a name="x1.11.3">1.11.3. Passing DOS Filenames from Kermit to Shell Commands</a></h4>

The following Kermit commands invoke the system command shell:
<p><pre>
  RUN (and its synonyms ! and @)
  REDIRECT
  PIPE
</pre><p>

Each of these commands takes a shell command as an operand.  These shell
commands are not, and can not be, parsed by Kermit since Kermit does not know
the syntax of shell commands, and so can't tell the difference between a
keyword, a filename, a variable, a switch, or other item.  Therefore the rules
can not be bent since Kermit doesn't know where or how to bend them.  To
illustrate (using the regular Windows shell):
<p><pre>
  run c:\\windows\\command\\chkdsk.exe
</pre><p>
works OK, but:
<p><pre>
  run c:/windows/command/chkdsk.exe
</pre><p>
is not accepted by COMMAND.COM.  But:
<p><pre>
  run c:\windows\command\chkdsk.exe
</pre><p>
results in Kermit applying its quoting rules before sending the text to the
shell.  Since "w" and "c" are not in the list of backslash-item codes, the
backslash means "take the following character literally".  Thus, by the
time this filename gets to the Windows shell, it has become:
<p><pre>
  c:windowscommandchkdsk.exe
</pre><p>
which is probably not what you wanted.  (If "w" and "c" were in the list,
the results could be even stranger.)  Even more confusing is the case where
a directory or filename starts with one or more digits:
<p><pre>
  run c:\123\lotus.exe
</pre><p>
in which "<tt>\123</tt>" is the Kermit notation for ASCII character 123, which
happens to be left brace (<tt>{</tt>), resulting in "<tt>c:{lotus.exe</tt>".
<p>
So when passing filenames to a Windows shell, always use double backslashes as
directory separators, to ensure that the shell gets single backslashes:
<p><pre>
  run c:\\windows\\command\\chkdsk.exe
  run c:\\123\\lotus.exe
</pre><p>
Similar problems might occur with the built-in EDIT, BROWSE, and FTP commands.
These commands result in Kermit building a shell command internally to invoke
the associated helper program; the form of this command might conflict with
the form demanded by certain alternative shells.

<p>
<hr>
<h4><a name="x1.11.4">1.11.4. Using Variables to Hold DOS Filenames</a></h4>

Now to the next level.  Suppose you want to write a script in which filenames
are parameters, and therefore are stored in variables.  Example:
<p><pre>
  define \%f c:\windows\command\chkdsk.exe
  ...
  run \%f
</pre><p>
Obviously this won't work for the reasons just noted; the RUN command requires
directory separators be coded as double backslashes:
<p><pre>
  define \%f c:\\windows\\command\\chkdsk.exe
  ...
  run \%f
</pre><p>
This will work; no surprises here.  However, if you had used ASSIGN rather
than DEFINE, you might have been surprised after all; review pages 348-349 of
<a href="ckb2.html"><cite>Using C-Kermit</cite></a> (2nd Ed) for the difference between DEFINE and ASSIGN.
<p>
We have said that any Kermit 95 or MS-DOS Kermit command that parses filenames
itself -- SEND, for example -- does not require double backslashes since it
knows it is parsing a filename.  So since the following works:
<p><pre>
  send c:\windows\command\chkdsk.exe
</pre><p>
Should the following also work?
<p><pre>
  define \%f c:\windows\command\chkdsk.exe
  ...
  send \%f
</pre><p>
Answer: No.  Why?  Because <tt>\%f</tt> is evaluated "recursively", to allow
for the 
possibility that its definition contains further variable references.  This is
true of all "backslash-percent-letter" (or -digit) variables, and also for
array references.  So <tt>\%f</tt> becomes
<tt>c:\windows\command\chkdsk.exe</tt>, which
becomes <tt>c:windowscommandchkdsk.exe</tt>.
<p>
The trick here is to use the "other" kind of variable, that is evaluated
only "one level deep" rather than recursively:
<p><pre>
  define filename c:\windows\command\chkdsk.exe
  ...
  send \m(filename)
</pre><p>
Similarly if you want to prompt the user for a filename:
<p><pre>
  ask filename { Please type a filename: }
   Please type a filename: c:\windows\command\chkdsk.exe
  send \m(filename)
</pre>

<p>
<hr>
<h4><a name="x1.11.5">1.11.5. Passing DOS Filenames as Parameters to Macros</a></h4>

Suppose you want to pass a DOS filename containing backslashes as a parameter
to a Kermit macro.  This raises two issues:
<p><ol>
<li>Parameters to macros are "just text" and so are fully evaluated before
they are passed to the macro.
<li>Once inside the macro, the formal parameters \%1, \%2, ... \%9 are the
type of variable that is evaluated recursively.
</ol>
<p>
Thus a DOS filename is ruined once in the act of parsing the macro invocation,
and again when referring to it from within the macro.  To illustrate, suppose
"test" is a macro.  Then in the invocation:
<p><pre>
  test c:\mydir\blah.txt
</pre><p>
"<tt>c:mydirblah.txt</tt>" is assigned to <tt>\%1</tt>.  However, if we double
the backslashes:
<p><pre>
  test c:\\mydir\\blah.txt
</pre><p>
"<tt>c:\mydir\blah.txt</tt>" is assigned to <tt>\%1</tt>.  But then when you
refer to \%1 in the macro, it is evaluated recursively, resulting in
"<tt>c:mydirblah.txt</tt>".  To illustrate:
<p><pre>
  define test echo \%1
  test c:\mydir\blah.txt
  c:mydirblah.txt
  test c:\\mydir\\blah.txt
  c:mydirblah.txt
  test c:\\\\mydir\\\\blah.txt
  c:\mydir\blah.txt
</pre><p>
Let's address each part of the problem separately.  First, inside the macro.
You can use the <tt>\fcontents()</tt> function to force a backslash-percent
variable (such as a macro argument) to be evaluated one level deep instead of
recursively, for example:
<p><pre>
  define test echo { The filename is "\fcontents(\%1)"}

  test c:\mydir\blah.txt               ; We don't expect this to work
   The filename is "c:mydirblah.txt"   ; and it doesn't.
  test c:\\mydir\\blah.txt             ; But this does...
   The filename is "c:\mydir\blah.txt"
</pre><p>
Thus if the filename arrives inside the macro with single backslashes, the
backslashes are preserved if you always refer to the parameter through the
<tt>\fcontents()</tt> function.
<p>
Now how to ensure that backslashes are not stripped or misinterpreted when
passing a filename to a macro?  This brings us back to what we learned in
earlier sections:
<p><ol>
<li>If it is a literal filename, either double the backslashes, or (if the
filename is to be used only within Kermit itself and not passed to a
DOS shell, or it is to be passed to an alternative shell that accepts
forward slash as a directory separator), use forward slash instead of
backslash as the directory separator.
<p>
<li>If it is a variable that contains a filename, make sure you use a
macro-style variable name, rather than a backslash-percent-character
name.
</ol>
<p>
Examples:
<p><pre>
  define test echo \fcontents(\%1)
  define filename c:\mydir\blah.txt

  test c:\\mydir\\blah.txt  ; Literal filename with double backslashes
  c:\mydir\blah.txt

  test c:/mydir/blah.txt    ; Literal filename with forward slashes
  c:/mydir/blah.txt

  test \m(filename)         ; Variable
  c:\mydir\blah.txt
</pre><p>
But what if you don't like these rules and you still want to pass a literal
filename containing single backslashes to a macro?  This is possible too, but
a bit tricky: turn command quoting off before invoking the macro, and then
turn it back on inside the macro.  Example:
<p><pre>
  define test set command quoting on, echo \fcontents(\%1)

  set command quoting off
  test c:\mydir\blah.txt
  c:\mydir\blah.txt
</pre><p>
Upon return from the macro, command quoting is back on (since the macro
turned it on).
<p>
Obviously this trick can not be used if the filename is stored in a variable,
since it prevents the variable from being evaluated.

<p>
<hr>
<h4><a name="x1.11.6">1.11.6. Passing DOS File Names from Macro Parameters to the DOS Shell</a></h4>

Now suppose you need to pass a DOS filename to a macro, and the macro needs
to pass it, in turn, to the Windows shell via (say) Kermit's RUN command.
This works too:
<p><pre>
  define xrun run \fcontents(\%1)
  xrun c:\\windows\\command\\chkdsk.exe
</pre><p>
(or you can use the SET COMMAND QUOTING OFF / ON technique described above
to avoid the double backslashes.)  But..
<p><pre>
  xrun c:/windows/command/chkdsk.exe
</pre><p>
does not work if the Windows shell does not recognize "/" as a directory
separator.  If there is a chance that a filename might be passed to the macro
in this form, the macro will need to convert it to a form acceptable to the
shell:
<p><pre>
  define xrun run \freplace(\fcontents(\%1),/,\\)
</pre><p>
Here we replace all occurrences (if any) of "<tt>/</tt>" in the argument with
"<tt>\</tt>" prior 
to issuing the RUN command.  Of course, in order to specify "<tt>\</tt>" as a
literal character in the <tt>\freplace()</tt> argument list, we have to double
it.

<p>
<hr>
<h4><a name="x1.11.7">1.11.7. Passing DOS Filenames to Kermit from the Shell</a></h4>

As noted in the manual, the <tt>\&#38;@[]</tt> array contains Kermit's
command-line arguments.  Suppose one of these arguments, say
<tt>\&#38;@[3]</tt>, is a DOS filename such as
<tt>C:\FOO\BAR\BAZ\OOFA.TXT</tt>.  (Note: In C-Kermit 7.0 and K95 1.1.18 and
later, command-line arguments after "<tt>=</tt>" or "<tt>--</tt>" are also
available in the top-level <tt>\%1..9</tt> variables; see 
<a href="#x7.5">Section 7.5</a>.)

<p>

Of course you can eliminate any problems by using forward slashes rather
than backslashes in the filename, but sometimes this is not possible, as when
the Kermit command line is being generated by another program than can only
generate "native" format DOS filenames.

<p>

As noted in the manual, "<tt>\%x</tt>" variables and <tt>\&#38;x[]</tt> arrays
are always evaluated "all the way" (recursively).  If the contents of one of
these variables contains backslashes, this causes another level of evaluation.

<p>

There is another kind of variable, which is evaluated only "one level deep".
You can use this to prevent interpretation of the backslashes in the
filenames.  Example:
<p><pre>
  assign filename \fcontents(\&#38;@[3])  ; Transfer contents
  ...
  send \m(filename)
</pre><p>
Or, more simply:
<p><pre>
  send \fcontents(\&#38;@[3])
</pre>
<p>
<hr>

<h3><a name="x1.12">1.12. Debugging</a></h3>

The debug log is produced when you give a "log debug" command.  This is
normally done at the request of the Kermit help desk, for forwarding to the
Kermit developers for analysis as a last resort in troubleshooting problems.
(Last resort because it can grow quite huge in a very short time.)  In cases
where timing information is critical to understanding a problem, you can
tell C-Kermit to put a timestamp on each debug log line by giving the command:
<p><pre>
  SET DEBUG TIMESTAMP ON
</pre><p>
At any time before or after activating the debug log (SET DEBUG TIMESTAMP OFF
turns off timestamping).  Timestamps can be turned off and on as desired while
logging.  Obviously, they increase the size and growth rate of the log
significantly, and so should be used sparingly.  Timestamps are of the form
hh:mm:ss.xxx, where .xxx is thousands of a second (but is included only on
platforms that include this feature).

<p>
<hr>
<h3><a name="x1.13">1.13. Logs</a></h3>

In UNIX C-Kermit and in K-95, you can now direct any log to a pipe.  This
not only lets you send your logs to places other than disk files, but also
lets you customize them to any desired degree.
<p><dl>
<dt><b>LOG</b> <i>{</i> <b>DEBUG, PACKETS, SESSION, TRANSACTION, CONNECTION</b> <i>} { file, pipe }</i> <tt>...</tt></b>
<dd>A "pipe" is the name of a command, preceded by a vertical bar.  If the
pipe contains any spaces, it must be enclosed in braces.
</dl><p>

Here are some examples for UNIX (always remember the importance of getting
the UNIX shell quoting rules right):
<p><dl>
<dt><tt>LOG TRANSACTIONS |lpr</tt>
<dd>This sends the transaction log to the default UNIX printer, rather than
to a file (use "lp" rather than "lpr" if necessary).
<p>
<dt><tt>LOG TRANSACTIONS {| myfilter &#62; t.log}</tt>
<dd>For those who don't like the format of the transaction log, or want to
extract certain information from it; write your own output filter.
<p>
<dt><tt>LOG SESSION {| lpr -Plaserwriter}</tt>
<dd>This sends the session log to a specific UNIX printer, rather than to a
  file.  Note the braces around the pipeline.  These are required because
  it contains spaces.
<p>
<dt><tt>LOG DEBUG {| tail -100 &#62; debug.log}</tt>
<dd>This causes the debug log file to contain only the final 100 lines.
  Suppose C-Kermit crashes under some unpredictable circumstances, and
  you need a debug log to catch it in the act.  But the debug log can grow
  to huge proportions very quickly, possibly filling up the disk.  Piping
  the debug log through "tail" results in keeping only the last 100 lines
  (or other number of your choice).
<p>
<dt><tt>LOG DEBUG {| grep "^TELNET" &#62; debug.log}</tt>
<dd>This one shows how to log only Telnet negotiations.  Piping the debug log
  through grep or egrep lets you log only specific information, rather than
  everything.  "man grep" for further info.
<p>
<dt><tt>LOG DEBUG {| gzip -c &#62; debug.log.gz}</tt>
<dd>Creates a full debug log, but compressed by gzip to save space.
<p>
<dt><tt>LOG PACKETS {| tr "\\01" "X" | cut -c9- &#62; packet.log}</tt>
<dd>This one writes the regular packet log, but translates the Ctrl-A that
  starts each packet to the letter "X" and removes the s-nn-nn- notation
  from the beginning of each line.  Note the double backslash (normal Kermit
  quoting rules).  "man tr" and "man cut" for further info.
</dl><p>
See 
<a href="#x2.12">Section 2.12</a> for information about the new connection log.

<p>
<hr>
<h3><a name="x1.14">1.14. Automatic File-Transfer Packet Recognition at the Command Prompt</a></h3>

Beginning in version 7.0, C-Kermit can recognize Kermit (and in some cases
also Zmodem) file-transfer packets while at its command prompt.  This is
convenient (for example), if you escaped back from a remote Kermit program
and told the local Kermit program to send a file, but forgot to tell the
remote Kermit program to receive it (and the local Kermit did not have the
"send a Kermit receive command" feature available).  This feature is
controlled by the following command:
<p><dl>
<dt><b>SET COMMAND AUTODOWNLOAD </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>When ON, which is the default, the command parser recognizes Kermit
  packets when Kermit is in remote mode.  An S packet makes it go into
  receive mode, an I packet makes it go into server mode.  When OFF, packet
  recognition is disabled and the behavior when a packet is received at the
  command prompt is as it was in C-Kermit 6.1 and earlier (namely to print
  an error message).
</dl><p>
COMMAND AUTODOWNLOAD is the command-mode equivalent of TERMINAL AUTODOWNLOAD,
which is effective during CONNECT mode.

<p>
<hr>
<h3><a name="x1.15">1.15. The TYPE Command</a></h3>

The TYPE command now accepts a selection of optional switches
(<a href="#x1.5">Section 1.5</a>), and also sets several variables.
<p>
Syntax: <b>TYPE</b> <i>[ switches... ] filename</i>
<p>
Variables:
<dl>
<dt><tt><b>\v(ty_ln)</b></tt>
<dd>Line number of current line (during TYPE command; see /PREFIX)
<p>
<dt><tt><b>\v(ty_lc)</b></tt>
<dd>Line count of file most recently TYPEd.
<p>
<dt><tt><b>\v(ty_mc)</b></tt>
<dd>Match count of file most recently TYPEd (see /MATCH).
</dl>
<p>

Switches:
<p><dl>
<dt><b>/PAGE</b>
<dd>If /PAGE is included, Kermit pauses at the end of each screenful and issues
a "more?" prompt.  You may press the space bar to view the next page
(screenful), or press "q" or "n" to return to the C-Kermit prompt.  If this
switch is given, it overrides the COMMAND MORE-PROMPTING setting for this
command only.  If it is not given, paging is according to COMMAND
MORE-PROMPTING.
<p>
<dt><b>/NOPAGE</b>
<dd>Do not pause at the end of each screenful; show the whole file (or all
selected lines) at once.  If this switch is given, it overrides the COMMAND
MORE-PROMPTING setting for this command only.  If it is not given, paging is
according to COMMAND MORE-PROMPTING.
<p>
<dt><b>/HEAD</b><i>[</i><b>:</b><i>n]</i>
<dd>Only show the first <i>n</i> lines of the file (where <i>n</i> is a
number).  If <i>n</i> is omitted, 10 is used.
<p>
<dt><b>/TAIL</b><i>[</i><b>:</b><i>n]</i>
<dd>Only show the last <i>n</i> lines of the file (where <i>n</i> is a
number).  If <i>n</i>is
omitted, 10 is used.  Note: /HEAD and /TAIL can't be combined; if you give
both switches, only the most recent one is used.
<p>
<dt><b>/MATCH:</b><i>pattern</i>
<dd>Only type lines from the file that match the given pattern (see
<a href="#x4.9.1">Section 4.9.1</a> for pattern notation).  UNIX users
familiar with grep should note a significant difference: there is no implied
"*" at the beginning and end of the pattern.  Thus:
<p><pre>
  TYPE /MATCH:foo    Lists lines whose entire contents are "foo".
  TYPE /MATCH:foo*   Lists lines that start with "foo".
  TYPE /MATCH:*foo   Lists lines that end with "foo".
  TYPE /MATCH:*foo*  Lists lines that have "foo" anywhere in them.
</pre><p>
/HEAD and /TAIL apply after /MATCH, so "<tt>type /tail:20 /match:x*</tt>"
shows the last 20 lines in the file that start with "<tt>x</tt>".
<p>
<dt><b>/PREFIX:</b><i>string</i>
<dd>Print the given string at the beginning of each line.  The string may be a
  constant, a variable, or a quoted variable.  If it's an unquoted variable,
  its value at the time the TYPE command was given is used as a constant.
  If it is a quoted variable, it is re-evaluated for each line; a useful
  variable for this context is \v(ty_ln) (the line number of the current line
  being typed).  If the prefix is to include spaces, it must be enclosed in
  braces.  Examples:
<p><dl>
<dt><tt>type /prefix:{oofa.txt: } /match:*thing* oofa.txt</tt>
<dd>Prints all lines in oofa.txt that contain "thing" with the filename
    itself as the prefix (similar to UNIX grep).
<p>
<dt><tt>type /prefix:{\v(time). } oofa.txt</tt>
<dd>Prefixes each line of oofa.txt with the time at which the TYPE command
was given (one backslash)
<p>
<dt><tt>type /prefix:{\\v(time). } oofa.txt</tt>
<dd>Prefixes each line of oofa.txt with the time at which that line is
being typed (two backslashes).
<p>
<dt><tt>type /prefix:{\\v(ty_ln). } oofa.txt</tt>
<dd>Prefixes each line of oofa.txt with its line number.
<p>
<dt><tt>type /prefix:{\\flpad(\\v(ty_ln),4). } oofa.txt</tt>
<dd>Same as the previous example, except the line number is right-adjusted
in a 4-column field.
</dl><p>
<dt><b>/WIDTH</b><i>[</i><b>:</b><i>n]</i>
<dd>Truncates each line at column <i>n</i> (which must be a number) prior to
printing it.  This option can be used for long lines when you don't want them
to wrap.  If <i>n</i>is omitted, your current screen width is used.
<p>
<dt><b>/COUNT</b>
<dd>Counts lines and -- if /MATCH was included, matches -- but does not print
any lines from the file.  The line and match count is shown at the end,
and the variables <tt>\v(ty_lc)</tt> and <tt>\v(ty_lm)</tt> are set
accordingly.
<p>
<dt><b>SET OPTIONS TYPE</b> <i>{</i> <b>/PAGE, /NOPAGE, /WIDTH:</b><i>n }</i>
<dd>Sets the paging default for TYPE commands, which can be overridden in any
particular TYPE command by including the desired switch.
</dl><p>
If a TYPE command is given with no switch, and no SET OPTIONS TYPE selection
is in effect, paging is according to your COMMAND MORE-PROMPTING setting
(SHOW COMMAND).

<p>
<hr>
<h3><a name="x1.16">1.16. The RESET Command</a></h3>

The RESET command, added in 7.0, closes all open files and logs, but does not
affect the open connection (if any).

<p>
<hr>
<h3><a name="x1.17">1.17. The COPY and RENAME Commands</a></h3>

As of C-Kermit 7.0, in the UNIX version only, the COPY and RENAME commands are
built in and do not call the underlying platform's COPY or RENAME command.
This allows them to work in "NOPUSH" versions and other circumstances where it
can't access system commands, and it allows file copying and renaming to be
done portably in scripts.  The characteristics of the built-in COPY or RENAME
include:
<ul><p>
<li>It fails if the source file is a directory or is wild or lacks read access.
<li>It fails if the source file is the destination file.
<li>It allows the destination file to be a directory, in which case the source
   file is copied (or renamed) into it with the same name.
<li>It overwrites an existing destination file if its permission allows.
<li>It sets the new file's permission according to umask but also carries
   forward the source file's execute permission bits if the destination file
   did not already exist.
<li>It fails if interrupted by Ctrl-C.
<li>Upon error, it prints an appropriate message.
<li>It returns standardized error codes that can be tested by IF SUCCESS /
FAIL.
</ul>
<p>
These commands now also accept the following switches:
<p><pre>
  /LIST (/LOG, /VERBOSE)    = Print "file1 =&#62; file2 (OK)" (or error message).
  /NOLIST (/NOLOG, /QUIET)  = Don't print anything (except error messages).
</pre><p>
/NOLIST is the default.
<p>
The same built-in code is used by the UNIX C-Kermit server to execute REMOTE
COPY commands (except in this case no switches are available).
<p>
The COPY command also accepts the following additional switches.  When any of
these are given (and they can be used in any combination except /SWAP and
/APPEND), some of the checks listed above are relaxed, and thus it might be
possible to get into trouble in certain cases, e.g. when the source and target
files are the same file:
<p><pre>
  /APPEND                   = Append source file to destination file.
  /SWAP-BYTES               = Swap bytes (see <a href="#x6.6.5">Section 6.6.5</a>).
  /FROMB64                  = Decode the source file from Base64 encoding.
  /TOB64                    = Encode the target file in Base64.
</pre><p>
Base64 is the encoding commonly used for enclosures in Internet email.

<p>
<hr>
<h3><a name="x1.18">1.18. The MANUAL Command</a></h3>

The MANUAL command can be used to access the appropriate Kermit manual or
other manual.  The general syntax is:
<p><dl>
<dt><b>MANUAL</b> <i>[ string ]</i>
<dd>If the string is omitted, C-Kermit asks the underlying system to access the
C-Kermit manual using whatever method is appropriate for the system.
</dl><p>
The specific action depends on the system.  In UNIX, a "man" command is
issued; "kermit" is the default argument but other manual topics may be
specified.  If the "man" command allows index or string searching, the
appropriate syntax may be included.
<p>
In Kermit 95, the MANUAL command brings up the HTML online K95 manual.
<p>
In VMS and elsewhere, "man" is simply translated to "help", with a default
argument of "kermit"; other and/or additional arguments may be included
according to the definition of the system's "help" command.
<p>
Correct operation of the "man" command in C-Kermit depends on the appropriate
man page or help topic having been installed in the right place with the
right permissions and format.

<p>
<hr>
<h3><a name="x1.19">1.19. String and Filename Matching Patterns</a></h3>

A pattern is a string that includes special notation for matching classes or
sequences of characters.  C-Kermit 7.0 / K95 1.1.19 supports patterns in
several places:
<p><ul>
<li>Filenames (<a href="#x4.9">Section 4.9</a>)
<li>SWITCH case labels (<a href="#x7.18">Section 7.18</a>)
<li>The new IF MATCH statement (<a href="#x7.4">Section 7.4</a>)
<li>TYPE /MATCH (<a href="#x1.15">Section 1.15</a>)
<li>SET FILE TEXT-PATTERNS and BINARY-PATTERNS (<a href="#x4.3">Section 4.3</a>)
<li>The <tt>\fsearch()</tt> and <tt>\farraylook()</tt> functions (<a href="#x7.3">Sections 7.3</a> and <a href="#x7.10.7">7.10.7</a>)
<li>The <tt>\fpattern()</tt> function used with [M,RE]INPUT (<a href="#x7.1">Section 7.1</a>)
</ul><p>
Patterns are also called wildcards, especially when used for filename
matching.  C-Kermit's pattern syntax is explained in 
<a href="#x4.9.1">Section 4.9.1</a>, and also
by the HELP WILDCARDS command.

<p>
<hr>
<h3><a name="x1.20">1.20. Multiple Commands on One Line</a></h3>

As of C-Kermit 7.0, commands can be grouped together on one line by separating
the commands with commas and enclosing the list in braces.  For example:
<p><pre>
  C-Kermit&#62; <u>{ echo One, echo Two, echo Three }</u>
  C-Kermit&#62; <u>do { echo One, echo Two, echo Three }</u>
</pre><p>
Command lists can be nested:
<p><pre>
  <i>[</i> do <i>]</i> { echo One, echo Two, if true { echo A, echo B}, echo Three }
</pre><p>
and the END command works as it does in macros:
<p><pre>
  <i>[</i> do <i>]</i> { echo One, echo Two, if true end, echo Three }
</pre><p>
The "one line" stricture is, of course, pliant to line-continuation
conventions, namely that lines ending in hyphen (-) or left brace ({) are
to be continued.  Thus the first example can also be rendered:
<p><pre>
  <i>[</i> do <i>]</i> {
      echo One
      echo Two
      echo Three
  }
</pre><p>
(the "do" is optional).

<p>
<hr>
<h3><a name="x1.21">1.21. What Do I Have?</a></h3>

C-Kermit can be built for hundreds of different platforms with practically
countless configuration options.  Certain commands might not be available in
certain configurations, etc.  Even on the same platform, different builds are
possible: "maximum functionality", "minimum size", "maximum performance", and
so on.  You can find out a lot about the configuration of your C-Kermit
program with the SHOW FEATURES command.  Of course, a lot of what it says,
especially in the bottom part, might seem like gibberish, but can be
deciphered with a Rosetta Stone (such as the C-Kermit source or the
<a href="ftp://kermit.columbia.edu/kermit/f/ckccfg.txt">ckccfg.txt</a>
file).  In any case, the output from SHOW FEATURES might easily explain why
some expected feature is missing, or some buffer is smaller than expected.
Here's a sample of the bottom section for the SunOS version:
<p><pre>
C-Kermit 7.0.196, 1 Jan 2000

Major optional features included:
 Network support (type SHOW NET for further info)
 Telnet Kermit Option
 Hardware flow control
 External XYZMODEM protocol support
 Latin-1 (West European) character-set translation
 Latin-2 (East European) character-set translation
 Cyrillic (Russian, Ukrainian, etc) character-set translation
 Greek character-set translation
 Hebrew character-set translation
 Japanese character-set translation
 Unicode character-set translation
 Pseudoterminal control
 REDIRECT command
 RESEND command
 Fullscreen file transfer display
 Control-character unprefixing
 Streaming
 Autodownload

Major optional features not included:
 No Kerberos(TM) authentication
 No SRP(TM) (Secure Remote Password) protocol
 No Secure Sockets Layer (SSL) protocol
 No Transport Layer Security (TLS) protocol
 No encryption
 No X Windows forwarding

Host info:
 Machine:    sun4m
 Model:      (unknown)
 OS:         SunOS
 OS Release: 4.1.3_U1
 OS Version: 4

Target: sunos41gsc
GCC version: 2.7.2
Compiled Dec 31 1999 10:38:54, options:
 __GNUC__ __STDC__ _POSIX_JOB_CONTROL _SC_JOB_CONTROL ARRAYREFLEN=1024 BIGBUFOK
 BROWSER BSD4 CK_ANSIC CK_APC CK_AUTODL CK_CURSES CK_DNS_SRV CK_ENVIRONMENT
 CK_FAST CK_LOGIN CK_MKDIR CK_NAWS CK_PCT_BAR CK_PERMS CK_RECALL CK_RTSCTS
 CK_SPEED CK_TIMERS CK_TMPDIR CK_TTGWSIZ CK_TTYFD CK_WREFRESH CKEXEC
 CKFLOAT=double CKGHNLHOST ckmaxfiles=64 CKMAXOPEN=64 CKMAXPATH=1023 CKREALPATH
 CKREGEX CKSYSLOG CKTUNING CMDBL=32763 CMDDEP=64 CONGSPD DCMDBUF DIRENT DYNAMIC
 FNFLOAT FORDEPTH=32 GFTIMER HADDRLIST HDBUUCP IFDEBUG IKS_OPTION IKSDB
 IKSDCONF INBUFSIZE=32768 INPBUFSIZ=4096 MAC_MAX=16384 MACLEVEL=128 MAXDDIR=32
 MAXDNUMS=4095 MAXGETPATH=128 MAXTAKE=54 MAXWLD=102400 MSENDMAX=1024 NETCMD
 NETCONN NETPTY NOKVERBS NOSETBUF OBUFSIZE=32768 PARSENSE PATTERNS PIPESEND
 RENAME RLOGCODE SAVEDUID SELECT SIG_V SOL_SOCKET sparc STREAMING sun SUNOS4
 SYSTIMEH TCPSOCKET TIMEH TLOG TNCODE TTLEBUF TTSPDLIST UIDBUFLEN=256 UNIX
 UNPREFIXZERO USE_LSTAT USE_MEMCPY VNAML=4096 WHATAMI XFRCAN Z_MAXCHAN=46
 z_maxchan=46 ZXREWIND

 byte order: big endian

 sizeofs: int=4 long=4 short=2 char=1 char*=4 float=4 double=8

 floating-point: precision=16 rounding=1
</pre><p>
Without going into detail about what all the notation means, notice a couple
things:
<p><ul>
<li>The Options section shows symbols ("macros") in effect during compilation,
together with their values (for those that have values).  The options are
listed in alphabetical order to make any particular option easier to find.
<p>
<li>MAXWLD is the maximum number of files that a wildcard can expand to.
<p>
<li>Anything starting with "NO" is a feature (or something other than a
feature) that has been deliberately "compiled out", or omitted.
<p>
<li>Important items for script writers include: CMDBL=32763 (the size of the
command buffer and therefore the maximum length for a macro or variable
definition; CMDDEP=64 (the limit on recursion depth); FORDEPTH=32 (the
nesting limit on FOR loops); INBUFSIZE=32768 (the size of the INPUT command
circular buffer); MAC_MAX=16384 (the maximum number of macros), etc.
</ul>
<p>
See the
<a href="ftp://kermit.columbia.edu/kermit/f/ckccfg.txt">ckccfg.txt</a>
file for details.

<p>
<hr>
<h3><a name="x1.22">1.22. Generalized File Input and Output</a></h3>

C-Kermit 7.0 adds a new generalized I/O system for stream files, augmenting
(and to some extent, overlapping with) the older OPEN, READ, WRITE, and CLOSE
commands.  In the new file i/o system, which can be used simultaneously with
the old one, all commands are grouped together under the new FILE keyword,
and some related functions and variables are added.

<h4><a name="x1.22.1">1.22.1. Why Another I/O System?</a></h4>

The well-known LOG, OPEN, READ, WRITE, and CLOSE commands have the following
restrictions:
<p><ol>
<li>Only one READ file and one WRITE file can be open at a time.
<li>The READ and WRITE commands are strictly line oriented.
<li>These commands can not be used with binary files.
<li>They do not support read/write access or random access.
<li>The syntax is a bit counterintuitive for programmers.
</ol><p>
The new file i/o system allows multiple files to be open at once, in any
desired combination of modes (read/write/append) supported by the operating
system, for line, block (record), or character i/o, for sequential or random
access, using consistent syntax and conventions.
<p>
The new system, however, does not replace the old one, since the old system
still must be used for:
<p><ol>
<li>The session, packet, debug, transaction, and connection logs.
<li>Reading and writing commands rather than files.
<li>Existing scripts.
</ol><p>
The new system works only with regular files, not with commands or pipes or
mailboxes or pseudoterminals.  No special provisions are made in the FILE
commands for handling devices or network connections, nor for preventing you
from trying to open them; if the underlying operating system treats them
like regular stream disk files, the FILE commands (except, of course SEEK,
REWIND, and COUNT) might work with them.  (In C programming terms, the FILE
commands are, at present, nothing more than a front end to <tt>fopen()</tt>
/ <tt>fread()</tt> / <tt>fwrite()</tt> / <tt>fclose()</tt> and friends, which
are a portable API to sequential files, but this might change in the future
for platforms like VMS and VOS that have more complicated file systems.)
<p>
Definitions:
<p><dl>
<dt><b><i>Channel</i></b>
<dd>A number assigned to a file when it is opened, by which it must be referred
to in all input/output operations.
<p>
<dt><b><i>Read/Write Pointer</i></b>
<dd>The current position in an open file, expressed as the 0-based byte count
from the beginning.
</dl>

<p>
<hr>
<h4><a name="x1.22.2">1.22.2. The FILE Command</a></h4>

<dl><dt><b>FILE</b> <tt> </tt> <i>keyword <tt> </tt> [ switches ] channel [ data ]</i>
<dd>
The <i>keyword</i> specifies the function: FILE OPEN, FILE READ, FILE WRITE,
FILE CLOSE, etc.  For convenience (and for familiarity to C programmers), the
two-word FILE commands can be shortened to the single words FOPEN, FREAD,
FWRITE, FCLOSE, and so on.  Switches are optional, and modify or amplify the
requested file function.
</dl>
<p>

As in C, Fortran, and other programming languages, open files are referred to
by "channels", integers such as 0, 1, 2, 3, and so on.  A channel number is
assigned when you open a file.  The number of available channels depends on
the underlying operating system, and can be seen in the variable:
<p><pre>
  \v(f_max)
</pre><p>
or by giving the FILE LIST (FLIST) command.  Channels are discussed in
greater detail in <a href="#x1.22.4">Section 1.22.4</a>.
<p>
FILE command errors can be caught with IF FAIL after the FILE command.  In
addition, the \v(f_error) variable is set to the completion code of the
command: 0 if no error, or a negative number if there was an error.  The error
codes are listed in
<a href="#x1.22.5">Section 1.22.5</a>.
<p>
The command to open a file is:
<p><dl>
<dt><b>FILE OPEN</b> <i>[ switches ] variable filename</i>
<dd>Opens a file for the type of access specified by the switches, or for
read-only access if no switches are given.  Upon success, a channel number
is assigned to this file and stored in the given variable so you can refer
to the open file in subsequent i/o commands.  If the file can not be opened,
the FILE OPEN command fails.  Synonym: <b>FOPEN</b>.
</dl><p>
The FILE OPEN switches are:
<p><dl>
<dt><b>/READ</b>
<dd>Open the file for read access.  If no switches are given, /READ is assumed.
If the file does not exist or can't be opened for read access, the FILE OPEN
command fails.
<p>
<dt><b>/WRITE</b>
<dd>Allow writing.  If a file of the same name already exists, it is
overwritten unless /READ or /APPEND is also included.  If a file of the
given name does not exist, it is created.
<p>
<dt><b>/APPEND</b>
<dd>Equivalent to /WRITE, except that if the file exists, it is not destroyed.
The read/write pointer is set to the end of the file, so unless you change
it with FILE SEEK or REWIND (see below), the first FILE WRITE command adds
to the end of the file, preserving what was there already.  If /WRITE is
also given, it is ignored.
<p>
<dt><b>/BINARY</b>
<dd>Open the file in "binary" mode, rather than text mode.  This switch is
meaningless (but still can be used) in UNIX.  In VMS, Windows, and OS/2,
it inhibits end-of-line processing and conversion, and so should be used
for binary files and/or files that are to be accessed in record or
character mode rather than line by line.
</dl><p>
The variable for the channel number can be any kind of variable: the \%x kind,
a macro name, or an array element.  But it must be a variable, not a number --
C-Kermit assigns the channel number; you can't tell it what number to use.
<p>
Example:
<p><pre>
  FILE OPEN \%c oofa.txt                  ; Open oofa.txt for reading.
  IF FAIL exit 1 Can't open oofa.txt      ; Always check to see if it worked.
  ECHO oofa.txt: channel = \%c
</pre><p>
If the file oofa.txt is opened successfully, a channel number is assigned
to the variable \%c.  Here's another example using a macro name for the
channel number:
<p><pre>
  FILE OPEN channel oofa.txt              ; Open oofa.txt for reading.
  IF SUCCESS ECHO oofa.txt: channel = \m(channel)
</pre><p>
Switches can be combined when it makes sense and the underlying operating
system allows it.  For example, to open a file in binary mode for reading and
writing (sometimes called "update"):
<p><pre>
  FILE OPEN /READ /WRITE /BINARY \%c budget.db
</pre><p>
Some combinations might be allowed, others not.  For example /READ /APPEND
will usually not be allowed.  /WRITE /APPEND is treated as /APPEND.
<p>
A major advantage of the new system over the older one is that you can have
multiple files open at once.  Suppose, for example, that you want to open all
the files in a certain directory at once:
<p><pre>
  .\%n := \ffiles(/usr/olga*,&#38;f)          ; Get file list into array.
  if ( &#62; \%n \v(f_max) ) {                ; Make sure there aren't too many.
      exit 1 {\v(dir): \%n = Too many files}
  }
  declare \&#38;c[\%n]                        ; Make array for channel numbers.
  for \%i 1 \%n 1 {                       ; Loop to open every file...
      file open \&#38;c[\%i] \&#38;f[\%i]         ; Try to open this one
      if fail exit 1 Open error: \&#38;f[\%i] ; Check for failure
  }
</pre><p>
If this loop completes successfully, the \&#38;c[] array will contain \%n
channel numbers of open files in elements 1 through \%n.
<p>
Any file that you open with FILE OPEN stays open until you close it.  The
command to close a file is:
<p><dl>
<dt><b>FILE CLOSE</b> <i>{</i> <b>ALL</b>, <i>channel }</i>
<dd>If a channel number is given and the channel refers to an open file, the
file is closed and the channel is freed for reuse; if the channel does not
refer to an open file, an error message is printed and the command fails.
If ALL is specified instead of a specific channel, all files opened with
FILE OPEN are closed and if all open files were closed successfully (even
if no files were open), the command succeeds; if any open file could not be
closed, the command fails; however, all open files that could be closed are
still closed.  Synonym: <b>FCLOSE</b>.
</dl><p>
FILE CLOSE might fail because, for example, the disk filled up or a quota
was exceeded.  Example:
<p><pre>
  fopen /write \%c new.txt                ; Open new.txt for writing.
  if fail exit 1                          ; Check for error.
  fclose \%c                              ; Close the file we just opened.
</pre><p>
This creates a 0-length file called new.txt.
<p>
Note that FILE OPEN /WRITE (without /READ or /APPEND) always creates a new
file, and therefore destroys any file with the same name that might already
exist (assuming you have permission to delete it).  To avoid overwriting
existing files, simply check first:
<p><pre>
  if exist new.txt exit 1 {Fatal - new.txt already exists}
  fopen /write \%c new.txt
  if fail ...
</pre><p>
The next two commands give information about open files:
<p><dl>
<dt><b>FILE STATUS</b> <i>channel</i>
<dd>Tells the name of the file, if any, open on the given channel and the
switches it was opened with.  The read/write pointer is also shown; this is
where the next read or write will occur; "[EOF]" is shown if the current
position in the open file is the end -- i.e. the next read will fail if the
file was opened in /READ mode; the next write will add material to the end.
The current line number (0-based) is also shown if known.  The FILE STATUS
command succeeds if the <i>channel</i> is open, and fails if there is no open
file on the given channel, or if the channel number is invalid or out of
range.  Synonym: <b>FSTATUS</b>.
<p>
<dt><b>FILE LIST</b>
<dd>Lists the channel number and name of each open file, along with its OPEN
modes (R, W, A, B, RW, etc) and its current read/write pointer or "[EOF]" if
it is at the end.  Also tells the number of files currently opened with FILE
OPEN, plus the maximum number of open files allowed by the system and the
maximum number allowed for FILE OPEN.  Synonym: <b>FLIST</b>.
</dl><p>
Next come the commands for reading and writing files:
<p><dl>
<dt><b>FILE READ</b> <i>[ switches ] channel [ variable ]</i>
<dd>Reads data from the file on the given channel number into the
<i>variable</i>, if one was given; if no variable was given, the result is
printed on the screen.  IMPORTANT: The variable should normally be a macro
name rather than a <tt>\%x</tt> or <tt>\&#38;x[]</tt> variable if you want
backslash characters in the file to be taken literally (see pp.408-412 of
<a href="ckb2.html"><cite>Using
C-Kermit</cite></a> for an explanation; you can also read into a <tt>\%x</tt>
or <tt>\&#38;x[]</tt> variable, but then you must remember to protect future
references to by <tt>\fcontents()</tt> if you don't want C-Kermit to process
any backslashes it might contain).  The desired amount of data (according to
the switches) is read from the file at the current read/write pointer, and
upon completion the read/write position is updated to first byte after the
data that was read, no matter what switches were given.  Synonym:
<b>FREAD</b>.

<p>
<dt><b>FILE WRITE</b> <i>[ switches ] channel text</i>
<dd>Writes the given text to the file on the given channel number.  The
<i>text</i>, of course, can be literal text or a variable, or any combination.
If the text might contain leading or trailing spaces, it must be enclosed in
braces if you want to preserve them.  Synonym: <b>FWRITE</b>.
</dl>
<p>
Before proceeding, a caution about the NUL character.  C-Kermit is so named
because it is a Kermit program written in the C language.  In C, character
strings are represented as a sequence of non-NUL bytes terminated by a NUL
byte (a byte in which all bits are 0).  Thus a C string can not contain NUL
bytes; it always ends with the first NUL byte.  C-Kermit variables are
implemented as C strings and therefore can't contain NUL bytes either, so the
FILE READ and FILE WRITE commands do not handle files or strings that contain
NUL bytes, except when the /CHARACTER switch is included with the FILE READ or
WRITE command, or when /LPAD:0 or /RPAD:0 is given with the FILE WRITE command;
these switches are explained below.
<p>
Also note that Kermit can not be used read or write binary numbers in the
machine's internal format (integer or floating-point); in general, numbers can
be processed only when represented as numeric or floating-point strings.
<p>
FILE READ switches are:
<p><dl>
<dt><b>/LINE</b>
<dd>Specifies that a line of text is to be read.  A line is defined according
  to the underlying operating system's text-file format.  For example, in
  UNIX a line is a sequence of characters up to and including a linefeed,
  or the end of the file, which ever comes first.  The line terminator (if
  any) is removed before assigning the text to the variable.  If no switches
  are included with the FILE READ command, /LINE is assumed.  Normally this
  switch should not be used with files opened in /BINARY mode (but nothing
  prevents it either).
<p>
<dt><b>/SIZE:</b><i>number</i>
<dd>Specifies that the given number of bytes (characters) is to be read.  The
  actual number of bytes returned will be less if the end of file is reached
  (or a NUL byte is encountered).  For example, if a file is 514 bytes long,
  FILE READ /SIZE:512 returns 512 bytes the first time and 2 bytes the second
  time.  FILE READ /SIZE provides a kind of "record i/o" for files that do not
  necessarily contain lines.  The resulting block of characters is assigned to
  the variable without any editing.  Synonym: <b>/BLOCK</b>.
<p>
<dt><b>/CHARACTER</b>
<dd>Equivalent to /SIZE:1.  If FILE READ /CHAR succeeds but the
<i>variable</i> is empty, this indicates a NUL byte was read.  Synonym:
<b>BYTE</b>.
</dl><p>
FILE WRITE switches are:
<p><dl>
<dt><b>/LINE</b>
<dd>Specifies that an appropriate line terminator is to be added to the
end of the <i>text</i>.  If no switches are included, /LINE is assumed.
<p>
<dt><b>/SIZE:</b><i>number</i>
<dd>Specifies that the given number of bytes (characters) is to be written.
If the given <i>text</i> is longer than the requested size, it is truncated;
if is shorter, it is padded according /LPAD and /RPAD switches.  Synonym:
<b>/BLOCK</b>.
<p>
<dt><b>/LPAD</b><i>[</i><b>:</b><i>value]</i>
<dd>If /SIZE was given, but the <i>text</i> is shorter than the requested
size, the text is padded on the left with sufficient copies of the character
whose   ASCII value is given to write the given length.  If no value is
specified, 32 (the code for Space) is used.  The value can also be 0 to write
the indicated number of NUL bytes.  If /SIZE was not given, this switch is
ignored.
<p>
<dt><b>/RPAD</b><i>[</i><b>:</b><i>value]</i>
<dd>Like LPAD, but pads on the right.
<p>
<dt><b>/CHARACTER</b>
<dd>Specifies that one character should be written.  If the <i>text</i> is
empty or not given, a NUL character is written; otherwise the first character
of <i>text</i> is given.  Synonym: <b>/BYTE</b>.
<p>
<dt><b>/STRING</b>
<dd>Specifies that the <i>text</i> is to be written as-is, with no terminator
added.
</dl><p>
Here's an example in which we copy a text file line by line:
<p><pre>
  file open /read \%c oofa.txt            ; Open input file
  if fail exit 1 Can't open input file    ; Check that it's open
  file open /write \%d new.txt            ; Open output file
  if fail exit 1 Can't open output file   ; Check
  while true {                            ; Loop to copy lines
      file read /line \%c line            ; Read a line
      if fail break                       ; Assume failure = end of file
      file write /line \%d {\m(line)}     ; Write the line to output file
      if fail exit 1 Write failure        ; Failure here is fatal
  }
  file close \%c                          ; Close the two files
  file close \%d
</pre><p>
Note that since /LINE is the default for both FILE READ and FILE WRITE, it can
be omitted as in the following example, where we also use the short names for
the FILE commands.
<p><pre>
  fopen /read \%c oofa.txt                ; Open input file
  if fail exit 1 Can't open input file    ; Check that it's open
  fopen /write \%d new.txt                ; Open output file
  if fail exit 1 Can't open output file   ; Check
  while true {                            ; Loop to copy lines
      fread \%c line                      ; Read a line
      if fail break                       ; Assume failure = end of file
      fwrite \%d {\m(line)}               ; Write the line to output file
      if fail exit 1 Write failure        ; Failure here is fatal
  }
  fclose \%c                              ; Close the two files
  fclose \%d
</pre><p>
Here's the same example using "record i/o" (the open and close sequences are
are omitted since they are the same as above).  The result is the same, but
execution is much faster:
<p><pre>
  while true {                            ; Loop to copy blocks
      fread /size:512 \%c block           ; Read a block into \%a
      if fail break                       ; Assume failure = end of file
      fwrite /string \%d {\m(block)}      ; Write the block to output file
      if fail exit 1 Write failure        ; Failure here is fatal
  }
</pre><p>
Although record i/o is faster, it should not be used in line-oriented
applications, since it returns arbitrary chunks of the file to your script,
rather than lines.  In this example, <tt>FWRITE /STRING</tt> is used rather
than <tt>FWRITE /SIZE:512</tt> to avoid the last output block being padded
beyond the original file's length.
<p>
A file can also be copied character by character, but this is much slower than
line i/o and VERY much slower than block i/o:
<p><pre>
  while true {                            ; Loop to copy blocks
      fread /char \%c c                   ; Read a character into c
      if fail break                       ; Assume failure = end of file
      fwrite /char \%d {\m(c)}            ; Write character to output file
      if fail exit 1 Write failure        ; Failure is fatal
  }
</pre><p>
Although character i/o is slow, it is the only way to process files that
contain NUL characters (i.e. bytes composed of only zero bits).  In the
example above, when "<tt>fread /char \%c c</tt>" returns a NUL, the c variable
is empty.  But since the FREAD /CHAR command did not fail, we know the result
was really a NUL.  FWRITE /CHAR, when given an empty variable (or no variable
at all) writes a NUL.  Thus the loop above will copy any file at all (very
slowly).  In non-copying applications, NULs are detected like this:
<p><pre>
  fread /char \%c c
  if fail (do something)
  if not def c (a NUL byte was read)
</pre><p>
Finally some advanced file operations:
<p><dl>
<dt><b>FILE FLUSH</b> <i>channel</i>
<dd>For output files only: commits all previous writes to disk,
in case the computer was buffering them.  Synonym: <b>FFLUSH</b>.
<p>
<dt><b>FILE COUNT</b> [ { <b>/BYTES, /LINES, /LIST, /NOLIST</b> <i>} ] channel</i>
<dd>By default, or if the /BYTES switch is given, counts the bytes in the
file, if any, open on the given channel.  If the /LINES switch is given,
counts lines in the file.  If the /LIST switch is given, the result is
printed.  If the /NOLIST switch is given, the result is not printed.
/QUIET is a synonym for /NOLIST.  If neither /LIST nor /NOLIST is given,
the result is printed if the command is given at top level, i.e. not from
a command file or macro.  In all cases, the result of the most recent FILE
COUNT command is stored in the variable <tt>\v(f_count)</tt>.  Note that FILE
COUNT /LINE works (and can only work) by reading the entire file; expect it to
take some time if the file is large.  Synonym: <b>FCOUNT</b>.
<p>
<dt><b>FILE REWIND</b> <i>channel</i>
<dd>Moves the read/write pointer to the beginning of the file.  Equivalent to
FILE SEEK <i>channel</i> 0.  Synonym: <b>FREWIND</b>.
<p>
<dt><b>FILE SEEK</b> <i>[ switches ] channel { [{+,-}]number</i>, <b>LAST, EOF</b> <i>}</i>
<dd>Moves the read/write pointer for the file on this channel to the given
position, which may be a byte (character) number or a line number,
expressed in either absolute or relative terms.  Switches:
<p><dl>
<dt><b>/BYTE</b>
<dd>The number given is a byte number.  Synonym: <b>/CHARACTER</b>.
<dt><b>/LINE</b>
<dd>The number given is a line number.
<dt><b>/ABSOLUTE</b>
<dd>The number given is absolute.
<dt><b>/RELATIVE</b>
<dd>The number given is relative to the current position.
</dl>
<p>

By default, or if the /BYTE switch is given, the <i>number</i> is a
byte number (0 = first byte).  If /LINE is given, the <i>number</i> is a line
number (0 = first line).  EOF means to move to the end of the file.
LAST means to move to the last line or character of the file, depending
on whether it's a line or character seek.
<p>
If neither the /RELATIVE nor the /ABSOLUTE switch is given, then if a
signed number is given, the motion is relative to the current position.
An expression that evaluates to a negative number is not considered signed
for this purpose; that is, a sign (+ or -) must be included as the first
character of the <i>number</i> in the command itself to force a relative seek
(in the absence of /RELATIVE or /ABSOLUTE).
<p>
If the number has no sign, or if the /ABSOLUTE switch is given, the number
represents an absolute position (relative to the beginning of the file).
Subsequent FILE READs or WRITEs will take place at the new position.
<p>
If the read/write pointer is placed after the end of the file, a
subsequent FILE READ will fail, but a FILE WRITE will succeed (possibly
creating a file with "holes").  If a FILE SEEK /BYTE command is given, the
current line becomes unknown (unless the position is 0) and subsequent
FILE SEEK /RELATIVE /LINE commands will fail until the next non-relative
FILE SEEK /LINE command is given.  Synonym: <b>FSEEK</b>.
</dl><p>
An absolute FILE SEEK to a negative position fails silently, as does a
relative seek to a position before the beginning of the file.
<p>
A caution about relative SEEKs: remember that the number is relative to the
current position.  Whenever you read or write, this changes the position.
In each of the following examples, assume the file open on channel \%c is
positioned at line <i>n</i> (the FREAD target variable is omitted for lack of
space):
<p><pre>
  { FREAD \%c, FSEEK /LINE \%c -1, FREAD \%c }  &#60;-- Reads line <i>n</i> twice
  { FREAD \%c, FSEEK /LINE \%c +0, FREAD \%c }  &#60;-- Reads lines <i>n</i> and <i>n</i>+1
  { FREAD \%c, FSEEK /LINE \%c +1, FREAD \%c }  &#60;-- Reads lines <i>n</i> and <i>n</i>+2
  { FREAD \%c, FSEEK /LINE \%c -2, FREAD \%c }  &#60;-- Reads lines <i>n</i> and <i>n</i>-1
  { FREAD \%c, FSEEK /LINE \%c -3, FREAD \%c }  &#60;-- Reads lines <i>n</i> and <i>n</i>-2
</pre><p>
Another caution: Using FSEEK and FREAD /SIZE to repeatedly read the same disk
block (e.g. when sampling a database record that is frequently updated) might
not give you updated disk blocks due to the internal buffering and caching of
the C library (this probably varies from one platform/compiler combination to
another).  If necessary you can force a fresh disk read with a close/open
sequence:
<p><pre>
  FCLOS \%c
  FOPEN \%c <i>samefilename</i>
  FSEEK \%c <i>samespot</i>
  FREAD /SIZE:<i>howmanybytes</i> \%c <i>variable</i>
</pre>

<p>
<hr>
<h4><a name="x1.22.3">1.22.3. FILE Command Examples</a></h4>

To read the last 10 lines of a text file into an array:
<p><pre>
  fopen /read \%c oofa.txt                ; Open the file
  if fail exit 1 Can't open oofa.txt      ; Always check for failure
  dcl \&#38;a[10]                             ; Declare a 10-element array
  fcount /line \%c                        ; Count lines in the file
  fseek /line \%c \v(f_count)-10          ; Seek to 10 lines from the end
  if fail exit 1 Can't seek               ; Check for failure
  for \%i 1 10 1 { fread \%c \&#38;a[\%i] }   ; Read the last 10 lines
  fclose \%c                              ; Close the file
</pre><p>
Note that blank lines show up as empty (undefined) array elements, for example
if you give a "show array a" command at this point.  This is normal.  You
can still use these elements; e.g.:
<p><pre>
  for \%i 1 10 1 { echo \%i. \&#38;a[\%i] }   ; Display the 10 lines
</pre><p>
Here is how to read the last line of a file (already open on channel \%c):
<p><pre>
  fseek /line \%c last                    ; Seek directly to last line
</pre><p>
Alternatively:
<p><pre>
  fseek /line \%c eof                     ; Seek to end of file
  fseek /line \%c -1                      ; Seek to beginning of last line
</pre><p>
Alternatively:
<p><pre>
  fcount /line \%c                        ; Count the file's lines
  fseek /line \%c \v(f_count)-1           ; Seek to last line
  fread \%c                               ; Read it
</pre><p>
To read every other line from the file (using relative SEEK), skipping
the first line:
<p><pre>
  fopen /read \%c oofa.txt                ; Open the file
  while ( success ) {                     ; Loop through lines
      fseek /line \%c +1                  ; Skip a line
      if success fread \%c                ; Read &#38; display a line
  }
  fclose \%c                              ; Close the file
</pre><p>
Here is how to read the lines of a file in reverse order:
<p><pre>
  fopen /read \%c oofa.txt                ; Open
  if fail exit 1                          ; Check
  fseek /line \%c last                    ; Seek to last line
  while success {                         ; Loop
      fread \%c                           ; Read line
      fseek /line \%c -2                  ; Seek backwards two lines
  }
  fclose \%c                              ; Close the file
</pre><p>
The loop works because a relative SEEK outside the file fails.
<p>
It is also possible to use block i/o to manage random-access files with
fixed-length records (as long as they don't contain NUL characters).  Suppose,
for example, you have a file of "card image" records with fixed-field
information about customers, such as:
<p><pre>
  Name:     Columns  1-32  (column numbers are 1-based)
  Address:  Columns 33-72
  Balance:  Columns 73-80
</pre><p>
The records are indexed by customer number, starting with 0.  There are no
line terminators separating them.  Therefore the record for customer number
n starts at position <i>n</i>x 80 (\%n*80).
<p>
Now suppose we received a payment from customer number 173 and want to update
the balance:
<p><pre>
  .\%n = 173                               ; Customer (record) number
  .\%a = 12.72                             ; Amount
  fopen /read /write \%c customer.db       ; Open the file
  if fail stop 1 OPEN FAILED: \f_errmsg()  ; Check
  fseek /byte \%c 80*\%n                   ; Seek to record
  fread /size:80 \%c r                     ; Read the record
  if fail stop 1 READ FAILED: \f_errmsg()  ; Check (IMPORTANT)
  .\%b := \fright(\m(r),8)                 ; Extract the balance
  .\%b := \ffpadd(\%b,\%a,2)               ; Add the new payment
  if fail stop 1 ARITHMETIC ERROR: \%b/\%a ; Catch bad records
  .r := {\fleft(\m(r),72)\flpad(\%b,8)}    ; Update the record
  fseek /byte \%c 80*\%n                   ; Reposition to same spot
  fwrite /size:80 \%c {\m(r)}              ; Replace the record
  if fail stop 1 WRITE FAILED: \f_errmsg() ; Check
  fclose \%c                               ; Close the file
</pre><p>
REMEMBER: Using FILE SEEK to move beyond the end of file can result in a file
with holes when writing; when reading, an end-of-file error will occur --
be sure to check for it.

<p>
<hr>
<h4><a name="x1.22.4">1.22.4. Channel Numbers</a></h4>

C-Kermit's channel numbers are integers from 0 to some platform-dependent
limit, such as 46 or 1985 (the value of \v(f_max)).  This is the limit placed
by the operating system on the number of files that may be opened by one
process or user or job, minus the standard input, output, and error files, and
minus the number of files reserved by C-Kermit for logs, OPEN READ and WRITE,
and file transfer (and maybe some command files -- the \v(f_max) number can't
be exact).
<p>
Although you must include a variable in the FILE OPEN command, to which the
channel number is assigned, you don't have to use a variable in the other FILE
commands if you know what the number is -- you can just put the number.  This
saves you a few keystrokes when typing commands at the prompt:
<p><pre>
  fopen \%c oofa.txt
  flist
  0. /usr/olga.oofa.txt (R) 0
</pre><p>
This tells the channel number is 0 (the number on the left is the channel
file's channel number).  Of course you can also find it by echoing the
variable:
<p><pre>
  echo \%c
  0
</pre><p>
Or with "fstatus \%c".  Now you can type commands like:
<p><pre>
  fread 0
</pre><p>
to read a line from the file.  Obviously, however, using digits rather than
a variable for the channel number  would be poor practice in a script.
<p>
If in commands like:
<p><pre>
  fread \%c \%a
</pre><p>
you have trouble remembering which variable is which, note that the channel
number is, indeed, a number.  Anywhere C-Kermit accepts a number it can also
accept an expression, so you can put parentheses around the channel number to
remind you it's the channel number and not the variable into which data is to
be read:
<p><pre>
  fread (\%c) \%a
</pre><p>
Normally channel numbers are assigned sequentially as 0, 1, 2, ... up to the
limit.  However, once you start closing files, there can be holes in the
sequence.  New channels are assigned to fill in the holes.  Thus you can't
depend on channel numbers being in any particular sequence.

<p>
<hr>
<h4><a name="x1.22.5">1.22.5. FILE Command Errors</a></h4>

Each FILE command sets the variable \v(f_error) to one of the following values:
<p><pre>
    0 = No error
   -1 = System error
   -2 = Attempt to read after end of file
   -3 = Channel not open
   -4 = Channel number out of range (negative or too large)
   -5 = Numeric argument (size, ...) out of range
   -6 = File not found
   -7 = Bad or missing filename
   -8 = Too many files are already open (FILE OPEN only)
   -9 = Forbidden operation (e.g. write to a read-only file)
  -10 = Access denied
  -11 = Illegal combination of OPEN modes (FILE OPEN only)
  -12 = Buffer overflow
  -13 = Current line number unknown (for relative line seeks)
  -14 through -98: Reserved.
  -99 = Requested operation not implemented in this version of C-Kermit
 -999 = Unknown error
</pre><p>
When \v(f_error) is -1, this means the FILE command failed because because
of a system error, in which case you can examine the following variables:
<p><pre>
  \v(errno)     = System error number.
  \v(errstring) = Error message corresponding to \v(errno).
</pre><p>
A special function is available for translating the \v(f_error) code to an
error message string:
<p><pre>
\f_errmsg([code])
  If the code is -1, returns error message of the most recent system
  error; otherwise if the code is a valid \v(f_error) value, the associated
  message is returned.  If the code is omitted, the status message
  corresponding to the current \v(f_error) value is returned.
</pre><p>
A FILE command that fails prints the appropriate error message automatically,
except when the command is READ or SEEK and the error is -2 (end of file); in
that case, the command still fails, but does not print a message.  This allows
constructions such as:
<p><pre>
  fopen \%c oofa.txt
  while success { fread \%c }
  fclose \%c
</pre><p>
to work as expected, i.e. without an annoying message when the end of file
is reached.

<p>
<hr>
<h4><a name="x1.22.6">1.22.6. File I/O Variables</a></h4>

The variables associated with the file i/o package are:
<p><dl>
<dt><tt><b>\v(f_count)</b></tt>
<dd>Result of the most recent FILE COUNT (FCOUNT) command.
<p>
<dt><tt><b>\v(f_error)</b></tt>
<dd>Numeric error code of most recent FILE command (0 = no error).
<p>
<dt><tt><b>\v(f_max)</b></tt>
<dd>Maximum number of files open simultaneously.
</dl>
<p>
<hr>

<h4><a name="x1.22.7">1.22.7. File I/O Functions</a></h4>

Some of the FILE commands can also be issued as function calls, which makes
script writing a bit more convenient, especially for C programmers.  Also,
several functions are provided that do not have command equivalents.  Each of
these functions takes a channel number as the first argument.  These functions
do not work for OPEN { READ, !READ, WRITE, !WRITE, and APPEND } files.
<p><dl>
<dt><tt><b>\f_status(</b><i>channel</i><b>)</b></tt>
<dd>Returns 0 if the channel is not open, otherwise a number between 1 and 15
which is the sum of the OPEN modes:
<p><pre>
  1 = /READ
  2 = /WRITE
  4 = /APPEND
  8 = /BINARY
</pre></dl>
<p>

The remaining functions work only for open channels.  Each of these functions
can fail for the applicable reasons listed in 
<a href="#x1.22.5">Section 1.22.5</a>.  For instructions
on handling function errors, see <a href="#x7.12">Section 7.12</a>.
<p><dl>
<dt><tt><b>\f_pos(</b><i>channel</i><b>)</b></tt>
<dd>Returns the file's current read/write pointer (0-based).  There is no FILE
command equivalent.
<p>
<dt><tt><b>\f_line(</b><i>channel</i><b>)</b></tt>
<dd>Returns the file's current line number (0-based), if known, otherwise -1.
There is no FILE command equivalent.  The line number is known as long as
no character or block i/o has been done on the channel.
<p>
<dt><tt><b>\f_handle(</b><i>channel</i><b>)</b></tt>
<dd>Returns the "file handle" of the file.  That is, it translates the portable
C-Kermit channel number into a system-specific file handle or number that
can be passed to other programs on the same platform.  In UNIX this is a
file descriptor.  There is no FILE command equivalent.
<p>
<dt><tt><b>\f_eof(</b><i>channel</i><b>)</b></tt>
<dd>Returns 1 if the read/write pointer of the file on the given channel is at
the end of the file, 0 otherwise.  Convenient in WHILE statements, e.g.:
<p><pre>
    while not \f_eof(\%c) { fread \%c }
</pre><p>
<dt><tt><b>\f_getchar(</b><i>channel</i><b>)</b></tt>
<dd>Equivalent to FREAD /CHAR.  Returns the character actually read.
If <tt>\f_getchar()</tt> does not fail but the return value is empty, this
means a NULL character was read.
<p>
<dt><tt><b>\f_getline(</b><i>channel</i><b>)</b></tt>
<dd>Equivalent to FREAD /LINE.  Returns the line actually read, but with the
line terminator stripped.  If <tt>\f_getline()</tt> does not fail but the
return value is empty, this normally means an empty line was read.
<p>
<dt><tt><b>\f_getblock(</b><i>channel,n</i><b>)</b></tt>
<dd>Equivalent to FREAD /SIZE:n.  Returns the block of characters actually
read.   If the returned block is smaller than <i>n</i>, it indicates either
that the end of file was reached or a NUL character is in the block.
<p>
<dt><tt><b>\f_putchar(</b><i>channel,c</i><b>)</b></tt>
<dd>Equivalent to FWRITE /CHARACTER.  Writes the character c.  If c contains
more than one character, only the first is written.  If c is empty a NUL
is written.  Returns the number of characters written on success, or a
negative error code upon failure.
<p>
<dt><tt><b>\f_putline(</b><i>channel,string</i><b>)</b></tt>
<dd>Equivalent to FWRITE /LINE.  Writes the string and adds the appropriate
line termination character or sequence.  If the string is empty or omitted, an
empty line is written.  Returns the number of characters written on success,
or a negative error code upon failure.
<p>
<dt><tt><b>\f_putblock(</b><i>channel,string</i><b>)</b></tt>
<dd>Equivalent to FWRITE /STRING.  Writes the string as given.  If the string
is empty or omitted, nothing is written.  Returns the number of characters
written on success, or a negative error code upon failure.
</dl>

<p>
<hr>
<h4><a name="x1.22.8">1.22.8. File I/O Function Examples</a></h4>

<pre>
  fopen /read \%c oofa.txt            ; Open our favorite file for reading
  if failure exit 1                   ; Check that it's open
  while not \f_eof(\%c) {             ; Loop until EOF
      .line := \f_getline(\%c)        ; Get a line
      if success echo {\m(line)}      ; Echo it
  }
  if not \f_eof(\%c) {                ; Check reason for loop exit
      exit 1 File Error: \f_errmsg()  ; If not EOF say so.
  }

  frewind \%c                         ; Rewind the file
  while not \f_eof(\%c) {             ; Same thing but with block i/o
      .block := \f_getblock(\%c,256)  ; (much faster than line i/o)
      if success xecho {\m(block)}
  }

  frewind \%c                         ; Rewind again
  while not \f_eof(\%c) {             ; Same deal but with character i/o
      .c := \f_getchar(\%c)           ; (much slower than line i/o)
      if success xecho {\m(c)}
  }
  close \%c
</pre><p>

To close all open files (equivalent to FCLOSE ALL):

<p><pre>
  for \%i 0 \v(f_max)-1 1 {
      if \f_status(\%i) fclose \%i
  }
</pre>

<p>
<hr>
<h3><a name="x1.23">1.23. The EXEC Command</a></h3>

The EXEC command is available only in UNIX.
<p><dl>
<dt><b>EXEC</b> <i>[</i> <b>/REDIRECT</b> <i>] command [ arg1 [ arg2 [ ... ] ]</i>
<dd>Runs the given command with the arguments in such a way that the
<i>command</i>   replaces C-Kermit in memory, and C-Kermit ceases to execute.
EXEC is like   RUN, except instead of returning to C-Kermit when finished, the
<i>command</i>   returns to whatever process invoked Kermit.
</dl><p>

In the normal case, no files are closed, so the EXEC'd command inherits the
open files, read/write pointers, working directory, process ID, user ID
(unless <i>command</i> is SUID), group ID (unless command is SGID), groups,
etc.  (In UNIX, the EXEC command is simply a front end for <tt>execvp()</tt>.)

<p>

If the /REDIRECT switch is included, then if a connection is open (SET LINE or
SET HOST), it becomes the standard input and output of the EXEC'd program.  If
no connection is open, the /REDIRECT switch has no effect.  For example to use
C-Kermit for PPP dialing in Linux:

<p><pre>
  set modem type usr          ; Specify the kind of modem you have
  set line /dev/ttyS1         ; Specify the device it's connected to
  set speed 57600             ; and the speed
  set flow rts/cts            ; and flow control.
  set dial retries 100        ; Try the dial sequence up to 100 times.
  dial {{9-212-555-1212}{9-212-555-1213}{9-212-555-1214}{9-212-555-1215}}
  if fail exit 1
  for \%i 1 16 1 {            ; Try up to 16 times to get login prompt
      input 10 Login:         ; Wait 10 sec for it to appear
      if success break        ; Got it - proceed...
      output \13              ; Send a carriage return and try again
  }
  if ( &#62; \%i 16 ) stop 1 NO LOGIN PROMPT
  lineout \(myuserid)         ; Send user ID
  input 30 assword:           ; Wait for Password prompt
  if fail stop 1 NO PASSWORD PROMPT
  lineout \m(mypassword)      ; Send the password.
  exec /redirect pppd         ; Replace ourselves with pppd.
</pre><p>

In this example we assume that the script has already set up the
<i>myuserid</i> and <i>mypassword</i> variables -- normally the password
should be prompted for, rather than stored on disk.  Notice the advantages
over the well-known "chat script":
<ul><p>
<li>You don't have to control the modem itself with AT commands; Kermit's
   DIAL command does this for you.
<li>You can have Kermit automatically redial as many times as you want
   until it gets a connection (if this is legal in your country).
<li>You can have Kermit fetch the number or numbers from a dialing directory.
<li>You can have Kermit cycle through a list of phone numbers (this is new
in C-Kermit 7.0; see 
<a href="#x2.1.16">Section 2.1.16</a>) without having to enter the numbers
in a dialing directory.
<li>Dialing is location-independent; you can use the same script to dial from
different areas or countries.
<li>Once the connection is made, the full power of Kermit's script language
is available to manage the dialog with the terminal server or other
device that answers the phone call.
</ul>
<b>NOTE:</b> PPP and SLIP dialing are not available in Windows 95/98/NT/2000,
whose APIs do not provide a method for an application to hand over a
connection to the PPP or SLIP driver.

<p>
<hr>

<h3><a name="x1.24">1.24. Getting Keyword Lists with '?'</a></h3>

Suppose you type "<tt>te</tt>" at the <tt>C-Kermit&#62;</tt> 6.0 prompt and
then Esc or Tab to
request keyword completion.  Kermit beeps, indicating that more than one
command starts with "te".  But if you type '?'  to see what they are, Kermit
shows only "telnet".  So why the beep?  Because of invisible keywords like
"telopt", "terminal", and "text".  Lots of keywords are invisible because they
are either synonyms for other keywords or else esoteric options to be used
only in special circumstances, so we don't want them cluttering up the menus.
<p> But then there is no way for you to discover them.  So in C-Kermit 7.0, if
you type '?' AFTER the beginning of a keyword field, then invisible keywords
are shown too:
<p><pre>
  C-Kermit&#62; <u>te&#60;Esc&#62;</u>&#60;BEEP&#62;
  C-Kermit&#62; te<u>?</u> Command, one of the following:
   telnet    telopt    terminal  text
  C-Kermit&#62;te
</pre><p>
But if '?' is typed at the beginning of a field, only visible keywords are
shown, as before (so, in this example, if '?' is typed at the C-Kermit&#62;
prompt, "telnet" is the only command shown that starts with "te").

<p>
<hr>
<h3><a name="x2">2. MAKING AND USING CONNECTIONS</h3>

The SET LINE, SET HOST, and SET PORT (a synonym for SET LINE) commands have
new synonyms, in which the word SET is replaced by the word OPEN: OPEN LINE,
etc.  There is no new functionality here, but OPEN is a better verb, since SET
generally takes no action, whereas these commands actually try to open a
connection.  Furthermore, there is the symmetry with CLOSE.

<p>
<hr>
<h3><a name="x2.0">2.0. SET LINE and SET HOST Command Switches</a></h3>

The SET LINE (SET PORT) and SET HOST commands now allow switches before the
device or host name, in most cases, and under certain circumstances, also at
the end.  The new syntax is backwards compatible with the previous syntax;
thus SET LINE, SET PORT, and SET HOST commands in command files written for
C-Kermit 6.0 or earlier still work.  The expanded syntax is:
<p>
<i>{</i> <b>OPEN</b>, <b>SET</b> <i>} {</i> <b>LINE</b>, <b>PORT</b>, <b>HOST</b> <i>} [ switches ] device-or-address [ switches ]</i>
<p>
The first group of switches is:
<p><dl>
<dt><b>/NETWORK-TYPE:</b><i>{</i><b>TCP/IP,X.25,PIPE,PTY...</b><i>}</i>
<dd>When more than one network type is available, this lets you specify the
type of network to use for this connection without affecting your global
SET NETWORK TYPE.  See 
<a href="#x2.7">Section 2.7</a> about pipes and ptys.
<p>
<dt><b>/USERID:</b><i>[string]</i>
<dd>This switch is equivalent to SET LOGIN USERID.  If a string is given, it
  sent to host during Telnet negotiations; if this switch is given but the
  string is omitted, no user ID is sent to the host.  If this switch is not
  given, your current LOGIN USERID (\v(userid) value), if any, is sent.
  Unlike most other switches, this one is "sticky", since the value must
  persist throughout the session in case the server requests the ID string
  at a later time.
<p>
<dt><b>/CONNECT</b>
<dd>Enter CONNECT mode immediately and automatically after the device or
  connection is open.  On serial devices, however, when CARRIER-WATCH is
  not OFF, wait up to 1 second for the Carrier Detect signal to appear
  before trying to connect, to give the device time to react DTR, which
  might have been off prior to opening the device.
<p>
<dt><b>/SERVER</b>
<dd>Enter server mode immediately and automatically after the device or
  connection is open.  Treatment of carrier is the same as for /CONNECT.
<p>
<dt><b>/WAIT</b>
<dt><b>/NOWAIT</b>
<dd>For Telnet connections only: Like SET TELNET WAIT <i>{</i> ON, OFF <i>}</i>, but applies
  only to this connection, and in fact applies only when OPENing this
  connection (which is usually the only place it matters).  Typically you
  would use TELNET /NOWAIT to make a connection to a misbehaving Telnet
  server that does not reply to negotiations as required by the Telnet
  protocol definition.
</dl><p>
Note: /CONNECT and /SERVER switches are not available in the RLOGIN and TELNET
commands, since these commands already include an implicit /CONNECT and
preclude automatic entry into server mode.
<p>
The /CONNECT and /SERVER switches are especially useful with "set host *"
connections.  For example, suppose you want to start a Kermit server on socket
3000 of your TCP host.  Normally you would have to give the command:
<p><pre>
  set host * 3000
</pre><p>
and then wait for a connection to come in, and only then could you give the
SERVER command (or else define a macro to do this, and then execute the macro).
Now you can do it in one step:
<p><pre>
  set host /server * 3000
</pre><p>
This tells C-Kermit to wait for the connection and then enter server mode
once it comes in, no matter how long it takes.  Similarly, "set host /conn *"
can be used to wait for a "chat" connection to come in.
<p>
Another set of switches is available in VMS only, for use only with SET LINE:
<p><dl>
<dt><b>/SHARE</b>
<dd>Allows the SET LINE device to be opened in shared mode.  Normally it makes
  no sense to open a serial device in shared mode, but it's necessary when
  C-Kermit is running in an environment such as DECIntact, that opens your
  job's controlling terminal in such a way that C-Kermit can't open it too,
  unless it enables SHARE privilege.  Note: SHARE privilege is required.
<p>
<dt><b>/NOSHARE</b>
<dd>Requires that the SET LINE device not be in use by any other process in
  order for it to be successfully opened by C-Kermit.  If neither /SHARE nor
  /NOSHARE is specified, /NOSHARE is used.
</dl><p>
The second group of switches is:
<p><dl>
<dt><b>/NO-TELNET-INIT</b>
<dd>Do not send initial Telnet negotiations even if this is a Telnet port.
<p>
<dt><b>/RAW-SOCKET</b>
<dd>This is a connection to a raw TCP socket (<a href="#x2.3.5">Section 2.3.5</a>).
<p>
<dt><b>/RLOGIN</b>
<dd>Use Rlogin protocol even if this is not an Rlogin port.
<p>
<dt><b>/TELNET</b>
<dd>Send initial Telnet negotiations even if this is not a Telnet port.
</dl><p>
As of C-Kermit 7.0 and K95 1.1.19, the TELNET command includes an implicit
/TELNET switch.  So if you TELNET to a non-TELNET port, Kermit sends initial
Telnet negotiations.  This makes sense, since that's what "telnet" means.
<p>
If you want to make a connection to a non-Telnet port without sending initial
Telnet negotiations, use:
<p><pre>
  set host <i>[</i> /connect <i>] name-or-address port</i>
</pre><p>
or:
<p><pre>
  telnet <i>name-or-address</i> <i>port</i> /no-telnet-init
</pre><p>
Additional switches might be added in the future; type "set host ?" or "set
line ?" to see a current list.

<p>
<hr>
<h3><a name="x2.1">2.1. Dialing</a></h3>

Automatic redialing is illegal or restricted in many countries, so until
C-Kermit 7.0, it was disabled by default, i.e. until a SET DIAL RETRIES
command was given.  In C-Kermit 7.0, if no SET DIAL RETRIES command has been
given, a default is picked dynamically at DIAL time based on the calling
country code, if known.  At this writing, the only country code known to have
no restrictions on automatic redialing is 1.  So in this case a limit of 10
is chosen; otherwise 1.  If you have not given an explicit SET DIAL RETRIES
command, SHOW DIAL shows the value as "(auto)", and then the value actually
used is shown when you give the DIAL command.
<p>
As of C-Kermit 7.0, automatic redialing is automatically canceled if the
call could not be placed because no dialtone was detected.

<p>
<hr>
<h4><a name="x2.1.1">2.1.1. The Dial Result Message</a></h4>

If DIAL DISPLAY is not ON, the "Call complete" message now shows the modem's
call result message, for example:
<p><pre>
  Dialing: ...
  Call complete: "CONNECT 31200/ARQ/V32/LAPM/V42BIS"
</pre><p>
The exact format and contents of this message, of course, depends on the
make, model, and configuration of your modem, so use your modem manual to
interpret it.  The call result message is also available in C-Kermit's
\v(dialresult) variable.
<p><pre>
  C-Kermit&#62; <u>echo \v(dialresult)</u>
  CONNECT 31200/ARQ/V32/LAPM/V42BIS
  C-Kermit&#62; <u>echo Speed = \fword(\v(dialresult),2)</u>
  Speed = 31200
  C-Kermit&#62;
</pre><p>
Suppose your modem reports the modulation speed as shown above and you want to
ensure your call is completed at (say) 24000 bps or more.  You can use a
little macro to do the job:
<p><pre>
define HSDIAL {                ; High Speed DIAL
    local \%s
    if &#60; \v(argc) 1 if not def \v(dialnumber) end 1 Usage: \%0 number
    set dial retries 100
    set dial interval 1
    while true {
	dial \%*
	if fail end 1 DIAL failed.
	asg \%s \fword(\v(dialresult),2)
	if def \%s if numeric \%s if not &#60; \%s 24000 break
    }
}
</pre><p>
(See 
<a href="#x7.5">Section 7.5</a> about the <tt>\%*</tt> variable.)

<p>
<hr>
<h4><a name="x2.1.2">2.1.2. Long-Distance Dialing Changes</a></h4>

Due to the glut of cell phones, pagers, fax machines, ISPs, etc, area codes
and dialing rules are changing all the time.  In the North American Numbering
Plan (NANP) countries (USA, Canada, etc), area codes are split or overlayed
with increasing frequency, and 10- and 11-digit dialing is gradually becoming
the norm for local calls.  Changes are occurring In Europe, too, partly for
these reasons and partly because of some new EC rules.

<p>

In <b>France</b>, effective 18 October 1996, all calls, even local ones, must
be dialed with an area code.  French area codes are presently 1-digit numbers,
1-6, and the long-distance dialing prefix is 0.  All calls within France are
considered long distance and begin with 01, 02, <tt>...</tt>, 06.

<p>

Effective 1 May 1997, all calls within the US state of <b>Maryland</b>, even
local ones, must be dialed with an area code but <i>without</i> the
long-distance prefix -- this is the now widely-known North American phenomenon
of "ten digit dialing".  The same is happening elsewhere -- many cities in
Florida adopted 10-digit dialing in 1998.

<p>

In <b>Italy</b> beginning 19 June 1998, all calls to fixed (as opposed to
mobile) numbers must be prefixed by 0.  When calling into Italy from outside,
the 0 must follow the country code (39).  Calls to cell phones, however, must
be placed without the 0.  Then on 29 December 2000, the 0 will become a 4 (for
calling fixed numbers) and a prefix of 3 must used for calling mobile phones.
More info at: http://www.telecomitalia.it/npnn/.

<p>
In <b>Spain</b>, effective 4 April 1998, with hard cutover on 18 July 1998, all
calls within the country must be dialed with 9 digits, and all calls from
outside Spain must also be dialed with 9 digits (after the country code, 34).
The new 9-digit numbers all begin with "9".  More info at:
<a href="http://www.telefonica.es/cambiodenumeracion/">http://www.telefonica.es/cambiodenumeracion/</a>

<p>

Several new dialing features and commands have been added in version 6.1 and
7.0 to address these changes.

<p>

C-Kermit 6.0 and Kermit 95 1.1.11 and earlier handle the French situation
via a reasonable subterfuge (setting the local area code to a nonexistent
one), but did not handle "ten-digit dialing" well at all; the recommended
technique was to change the long-distance dialing prefix to nothing, but this
defeated Kermit's "list numbers for one name" feature when the numbers were in
different locations.  For example:
<p><pre>
  set dial ld-prefix
  dial onlineservice
</pre><p>
where "onlineservice" is a dialing directory entry name corresponding to
entries that are in (say) Maryland as well as other states, would not
correctly dial the numbers not in Maryland.
<p>
A new command lets you specify a list of area codes to be considered local,
except that the area code must be dialed:
<p><dl>
<dt><b>SET DIAL LC-AREA-CODES</b> <i>[ areacode [ areacode [ areacode [ ... ] ] ] ]</i>
<dd>The list may include up to 32 area codes.  If a number is called whose area
code is in this list, it is dialed WITHOUT the long-distance prefix, but WITH
the area code.
</dl>
<p>
So in Maryland, which (last time we looked) has two area
codes, 410 and 301, the setup would be:
<p><pre>
  SET DIAL LC-AREA-CODES 410 301
</pre><p>
Example:
<p><pre>
  SET DIAL LD-PREFIX 1
  SET DIAL AREA-CODE 301
  SET DIAL LC-AREA-CODES 410 301 &#60;-- Area codes in 10-digit dialing region
  DIAL +1 (301) 765-4321         &#60;-- Dials 3017654321  (local with area code)
  DIAL +1 (410) 765-4321         &#60;-- Dials 4107654321  (local with area code)
  DIAL +1 (212) 765-4321         &#60;-- Dials 12127654321 (long distance)
</pre><p>
The SET DIAL LC-AREA-CODES command does not replace the SET DIAL AREA-CODE
command.  The latter specifies the area code you are dialing from.  If the
called number is in the same area code, then the area code is dialed if it is
also in the LC-AREA-CODES list, and it is not dialed otherwise.  So if "301"
had not appeared in the LC-AREA-CODES list in the previous example:
<p><pre>
  SET DIAL LD-PREFIX 1
  SET DIAL AREA-CODE 301
  SET DIAL LC-AREA-CODES 410     &#60;-- Area codes in 10-digit dialing region
  DIAL +1 (301) 765-4321         &#60;-- Dials 7654321     (local)
  DIAL +1 (410) 765-4321         &#60;-- Dials 4107654321  (local with area code)
  DIAL +1 (212) 765-4321         &#60;-- Dials 12127654321 (long distance)
</pre><p>
The new Kermit versions also add a Local Call Prefix and Local Call Suffix, in
case you have any need for it.  These are added to the beginning and of local
phone numbers (i.e. numbers that are not long-distance or international).
Examples:
<p><pre>
  SET DIAL LD-PREFIX 1
  SET DIAL LC-PREFIX 9
  SET DIAL LC-SUFFIX *
  SET DIAL LC-AREA-CODES 410     &#60;-- Area codes in 10-digit dialing region
  SET DIAL AREA-CODE 301
  DIAL +1 (301) 765-4321         &#60;-- Dials 97654321*     (local)
  DIAL +1 (410) 765-4321         &#60;-- Dials 94107654321*  (local with area code)
  DIAL +1 (212) 765-4321         &#60;-- Dials 12127654321   (long distance)
</pre>

<p>
<hr>
<h4><a name="x2.1.3">2.1.3. Forcing Long-Distance Dialing</a></h4>

Suppose a number is in your country and area, but for some reason you need to
dial it long-distance anyway (as is always the case in France).  There have
always been various ways to handle this:
<p><ol>
<li>Temporarily set your area code to a different (or nonexistent or
impossible) one (but this required knowledge of which area codes were
nonexistent or impossible in each country).
<p>
<li>Dial the number literally instead of using the portable format, but this
defeats the purpose of the portable dialing directory.
</ol><p>
Now there is also a new command that, very simply, can force long-distance
dialing:
<p><dl>
<dt><b>SET DIAL FORCE-LONG-DISTANCE </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>If a call is placed to a portable phone number within the same country
  code as the calling number, it is dialed with the long-distance prefix
  and the area code if FORCE-LONG-DISTANCE is ON.  If OFF, the regular
  rules and procedures apply.
</dl><p>
Example (France):
<p><pre>
  SET DIAL COUNTRY-CODE 33
  SET DIAL AREA-CODE 6
  SET DIAL FORCE-LONG-DISTANCE ON
</pre><p>
(In fact, SET DIAL COUNTRY-CODE 33 automatically sets DIAL FORCE-LONG-DISTANCE
ON...)
<p>
Example (USA, for a certain type of reverse-charge calling in which the
called number must always be fully specified):
<p><pre>
  SET DIAL PREFIX 18002666328$     ; 1-800-COLLECT
  SET DIAL COUNTRY-CODE 1
  SET DIAL AREA-CODE 212
  SET DIAL FORCE-LONG-DISTANCE ON
</pre><p>
Example (Toronto, where calls to exchange 976 within area code 416 must be
dialed as long distance, even when you are dialing from area code 416):
<p><pre>
  SET DIAL COUNTRY-CODE 1
  SET DIAL AREA-CODE 416
  SET DIAL FORCE-LONG-DISTANCE ON
  DIAL +1 (416) 976-xxxx
</pre><p>
If dialing methods were consistent and sensible, of course it would be
possible to always dial every domestic call as if it were long distance.  But
in many locations this doesn't work or if it does, it costs extra.  The
following macro can be used for dialing any given number with forced
long-distance format:
<p><pre>
  define LDIAL {
      local \%x
      set dial force-long-distance on
      dial \%*
      asg \%x \v(success)
      set dial force-long-distance off
      end \%x
  }
</pre><p>
(See <a href="#x7.5">Section 7.5</a> about the <tt>\%*</tt> variable.)

<p>
<hr>
<h4><a name="x2.1.4">2.1.4. Exchange-Specific Dialing Decisions</a></h4>

This applies mainly to the North American Numbering Plan (NANP).  Refer to the
section "Alternative notations" in <a href="ckb2.html"><cite>Using C-Kermit</cite></a> 2nd Edition, pages
106-107, and the story about Toronto on page 110.  Using the new LC-AREA-CODES
list, we can address the problem by treating the exchange as part of the area
code:
<p><pre>
  SET DIAL LD-PREFIX 1
  SET DIAL AREA-CODE 416
  SET DIAL LC-AREA-CODES 905276
  DIAL +1 416 765 4321               &#60;-- 7654321      (local)
  DIAL +1 905 276 4321               &#60;-- 9052764321   (local with area code)
  DIAL +1 905 528 4321               &#60;-- 19055284321  (long distance)
</pre><p>
The same technique can be used in Massachusetts (story at top of page 111)
and in any other place where dialing to some exchanges within a particular
area code is local, but to others in the same area code is long distance.

<p>
<hr>
<h4><a name="x2.1.5">2.1.5. Cautions about Cheapest-First Dialing</a></h4>

Kermit does not maintain a knowledge base of telephony information; it only
provides the tools to let you enter a phone number in a standard format and
dial it correctly from any location in most cases.
<p>
In particular, Kermit does not differentiate the charging method from the
dialing method.  If a call that is DIALED as long-distance (e.g. from 212 to
718 in country code 1) is not CHARGED as long distance, we have no way of
knowing that without keeping a matrix of charging information for every
area-code combination within every country, and any such matrix would be
obsolete five minutes after it was constructed.  Thus, "cheapest-first"
sorting is only as reliable as our assumption that the charging method follows
the dialing method.  A good illustration would be certain online services that
have toll-free dialup numbers which they charge you a premium (in your online
service bill) for using.

<p>
<hr>
<h4><a name="x2.1.6">2.1.6. Blind Dialing (Dialing with No Dialtone)</a></h4>

C-Kermit's init string for Hayes-like modems generally includes an X4 command
to enable as many result codes as possible, so that Kermit can react
appropriately to different failure reasons.  One of the result codes that X4
enables is "NO DIALTONE".  A perhaps not obvious side effect of enabling this
result code that the modem must hear dialtone before it will dial.
<p>
It is becoming increasingly necessary to force a modem to dial even though it
does not hear a dialtone on the phone line; for example, with PBXs that have
strange dialtones, or with phone systems in different countries, or with ISDN
phones, etc.  This is called "blind dialing".
<p>
C-Kermit 7.0 has two new commands to cope with this situation:
<p><dl>
<dt><b>SET DIAL IGNORE-DIALTONE</b> <i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>OFF (the default) means to tell the modem to wait for dialtone before
  dialing.  ON means to enable "blind dialing", i.e. tell the modem NOT
  to wait for dialtone before dialing.  Generally this is accomplished by
  sending ATX3 to the modem just prior to dialing.  SET MODEM TYPE xxx
  and then SHOW MODEM displays Kermit's built-in "ignore dialtone" command.
<p>
<dt><b>SET DIAL COMMAND IGNORE-DIALTONE</b> <i>text</i>
<dd>This lets you change the built-in ignore-dialtone command (such as ATX3)
  to whatever you choose, in case the built-in one does not work, or another
  command works better.
</dl><p>
Notes:
<ol><p>
<li>The ignore-dialtone command is not sent unless SET DIAL IGNORE-DIALTONE
is ON.
<p>
<li>The ATX3 command generally disables not only NO DIALTONE, but also BUSY.
    So this will prevent Kermit from detecting when the line is busy.  This
    is a property of the modem, not of Kermit.
</ol>

<p>
<hr>
<h4><a name="x2.1.7">2.1.7. Trimming the Dialing Dialog</a></h4>

The command:
<p><pre>
  SET MODEM COMMAND <i>action</i> [ <i>command</i> ]
</pre><p>
is used to override Kermit's built-in modem commands for each action, for
each kind of modem in its internal database.  If you include a <i>command</i>,
this is used instead of the built-in one.  If you omit the <i>command</i>, this
restores the original built-in command.
<p>
If you want to omit the command altogether, so Kermit doesn't send the command
at all, or wait for a response, use:
<p><pre>
  SET MODEM COMMAND <i>action</i> {}
</pre><p>
That is, specify a pair of empty braces as the command, for example:
<p><pre>
  SET MODEM COMMAND ERROR-CORRECTION ON {}
</pre>

<p>
<hr>
<h4><a name="x2.1.8">2.1.8. Controlling the Dialing Speed</a></h4>

The rate at which characters are sent to the modem during dialing is normally
controlled by the built-in modem database.  You might want to override this
if Kermit seems to be dialing too slowly, or it is sending characters to the
modem faster than the modem handle them.  A new command was added for this
in C-Kermit 7.0:
<p><dl>
<dt><b>SET DIAL PACING <i>number</i></b>
<dd>Specifies the number of milliseconds (thousandths of seconds) to pause
  between each character when sending commands to the modem during DIAL or
  ANSWER command execution.  0 means no pause at all, -1 (the default) or any
  other negative number means to use the value from the database.  Any number
  greater than 0 is the number of milliseconds to pause.
</dl><p>
HINT: You might also need to control the rate at which the modem generates
Touch Tones during dialing, for example when sending a numeric page.  There
are two ways to do this.  One way is to insert pause characters into the
dialing string.  For modems that use the AT command set, the pause character
is comma (,) and causes a 2-second pause.  On most modems, you can use the S8
register to change the pause interval caused by comma in the dialing string.
The other way is to set your modem's tone generation interval, if it has a
command for that.  Most AT-command-set modems use S11 for this; the value is
in milliseconds.  For example on USR modems:
<p><pre>
  ATS11=200
</pre><p>
selects an interval of 200 milliseconds to separate each dialing tone.
<p>
Hint: To add S-Register settings or other commands to your dialing procedure,
use the new SET MODEM COMMAND PREDIAL-INIT command (<a href="#x2.2.2">Section 2.2.2</a>).

<p>
<hr>
<h4><a name="x2.1.9">2.1.9. Pretesting Phone Number Conversions</a></h4>

The LOOKUP command now accepts telephone numbers as well as directory-entry
names, for example:
<p><pre>
  LOOKUP +1 (212) 7654321
</pre><p>
When given a phone number, LOOKUP prints the result of converting the phone
number for dialing under the current dialing rules.  For example, if my
country code is 1 and my area code is 212, and I am dialing out from a PBX
whose outside-line prefix is "93,":
<p><pre>
  C-Kermit&#62; <u>lookup +1 (212) 7654321</u>
  +1 (212) 7654321 =&#62; 93,7654321
  C-Kermit&#62;
</pre><p>
You can also use the <tt>\fdialconvert(<i>phone-number</i>)</tt> function (<a
href="#x2.1.11">Section 2.1.11</a>) to do this programmatically:
<p><pre>
  C-Kermit&#62; <u>echo "\fdialconvert(+1 (212) 7654321)"</u>
  "93,7654321"
  C-Kermit&#62;
</pre><p>
So the new LOOKUP behaves as follows:
<p><dl>
<dt><b>LOOKUP</b> <i>portable-format-phone-number</i>
<dd>Displays how the number would actually be dialed
  Sets FAILURE if there was a conversion error, otherwise SUCCESS.
<p>
<dt><b>LOOKUP</b> <i>literal-format-phone-number</i>
<dd>Displays the same <i>literal-format-phone-number</i>
  Always sets SUCCESS.
<p>
<dt><b>LOOKUP</b> <i>dialing-directory-name</i>
<dd>Displays all matching entries and converts portable phone numbers.
  Sets SUCCESS if at least one entry was found, otherwise FAILURE.
<p>
<dt><b>LOOKUP =</b><i>anything</i>
<dd>Displays "=<i>anything</i>" and sets SUCCESS.
</dl><p>
There is, at present, no programmatic way to fetch numbers from the dialing
directory.  This will be considered for a future release.

<p>
<hr>
<h4><a name="x2.1.10">2.1.10. Greater Control over Partial Dialing</a></h4>

The following rules now apply to partial dialing:
<p><ul>
<li>Phone number transformations based on country and area code,
application of prefixes, etc, are performed only on the first PDIAL.
<p>
<li>Each PDIAL argument is looked up in the dialing directory, so it is
possible have directory entries for pieces of phone numbers or other
information.
<p>
<li>Suffixes are not applied automatically, since there is no way for C-Kermit
to know in which PDIAL segment you want them to be applied.
</ul><p>
However, the suffix that *would* have been applied, based on the dialing rules
that were invoked when processing the first PDIAL command, is stored in the
variable:
<p><pre>
  \v(dialsuffix)
</pre><p>
which you can include in any subsequent PDIAL or DIAL commands.
<p>
Example:
<p><pre>
  pdial {\m(my_long_distance_pager_number_part_1)}
  pdial {\m(my_long_distance_pager_number_part_2)}
  pdial {\v(dialsuffix)}
  pdial {\m(my_long_distance_pager_number_part_3)}
  pdial {@\m(numeric_pager_code)#}
</pre>

<p>
<hr>
<h4><a name="x2.1.11">2.1.11. New DIAL-related Variables and Functions</a></h4>

<dl>
<dt><tt><b>\fdialconvert(</b><i>s</i><b>)</b></tt>
<dd>s is a phone number in either literal or portable format (not a dialing
directory entry name).  The function returns the dial string that would
actually be used by the DIAL command when dialing from the current location,
after processing country code, area code, and other SET DIAL values, and
should be the same as the result of LOOKUP when given a telephone number.
<p>
<dt><tt><b>\v(dialsuffix)</b></tt>
<dd>Contains the suffix, if any, that was applied in the most recent DIAL
  command, or the suffix that would have been applied in the most recent PDIAL
  command.  Use this variable to send the dial suffix at any desired point in
  a PDIAL sequence.
<p>
<dt><tt><b>\v(dialtype)</b></tt>
<dd>A number indicating the type of call that was most recently placed.  Can
  be used after a normal DIAL command, or after the first PDIAL command in
  a PDIAL sequence.  Values are:
<p><pre>
  -2: Unknown because TAPI handled the phone number translation.
  -1: Unknown because some kind of error occured.
   0: Internal within PBX.
   1: Toll-free.
   2: Local within calling area.
   3: Unknown (e.g. because a literal-format phone number was given).
   4: Long distance within country.
   5: International
</pre><p>
<dt><tt><b>\v(dialcount)</b></tt>
<dd>The current value of the DIAL retry counter, for use in a DIAL macro
(<a href="#x2.1.13">Section 2.1.13</a>).
<p>
<dt><tt><b>\v(d$px)</b></tt>
<dd>PBX Exchange (see <a href="#x2.1.12">Section 2.1.12</a>).
</dl>
<p>
Other dial-related variables, already documented in <a href="ckb2.html"><cite>Using C-Kermit</cite></a> (or
other sections of this document, e.g. 
<a href="#x2.1.1">Section 2.1.1</a>), include <tt>\v(dialnumber)</tt>,
<tt>\v(dialstatus)</tt>, etc.  A convenient way to display all of them is:
<p><pre>
  show variable dial  ; hint: abbreviate "sho var dial"
</pre><p>
This shows the values of all the variables whose names start with "dial".
Also "<tt>show variable d$</tt>" (to show the <tt>\v(d$...)</tt> variables).

<p>
<hr>
<h4><a name="x2.1.12">2.1.12. Increased Flexibility of PBX Dialing</a></h4>

Refer to <a href="ckb2.html"><cite>Using C-Kermit</cite></a>, 2nd Edition, pages 107-108.  Recall that three
commands are needed to configure C-Kermit for dialing from a PBX:
<p><pre>
  SET DIAL PBX-EXCHANGE <i>number</i>
  SET DIAL PBX-INSIDE-PREFIX <i>number</i>
  SET DIAL PBX-OUTSIDE-PREFIX <i>number</i>
</pre><p>
Unfortunately, this model does not accommodate PBXs that have more than one
exchange.  For example our PBX at Columbia University (which must handle more
than 10,000 phones) has 853-xxxx and 854-xxxx exchanges.
<p>
Beginning in C-Kermit 7.0, the SET DIAL PBX-EXCHANGE command accepts a list of
exchanges, e.g.:
<p><pre>
  SET DIAL PBX-EXCHANGE 853 854
</pre><p>
(multiple exchanges are separated by spaces, not commas).
<p>
So now when dialing a portable-format number that has the same country and
area codes as those of your dialing location, C-Kermit compares the exchange
of the dialed number with each number in the PBX Exchange list (rather than
with a single PBX Exchange number, as it did formerly) to determine whether
this is an internal PBX number or an external call.  If it is an external
call, then the PBX Outside Prefix is applied, and then the normal dialing
rules for local or long-distance calls.
<p>
If it is an inside call, the exchange is replaced by the PBX Inside Prefix.
But if the PBX has more than one exchange, a single fixed PBX Inside Prefix is
probably not sufficient.  For example, at Columbia University, we must dial
3-xxxx for an internal call to 853-xxxx, but 4-xxxx for a call to 854-xxxx.
That is, the inside prefix is the final digit of the exchange we are dialing.
For this reason, C-Kermit 7.0 provides a method to determine the inside prefix
dynamically at dialing time, consisting of a new variable and new syntax for
the SET DIAL PBX-INSIDE-PREFIX command:
<p><dl>
<dt><b>\v(d$px)</b>
<dd>This variable contains the exchange that was matched when a PBX internal
  call was detected.  For example, if the PBX exchange list is "853 854"
  and a call is placed to +1 (212) 854-9999, \v(d$px) is set to 854.
<p>
<dt><b>SET DIAL PBX-INSIDE-PREFIX <tt>\f</tt></b><tt><i>xxx</i>(...)</tt></b>
<dd>If the PBX Inside Prefix is defined to be a function, its evaluation is
  deferred until dialing time.  Normally, this would be a string function
  having \v(d$px) as an operand.  Of course, you can still specify a constant
  string, as before.
</dl><p>
So given the following setup:
<p><pre>
  SET DIAL COUNTRY-CODE 1
  SET DIAL AREA-CODE 212
  SET DIAL PBX-OUTSIDE-PREFIX 93,
  SET DIAL PBX-EXCHANGE 853 854
  SET DIAL PBX-INSIDE-PREFIX \fright(\v(d$px),1)
</pre><p>
The following numbers give the results indicated:
<p><pre>
 <u>Number</u>                   <u>Result</u>
  +1 (212) 854-9876        4-9876
  +1 (212) 853-1234        3-1234
  +1 (212) 765-4321        93,765-4321
  +1 (333) 765-4321        93,1333765-4321
</pre><p>
Furthermore, the K_PBX_XCH environment variable may now be set to a list of
exchanges to automatically initialize C-Kermit's PBX exchange list, for
example (in UNIX ksh or bash):
<p><pre>
  export K_PBX_XCH="853 854"
</pre><p>
(Quotes required because of the space.)  Of course, this variable can also be
set to a single exchange, as before:
<p><pre>
  export K_PBX_XCH=853
</pre>

<p>
<hr>
<h4><a name="x2.1.13">2.1.13. The DIAL macro - Last-Minute Phone Number Conversions</a></h4>

After a DIAL or LOOKUP command is given, a list of phone numbers is assembled
from the dialing directory (if any), with all location-dependent conversion
rules applied as described in Chapter 5 of <a href="ckb2.html"><cite>Using C-Kermit</cite></a>.
<p>
However, additional conversions might still be required at the last minute
based on local or ephemeral conditions.  So that you can have the final word
on the exact format of the dial string, C-Kermit 7.0 lets you pass the
converted string through a macro of your own design for final processing
before dialing.  The relevant command is:
<p><dl>
<dt><b>SET DIAL MACRO</b> <i>[ name ]</i>
<dd>Specifies the name of a macro to be run on each phone number after all
built-in conversions have been applied, just before the number is dialed.
If no name is given, no macro is run.  The phone number, as it would have
been dialed if there were no dial macro, is passed to the macro.
</dl><p>
The dial macro can do anything at all (except start a file transfer).
However, the normal use for the macro would be to modify the phone number.
For this reason the phone number is passed to the macro as argument number 1
(\%1).  To cause a modified number to be dialed, the macro should terminate
with a RETURN statement specifying a return value.  To leave the number alone,
the macro should simply end.  Example:
<p><pre>
  define xxx return 10108889999$\%1
  set dial macro xxx
  dial xyzcorp
</pre><p>
This defines a DIAL MACRO called xxx, which puts an access code on the
front of the number.  Another example might be:
<p><pre>
  def xxx if equal "\v(modem)" "hayes-1200" return \freplace(\%1,$,{,,,,,})
  set dial macro xxx
  dial xyzcorp
</pre><p>
which replaces any dollar-sign in the dial string by a series of five commas,
e.g. because this particular modem does not support the "wait for bong"
feature (remember that commas that are to be included literally in function
arguments must be enclosed in braces to distinguish them from the commas that
separate the arguments) and when the IF condition is not satisfied, the macro
does not return a value, and so the number is not modified.  Then when a DIAL
command is given referencing a dialing directory entry, "xyzcorp".  The macro
is automatically applied to each matching number.
<p>
Numerous dial-, modem-, communications-, and time-related variables are
available for decision making your dial macro.  Type SHOW VARIABLES for a
list.  Of particular interest is the \v(dialcount) variable, which tells how
many times the DIAL command gone through its retry loop: 1 on the first try,
2 on the second, 3 on the third, and so on, and the \v(dialresult) and
\v(dialstatus) variables.
<p>
Here are some other applications for the DIAL MACRO (from users):
<p><ul>
<li>Phone numbers in the dialing directory are formatted with '<tt>-</tt>'
for readability, but some modems don't like the hyphens, so the DIAL
macro is used to remove them before dialing; e.g 0090-123-456-78-99
becomes 00901234567899: "<tt>def xxx return \freplace(\%1,-)</tt>".
<p>
<li>To set some specific modem (or other) options depending on the called
customer or telephone number.
<p>
<li>Choosing the most appropriate provider based on (e.g.) time of day,
or cycling through a list of providers in case some providers might
be busy.
</ul><p>
To illustrate the final item, suppose you have a choice among many phone
service providers; the provider is chosen by dialing an access code before the
number.  Different providers might be better (e.g. cheaper) for certain times
of day or days of the week, or for dialing certain locations; you can use the
DIAL macro to add the access for the most desirable provider.
<p>
Similarly, when the same number might be reached through multiple providers,
it's possible that one provider might not be able to complete the call, but
another one can.  In that case, you can use the DIAL macro to switch providers
each time through the DIAL loop -- that's where the \v(dialcount) variable
comes in handy.
<p>
The following command can be used to debug the DIAL macro:
<p><dl>
<dt><b>SET DIAL TEST </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Normally OFF, so the DIAL command actually dials.  When ON, the DIAL
command performs all lookups and number conversions, and then goes through
the number list and retry loop, but instead of actually dialing, lists
the numbers it would have called if none of the DIAL attempts succeeded
(or more precisely, every number was always busy).
</dl>

<p>
<hr>
<h4><a name="x2.1.14">2.1.14. Automatic Tone/Pulse Dialing Selection</a></h4>

<dl>
<dt><b>SET DIAL METHOD</b> <i>{</i> <b>AUTO, DEFAULT, PULSE, TONE</b> <i>}</i>
<dd>Chooses the dialing method for subsequent calls.
</dl>
<p>
Prior to version 7.0, C-Kermit's DIAL METHOD was DEFAULT by default, meaning
it does not specify a dialing method to the modem, but relies on the modem
to have an appropriate default dialing method set.  So, for example, when
using Hayes compatible modems, the dial string would be something like
ATD7654321, rather than ATDT7654321 or ATDP7654321.
<p>
In C-Kermit 7.0 and K95 1.1.19, the dial method can be set from the
environment variable:
<p><pre>
  K_DIAL_METHOD
</pre><p>
when Kermit starts.  The values can be TONE, PULSE, or DEFAULT, e.g. (UNIX):
<p><pre>
  set K_DIAL_METHOD=TONE; export K_DIAL_METHOD
</pre><p>
In the absence of a K_DIAL_METHOD definition, the new default SET DIAL METHOD
is AUTO rather than DEFAULT.  When DIAL METHOD is AUTO and the local country
code is known, then if tone dialing is universally available in the
corresponding area, tone dialing is used; if dialing from a location where
pulse dialing is mandatory, pulse dialing is used.
<p>
The "tone country" and "pulse country" lists are preloaded according to our
knowledge at the time of release.  You can see their contents in the SHOW
DIAL listing.  You can change the lists with:
<p><dl>
<dt><b>SET DIAL TONE-COUNTRIES</b> <i>[ cc [ cc [ ... ] ] ]</i>
<dd>Replaces the current TONE-COUNTRIES list with the one given.  Each cc is
a country code; separate them with spaces (not commas).  Example:
<p><pre>
  set dial tone-countries 1 358 44 46 49
</pre><p>
If no country codes are given, the current list, if any, is removed, in
which case SET DIAL METHOD AUTO is equivalent to SET DIAL METHOD DEFAULT.
<p>
<dt><b>SET DIAL PULSE-COUNTRIES</b> <i>[ cc [ cc [ ... ] ] ]</i>
<dd>Replaces the current PULSE-COUNTRIES list with the one give.  Syntax and
operation is like SET DIAL TONE-COUNTRIES.
</dl><p>
If the same country code appears in both lists, Pulse takes precedence.
<p>
The SET DIAL TONE- and PULSE-COUNTRIES commands perform no verification
whatsoever on the cc's, since almost any syntax might be legal in some
settings.  Furthermore, there is no facility to edit the lists; you can only
replace the whole list.  However, since the only purpose of these lists is to
establish a basis for picking tone or pulse dialing automatically, all you
need to override the effect of the list is to set a specific dialing method
with SET DIAL METHOD TONE or SET DIAL METHOD PULSE.

<p>
<hr>
<h4><a name="x2.1.15">2.1.15. Dial-Modifier Variables</a></h4>

As of C-Kermit 7.0, dial modifiers are available in the following variables:
<p><pre>
 \v(dm_lp) Long pause
 \v(dm_sp) Short pause
 \v(dm_pd) Pulse dial
 \v(dm_td) Tone dial
 \v(dm_wa) Wait for answer
 \v(dm_wd) Wait for dialtone
 \v(dm_rc) Return to command mode
</pre><p>
You can use these in your dial strings in place of hardwired modifiers like
"@", ",", etc, for increased portability of scripts.  Example:
<p><pre>
  C-Kermit&#62;<u>set modem type usrobotics</u>
  C-Kermit&#62;<u>sho variables dm</u>
   \v(dm_lp) = ,
   \v(dm_sp) = /
   \v(dm_pd) = P
   \v(dm_td) = T
   \v(dm_wa) = @
   \v(dm_wd) = W
   \v(dm_rc) = ;
  C-Kermit&#62;exit
</pre>

<p>
<hr>
<h4><a name="x2.1.16">2.1.16. Giving Multiple Numbers to the DIAL Command</a></h4>

Prior to C-Kermit 7.0, the only way to give a DIAL command a list of phone
numbers to try until one answers was to create a dialing directory that had
multiple entries under the same name, and then use that entry name in the DIAL
command.  Now a list of numbers can be given to the DIAL command directly in
the following format:
<p><pre>
  dial {{number1}{number2}{number3}...}
</pre><p>
This is the same list format used by SEND /EXCEPT: and other commands that
allow a list where normally a single item is given.  Restrictions on this
form of the DIAL command are:
<p><ul>
<li>The first two braces must be adjacent; spacing is optional thereafter.
<li>Each number must be an actual number to dial, not a dialing directory entry.
<li>Dialing directory entries may not contain number lists in this format.
</ul><p>
In all other respects, the numbers are treated as if they had been fetched
from the dialing directory; they can be in literal or portable format, etc.
Example:
<p><pre>
  dial {{7654321} {+1 (212) 5551212} { 1-212-5556789 }}
</pre><p>
The list can be any length at all, within reason.
<p>
This feature is especially handy for use with the K95 Dialer, allowing a list
of phone numbers to be specified in the Telephone Number box without having
to set up or reference a separate dialing directory.
<p>
You can also use it to add commonly-dialed sequences as variables in your
C-Kermit customization file, e.g.:
<p><pre>
  define work {{7654321}{7654322}{7654323}}
</pre><p>
and then:
<p><pre>
  dial {\m(work)}
</pre><p>
(the variable name must be enclosed in braces).
<p>
Or more simply:
<p><pre>
  define work dial {{7654321}{7654322}{7654323}}
</pre><p>
and then:
<p><pre>
  work
</pre>

<p>
<hr>
<h3><a name="x2.2">2.2. Modems</a></h3>
<h4><a name="x2.2.1">2.2.1. New Modem Types<a/></h4>
<p>
Since C-Kermit 6.0:
<p><pre>
  atlas-newcom-33600ifxC Atlas/Newcom 33600
  att-keepintouch        AT&#38;T KeepinTouch PCMCIA V.32bis Card Modem
  att-1900-stu-iii       AT&#38;T Secure Data STU-III Model 1900
  att-1910-stu-iii       AT&#38;T Secure Data STU-III Model 1910
  bestdata               Best Data
  cardinal               Cardinal V.34 MVP288X series.
  compaq                 Compaq Data+Fax (e.g. in Presario)
  fujitsu                Fujitsu Fax/Modem Adapter
  generic-high-speed     Any modern error-correcting data-compressing modem
  itu-t-v25ter/v250      ITU-T (CCITT) V.25ter (V.250) standard command set
  megahertz-att-v34      Megahertz AT&#38;T V.34
  megahertz-xjack        Megahertz X-Jack
  motorola-codex         Motorola Codex 326X Series
  motorola-montana       Motorola Montana
  mt5634zpx              Multitech MT5634ZPX
  rockwell-v90           Rockwell V.90 56K
  rolm-244pc             Siemens/Rolm 244PC (AT command set)
  rolm-600-series        Siemens/Rolm 600 Series (AT command set)
  spirit-ii              QuickComm Spirit II
  suprasonic             SupraSonic V288+
  supra-express-v90      Supra Express V.90
</pre><p>

One of the new types, "<b>generic-high-speed</b>" needs a bit of explanation.
This type was added to easily handle other types that are not explicitly
covered, without going through the bother of adding a complete user-defined
modem type.  This one works for modern modems that use the AT command set, on
the assumption that all the default ("factory") settings of the modem (a) are
appropriate for Kermit, (b) include error correction, data compression, and
speed buffering; and (c) are recallable with the command <tt>AT&#38;F</tt>.

<p>

If the command to recall your modem's profile is not <tt>AT&#38;F</tt>, use
the SET MODEM COMMAND INIT-STRING command to specify the appropriate modem
command.  The default init-string is <tt>AT&#38;F\13</tt> (that is, AT,
ampersand, F, and then carriage return); a survey of about 20 modern modem
types shows they all support this, but they might mean different things by it.
For example, the USR Sportster or Courier needs <tt>AT&#38;F1</tt> (not
<tt>AT&#38;F</tt>, which is equivalent to <tt>AT&#38;F0</tt>, which recalls an
inappropriate profile), so for USR modems:

<p><pre>
  set modem type generic-high-speed
  set modem command init AT&#38;F1\13
</pre><p>

Of course, USR modems already have their own built-in modem type.  But if you
use this one instead, it will dial faster because it has fewer commands to
give to the modem; in that sense "<tt>&#38;F1</tt>" is like a macro that
bundles numerous commands into a single one.  See your modem manual for
details about factory profiles and commands to recall them.

<p>

WARNING: Do not use the generic-high-speed modem type in operating systems
like VMS where hardware flow control is not available, at least not unless you
change the init string from <tt>AT&#38;F\13</tt> to something else that
enables local Xon/Xoff or other appropriate type of flow control.

<p>
Also see 
<a href="#x2.1.7">Section 2.1.7</a> for additional hints about making dialing go faster.

<p>
<hr>
<h4><a name="x2.2.2">2.2.2. New Modem Controls</a></h4>

<dl>
<dt><b>SET MODEM CAPABILITIES</b> <i>list</i>
<dd>In C-Kermit 7.0, this command automatically turns MODEM SPEED-MATCHING OFF
if SB (Speed Buffering) is in the <i>list</i>, and turns it ON if SB is absent.
<p>
<dt><b>SET MODEM COMMAND PREDIAL-INIT</b><i> [ text ]</i>
<dd>Commands to be sent to the modem just prior to dialing.  Normally none.
<p>
<dt><b>SET MODEM SPEAKER </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Determines whether modem speaker is on or off while call is being placed.
ON by default.  Note: This command does not provide fine-grained control
over when the speaker is on or off.  Normally, ON means while the call is
being placed, until the point at which carrier is successfully established.
If your modem has a different speaker option that you want to choose, then
use the SET MODEM COMMAND SPEAKER ON <i>text</i> command to specify this
option. 
<p>
<dt><b>SET MODEM COMMAND SPEAKER</b> <i>{</i> <b>ON, OFF</b> <i>} [ <i>text</i> ]</i>
<dd>Specify or override the commands to turn your modem's speaker on and off.
<p>
<dt><b>SET MODEM VOLUME</b> <i>{</i> <b>LOW, MEDIUM, HIGH</b> <i>}</i>
<dd>When MODEM SPEAKER is on, select volume.  Note: In some modems, especially
  internal ones, these commands have no effect; this is a limitation of the
  particular modem, not of Kermit.
<p>
<dt><b>SET MODEM COMMAND VOLUME</b> <i>{</i> <b>LOW, MEDIUM, HIGH</b> <i>} [ text ]</i>
<dd>Specify or override the commands to set your modem's speaker volume.
<p>
<dt><b>SET MODEM COMMAND IGNORE-DIALTONE</b> <i>[ text ]</i>
<dd>The command to enable blind dialing (<a href="#x2.1.6">Section 2.1.6</a>).
<p>
<dt><b>SET MODEM ESCAPE-CHARACTER</b> <i>code</i>
<dd>Has been augmented to allow codes of 0 or less: &#60; 0 means the escape
mechanism is disabled.  = 0 means to use (restore) the default value from the
modem database.  &#62; 0 and &#60; 128 is a literal value to be used instead
of the default one.  &#62; 127 means the escape mechanism is disabled.  This
affects "modem hangup".  When the escape mechanism is disabled, but SET MODEM
HANGUP-METHOD is MODEM-COMMAND, it sends the hangup command immediately,
without the &#60;pause&#62;+++&#60;pause&#62; business first.  This is useful
(for example) when sending lots of numeric pages, a process in which never we
go online, and so never need to escape back.  Eliminating the unnecessary
pauses and escape sequence allows a lot more pages to be sent per unit time.
</dl>	
<p>
Recall that C-Kermit can dial modems to which it is connected via TCP/IP
(Telnet or Rlogin) as described on page 126 of <a href="ckb2.html"><cite>Using C-Kermit</cite></a>, 2nd Ed.
In this case the MODEM HANGUP-METHOD should be MODEM-COMMAND, since RS-232
signals don't work over TCP/IP connections.  As noted in the manual, such
connections are set up by the following sequence:
<p><pre>
  set host <i>host [ port ]</i>
  set modem type <i>name</i>
  dial <i>number</i>
</pre><p>
But this can cause complications when you use Kermit to switch between serial
and TCP/IP connections.  In the following sequence:
<p><pre>
  set host <i>name</i>
  set modem type <i>name</i>
  set port <i>name</i>
</pre><p>
the first two commands obey the rules for dialing out over Telnet.  However,
the SET PORT command requires that Kermit close its current (Telnet)
connection before it can open the serial port (since Kermit can only have one
connection open at a time).  But since a modem type was set after the "set
host" command was given, Kermit assumes it is a Telnet dialout connection and
so sends the modem's hangup sequence is sent to the Telnet host.  To avoid
this, close the network connection explicitly before opening the serial one:
<p><pre>
  set host <i>name</i>
  close
  set modem type <i>name</i>
  set port <i>name</i>
</pre>

<p>
<hr>
<h3><a name="x2.3">2.3. TELNET and RLOGIN</a></h3>

For additional background, please also read the 
<a href="ftp://kermit.columbia.edu/kermit/f/telnet.txt">TELNET.TXT</a>
file, also available on the Web in <a href="telnet.html">HTML format</a>.
<p>
<i>Cautions:</i>
<p>
<ul>
<li>If making a Telnet connection with C-Kermit takes a very long time, like
over a minute, whereas the system Telnet program makes the same connection
immediately, try including the /NOWAIT switch:
<p><pre>
  C-Kermit&#62; <u>telnet /nowait hostname</u>
</pre><p>
See 
<a href="ftp://kermit.columbia.edu/kermit/f/telnet.txt">TELNET.TXT</a>
or <a href="telnet.html">TELNET.HTM</a>
for details.  If it also takes a very long time to make a
Telnet connection with system Telnet, then the delay is most likely caused
by reverse DNS lookups when your host is not properly registered in DNS.
<p>
<li>When supplying numeric IP addresses to C-Kermit or to any other application
(regular Telnet, Rlogin, etc), do not include leading 0's in any fields unless
you intend for those fields to be interpreted as octal (or hex) numbers.  The
description of the Internet address interpreter (the sockets library
<tt>inet_addr()</tt> routine) includes these words:
<p><blockquote>
All numbers supplied as "parts" in a "<tt>.</tt>" notation may be decimal,
octal, or hexadecimal, as specified in the C language (that is, a leading 0x
or 0X implies hexadecimal; otherwise, a leading 0 implies octal; otherwise,
the number is interpreted as decimal).
</blockquote><p>
To illustrate, 128.59.39.2 and 128.059.039.002 are <i>not</i> the same host!
Even though most of the fields contain non-octal digits.  Using system Telnet
(not Kermit):
<p><pre>
  $ <u>telnet 128.059.039.002</u>
  Trying 128.49.33.2 ...
</pre><p>
Of course the same thing happens with Kermit because it uses (as it must) the
same system service for resolving network addresses that Telnet, FTP, and all
other TCP/IP applications use.
<p>
<li>The RLOGIN section on page 123 does not make it clear that you can use the
SET TELNET TERMINAL-TYPE command to govern the terminal type that is reported
by C-Kermit to the RLOGIN server.
<p>
<li>Note that the SET TCP commands described on pages 122-123 might be absent;
some platforms that support TCP/IP do not support these particular controls.
</ul>
<p>

New commands:
<p><dl>
<dt><b>TELOPT</b> <i>{</i> <b>AO, AYT, BREAK, CANCEL, EC, EL, EOF, EOR, GA, IP, DMARK,<br>
DO, DONT, NOP, SB, SE, SUSP, WILL, WONT</b> <i>}</i></b>
<dd>This command was available previously, but supported only DO, DONT, WILL,
  and WONT.  Now it lets you send all the Telnet protocol commands.  Note
  that certain commands do not require a response, and therefore can be used
  as nondestructive "probes" to see if the Telnet session is still open; e.g.:
<p><pre>
  set host xyzcorp.com
  ...
  telopt nop
  if fail stop 1 Connection lost
</pre><p>
<dt><b>SET TCP ADDRESS</b> [ ip-address ]</i>
<dd>Specifies the IP address of the computer that C-Kermit is running on.
  Normally this is not necessary.  The exception would be if your
  machine has multiple network adapters (physical or virtual) with a
  different address for each adapter AND you want C-Kermit to use a
  specific address when making outgoing connections or accepting
  incoming connections.
<p>
<dt><b>SET TCP DNS-SERVICE-RECORDS</b> <i>{</i> <b>ON, OFF</b> <i>}</i>
<dd>Tells C-Kermit whether to try to use DNS SRV records to determine the
  host and port number upon which to find an advertised service.  For
  example, if a host wants regular Telnet connections redirected to some
  port other than 23, this feature allows C-Kermit to ask the host which
  port it should use.  Since not all domain servers are set up to answer
  such requests, this feature is OFF by default.
<p>
<dt><b>SET TCP REVERSE-DNS-LOOKUP</b> <i>{</i> <b>ON, OFF, AUTO</b> <i>}</i>
<dd>Tells Kermit whether to perform a reverse DNS lookup on TCP/IP connections.
  This allows Kermit to determine the actual hostname of the host it is
  connected to, which is useful for connections to host pools, and is required
  for Kerberos connections to host pools and for incoming connections.  If the
  other host does not have a DNS entry, the reverse lookup could take a long
  time (minutes) to fail, but the connection will still be made.  Turn this
  option OFF for speedier connections if you do not need to know exactly which
  host you are connected to and you are not using Kerberos.  AUTO, the
  default, means the lookup is done on hostnames, but not on numeric IP
  addresses.
<p>
<dt><b>SET TELNET WAIT-FOR-NEGOTIATIONS </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Each Telnet option must be fully negotiated either On or Off before the
  session can continue.  This is especially true with options that require
  sub-negotiations such as Authentication, Encryption, and Kermit; for
  proper support of these options Kermit must wait for the negotiations to
  complete.  Of course, Kermit has no way of knowing whether a reply is
  delayed or not coming at all, and so will wait a minute or more for
  required replies before continuing the session.  If you know that Kermit's
  Telnet partner will not be sending the required replies, you can set this
  option of OFF to avoid the long timeouts.  Or you can instruct Kermit to
  REFUSE specific options with the SET TELOPT command.
<p>
<dt><b>SET TELOPT</b> <i>[ {</i> <b>/CLIENT, /SERVER</b> <i> } ] option</i><br>
<i>{</i> <b>ACCEPTED, REFUSED, REQUESTED, REQUIRED</b> <i>}</i><br>
<i>[ {</i> <b>ACCEPTED, REFUSED, REQUESTED, REQUIRED</b> <i>} ]</i>
<dd>SET TELOPT lets you specify policy requirements for Kermit's handling of
  Telnet option negotiations.  Setting an option is REQUIRED causes Kermit
  to offer the option to the peer and disconnect if the option is refused.
  REQUESTED causes Kermit to offer an option to the peer.  ACCEPTED results
  in no offer but Kermit will attempt to negotiate the option if it is
  requested.  REFUSED instructs Kermit to refuse the option if it is
  requested by the peer.
<p>
  Some options are negotiated in two directions and accept separate policies
  for each direction; the first keyword applies to Kermit itself, the second
  applies to Kermit's Telnet partner; if the second keyword is omitted, an
  appropriate (option-specific) default is applied.  You can also include a
  /CLIENT or /SERVER switch to indicate whether the given policies apply
  when Kermit is the Telnet client or the Telnet server; if no switch is
  given, the command applies to the client.
<p>
  Note that some of Kermit's Telnet partners fail to refuse options that
  they do not recognize and instead do not respond at all.  In this case it
  is possible to use SET TELOPT to instruct Kermit to REFUSE the option
  before connecting to the problem host, thus skipping the problematic
  negotiation.
<p>
  Use SHOW TELOPT to view current Telnet Option negotiation settings.
  SHOW TELNET displays current Telnet settings.
</dl>

<p>
<hr>
<h4><a name="x2.3.0">2.3.0. Bug Fixes</a></h4>

If "set host nonexistent-host" was given (and it properly failed), followed by
certain commands like SEND, the original line and modem type were not restored
and C-Kermit thought that it still had a network hostname; fixed in 7.0.

<h4><a name="x2.3.1">2.3.1. Telnet Binary Mode Bug Adjustments</a></h4>

SET TELNET BUG BINARY-ME-MEANS-U-TOO <i>{</i> ON, OFF <i>}</i> was added to
edit 192 after the book was printed.  Also SET TELNET BUG
BINARY-U-MEANS-ME-TOO.  The default for both is OFF.  ON should be used when
communicating with a Telnet partner (client or server) that mistakenly
believes that telling C-Kermit to enter Telnet binary mode also means that it,
too, is in binary mode, contrary to the Telnet specification, which says that
binary mode must be negotiated in each direction separately.

<h4><a name="x2.3.2">2.3.2. VMS UCX Telnet Port Bug Adjustment</a></h4>

A new command, SET TCP UCX-PORT-BUG, was added for VMS versions with UCX (DEC
TCP/IP), applying only to early versions of UCX, like 2.2 or earlier.  If you
try to use VMS C-Kermit to make a Telnet connection using a port name (like
"telnet", which is used by default), the underlying UCX
<tt>getservbyname()</tt> function might return the service number with its
bytes swapped and the connection will fail.  If "telnet hostname 23" works,
then your version of UCX has this bug and you can put "set tcp ucx-port-bug
on" in your <tt>CKERMIT.INI</tt> file to get around it.

<h4><a name="x2.3.3">2.3.3. Telnet New Environment Option</a></h4>

The TELNET NEW-ENVIRONMENT option
(<a href="ftp://ftp.isi.edu/in-notes/rfc1572.txt">RFC 1572</a>)
is supported as 7.0.  This option
allows the C-Kermit Telnet client to send certain well-known variables to the
Telnet server, including USER, PRINTER, DISPLAY, and several others.  This
feature is enabled by default in Windows and OS/2, disabled by default
elsewhere.  The command to enable and disable it is:
<p><pre>
  SET TELNET ENVIRONMENT <i>{</i> ON, OFF <i>}</i>
</pre><p>
When ON, and you Telnet to another computer, you might (or might not) notice
that the "login:" or "Username:" prompt does not appear -- that's because your
username was sent ahead, in which case the remote system might prompt you only
for your password (similar to Rlogin).  Use "set telnet environment off" to
defeat this feature, particularly in scripts where the dialog must be
predictable.  You can also use this command to specify or override specific
well-known environment variable values:
<p><pre>
 SET TELNET ENVIRONMENT <i>{</i> ACCT,DISPLAY,JOB,PRINTER,SYSTEMTYPE,USER <i>} [ text ]</i>
</pre>

<h4><a name="x2.3.4">2.3.4. Telnet Location Option</a></h4>

The TELNET LOCATION option
(<a href="ftp://ftp.isi.edu/in-notes/rfc779.txt">RFC 779</a>)
is supported in 7.0.  This option allows
the C-Kermit Telnet client to send a location string to the server if the
server indicates its willingness to accept one.  If an environment variable
named LOCATION exists at the time C-Kermit starts, its value is used as the
location string.  If you want to change it, use:
<p><pre>
  SET TELNET LOCATION <i>text</i>
</pre><p>
If you omit the <i>text</i> from this command, the Telnet location feature is
disabled.
<p>
SET TELNET ENVIRONMENT DISPLAY is used to set the DISPLAY variable that is
sent to the host, as well as the the XDISPLAY location.

<h4><a name="x2.3.5">2.3.5. Connecting to Raw TCP Sockets</a></h4>

The SET HOST and TELNET commands now accept an optional switch, /RAW-SOCKET,
at the end, only if you first give a host and a port.  Example:
<p><pre>
  set host xyzcorp.com 23 /raw-socket
  set host 128.49.39.2:2000 /raw-socket
  telnet xyzcorp.com 3000 /raw
</pre><p>
Without this switch, C-Kermit behaves as a Telnet client when (a) the port is
23 or 1649, or (b) the port is not 513 and the server sent what appeared to be
Telnet negotiations -- that is, messages starting with 0xFF (IAC).  With this
switch, Kermit should treat all incoming bytes as raw data, and will not
engage in any Telnet negotiations or NVT CRLF manipulations.  This allows
transparent operation through (e.g.) raw TCP ports on Cisco terminal servers,
through the 'modemd' modem server, etc.

<h4><a name="x2.3.6">2.3.6. Incoming TCP Connections</a></h4>

Accomplished via SET HOST * <i>port</i>, were introduced in C-Kermit 6.0, but
for UNIX only.  In Version 7.0, they are also available for VMS.

<p>
<hr>

<h3><a name="x2.4">2.4. The EIGHTBIT Command</a></h3>

EIGHTBIT is simply a shorthand for: SET PARITY NONE, SET TERMINAL BYTESIZE 8,
SET COMMAND BYTESIZE 8; that is, a way to set up an 8-bit clean connection
in a single command.

<p>
<hr>
<h3><a name="x2.5">2.5. The Services Directory</a></h3>

Chapter 7 of <a href="ckb2.html"><cite>Using C-Kermit</cite></a> does not mention the ULOGIN macro, which is
used by our sample services directory, CKERMIT.KND.  Unlike UNIXLOGIN,
VMSLOGIN, etc, this one is for use with systems that require a user ID but
no password.  Therefore it doesn't prompt for a password or wait for a
password prompt from the remote service.
<p>
In version 7.0, the CALL macro was changed to not execute a SET MODEM TYPE
command if the given modem type was the same as the current one; otherwise the
new SET MODEM TYPE command would overwrite any customizations that the user
had made to the modem settings.  Ditto for SET LINE / SET PORT and SET SPEED.

<p>
<hr>
<h3><a name="x2.6">2.6. Closing Connections</a></h3>

Until version 7.0, there was never an obvious and general way to close a
connection.  If a serial connection was open, it could be closed by "set
line" or "set port" (giving no device name); if a network connection was
open, it could be closed by "set host" (no host name).
<p>
In version 7.0, a new command closes the connection in an obvious and
straightforward way, no matter what the connection type:
<p><pre>
  CLOSE <i>[</i> CONNECTION <i>]</i>
</pre><p>
The CLOSE command was already present, and required an operand such as
DEBUG-LOG, WRITE-FILE, etc, and so could never be given by itself.  The new
CONNECTION operand is now the default operand for CLOSE, so CLOSE by itself
closes the connection, if one is open, just as you would expect, especially
if you are a Telnet or Ftp user.
<p>
Also see the description of the new SET CLOSE-ON-DISCONNECT command in
<a href="#x2.10">Section 2.10</a>.

<p>
<hr>
<h3><a name="x2.7">2.7. Using C-Kermit with External Communication Programs</a></h3>

C-Kermit 7.0 includes a new ability to create and conduct sessions through
other communications programs.  Two methods are available:
<p><ol>
<li><b>Pty</b> (pseudoterminal): The external program is run on a
"pseudoterminal",
which is controlled by Kermit.  This method works with practically any
external program, but it is not portable.  At this writing, it works only
on some (not all) UNIX versions, and not on any non-UNIX platforms.
<p>
<li><b>Pipe</b>: The external program's standard input and output are
redirected through a "pipe" controlled by Kermit.  This method is relatively
portable -- it should work across all UNIX versions, and it also works in
Windows and OS/2 -- but it is effective only when the external program
actually uses standard i/o (and many don't).
</ol><p>
The two methods are started differently but are used the same way thereafter.
<p>
The purpose of this feature is to let you use C-Kermit services like file
transfer, character-set translation, scripting, automatic dialing, etc, on
connections that Kermit can't otherwise make itself.
<p>
This feature is the opposite of the REDIRECT feature, in which C-Kermit makes
the connection, and redirects an external (local) command or program over this
connection.  In a pty or pipe connection, C-Kermit runs and controls a local
command or program, which makes the connection.  (The same method can be used
to simply to control a local program without making a connection; see
<a href="#x2.8">Section 2.8</a>.)
<p>
To find out if your version of Kermit includes PTY support, type "show
features" and look for NETPTY in the alphabetical list of options.  For pipes,
look for NETCMD.
<p>
The commands are:
<p><dl>
<dt><b>SET NETWORK TYPE PTY</b>  <i>or</i>  <b>SET NETWORK TYPE PIPE</b>
<dt><b>SET HOST</b> <i>command</i>
<dd>where <i>command</i> is any interactive command.  If the command does not
use standard i/o, you must use SET NETWORK TYPE PTY.
</dl><p>
Notes:
<p>
<ul>
<li>COMMAND is an invisible synonym for PIPE.
<li>The <i>command</i> and its arguments are case-sensitive in UNIX.
</ul><p>

The SET NETWORK TYPE, SET HOST sequence sets the given network type for all
subsequent SET HOST commands until another SET NETWORK TYPE command is given
to change it.
<p>
You can also use the new <b>/NETWORK-TYPE:PTY</b> or <b>/NETWORK-TYPE:PIPE</b>
(or simply <b>/PIPE</b> or <b>/PTY</b>) switches on the SET HOST command
itself:
<p><pre>
  SET HOST /NETWORK-TYPE:PIPE <i>command</i>  ; These two are the same
  SET HOST /PIPE <i>command</i>

  SET HOST /NETWORK-TYPE:PTY <i>command</i>   ; Ditto
  SET HOST /PTY <i>command</i>
</pre>
<p>

These are like SET NETWORK TYPE followed by SET HOST, except they apply only
to the connection being made and do not change the global network type setting
(see 
<a href="#x1.5">Section 1.5</a> about the difference between switches and SET
commands).
<p>

Include any command-line options with the <i>command</i> that might be needed,
as in this example where C-Kermit uses another copy of itself as the
communications program:
<p><pre>
  SET HOST /PIPE /CONNECT kermit -YQJ xyzcorp.com
</pre><p>
As usual, if you include the /CONNECT switch, SET HOST enters CONNECT mode
immediately upon successful execution of the given command.  Therefore new
commands are available as a shorthand for SET HOST /CONNECT /PTY and /PIPE:
<p><dl>
<dt><b>PTY</b> <i>[ command ]</i>
<dt><b>PIPE</b> <i>[ command ]</i>
<dd>The PTY and PIPE commands work like the TELNET and RLOGIN commands: they
set up the connection (in this case, using the given command) and then enter
CONNECT mode automatically (if the PIPE or PTY command is given without a
<i>command</i>, it continues the current session if one is active; otherwise it
gives an error message).
</dl>
<p>

The PIPE command is named after the mechanism by which C-Kermit communicates
with the <i>command</i>: UNIX pipes.  C-Kermit's i/o is "piped" through the
given command.  Here is a typical example:
<p><pre>
  PIPE rlogin -8 xyzcorp.com
</pre><p>
This is equivalent to:
<p><pre>
  SET HOST /PIPE rlogin -8 xyzcorp.com
  CONNECT
</pre><p>
and to:
<p><pre>
  SET HOST /PIPE /CONNECT rlogin -8 xyzcorp.com
</pre><p><dl>
<dt><b>IMPORTANT:</b>
<dd>If you are writing a script, do not use the PIPE, PTY, TELNET, or RLOGIN
  command unless you really want C-Kermit to enter CONNECT mode at that
  point.  Normally SET HOST is used in scripts to allow the login and
  other dialogs to be controlled by the script itself, rather than by
  an actively participating human at the keyboard.
</dl>
<p>

Throughput of pty and pipe connections is limited by the performance of the
chosen command or program and by the interprocess communication (IPC) method
used and/or buffering capacity of the pipe or pty, which in turn depends on
the underlying operating system.
<p>
In one trial (on SunOS 4.1.3), we observed file transfer rates over an rlogin
connection proceeding at 200Kcps for downloads, but only 10Kcps for uploads on
the same connection with the same settings (similar disparities were noted in
HP-UX).  Examination of the logs revealed that a write to the pipe could take
as long as 5 seconds, whereas reads were practically instantaneous.  On the
other hand, using Telnet as the external program rather than rlogin, downloads
and uploads were better matched at about 177K each.
<p>
Most external communication programs, like C-Kermit itself, have escape
characters or sequences.  Normally these begin with (or consist entirely of) a
control character.  You must be sure that this control character is not
"unprefixed" when uploading files, otherwise the external program will "escape
back" to its prompt, or close the connection, or take some other unwanted
action.  When in CONNECT mode, observe the program's normal interaction rules.
Of course C-Kermit's own escape character (normally Ctrl-\) is active too,
unless you have taken some action to disable it.
<p>
On PTY connections, the underlying PTY driver is not guaranteed to be
transparent to control characters -- for example, it might expand tabs,
translate carriage returns, generate signals if it sees an interrupt
character, and so on.  Similar things might happen on a PIPE connection.  For
this reason, if you plan to transfer files over a PTY or PIPE connection, tell
the file sender to:
<p><dl>
<dt><b>SET PREFIXING ALL</b>
<dd>This causes all control characters to be prefixed and transmitted
    as printable ASCII characters.
</dl><p>
If the external connection program is not 8-bit clean, you should also:
<p><dl>
<dt><b>SET PARITY SPACE</b>
<dd>This causes 8-bit data to be encoded in 7 bits using single and/or
    locking shifts.
</dl><p>
And if it does not make a reliable connection (such as those made by Telnet,
Rlogin, Ssh, etc), you should:
<p><dl>
<dt><b>SET STREAMING OFF</b>
<dd>This forces C-Kermit to treat the connection as unreliable and
to engage in its normal ACK/NAK protocol for error detection and
correction, rather than "streaming" its packets, as it normally
does on a network connection (<a href="#x4.20">Section 4.20</a>).
</dl>
<p>

In some cases, buffer sizes might be restricted, so you might also need to
reduce the Kermit packet length to fit; this is a trial-and-error affair.  For
example, if transfers always fail with 4000-byte packets, try 2000.  If that
fails too, try 1000, and so on.  The commands are:
<p><dl>
<dt><b>SET RECEIVE PACKET-LENGTH</b> <i>number</i>
<dd>This tells the file receiver to tell the file sender the longest
packet length it can accept.
<p>
<dt><b>SET SEND PACKET-LENGTH</b> <i>number</i>
<dd>This tells the file sender not to send packets longer than the given
length, even if the receiver says longer ones are OK.  Of course, if
the receiver's length is shorter, the shorter length is used.
</dl><p>
If none of this seems to help, try falling back to the bare minimum,
lowest-common-denominator protocol settings:
<p><dl>
<dt><b>ROBUST</b>
<dd>No sliding windows, no streaming, no control-character unprefixing,
packet length 90.
</dl><p>
And then work your way back up by trial and error to get greater throughput.
<p>
Note that when starting a PIPE connection, and the connection program (such as
telnet or rlogin) prints some greeting or information messages before starting
the connection, these are quite likely to be printed with a stairstep effect
(linefeed without carriage return).  This is because the program is not
connected with the UNIX terminal driver; there's not much Kermit can do about
it.  Once the connection is made, everything should go back to normal.  This
shouldn't happen on a PTY connection because a PTY is, indeed, a terminal.
<p>
On a similar note, some connection programs (like Solaris 2.5 rlogin) might
print lots of error messages like "ioctl TIOCGETP: invalid argument" when
used through a pipe.  They are annoying but usually harmless.  If you want to
avoid these messages, and your shell allows redirection of stderr, you can
redirect stderr in your pipe command, as in this example where the user's
shell is bash:
<p><pre>
  PIPE rlogin xyzcorp.com 2&#62; /dev/null
</pre><p>
Or use PTY rather than PIPE, since PTY is available on Solaris.

<p>
<hr>
<h4><a name="x2.7.0">2.7.0. C-Kermit over tn3270 and tn5250</a></h4>

Now you can make a connection from C-Kermit "directly" to an IBM mainframe and
transfer files with it, assuming it has Kermit-370 installed.  Because tn3270
is neither 8-bit clean nor transparent to control characters, you must give
these commands:
<p><pre>
  SET PREFIXING ALL   ; Prefix all control characters
  SET PARITY SPACE    ; Telnet connections are usually not 8-bit clean
</pre><p>
and then:
<p><pre>
  SET HOST /PTY /CONNECT tn3270 abccorp.com
</pre><p>
or simply:
<p><pre>
  pty tn3270 abccorp.com
</pre><p>
SET HOST /PIPE does not work in this case, at least not for file transfer.
File transfer does work, however, with SET HOST /PTY, provided you use the
default packet length of 90 bytes; anything longer seems to kill the session.
<p>
You can also make connections to IBM AS/400 computers if you have a tn5250
program installed:
<p><pre>
  pty tn5250 <i>hostname</i>
</pre><p>
In this case, however, file transfer is probably not in the cards since
nobody has ever succeeded in writing a Kermit program for the AS/400.
Hint:
<p><pre>
  define tn3270 {
      check pty
      if fail end 1 Sorry - no PTY support...
      pty tn3270 \%*
  }
</pre><p>
Similarly for tn5250.  Note that CHECK PTY and CHECK PIPE can be used in
macros and scripts to test whether PTY or PIPE support is available.

<p>
<hr>
<h4><a name="x2.7.1">2.7.1. C-Kermit over Telnet</a></h4>

Although C-Kermit includes its own Telnet implementation, you might need to
use an external Telnet program to make certain connections; perhaps because it
has access or security features not available in C-Kermit itself.  As noted
above, the only precautions necessary are usually:
<p><pre>
  SET PREFIXING ALL   ; Prefix all control characters
  SET PARITY SPACE    ; Telnet connections might not be 8-bit clean
</pre><p>
and then:
<p><pre>
  SET HOST /PTY (or /PIPE) /CONNECT telnet abccorp.com
</pre><p>
or, equivalently:
<p><pre>
  PTY <i>(or PIPE)</i> telnet abccorp.com
</pre>

<p>
<hr>
<h4><a name="x2.7.2">2.7.2. C-Kermit over Rlogin</a></h4>

C-Kermit includes its own Rlogin client, but this can normally be used only if
you are root, since the rlogin TCP port is privileged.  But ptys and pipes let
you make rlogin connections with C-Kermit through your computer's external
rlogin program, which is normally installed as a privileged program:
<p><pre>
  SET PREFIXING ALL
</pre><p>
and then:
<p><pre>
  SET HOST /PTY (or /PIPE) /CONNECT rlogin -8 abccorp.com
</pre><p>
or, equivalently:
<p><pre>
  PTY <i>(or PIPE)</i> rlogin -8 abccorp.com
</pre><p>
The "-8" option to rlogin enables transmission of 8-bit data.  If this is
not available, then include SET PARITY SPACE if you intend to transfer files.
<p>
Note that the normal escape sequence for rlogin is Carriage Return followed by
Tilde (~), but only when the tilde is followed by certain other characters;
the exact behavior depends on your rlogin client, so read its documentation.

<p>
<hr>
<h4><a name="x2.7.3">2.7.3. C-Kermit over Serial Communication Programs</a></h4>

Ptys and pipes also let you use programs that make serial connections, such as
cu or tip.  For example, C-Kermit can be used through cu to make connections
that otherwise might not be allowed, e.g. because C-Kermit is not installed
with the required write permissions to the dialout device and the UUCP
lockfile directory.
<p>
Suppose your UUCP Devices file contains an entry for a serial device tty04 to
be used for direct connections, but this device is protected against you (and
Kermit when you run it).  In this case you can:
<p><pre>
  SET CONTROL PREFIX ALL
  PTY <i>(or PIPE)</i> cu -l tty04
</pre><p>
(Similarly for dialout devices, except then you also need to include the phone
number in the "cu" command.)
<p>
As with other communication programs, watch out for cu's escape sequence,
which is the same as the rlogin program's: Carriage Return followed by Tilde
(followed by another character to specify an action, like "<tt>.</tt>" for
closing the connection and exiting from cu).

<p>
<hr>
<h4><a name="x2.7.4">2.7.4. C-Kermit over Secure Network Clients</a></h4>

<blockquote>
DISCLAIMER: There are laws in the USA and other countries regarding
use, import, and/or export of encryption and/or decryption or other
forms of security software, algorithms, technology, and intellectual
property.  The Kermit Project attempts to follow all known statutes,
and neither intends nor suggests that Kermit software can or should
be used in any way, in any location, that circumvents any regulations,
laws, treaties, covenants, or other legitimate canons or instruments
of law, international relations, trade, ethics, or propriety.
</blockquote><p>

For secure connections or connections through firewalls, C-Kermit 7.0 can be a
Kerberos, SRP, and/or SOCKS client when built with the appropriate options and
libraries.  But other application-level security acronyms and methods -- SSH,
SSL, SRP, TLS -- pop up at an alarming rate and are (a) impossible to keep up
with, (b) usually mutually incompatible, and (c) have restrictions on export
or redistribution and so cannot be included in C-Kermit itself.
<p>
However, if you have a secure text-based Telnet (or other) client that employs
one of these security methods, you can use C-Kermit "through" it via a pty
or pipe.

<p>
<hr>
<h4><a name="x2.7.4.1">2.7.4.1. SSH</a></h4>

C-Kermit does not and can not incorporate SSH due to licensing, patent,
and USA export law restrictions.
<p>
The UNIX SSH client does not use standard input/output, and therefore can be
used only by Kermit's PTY interface, if one is present.  The cautions about
file transfer, etc, are the same as for Rlogin.  Example:
<p><pre>
  SET PREFIXING ALL
  PTY ssh XYZCORP.COM
</pre><p>
Or, for a scripted session:
<p><pre>
  SET PREFIXING ALL
  SET HOST /PTY ssh XYZCORP.COM
</pre><p>
Hint:
<p><pre>
  define ssh {
      check pty
      if fail end 1 Sorry - no PTY support...
      pty ssh \%*
  }
</pre>

<p>
<hr>
<h4><a name="x2.7.4.2">2.7.4.2. SSL</a></h4>

Secure Sockets Layer (SSL) is another TCP/IP security overlay, this one
designed by and for Netscape.  An SSL Telnet client is available for UNIX
from the University of Queensland.  More info at:
<p><pre>
  <a href="http://www.psy.uq.oz.au/~ftp/Crypto/">http://www.psy.uq.oz.au/~ftp/Crypto/</a>
</pre><p>
Interoperability with C-Kermit is unknown.  C-Kermit also includes its own
built-in SSL/TLS support, but it is not exportable;
<a href="security.html">CLICK HERE</a> file for details.

<p>
<hr>
<h4><a name="x2.7.4.3">2.7.4.3. SRP</a></h4>

SRP(TM) is Stanford University's Secure Remote Password protocol.  An SRP
Telnet client is available from Stanford:
<p><pre>
  <a href="http://srp.stanford.edu/srp/">http://srp.stanford.edu/srp/</a>
</pre><p>
Stanford's SRP Telnet client for UNIX has been tested on SunOS and works fine
with C-Kermit, as described in 
<a href="#x2.7.1,">Section 2.7.1,</a> e.g.
<p><pre>
  SET PREFIX ALL
  PTY <i>(or PIPE)</i> srp-telnet xenon.stanford.edu
</pre><p>
C-Kermit itself can be built as an SRP Telnet client on systems that have
libsrp.a installed; the C-Kermit support code, however, may not be exported
outside the USA or Canada.

<p>
<hr>
<h4><a name="x2.7.4.4">2.7.4.4. SOCKS</a></h4>

C-Kermit can be built as a SOCKS-aware client on systems that have a SOCKS
library.  See section 8.1.1 of the
<a href="ftp://kermit.columbia.edu/kermit/f/ckccfg.txt"><tt>ckccfg.txt</tt></a>
file. 
<p>
C-Kermit 7.0 can also be run over SOCKSified Telnet or rlogin clients with SET
NETWORK TYPE COMMAND.  Suppose the Telnet program on your system is SOCKS
enabled but C-Kermit is not.  Make Kermit connections like this:
<p><pre>
  SET PREFIX ALL
  PTY <i>(or PIPE)</i> telnet zzz.com
</pre>

<p>
<hr>
<h4><a name="x2.7.4.5">2.7.4.5. Kerberos</a></h4>

UNIX C-Kermit can be built with MIT Kerberos IV or V authentication and
encryption.  Instructions are available in a
<a href="security.html">separate document</a>.
Additional modules are required that can not be exported from the USA to any
country except Canada, by US law.
<p>
If you have Kerberos installed but you don't have a Kerberized version of
C-Kermit, you can use ktelnet as C-Kermit's external communications program
to make secure connections without giving up C-Kermit's services:
<p><pre>
  SET PREFIX ALL
  PTY <i>(or PIPE)</i> ktelnet cia.gov
</pre>

<p>
<hr>
<h3><a name="x2.8">2.8. Scripting Local Programs</a></h3>

If your version of Kermit has PTY support built in, then any text-based
program can be invoked with SET HOST /PTY or equivalent command and controlled
using the normal sequence of OUTPUT, INPUT, IF SUCCESS commands (this is the
same service that is provided by the 'expect' program, but controlled by the
Kermit script language rather than Tcl).
<p>
When PTY service is not available, then any program that uses standard input
and output can be invoked with SET HOST /PIPE.
<p>
Here's an example in which we start an external Kermit program, wait for its
prompt, give it a VERSION command, and then extract the numeric version number
from its response:
<p><pre>
  set host /pty kermit -Y
  if fail stop 1 {Can't start external command}
  input 10 C-Kermit&#62;
  if fail stop 1 {No C-Kermit&#62; prompt}
  output version\13
  input 10 {Numeric: }
  if fail stop 1 {No match for "Numeric:"}
  clear input
  input 10 \10
  echo VERSION = "\fsubstr(\v(input),1,6)"
  output exit\13
</pre><p>
This technique could be used to control any other interactive program, even
those that do screen formatting (like Emacs or Vi), if you can figure out the
sequence of events.  If your Kermit program doesn't have PTY support, then the
commands are restricted to those using standard i/o, including certain shells,
interactive text-mode "hardcopy" editors like ex, and so on.
<p>
If you are using the PTY interface, you should be aware that it runs the
given program or command directly on the pty, without any intervening shell
to interpret metacharacters, redirectors, etc.  If you need this sort of
thing, include the appropriate shell invocation as part of your command; for
example:
<p><pre>
  pty echo *
</pre><p>
just echoes "*"; whereas:
<p><pre>
  pty ksh -c "echo *"
</pre><p>
echoes all the filenames that ksh finds matching "*".
<p>
Similarly for redirection:
<p><pre>
  set host /pty ksh -c "cat &#62; foo"  ; Note: use shell quoting rules here
  set transmit eof \4
  transmit bar
</pre><p>
And for that matter, for built-in shell commands:
<p><pre>
  set host /pty ksh -c "for i in *; do echo $i; done"
</pre><p>
The PIPE interface, on the other hand, invokes the shell automatically, so:
<p><pre>
  pipe echo *
</pre><p>
prints filenames, not "*".

<p>
<hr>
<h3><a name="x2.9">2.9. X.25 Networking</a></h3>

X.25 networking is documented in <a href="ckb2.html"><cite>Using C-Kermit</cite></a>, 2nd Edition.  When the book
was published, X.25 was available only in SunOS, Solaris, and Stratus VOS.
Unlike TCP/IP, X.25 APIs are not standardized; each vendor's X.25 libraries
and services (if they have them at all) are unique.
<p>
This section describes new additions.

<p>
<hr>
<h4><a name="x2.9.1">2.9.1. IBM AIXLink/X.25 Network Provider Interface for AIX</a></h4>

Support for X.25 was added via IBM's Network Provider Interface (NPI),
AIXLink/X.25 1.1, to the AIX 4.x version of C-Kermit 7.0.  Unfortunately,
AIXLink/X.25 is a rather bare-bones facility, lacking in particular any form
of PAD support (X.3, X.28, X.29).  Thus, the AIX version of C-Kermit, when
built to include X.25 networking, has neither a PAD command, nor a SET PAD
command.  The same is true for the underlying AIX system: no PAD support.
Thus it is not possible to have an interactive shell session over an X.25
connection into an AIX system (as far as we know), even from X.25-capable
Kermit versions (such as Solaris or VOS) that do include PAD support.
<p>
Thus the X.25 capabilities in AIX C-Kermit are limited to peer-to-peer
connections, e.g. from a C-Kermit client to a C-Kermit server.  Unlike the
Solaris, SunOS, and VOS versions, the AIX version can accept incoming X.25
connections:
<p><pre>
  set network type x.25
  if fail stop 1 Sorry - no X.25 support
  ; Put any desired DISABLE or ENABLE or SET commands here.
  set host /server *
  if fail stop 1 X.25 "set host *" failed
</pre><p>
And then access it from the client as follows:
<p><pre>
  set network type x.25
  if fail stop 1 Sorry - no X.25 support
  set host xxxxxxx ; Specify the X.25/X.121 address
  if fail stop 1 Can't open connection
</pre><p>
And at this point the client can use the full range of client commands:
SEND, GET, REMOTE xxx, FINISH, BYE.
<p>
The AIX version also adds two new variables:
<p><dl>
<dt><tt><b>\v(x25local_nua)</b></tt>
<dd>The local X.25 address.
<p>
<dt><tt><b>\v(x25remote_nua)</b></tt>
<dd>The X.25 address of the host on the other end of the connection.
</dl>
<p>

C-Kermit's AIX X.25 client has not been tested against anything other than
a C-Kermit X.25 server on AIX.  It is not known if it will interoperate with
C-Kermit servers on Solaris, SunOS, or VOS.
<p>
To make an X.25 connection from AIX C-Kermit, you must:
<p><pre>
  set x25 call-user-data <i>xxxx</i>
</pre><p>
where <i>xxxx</i> can be any even-length string of hexadecimal digits, e.g.
123ABC.

<p>
<hr>
<h4><a name="x2.9.2">2.9.2. HP-UX X.25</a></h4>

Although C-Kermit presently does not include built-in support for HP-UX X.25,
it can still be used to make X.25 connections as follows: start Kermit and
tell it to:
<p><pre>
  set prefixing all
  set parity space
  pty padem <i>address</i>
</pre><p>
This should work in HP-UX 9.00 and later (see 
<a href="#x2.7">Section 2.7</a>).  If you have an
earlier HP-UX version, or the PTY interface doesn't work or isn't available,
try:
<p><pre>
  set prefixing all
  set parity space
  pipe padem <i>address</i>
</pre><p>
Failing that, use Kermit to telnet to localhost and then after logging back
in, start padem as you would normally do to connect over X.25.

<p>
<hr>
<h3><a name="x2.10">2.10. Additional Serial Port Controls</a></h3>

C-Kermit 7.0 adds the following commands for greater control over serial
ports.  These commands are available only in C-Kermit versions whose
underlying operating systems provide the corresponding services (such as
POSIX and UNIX System V), and even then their successful operation depends
on the capabilities of the specific device and driver.
<p><dl>
<dt><b>SET DISCONNECT </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>On a SET LINE or SET PORT connection with SET CARRIER ON or AUTO, if
  the carrier signal drops during the connection, indicating that the
  connection has been lost, and C-Kermit notices it, this setting governs
  what happens next.  With SET DISCONNECT OFF, which is consistent with
  previous behavior, and therefore the default, C-Kermit continues to keep the
  device open and allocated.  With SET DISCONNECT ON, C-Kermit automatically
  closes and releases the device when it senses a carrier on-to-off
  transition, thus allowing others to use it.  However, it remains the default
  device for i/o (DIAL, REDIAL, INPUT, SEND, CONNECT, etc), so if a subsequent
  i/o command is given, the device is reopened if it is still available.  When
  it has been automatically closed in this manner, SHOW COMMUNICATIONS puts
  "(closed)" after its name, and in UNIX, the lockfile disappears -- both from
  SHOW COMM and from the lockfile directory itself.  Synonym:
  <b>SET CLOSE-ON-DISCONNECT</b>.
<p>
<dt><b>SET EXIT ON-DISCONNECT </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Like DISCONNECT, but makes the program exit if a connection drops.
</dl><p>
Note that SET CLOSE-ON-DISCONNECT and SET EXIT ON-DISCONNECT apply only to
connections that drop; they do not apply to connections that can't be made
in the first place.  For example, they have no effect when a SET LINE,
SET HOST, TELNET, or DIAL command fails.
<p><dl>
<dt><b>HANGUP</b>
<dd>If [CLOSE-ON-]DISCONNECT is ON, and the HANGUP command is given on a serial
  device, and the carrier signal is no longer present after the HANGUP
  command, the device is closed and released.
<p>
<dt><b>SET PARITY HARDWARE</b> <i>{</i> <b>EVEN, ODD</b> <i>}</i>
<dd>Unlike SET PARITY { EVEN, ODD, MARK, SPACE }, which selects 7 data bits
  plus the indicated kind of parity (to be done in software by Kermit itself),
  SET PARITY HARDWARE selects 8 data bits plus even or odd parity, to be done
  by the underlying hardware, operating system, or device driver.  This
  command is effective only with a SET LINE or SET PORT device.  That is, it
  has no effect in remote mode, nor on network connections.  There is
  presently no method for selecting 8 data bits plus mark or space parity.
  If hardware parity is in effect, the variable \v(hwparity) is set to
  "even" or "odd".  Note: some platforms might also support settings of
  SPACE, MARK, or NONE.
<p>
<dt><b>SET STOP-BITS</b> <i>{</i> <b>1, 2</b> <i>}</i>
<dd>This tells the number of 1-bits to insert after an outbound character's
  data and parity bits, to separate it from the next character.  Normally 1.
  Choosing 2 stop bits should do no harm, but will slow down serial
  transmission by approximately 10 percent.  Historically, 2 stop bits were
  used with Teletypes (at 110 bps or below) for print-head recovery time.
  There is presently no method for choosing any number of stop bits besides
  1 and 2.
<p>
<dt><b>SET SERIAL</b> <i>[ dps ]</i>
<dd><i>dps</i> stands for Data-bits, Parity, Stop-bits.  This is the notation
  familiar to many people for serial port configuration: 7E1, 8N1, 7O2, etc.
  The data bits number also becomes the TERMINAL BYTESIZE setting.  The second
  character is E for Even, O for Odd, M for Mark, S for Space, or N for None.
  The list of available options depends on the capabilities of the specific
  platform.  If <i>dps</i> is omitted, 8N1 is used.  Type "set serial ?"  for a
  list of available choices.  Examples:
<p><dl>
<dt><b>SET SERIAL 7E1</b>
<dd>Equivalent to SET PARITY EVEN, SET STOP-BITS 1, SET TERM BYTE 7.
<p>
<dt><b>SET SERIAL 8N1</b>
<dd>Equivalent to SET PARITY NONE, SET STOP-BITS 1, SET TERM BYTE 8.
<p>
<dt><b>SET SERIAL 7E2</b>
<dd>Equivalent to SET PARITY EVEN and SET STOP-BITS 2, SET TERM BYTE 7.
<p>
<dt><b>SET SERIAL 8E2</b>
<dd>Same as SET PARITY HARDWARE EVEN, SET STOP-BITS 2, SET TERM BYTE 8.
<p>
<dt><b>SET SERIAL</b>
<dd>Same as SET PARITY NONE and SET STOP-BITS 1, SET TERM BYTE 8.
</dl></dl><p>
Notes:
<p><ul>
<li>The SET SERIAL <i>xx</i>2 options are available only in Kermit versions where the
   SET PARITY HARDWARE command is also available.  (SHOW FEATURES includes
   "HWPARITY" in its options list.)
<p>
<li>The SET SERIAL 7<i>xx</i> and 8N1 options affect the software parity setting, even
   for network connections.
<p>
<li>As noted in the manual, selecting 8 data bits does not give you 8-bit
   terminal sessions in CONNECT mode unless you also SET TERMINAL BYTESIZE 8.
   The default terminal bytesize remains 7, to protect against the situation
   where the remote host is generating parity but you don't know about it.  If
   the terminal bytesize was 8 by default and you CONNECTed to such a host,
   you would see only garbage on your screen.
<p>
<li>If you do not give a SET STOP-BITS or SET SET SERIAL command, C-Kermit
   does not attempt to set the device's stop bits; instead, it uses whatever
   setting the device uses when not given explicit instructions about stop
   bits.
</ul><p>
<b>SHOW COMMUNICATIONS</b> displays the current settings.  Stop bits and
hardware parity are shown only for SET PORT / SET LINE (serial) devices, since
they do not apply to network connections or to remote mode.  STOP-BITS is shown
as "(default)" if you have not given an explicit SET STOP-BITS or SET SERIAL
command.
<p>
The <tt>\v(serial)</tt> variable shows the SET SERIAL setting (8N1, 7E1, etc).

<p>
<hr>
<h3><a name="x2.11">2.11. Getting Access to the Dialout Device</a></h3>

<blockquote>
This section is for UNIX only; note the special words about QNX
at the end.  Also see 
<a href="#x2.0">Section 2.0</a> for SET LINE switches, particularly
the /SHARE switch for VMS only.
</blockquote><p>

C-Kermit does its best to obey the UUCP lockfile conventions of each platform
(machine, operating system, OS version) where it runs, if that platform uses
UUCP.
<p>
But simply obeying the conventions is often not good enough, due to the
increasing likelihood that a particular serial device might have more than one
name (e.g. /dev/tty00 and /dev/term/00 are the same device in Unixware 7;
/dev/cua and /dev/cufa are the same device in NeXTSTEP), plus the increasingly
widespread use of symlinks for device names, such as /dev/modem.
<p>
C-Kermit 7.0 goes to greater lengths than previous versions to successfully
interlock with other communications program (and other instances of Kermit
itself); for example, by:
<p><ul>
<li>Creation of dual lockfiles whenever a symlink is used; one for the link
name and one for the real name.
<li>Creation of dual lockfiles in HP-UX according to HP rules.
<li>Creation of dual uppercase/lowercase lockfile names in SCO UNIX/ODT/OSR5.
<li>The use of <tt>ttylock()</tt> in versions of AIX where it works.
<li>The use, wherever possible, of lockfile names based on inode/major/minor
device number rather than device name.
</ul><p>

See the <a href="ftp://kermit.columbia.edu/kermit/f/ckuins.txt">ckuins.txt</a>
and <a href="ftp://kermit.columbia.edu/kermit/f/ckubwr.txt">ckubwr.txt</a>
files for details.
<p>
<b>QNX</b> is almost unique among UNIX varieties in having no UUCP programs nor
UUCP-oriented dialout-device locking conventions.  QNX does, however, allow a
program to get the device open count.  This can not be a reliable form of
locking unless all applications do it (and they don't), so by default, Kermit
uses this information only for printing a warning message such as:
<p><pre>
  C-Kermit&#62;set line /dev/ser1
  WARNING - "/dev/ser1" looks busy...
</pre><p>
However, if you want to use it as a lock, you can do so with:
<p><pre>
  SET QNX-PORT-LOCK <i>{</i> ON, OFF <i>}</i>
</pre><p>
QNX-PORT-LOCK is OFF by default; if you set in ON, C-Kermit fails to open
any dialout device when its open count indicates that another process has it
open.  SHOW COMM (in QNX only) displays the setting, and if you have a port
open, it also shows the current open count (with C-Kermit's own access
always counting as 1).

<p>
<hr>
<h3><a name="x2.12">2.12. The Connection Log</a></h3>

C-Kermit 7.0 adds the ability to log connections, so you can see where you've
been and have a record of calls you've made.  A connection is defined as any
communications session that is begun by SET LINE, SET PORT, DIAL, SET HOST,
TELNET, or RLOGIN.  Connections are not logged unless you request it; the
command is:
<p><dl>
<dt><b>LOG CX </b> <i>[ filename [ { </i><b>NEW, APPEND</b> <i>} ] ]</i>
<dd>Enables logging of connections in the given file.  If the trailing
<tt><i>{</i> NEW, APPEND <i>}</i></tt> keyword is omitted, the file is opened
for appending; i.e. new records are written to the end.  If NEW is specified,
a new file is created; if a file of the same name already existed, it is
overwritten.  If the filename is omitted, CX.LOG in your home (login)
directory is used (note: uppercase).  To accept all defaults, just use
"log connections" (or "l c" for short).  Synonym: <b>LOG CONNECTIONS</b>.
<p>
<dt><b>CLOSE CX-LOG</b>
<dd>This closes the connection log if it was open.  (Note, the CLOSE CONNECTION
  command closes the connection itself).
<p>
<dt><b>SHOW CX</b>
<dd>This shows your current connection, if any, including the elapsed time
  (since you opened it).  Synonym: <b>SHOW CONNECTION</b>.
<p>
<dt><b><tt>\v(cx_time)</tt></b>
<dd>This variable shows the elapsed time of your current connection, or if
there is no current connection, of your most recent connection, of if there
have been no connections, 0.
</dl><p>
The connection contains one line per connection, of the form:
<p><pre>
  yyyymmdd hh:mm:ss username pid p=v [ p=v [ ... ] ]
</pre><p>
where the timestamp (in columns 1-18) shows when the connection was made;
username is the login identity of the person who made the connection; pid is
Kermit's process ID when it made the connection.  The p's are parameters that
depend on the type of connection, and the v's are their values:
<p><pre>
  T = Connection Type (TCP, SERIAL, DIAL, DECNET, etc).
  H = The name of the Host from which the connection was made.
  N = Destination phone Number or Network host name or address.
  D = Serial connections only: Device name.
  O = Dialed calls only: Originating country code &#38; area code if known.
  E = Elapsed time in hh:mm:ss format (or hhh:mm:ss, etc).
</pre><p>
If you always want to keep a connection log, simply add:
<p><pre>
  log connections
</pre><p>
to your C-Kermit customization file.  Note, however, that if you make a lot of
connections, your CX.LOG will grow and grow.  You can handle this by adding a
"logrotate" procedure like the following to your customization file, before
the "log connections" command:
<p><pre>
  define LOGROTATE {                    ; Define LOGROTATE macro
      local \%i \%m \%d \%n \%f MAX
      def MAX 4                         ; How many months to keep
      if not def \%1 -                  ; No argument given
	end 1 \%0: No filename given
      if not = 1 \ffiles(\%1) -         ; Exactly 1 file must match
	end 1 \%0: \%1 - File not found
      .\%d := \fsubstr(\fdate(\%1),1,6) ; Arg OK - get file year &#38; month
      if = \%d -                        ; Compare file year &#38; month
        \fsubstr(\v(ndate),1,6) -       ; with current year &#38; month
	  end 0                         ; Same year &#38; month - done
      rename \%1 \%1.\%d                ; Different - rename file
      .\%n := \ffiles(\%1.*)            ; How many old files
      if &#60; \%n \m(MAX) end 0            ; Not enough to rotate
      .\%m := \%1.999999                ; Initial compare string
      for \%i 1 \%n 1 {                 ; Loop thru old logs
	 .\%f := \fnextfile()           ; Get next file name
	 if llt \%f \%m .\%m := \%f     ; If this one older remember it
      }
      delete \%m                        ; Delete the oldest one
  }
  log connections                       ; Now open the (possibly new) log
  logrotate \v(home)CX.LOG              ; Run the LOGROTATE macro
</pre><p>
As you can see, this compares the yyyymm portion of the modification date
(<tt>\fdate()</tt>) of the given file (<tt>\%1</tt>) with the current yyyymm.
If they differ,
the current file has the yyyymm suffix (from its most recent modification
date) appended to its name.  Then we search through all other such files, find
the oldest one, and delete it.  Thus the current log, plus the logs from the
most recent four months, are kept.  This is all done automatically every time
you start C-Kermit.
<p>
On multiuser systems, it is possible to keep a single, shared, system-wide
connection log, but this is not recommended since (a) it requires you keep a
publicly write-accessible logfile (a glaring target for mischief), and (b) it
would require each user to log to that file and not disable logging.  A better
method for logging connections, in UNIX at least, is syslogging (see
<a href="ftp://kermit.columbia.edu/kermit/f/ckuins.txt">ckuins.txt</a> Section
15 and <a href="http://www.columbia.edu/kermit/iksd.html#x4.2">Section 4.2</a> of the
<a href="http://www.columbia.edu/kermit/iksd.html">IKSD Administration Guide</a> for details).

<p>
<hr>
<h3><a name="x2.13">2.13. Automatic Connection-Specific Flow Control Selection</a></h3>

Beginning in C-Kermit 7.0, the appropriate flow-control method for each
connection type is kept in a table, for example:
<p><pre>
  Remote:           NONE
  Modem:            RTS/CTS
  Direct-Serial:    NONE
  TCPIP:            NONE
</pre><p>
The size of the table and values for each connection type can vary from
platform to platform.  Type "set flow ?" for a list of available flow-control
types.
<p>
The table is used to automatically select the appropriate kind of flow
control whenever you make a connection.  You can display the table with:
<p><pre>
  SHOW FLOW-CONTROL
</pre><p>
The defaults are as follows:
<p><dl>
<dt><b>Remote:</b>
<dd>NONE or XON/XOFF.  This is because C-Kermit is not allowed to find out what
  type of connection the incoming user has (*).  No kind of flow control will
  work on every kind of connection, including (unexpectedly) KEEP, which we
  would have liked to use, but not turning off flow control at the remote end
  during file transfer on TCP/IP connections is fatal to the transfer (except
  in VMS and HP-UX, where it must be set to Xon/Xoff!)  Therefore if you are
  dialing in to a serial port on a server (UNIX or VMS) where C-Kermit is
  running, you will need to tell C-Kermit to "set flow keep" before
  transferring files (assuming the modem and port are configured correctly by
  the system administrator; otherwise you'll need to give a specific kind of
  flow control, e.g. "set flow xon/xoff"), so in this case C-Kermit will not
  disable flow control, as it must do when you are coming via Telnet (directly
  or through a terminal server, except on VMS and HP-UX).
<p>
<dt><b>Modem:</b>
<dd>This applies when you dial out with a modem.  In this case, the MODEM
  FLOW-CONTROL setting takes affect after the SET FLOW setting, so it can pick
  the most appropriate flow control for the combination of the particular
  modem and the computer/port/driver that is dialing.
<p>
<dt><b>Direct-Serial:</b>
<dd>The default here is NONE because C-Kermit has no way of knowing what kind
  of flow control, if any, is or can be done by the device at the other end
  of the connection.  RTS/CTS would be a bad choice here, because if the CTS
  signal is not asserted, the connection will hang.  And since direct
  connections are often made with 3-wire cables, there is a good chance the
  CTS signal will not be received.
<p>
<dt><b>TCPIP:</b>
<dd>NONE, since TCP and IP provide their own flow control transparently to the
  application, except in VMS, where Xon/Xoff is the default due to the
  requirements of the VMS TCP/IP products.
<p>
<dt><b>Other networks:</b>
<dd>NONE, since networks should provide their flow control transparently to the
  application.
</dl><p>
(*) This is possibly the worst feature of UNIX, VMS, and other platforms
    where C-Kermit runs.  If C-Kermit was able to ask the operating system
    what kind of connection it had to the user, it could set up many things
    for you automatically.
<p>
You can modify the default-flow-control table with:
<p><pre>
  SET FLOW-CONTROL /xxx { NONE, KEEP, RTS/CTS, XON/XOFF, ... }
</pre><p>
where "xxx" is the connection type, e.g.
<p><pre>
  SET FLOW /REMOTE NONE
  SET FLOW /DIRECT RTS/CTS
</pre><p>
If you leave out the switch, SET FLOW works as before, choosing the flow
control method to be used on the current connection:
<p><pre>
  SET FLOW XON/XOFF
</pre><p>
Thus, whenever you make a connection with SET PORT, SET LINE, DIAL, SET HOST,
TELNET, RLOGIN, etc, an appropriate form of flow control is selected
automatically.  You can override the automatic selection with a subsequent
SET FLOW command, such as SET FLOW NONE (no switch included).
<p>
The flow control is changed automatically too when you give a SET MODEM TYPE
command.  For example, suppose your operating system (say Linux) supports
hardware flow control (RTS/CTS).  Now suppose you give the following
commands:
<p><pre>
  set line /dev/ttyS2    ; Automatically sets flow to NONE
  set modem type usr     ; Automatically sets flow to RTS/CTS
  set modem type rolm    ; Doesn't support RTS/CTS so now flow is XON/XOFF
</pre><p>
IMPORTANT: This new feature tends to make the order of SET LINE/HOST and
SET FLOW commands matter, where it didn't before.  For example, in VMS:
<p><pre>
  SET FLOW KEEP
  SET LINE TTA0:
</pre><p>
the SET LINE undoes the SET FLOW KEEP command; the sequence now must be:
<p><pre>
  SET FLOW /DIRECT KEEP
  SET LINE TTA0:
</pre><p>
or:
<p><pre>
  SET LINE TTA0:
  SET FLOW KEEP
</pre>

<p>
<hr>
<h3><a name="x2.14">2.14. Trapping Connection Establishment and Loss</a></h3>

If you define a macro called ON_OPEN, it is executed any time that a SET LINE,
SET PORT, SET HOST, TELNET, RLOGIN or similar command succeeds in opening a
connection.  The argument is the host or device name (as shown by SHOW
COMMUNICATIONS, and the same as \v(line)).  This macro can be used for all
sorts of things, like automatically setting connection- or host-specific
parameters when the connection is opened.  Example:
<p><pre>
  def ON_OPEN {
      switch \%1 {
        :abccorp.com, set reliable off, break
        :xyzcorp.com, set receive packet-length 1000, break
        etc etc...
      }
  }
</pre><p>
If you define a macro called ON_CLOSE, it will be executed any time that
a SET LINE, SET PORT, SET HOST, TELNET, RLOGIN or any other kind of connection
that C-Kermit has made is closed, either by the remote or by a local CLOSE,
HANGUP, or EXIT command or other local action, such as when a new connection
is opened before an old one was explicitly closed.
<p>
As soon as C-Kermit notices the connection has been closed, the ON_CLOSE macro
is invoked at (a) the top of the command parsing loop, or (b) when a
connection is closed implicitly by a command such as SET LINE that closes any
open connection prior to making a new connection, or (c) when C-Kermit closes
an open connection in the act of exiting.
<p>
The ON_CLOSE macro was inspired by the neverending quest to unite Kermit and
SSH.  In this case using the "tunnel" mechanism:
<p><pre>
  def TUNNEL {                                ; \%1 = host to tunnel to
      local \%p
      if not def \%1 stop 1
      assign tunnelhost \%1                   ; Make global copy
      undef on_close
      set macro error off
      close connection                        ; Ignore any error
      open !read tunnel start \%1
      read \%p                                ; Get port number
      if fail stop 1 Tunnel failure: \%1
      close read
      if fail stop 1 Tunnel failure: \%1      ; See <a href="#x4.2.8.1">Section 4.2.8.1</a>
      assign on_close {                       ; Set up close handler
          echo Closing tunnel: \m(tunnelhost)
          !tunnel stop \m(tunnelhost)
          undef on_close
      }
      set host localhost:\%p /telnet
      if success end 0
      undef on_close
      stop 1 Connection failure: \%1
  }
</pre><p>
In this case, when the connection stops, we also need to shut down the tunnel,
even if it is at a later time after TUNNEL has finished executing.  This way
we can escape back, reconnect, transfer files, and so on until the connection
is broken by logging out from the remote, or by explicitly closing it, or by
EXITing from C-Kermit, at which time the tunnel is shut down.
<p>
When the connection is closed, no matter how, the ON_CLOSE macro executes
and then undefines (destroys) itself, since we don't want to be closing
tunnels in the future when we close subsequent connections.
<p>
Other such tricks can be imagined, including ending ON_CLOSE with a STOP
command to force the command stack to be peeled all the way back to the top,
for example in a deeply nested script that depends on the connection being
open:
<p><pre>
  def on_close { stop 1 CONNECTION LOST }
</pre><p>
When C-Kermit invokes the ON_CLOSE macro, it supplies one argument (\%1):
the reason the connection was closed as a number, one of the following:
<p><pre>
  2 - Fatal failure to negotiate a required item on a network connection.
  1 - Closed by C-Kermit command.
  0 - All others (normally closed by remote).
</pre><p>
which may be used for any purpose; for example, to add a comment to the
connection log:
<p><pre>
  def on_close {
      local \%m
      if not open cx end 0
      switch \%1 {
        :0, .\%m = Closed by remote, break
        :1, .\%m = Closed by me, break
        :2, .\%m = Network protocol negotiation failure, break
      }
      if def \%m writeln cx {# \%m}
  }
</pre>

<p>
<hr>
<h3><a name="x2.15">2.15. Contacting Web Servers with the HTTP Command</a></h3>

C-Kermit 7.0 (at this writing, the UNIX version only) supports direct contact
and interaction with Web servers via HTTP 1.0 protocol.  To make a connection,
use Kermit's normal method for making a TCP/IP connection, but specify the
HTTP port:
<p><pre>
  SET HOST <i>host</i> http [ <i>switches</i> ]
</pre><p>
where <i>host</i> is the IP hostname or address, and http is the name of the
TCP port for the Web server.  Relevant switches include:
<p><dl>
<dt><b>/RAW</b>
<dd>Treat the connection as a transparent binary pipe.  This switch may be
  required if a port other than 'http' is used.
<p>
<dt><b>/SSL</b>
<dd>Make an secure private connection with SSL (only if SSL support is included
  in your version of Kermit).  In this case the port name might need to be
  https rather than http, e.g. "set host secureserver.xyxcorp.com https /ssl".
<p>
<dt><b>/TLS</b>
<dd>Make an secure private connection with TLS (only if TLS support is included
  in your version of Kermit).  In this case the port name would be https
  rather than http.
</dl><p>
Then you can issue an HTTP command.  In most cases, the server closes the
connection when the command is complete.  Example:
<p><pre>
  SET HOST www.columbia.edu http
  IF FAIL EXIT 1 Can't contact server
  HTTP GET kermit/index.html
</pre><p>
At this point the connection is closed, since that's how HTTP 1.0 works.  If
you want to perform additional operations, you must establish a new connection
with another SET HOST command.
<p>
The HTTP command acts as a client to the Web server, except instead of
displaying the results like a Web browser would, it stores them.  Any HTTP
command can (but need not) include any or all of the following switches:
<p><dl>
<dt><b>/AGENT:</b><i>user-agent</i>
<dd>Identifies the client to the server; "C-Kermit" or "Kermit-95"
  by default.
<p>
<dt><b>/HEADER:</b><i>header-line</i>
<dd>Used for specifying any optional headers.  A list of headers is provided
  using braces for grouping:
<p><pre>
  /HEADER:{{<i>tag</i>:<i>value</i>}{<i>tag</i>:<i>value</i>}...}
</pre><p>
For a listing of valid <i>tag</i> value and <i>value</i> formats see
<a href="ftp://ftp.isi.edu/in-notes/rfc1945.txt">RFC 1945</a>:
<cite>Hypertext Transfer Protocol -- HTTP/1.0</cite>.  A maximum of eight
headers may be specified.
<p>
<dt><b>/USER:</b><i>name</i>
<dd>In case a page requires a username for access.
<p>
<dt><b>/PASSWORD:</b><i>password</i>
<dd>In case a page requires a password for access.
<p>
<dt><b>/ARRAY:</b><i>arrayname</i>
<dd>Tells Kermit to store the response headers in the given array, one line per
element.  The array need not be declared in advance.  Example:
<p><pre>
  C-Kermit&#63; <u>http /array:c get kermit/index.html</u>
  C-Kermit&#63; <u>show array c</u>
  Dimension = 9
  1. Date: Fri, 26 Nov 1999 23:12:22 GMT
  2. Server: Apache/1.3.4 (Unix)
  3. Last-Modified: Mon, 06 Sep 1999 22:35:58 GMT
  4. ETag: "bc049-f72-37d441ce"
  5. Accept-Ranges: bytes
  6. Content-Length: 3954
  7. Connection: close
  8. Content-Type: text/html
</pre>
</dl>
<p>

As you can see, the header lines are like MIME e-mail header lines:
identifier, colon, value.  The /ARRAY switch is the only method available
to a script to process the server responses for a POST or PUT command.
<p>
The HTTP commands are:
<p><dl>
<dt><b>HTTP</b> <i>[ switches ]</i> <b>GET</b> <i>remote-filename [ local-filename ]</i>
<dd>Retrieves the named file.  If a <i>local-filename</i> is given, the file is
  stored locally under that name; otherwise it is stored with its own name.
<p>
<dt><b>HTTP</b> <i>[ switches ]</i> <b>HEAD</b> <i>remote-filename local-filename</i>
<dd>Like GET except without actually getting the file; instead it gets only
the headers, storing them into the given file, whose name must be given,
one line per header item, as shown above in the /ARRAY: switch description.
<p>
<dt><b>HTTP</b> <i>[ switches ]</i> <b>INDEX</b> <i>remote-directory [ local-filename ]</i>
<dd>Retrieves the file listing for the given server directory.
NOTE: This command is not supported by most Web servers.
<p>
<dt><b>HTTP</b> <i>[ switches ]</i> <b>POST</b> <i>[</i> <b>/MIME-TYPE:</b><i>type ] local-file remote-file</i></i>
<dd>Used to send a response as if it were sent from a form.  The data to be
posted must be read from a file.
<p>
<dt><b>HTTP</b> <i>[ switches ]</i> <b>PUT</b> <i>[</i> <b>/MIME-TYPE:</b><i>type ] local-file remote-file</i>
<dd>Uploads a local file to a server file.
<p>
<dt><b>HTTP</b> <i>[ switches ]</i> <b>DELETE</b> <i>remote-filename</i>
<dd>Instructs the server to delete the specified filename.
</dl>

<p>
<hr>
<h3><a name="x3">3. TERMINAL CONNECTION</a></h3>
<h3><a name="x3.1">3.1. CONNECT Command Switches</a></h3>

The following switches (see <a href="#x1.5">Section 1.5</a>) were added to the
CONNECT command in 7.0:
<p><dl>
<dt><b>/QUIETLY</b>
<dd>Don't print the "Connecting to..." or "Back at..." messages.
    CQ is an invisible command synonym for CONNECT /QUIETLY.
<p>
<dt><b>/TRIGGER:</b><i>string</i>
<dd>Specify a trigger or triggers (<a href="#x3.2">Section 3.2</a>)
effective for this CONNECT
command only, temporarily overriding any current SET TERMINAL TRIGGER
values (<a href="#x3.2">Section 3.2</a>).
</dl><p>
Note: Other switches might also be available; type "connect ?" for a list,
"help connect" for a description of each.

<p>
<hr>
<h3><a name="x3.2">3.2. Triggers</a></h3>

Triggers were added for UNIX, VMS, AOS/VS, and K95 in C-Kermit 7.0.
<p><dl>
<dt><b>SET TERMINAL TRIGGER</b> <i>string</i>
<dd>Tells C-Kermit to look for the given string during all subsequent CONNECT
sessions, and if seen, to return to command mode automatically, as if you
had escaped back manually.  If the string includes any spaces, you must
enclose it in braces.  Example:
<p><pre>
  set terminal trigger {NO CARRIER}
</pre></dl><p>
Comparisons are made after character-set translation.
<p>
If a string is to include a literal brace character, precede it with a
backslash:
<p><pre>
  ; My modem always makes this noise when the connection is lost:
  set terminal trigger |||ppp\{\{\{\{UUUUUUU
</pre><p>
If you want Kermit to look for more than one string simultaneously, use the
following syntax:
<p><pre>
  set terminal trigger {{<i>string1</i>}{<i>string2</i>}...{<i>stringn</i>}}
</pre><p>
In this case, C-Kermit will return to command mode automatically if any of
the given strings is encountered.  Up to 8 strings may be specified.
<p>
If the most recent return to command mode was caused by a trigger, the new
variable, <tt>\v(trigger)</tt>, shows the trigger value; otherwise
<tt>\v(trigger)</tt> is empty.
<p>
The SHOW TRIGGER command displays the SET TERMINAL TRIGGER values as well as
the <tt>\v(trigger)</tt> value.

<p>
<hr>
<h3><a name="x3.3">3.3. Transparent Printing</a></h3>

As noted in the manual, C-Kermit's CONNECT command on UNIX is not a terminal
emulator, but rather a "semitransparent pipe" between the terminal or emulator
you are using to access C-Kermit, and the remote host to which C-Kermit is
connected.  The "semitransparent" qualifier is because of character-set
translation as well as several actions taken by the emulator in response to
the characters or strings that pass through it, such as APCs, Kermit packets
(autodownload), triggers, etc.
<p>
The UNIX version of C-Kermit 7.0 adds another such action: Transparent
printing, also called Controller printing (as distinct from Autoprint or line
or screen print).  It is intended mainly for use on UNIX workstation consoles
(as opposed to remote logins), but with some care can also be used when
accessing C-Kermit remotely.
<p>
Transparent printing is related to APC by sharing C-Kermit's built-in ANSI
escape-sequence parser to detect "printer on" and "printer off" sequences from
the host.  When the printer-on sequence is received, all subsequent arriving
characters -- including NUL, control characters, and escape sequences --
are sent to the SET PRINTER device instead of to your screen until
the printer-off sequence is received, or you escape back, whichever happens
first.  These bytes are not translated or modified or filtered in any way
by Kermit (except for possibly stripping of the 8th bit, as noted below), but
if filtering or translation is desired, this can be accomplished by your
SET PRINTER selection (e.g. by choosing a pipeline of filters).
<p>
By default, your SET PRINTER device is your default UNIX printer, but
it can also be a file, a command, or the null device (which causes all printer
material to be discarded).  See <a href="ckb2.html"><cite>Using C-Kermit</cite></a>, 2nd Ed., p.41 for details.
<p>
Transparent printing is controlled by the command:
<p><dl>
<dt><b>SET TERMINAL PRINT </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>When ON, transparent-print sequences are obeyed, and printing occurs on the
system where C-Kermit is running.  When OFF, transparent print sequences are
ignored and passed through to your actual terminal or emulator, along with
the data they enclose.  OFF is the default, for compatibility with earlier
C-Kermit releases.  As noted in the manual, when the current SET PRINTER
device is a file, transparent-print material is appended to it; the file is
not overwritten.
<p>
<dt><b>SET TERMINAL BYTESIZE</b> <i>{</i> <b>7, 8</b> <i>}</i>
<dt><b>SET PARITY</b> <i>{</i> <b>EVEN, ODD, MARK, SPACE, NONE</b> <i>}</i>
<dd>If the terminal bytesize is 7, or PARITY is not NONE, the 8th bit of each
byte is stripped prior to printing.
</dl><p>
The transparent-print escape sequences are:
<p><dl>
<dt><b><tt>&#60;ESC&#62;[5i</tt></b>
<dd>Printer On.  Send all subsequent incoming bytes to the printer without
any kind of filtering, translation, or alteration.  Note:
<tt>&#60;ESC&#62;</tt> stands for ASCII character number 27 (decimal), Escape.
<p>
<dt><b><tt>&#60;ESC&#62;[4i</tt></b>
<dd>Printer Off.  Resume displaying incoming bytes on the screen.
</dl>
<p>
These are the same sequences used by DEC VT100 and higher terminals and other
ANSI X3.64 and ISO 6429 compatible terminals.  There is no provision for
selecting other printer-control sequences.
<p>
<i>Restrictions:</i>
<p><ol>
<li>You must SET TERM TRANSPARENT-PRINT ON before you can use this feature.
<p>
<li>Only the 7-bit forms of the escape sequences are supported.  The 8-bit
CSI C1 control is not recognized.
<p>
<li>Autoprint is not supported, since this requires a full-fledged terminal
emulator with direct access to the screen.
<p>
<li>The start-print and stop-print sequences pass through to the screen (there
is no way to avoid this without causing unacceptable delays or deadlocks
in CONNECT mode).  Thus if your terminal or emulator also supports
transparent printing via these same sequences, an empty file will be sent
to its printer.  Normally this has no effect.
</ol><p>
Point (4) is similar to the situation with autodownload and APC -- when you
have several Kermit clients in a chain, you should take care that these
features are enabled in only one of them.
<p>
<i>Example 1:</i>
<p><pre>
  set printer {|lpr -Plaser}  ; Specify the printer (if not default).
  set term print on           ; Enable transparent printing.
  set term byte 8             ; Enable 8-bit characters.
  connect                     ; Enter CONNECT mode.
</pre><p>
<i>Example 2:</i>
<p><pre>
  set printer /home/users/olga/printer.log  ; Send printer material to a file.
</pre><p>
<i>Example 3:</i>
<p><pre>
  set printer {| grep -v ^Received | lpr}   ; Filter out some lines
</pre><p>
Then use "pcprint" or "vtprint" commands on the host to initiate transparent
print operations.  See
<a href="ckb2.html"><cite>Using
C-Kermit</cite></a>, 2nd Ed., p.406 for details.
<p>
Here is a sample "pcprint" shell script for UNIX:
<p><pre>
  #!/bin/sh
  echo -n '&#60;ESC&#62;[5i'
  if [ $# -eq 0 ]; then
    cat
  else
    cat $*
  fi
  echo -n '&#60;FF&#62;&#60;ESC&#62;[4i'
  # (end)
</pre><p>
(Replace "<tt>&#60;ESC&#62;</tt>" by the actual ASCII Escape character and
"<tt>&#60;FF&#62;</tt>" by the ASCII Formfeed character).
<p>
If you always want transparent printing enabled, put "set term print on"
in your C-Kermit customization file (<tt>~/.mykermrc</tt> in UNIX).  The "set
term bytesize" selection, however, is a property of each separate connection.

<p>
<hr>
<h3><a name="x3.4">3.4. Binary and Text Session Logs</a></h3>

C-Kermit 7.0 corrects an oversight in earlier releases, in which binary
session logs (SET SESSION-LOG BINARY) translated character sets and performed
various formatting transformations (e.g. "newline mode") before writing
characters to the session log.  In C-Kermit 7.0, binary-mode session logging
writes characters as they come in, before anything (other that parity-bit
stripping) is done to them.  Text-mode session logging records the characters
after processing.

<p>
<hr>
<h3><a name="x4">4. FILE TRANSFER</a></h3>

Every file is transferred either in text mode (which implies record-format
and character-set translation) or binary mode (in which each byte is sent
literally without any kind of conversion).  The mode in which a file is
transferred is controlled by (a) the default mode, in the absence of any
other indications; (b) the SET FILE TYPE command; (c) various automatic
mechanisms based on client/server negotiations, directory information or
filename patterns, etc.
<p>
The default FILE TYPE was changed from TEXT to BINARY in C-Kermit 7.0
because:
<p><ul>
<li>Transferring a text file in binary mode does less damage than
transferring a binary file in text mode.
<p>
<li>Only binary-mode transfers can be recovered from the point of failure.
<p>
<li>The automatic transfer-mode mechanisms switch to text mode on a per-file
basis anyway, so only those files that are not covered by the automatic
mechanisms are affected.
<p>
<li>All file transfers on the Web are done in binary mode, so people are
accustomed to it and expect it.
</ul>

<p>
<hr>
<h3><a name="x4.0">4.0. BUG FIXES, MINOR CHANGES, AND CLARIFICATIONS</a></h3>
<h4><a name="x4.0.0">4.0.0. Filenames with Spaces</a></h4>

Filenames that contain spaces are a major nuisance to a program like Kermit,
whose command language is line- and word-oriented, in which words are
separated by spaces and a filename is assumed to be a "word".  In general
(unless noted otherwise in the description of a particular command), there is
only one way to refer to such files in Kermit commands, and that is to enclose
the name in braces:
<p><pre>
  send {this file}
</pre><p>
Tells Kermit to send the file whose name is "this file" (two words, no
quotes).  Of course, various circumlocutions are also possible, such as:
<p><pre>
  define \%a this file
  send \%a
</pre><p>
BUT, perhaps contrary to expectation, you can't use "\32" to represent the
space:
<p><pre>
  send this\32file
</pre><p>
does not work.  Why?  Because the Kermit parser, which must work on many
operating systems including Windows, has no way of knowing what you mean by
"this\32file".  Do you mean a file whose name is "this file" in the current
directory?  Or do you mean a file whose name is "32file" in the "this"
subdirectory of the current directory?  Guessing won't do here; Kermit must
behave consistently and deterministically in all cases on all platforms.
<p>
Note that you can't use Esc or Tab within <tt>{...}</tt> for filename
completion, or question mark to get a filename list.  However, you can include
wildcards; for example:
<p><pre>
  send {* *}
</pre><p>
sends all files whose name contains a space.
<p>
All things considered, it is best to avoid spaces in file and directory names
if you can.  Also see 
<a href="#x5.4">Section 5.4</a> on this topic.

<p>
<hr>
<h4><a name="x4.0.1">4.0.1. Packet out of Window</a></h4>

C-Kermit 6.0 could send packets "out of window" if the window size was
greater than 1 and ACKs had arrived out of order.  Fixed in 6.1.

<p>
<hr>
<h4><a name="x4.0.2">4.0.2. MOVE after ADD SEND-LIST</a></h4>

ADD SEND-LIST followed by MOVE did not delete original files; fixed in 6.1.
Carrier loss was not detected during transfer; in 7.0 C-Kermit checks for
this (but results can not be guaranteed).  In any case, the protocol will
eventually time out if the connection is lost.

<p>
<hr>
<h4><a name="x4.0.3">4.0.3. GET and RECEIVE As-Names</a></h4>

In 5A(190) through 6.0.192, the GET and RECEIVE as-name did not properly
override the RECEIVE PATHNAMES setting.  In 7.0 it does.

<p>
<hr>
<h4><a name="x4.0.4">4.0.4. New Brief Statistics Listing</a></h4>

Version 7.0 adds a /BRIEF switch to the STATISTICS command, to display a short
file-transfer statistics report.  /BRIEF is now the default.  Use /VERBOSE to
see the full display, which is about 25 lines long.

<p>
<hr>
<h4><a name="x4.0.5">4.0.5. Improved FAST Command</a></h4>

The preinstalled definition of the FAST macro did not take enough factors into
account.  Now it sets packet lengths and window sizes appropriate to the
configuration.  Furthermore, in IRIX only, it might restrict the SEND packet
length to 4000, to work around a bug in the IRIX Telnet server, depending on
the IRIX version (see
<a href="ftp://kermit.columbia.edu/kermit/f/ckubwr.txt">ckubwr.txt</a>, IRIX
section).  To see the built-in definition of the FAST macro, type "show macro
fast".  To change it, simply define it to be whatever you want -- it's just a
macro, like any other.

<p>
<hr>
<h4><a name="x4.0.6">4.0.6. The SET SEND BACKUP Command</a></h4>

Version 7.0 adds SET SEND BACKUP <i>{</i> ON, OFF <i>}</i>.  This tells whether backup
files should be sent.  Backup files are the ones created by Kermit (and EMACS,
and possibly other applications) to preserve old copies of files when creating
new ones with the same name.  Kermit does this when receiving a file and its
FILE COLLISION setting is BACKUP (or RENAME, in which case it the new file
gets the backup name).  On most platforms, the backup name is formed by adding:
<p><pre>
  .~<i>n</i>~
</pre><p>
to the end of the filename, where "n" is a number.  For example, if the
original file is oofa.txt, a backup file might be called:
<p><pre>
  oofa.txt.~1~
</pre><p>
(or oofa.txt.~2~, etc).  If you SET SEND BACKUP OFF, this tells Kermit not to
send files that have backup names.  Normally, SET SEND BACKUP is ON (as shown
by SHOW PROTOCOL), and backup files are sent if their names match the SEND
file specification.
<p>
Also see PURGE, SET FILE COLLISION, SEND /NOBACKUP, DIRECTORY /[NO]BACKUP.

<p>
<hr>
<h4><a name="x4.0.7">4.0.7. The SET { SEND, RECEIVE } VERSION-NUMBERS Command</a></h4>

VMS Only.  Normally when sending files, VMS C-Kermit strips the version
number.  For example, if the file is FOO.BAR;34, the name is sent as FOO.BAR
(without the ";34").  If you want to keep version numbers on when sending
files, use SET SEND VERSION-NUMBERS ON.  The effect depends on the receiver.
<p>
Normally when receiving files, and an incoming filename includes a VMS-style
version number (such as FOO.BAR;34) VMS C-Kermit strips it before trying to
create the new file; this way the new file receives the next highest version
number in the customary manner for VMS.  If you want version numbers on
incoming filenames to be used in creating the new files, use SET RECEIVE
VERSION-NUMBERS ON.
<p>
Normally these commands would be effective only when VMS C-Kermit is
exchanging files with a non-VMS Kermit program, since VMS-to-VMS transfers use
labeled mode unless you have gone out of your way to defeat it.
<p>
Example: You want to send all versions of all files in the current directory
from a VMS C-Kermit client to a UNIX C-Kermit server.  Use:
<p><pre>
  set send version-numbers on
  send *.*;*
</pre><p>
The resulting Unix files will have VMS-style version numbers as part of their
name, for example "<tt>foo.bar;1</tt>", "<tt>foo.bar;2</tt>", etc.
<p>
Now suppose you want to send these files from Unix to another VMS system and
preserve the version numbers.  Again we have a Unix C-Kermit server and VMS
C-Kermit client.  Give these commands to the client:
<p><pre>
  set receive version-numbers on
  get *
</pre>

<p>
<hr>
<h4><a name="x4.0.8">4.0.8. The SET { SEND, RECEIVE } { MOVE-TO, RENAME-TO } Commands</a></h4>

These commands are persistent global versions of the /MOVE-TO: and
/RENAME-TO: switches of the SEND, GET, and RECEIVE commands.  They should
normally be used only when setting up a dedicated transaction-processing
application, in which each file is to be moved or renamed immediately after,
and only if, it is transferred successfully, so that (for example) an
independent, concurrent process can notice when new files appear and process
them immediately without having to guess whether they are complete.

<p>
<hr>
<h4><a name="x4.0.9">4.0.9. SET FILE INCOMPLETE AUTO</a></h4>

SET FILE INCOMPLETE <i>{</i> KEEP, DISCARD <i>}</i>, which tells whether to
keep or discard incompletely received files, has a new option, AUTO, which is
also the default.  It means KEEP the incomplete file if the transfer is in
binary mode, otherwise DISCARD it.  This reduces the chances that a subsequent
recovery operation (RESEND, REGET, etc) could produce a corrupt file, since
recovery works only for binary-mode transfers.

<p>
<hr>
<h3><a name="x4.1">4.1. FILE-TRANSFER FILENAME TEMPLATES</a></h3>

File-transfer filename templates allow files to be renamed automatically by
the file sender, the receiver, or both, during transfer of groups of files.

<h4><a name="x4.1.1">4.1.1. Templates in the As-Name</a></h4>

Prior to C-Kermit 6.1 and Kermit 95 1.1.12 the only options that could be
used to affect the names of files being transferred were SET FILENAMES
<i>{</i> LITERAL, CONVERTED <i>}</i> and SET <i>{</i> SEND, RECEIVE <i>}</i>
PATHNAMES <i>{</i> ON, OFF <i>}</i>, plus the "as-name" feature of the SEND
(MOVE, etc) and RECEIVE commands.
<p>
Previously, the as-name could be used only for a single file.  For example:
<p><pre>
  SEND FOO BAR
</pre><p>
would send the file FOO under the name BAR, but:
<p><pre>
  SEND *.TXT anything
</pre><p>
was not allowed, since it would give the same name to each file that was sent.
When receiving:
<p><pre>
  RECEIVE FOO
</pre><p>
would rename the first incoming file to FOO before storing it on the disk,
but subsequent files would not be renamed to FOO, since this would result in
overwriting the same file repeatedly.  Instead, they were stored under the
names they arrived with.
<p>
Beginning in C-Kermit 6.1 and Kermit 95 1.1.12, it is possible to
specify as-names in SEND, RECEIVE, and related commands even for file
groups.  This is accomplished by using replacement variables in the as-name,
along with optional material such character-string functions and/or constant
strings.  An as-name containing replacement variables is called a filename
template.
<p>
The key to filename templates is the new variable:
<p><pre>
  \v(filename)
</pre><p>
During file transfer it is replaced by the name of each file currently being
transferred (after transfer, it is the name of the last file transferred).
<p>
So, for example:
<p><pre>
  send *.txt \v(filename).new
</pre><p>
sends each file with its own name, but with ".new" appended to it.  Of course
if the name already contains periods, this could confuse the file receiver, so
you can also achieve fancier effects with constructions like:
<p><pre>
  send *.txt \freplace(\v(filename),.,_).new
</pre><p>
which replaces all periods in the original filename by underscores, and then
appends ".new" to the result.  So, for example, oofa.txt would be sent as
oofa_txt.new.
<p>
Another new variable that is useful in this regard is \v(filenumber), which
is the ordinal number of the current file in the file group, so you can also:
<p><pre>
  send *.txt FILE\flpad(\v(filenum),2,0)
</pre><p>
resulting in a series of files called FILE00, FILE01, FILE02, etc.  (At the
end of the transfer, \v(filenum) tells the number of files that were
transferred).
<p>
If you specify a constant as-name when sending a file group:
<p><pre>
  send *.txt thisnameonly
</pre><p>
Kermit complains and asks you to include replacement variables in the
as-name.  You should generally use \v(filename) or \v(filenumber) for this
purpose, since other variables (with the possible exception of date/time
related variables) do not change from one file to the next.  But Kermit
accepts any as-name at all that contains any kind of variables for file
group, even if the variable will not change.  So:
<p><pre>
  send *.txt \%a
</pre><p>
is accepted, but all files are sent with the same name (the value of \%a, if
it has one and it is constant).  If the variable has no value at all, the
files are sent under their own names.
<p>
Of course, the value of \%a in the previous example need not be constant:
<p><pre>
  define \%a FILE\flpad(\v(filenum),2,0)_at_\v(time)
  send *.txt \%a
</pre><p>
The RECEIVE command, when given without an as-name, behaves as always, storing
all incoming files under the names they arrive with, subject to SET FILE NAME
and SET RECEIVE PATHNAMES modifications (<a href="#x4.10">Section 4.10</a>).
<p>
However, when an as-name is given in the RECEIVE command, it is applied to
all incoming files rather than to just the first.  If it does not contain
replacement variables, then the current FILE COLLISION setting governs the
result.  For example:
<p><pre>
  receive foo
</pre><p>
will result in incoming files named <tt>foo, foo.~1~, foo.~2~</tt>, and so on,
with the default FILE COLLISION setting of BACKUP.  If it does contain
replacement variables, of course they are used.
<p>
When receiving files, the <tt>\v(filename)</tt> variable refers to the name
that was received in the incoming file-header packet, BEFORE any processing by
SET FILE NAMES or SET RECEIVE PATHNAMES.  Since the filenames in file-header
packets are usually in uppercase, you would need to convert them explicitly if
you want them in lowercase, e.g.:
<p><pre>
  receive \flower(\v(filename)).new
</pre>

<p>
<hr>
<h4><a name="x4.1.2">4.1.2. Templates on the Command Line</a></h4>

On the command-line, use templates as shown above as the -a option argument,
bearing in mind the propensity of UNIX and perhaps other shells to treat
backslash as a shell escape character.  So in UNIX (for example):
<p><pre>
  kermit -s oofa.* -a x.\\v(filenum)
</pre><p>
By the way, this represents a change from 6.0 and earlier releases in
which the as-name (-a argument or otherwise) was not evaluated by the command
parser.  Thus, for example, in VMS (where the shell does not care about
backslashes), it was possible to:
<p><pre>
  kermit -s oofa.txt -a c:\tmp\oofa.txt
</pre><p>
Now backslashes in the as-name must be quoted not only for the shell (if
necessary) but also for Kermit itself:
<p><pre>
  kermit -s oofa.txt -a c:\\tmp\\oofa.txt      ; Kermit only
  kermit -s oofa.txt -a c:\\\\tmp\\\\oofa.txt  ; Shell and Kermit
</pre><p>
You can also use the \fliteral() function for this:
<p><pre>
  kermit -s oofa.txt -a \fliteral(c:\tmp\oofa.txt)      ; Kermit only
  kermit -s oofa.txt -a \\fliteral(c:\\tmp\\oofa.txt)   ; Shell and Kermit
</pre>

<p>
<hr>
<h4><a name="x4.1.3">4.1.3. Post-Transfer Renaming</a></h4>

Filename templates are now also useful in SET { SEND, RECEIVE } RENAME-TO and
in the /RENAME-TO: switch, that can be given to the SEND, GET, or RECEIVE
commands; this is similar to an as-name, but is effective on a per-file basis
if and only if the file was transferred successfully.
<p>
MOVE-TO and RENAME-TO address a requirement commonly stated for transaction
processing and similar systems.  Suppose, for example, a central system "X"
accepts connections from multiple clients simultaneously; a process on X waits
for a file to appear and then processes the file.  This process must have a
way of knowing when the file has been completely and successfully transferred
before it starts to process it.  This can be accomplished easily using
C-Kermit's SET { SEND, RECEIVE } { MOVE-TO, RENAME-TO } command or /MOVE-TO:
or /RENAME-TO: switches, described in 
<a href="#x4.7.1">Sections 4.7.1</a> through <a href="#x4.7.3">4.7.3</a>.
<p>
Here's an example for the client side, in which files to be sent are placed in
a certain directory (/usr/olga/tosend in this example) by another process when
they are ready to go.  This might be in a hospital or big doctor's office,
where medical insurance claims are entered at a number of workstations, and
then deposited in the "tosend" directory, from which they are sent to a claims
clearinghouse.  We assume the connection is already made and a Kermit server
is on the other end.
<p><pre>
  local srcdir findir              ; Declare local (automatic) variables
  assign srcdir /usr/olga/tosend   ; Local source directory (files to send)
  assign findir /usr/olga/sent     ; Where to move files after they are sent
  log transactions                 ; Keep a log of transfers
  cd \m(srcdir)                    ; Change to the source directory
  while true {                     ; Loop forever...
      send /move-to:\m(findir) *   ; Send all files
      sleep 60                     ; Sleep a minute
  }                                ; Go back and do it again
</pre><p>
Note how simple this is.  Once each file is sent, it is moved so it won't be
sent again (you could also use SEND /RENAME-TO: or even SEND /DELETE).  If a
transfer fails, the file is not moved and so we try again to send it next time
around.  If there are no files to send, the SEND command does nothing but a
message is printed; you can avoid the message by checking first to see if any
files are in the directory:
<p><pre>
  while true {                     ; Loop forever...
      if &#62; \ffiles(*) 0 -          ; If there are any files
        send /move-to:\m(findir) * ; send them.
      sleep 60                     ; Sleep a minute.
  }                                ; Go back and do it again.
</pre><p>
It's even simpler on the server side (here again we assume the connection
is already in place):
<p><pre>
  local rcvdir findir              ; Declare local (automatic) variables
  assign rcvdir /usr/ivan/tmp      ; Temporary receiving directory
  assign findir /usr/ivan/new      ; Where to move files after reception
  log transactions                 ; Keep a log of transfers
  cd \m(rcvdir)                    ; Change to the source directory
  set receive move-to \m(findir)   ; Declare move-to directory.
  server                           ; Enter server mode.
</pre><p>
A separate process (e.g. the medical claim-form decoder) can look for files
appearing in the /usr/ivan/new directory and process them with every
confidence that they have been completely received.
<p>
Note that the use of MOVE-TO can result in moved files overwriting one another
(the application would normally avoid this by assigning each transaction a
unique, e.g. based on customer number and claim number).  But if filename
collisions are a possibility in your application, RENAME-TO might be a better
choice; you can use any variables you like in the template to ensure
uniqueness of the RENAME-TO filename; for example:
<p><pre>
  SET RECEIVE RENAME-TO \v(filename)_\v(ndate)_\v(ntime)_\v(userid)_\v(pid)
</pre>

<p>
<hr>
<h3><a name="x4.2">4.2. FILE-TRANSFER PIPES AND FILTERS</a></h3>
<h4><a name="x4.2.1">4.2.1. INTRODUCTION</a></h4>

Beginning in C-Kermit 6.1 and Kermit 95 1.1.12, it is possible to send from a
command, or "pipe", as well as from a file, and to receive to a pipe or
command.  In a typical example, we might want to transfer an entire directory
tree from one UNIX system to another (but without using the methods described
in 
<a href="#x4.3">Sections 4.3</a> , <a href="#x4.10">4.10</a>,
<a href="#x4.11">4.11</a>, and <a href="#x4.15">4.15</a>).  We could do this in
multiple steps as follows:
<p><pre>
  1. Create a tar archive of the desired directory tree
  2. Compress the tar archive
  3. Transfer it in binary mode to the other computer
  4. Decompress it
  5. Extract the directory tree from the tar archive
</pre><p>
But this is inconvenient and it requires a temporary file, which might be
larger than we have room for.
<p>
The new pipe-transfer feature lets you do such things in a single step,
and without intermediate files.
<p>
Additional new features, also discussed here, let you specify pre- and post-
processing filters for outbound and incoming files, and give you a way to
insert the output from shell or system commands into C-Kermit commands.
<p>
The file-transfer related features are available only with Kermit protocol,
not with any external protocols, nor with K95's built-in XYZMODEM protocols
(because XYZMODEM recovers from transmission errors by rewinding the source
file, and you can't rewind a pipe).
<p>
This section begins by discussing the simple and straightforward use of these
features in UNIX, in which pipes and input/output redirection are a
fundamental component and therefore "just work", and then goes on to discuss
their operation in Windows and OS/2, where matters are much more complicated.

<p>
<hr>
<h4><a name="x4.2.1.1">4.2.1.1. TERMINOLOGY</a></h4>

<dl>
<dt><b>Standard Input</b>
<dd>This is a precise technical term denoting the normal source of input for
  a command or program, which is the keyboard of your terminal by default,
  but which can be redirected to a file or pipe.
<p>
<dt><b>Stdin</b>
<dd>Abbreviation for Standard Input.
<p>
<dt><b>Standard Output</b>
<dd>A precise technical term denoting the normal destination for output from a
  command or program, which is your terminal screen by default, but which can
  be redirected to a file.
<p>
<dt><b>Stdout</b>
<dd>Abbreviation for Standard Output.
<p>
<dt><b>Stdio</b>
<dd>Abbreviation for Standard Input / Standard Output.
<p>
<dt><b>I/O</b>
<dd>Abbreviation for Input / Output.
<p>
<dt><b>Shell</b>
<dd>Text-based system command processor, such as the UNIX shell, DOS
  COMMAND.COM, etc.
<p>
<dt><b>Pipe</b>
<dd>A mechanism by which the standard output of one program is sent to
  the standard input of another.
<p>
<dt><b>Pipeline</b>
<dd>A series of programs connected by pipes.
</dl>

<p>
<hr>
<h4><a name="x4.2.1.2">4.2.1.2. NOTATION</a></h4>

In command descriptions, "<i>command</i>" is replaced by a shell or system
command or pipeline.  The command names specified in these commands are
interpreted by your shell, just as if you were typing them at the shell
prompt, and so if they are in your PATH, they will be found in the expected
manner.  Therefore you don't have to specify complete pathnames for commands
that are programs (but it shouldn't hurt if you do).

<p>
The normal notation for I/O redirection is as follows:
<p><pre>
  &#60;  Read Stdin from the given file.
  &#62;  Send Stdout to the given file.
  |  Send Stdout from the command on the left to the command on the right.
</pre><p>
Examples:
<p><dl>
<dt><tt>sort &#60; foo &#62; bar</tt>
<dd>Sorts the lines in file "foo" and writes the results to file "bar"
<p>
<dt><tt>grep -c "some text" *.txt | grep -v ":0" | sort | pr -3 | lpr</tt>
<dd>This is a command pipeline composed of 5 commands:
<p>
<dt><tt>grep -c "some text" *.txt</tt>
<dd>Looks in all files whose names end with ".txt" for the string "some text"
and writes to Stdout the names of each file followed by a colon and the
number of occurrences in each.
<p>
<dt><tt>grep -v ":0"</tt>
<dd>Prints to Stdout the lines from Stdin that do NOT contain the string ":0",
in this case, it removes the names of files that do not contain "some
text".
<p>
<dt><tt>sort</tt>
<dd>Sorts the lines from Stdin alphabetically to Stdout.
<p>
<dt><tt>pr -3</tt>
<dd>Arranges the lines from Stdin in three columns.
<p>
<dt><tt>lpr</tt>
<dd>Prints its Stdin on the default printer.
</dl><p>
Note that the Kermit features described here work only with commands that use
Stdio.  If you attempt to use them with commands whose input and output can
not be redirected, Kermit will most likely get stuck.  Kermit has no way of
telling how an external command works, nor what the syntax of the shell is, so
it's up to you to make sure you use these features only with redirectable
commands.
<p>

The quoting rules of your shell apply to the <i>command</i>.  Thus in UNIX,
where C-Kermit tries to use your preferred shell for running commands, shell
"metacharacters" within commands must be escaped if they are to be taken
literally, using the methods normal for your shell.  For example, the UNIX tr
(translate) command must have its arguments in quotes:
<p><pre>
  tr "[a-z]" "[A-Z]"
</pre><p>
otherwise the shell is likely to replace them by all filenames that match,
which is probably not what you want.  This is also true when using your shell
directly, and has nothing to do with Kermit.

<p>
<hr>
<h4><a name="x4.2.1.3">4.2.1.3. SECURITY</a></h4>

Some sites might not wish to allow access to system commands or external
programs from within Kermit.  Such access, including all the features
described here, can be disabled in various ways:
<p><ol>
<li>When building from source code, include -DNOPUSH among the CFLAGS.
<li>At runtime, give the NOPUSH command.
<li>For server mode, give the DISABLE HOST command.
<li>Implicit use of pipes can be disabled as described in
<a href="#x4.2.4">Section 4.2.4</a>.
</ol>
<p>
Note: 3 and 4 are not necessary if you have done 1 or 2.

<p>
<hr>
<h4><a name="x4.2.2">4.2.2. Commands for Transferring from and to Pipes</a></h4>

SEND /COMMAND sends data from a command or command pipeline, and RECEIVE
/COMMENT writes data to a command or pipeline.  The GET /COMMAND command
asks a server to send material, and then writes the incoming material to a
command or pipeline.  These features, along with switches (like "/COMMAND",
described in 
<a href="#x4.7">Section 4.7</a>) are new to C-Kermit 6.1.  The following
synonyms are also provided:
<p><pre>
  CSEND    = SEND /COMMAND
  CRECEIVE = RECEIVE /COMMAND
  CGET     = GET /COMMAND
</pre><p>
None of these commands can be used if a SEND or RECEIVE FILTER (respectively,
<a href="#x4.2.3">Section 4.2.3</a>) is in effect, or if a NOPUSH command
(<a href="#x4.2.1.3">Section 4.2.1.3</a>) has been
given, or if the current protocol is not Kermit.

<p>
<hr>
<h4><a name="x4.2.2.1">4.2.2.1. Sending from a Command</a></h4>

<dl>
<dt><b>SEND /COMMAND</b> <i>command [ as-name ]</i>
<dt><b>SEND /AS-NAME:</b><i>as-name</i> <b>/COMMAND</b> <i>command</i>
<dt><b>CSEND</b> <i>command [ as-name ]</i>
<dd>These three forms are the same.  They work like the SEND command, but
instead of sending a file, it sends the standard output of the given
<i>command</i>, either under the command's own name, or else with the given
<i>as-name</i>.  If the <i>command</i> contains spaces, it must be enclosed in
braces.  Braces should also be used for the <i>as-name</i> if it contains
spaces.  If braces are included around either the <i>command</i> or the
<i>as-name</i>, they are removed after parsing but before use.  As with SEND,
the transfer is in text or binary mode according the current FILE TYPE
setting, unless you override the global transfer mode by including a /TEXT or
/BINARY switch.  The <i>command</i> must require no input.
</dl><p>
When sending from a command or pipeline, C-Kermit has no way of knowing
in advance how much data will be sent, and so it can not send the size
to the other Kermit in the Attribute packet, and so the receiving Kermit
has no way of displaying "percent done" or a progress bar (thermometer).
<p>
Examples that make sense in text mode (illustrated by common UNIX commands):
<dl>
<dt><tt>SEND /COMMAND finger</tt>
<dt><tt>CSEND finger</tt>
<dd>sends the current "finger" listing (who's logged in) under the
name "finger".  The two forms "send /command" and "csend" are
equivalent; we won't bother showing them both in the rest of the
examples.
<p>
<dt><tt>SEND /COMMAND:{finger}</tt>
<dt><tt>CSEND {finger}</tt>
<dd>Same as previous example (braces are removed from "{finger}").
<p>
<dt><tt>SEND /COMMAND:{ finger }</tt>
<dt><tt>CSEND { finger }</tt>
<dd>Same as previous example, but note that the spaces are kept.  This
does not prevent the shell from running the "finger" program, but
its output is sent under the name " finger " (with a leading and
trailing space).
<p>
<dt><tt>SEND /COMMAND:finger /AS-NAME:userlist</tt>
<dt><tt>CSEND finger userlist</tt>
<dd>sends the current finger listing under the name "userlist".
<p>
<dt><tt>SEND /COMMAND:{finger | sort -r} /AS-NAME:userlist</tt>
<dt><tt>CSEND {finger | sort -r} userlist</tt>
<dd>sends the current finger listing, sorted in reverse order, under the
name "userlist".  The braces are needed to distinguish the <i>command</i>
from the <i>as-name</i>.
<p>
<dt><tt>SEND /COMMAND:{finger | sort -r} /AS-NAME:{userlist}</tt>
<dt><tt>CSEND {finger | sort -r} {userlist}</tt>
<dd>Same as previous example (braces are removed from "{userlist}").
<p>
<dt><tt>SEND /COMMAND:{finger | sort -r} /AS-NAME:{\freplace(\v(filename),\32,_)}</tt>
<dt><tt>CSEND {finger | sort -r} {\freplace(\v(filename),\32,_)}</tt>
<dd>Like the previous example, but sends the output of the <i>command</i> under
the name of the command, but with all spaces (\32) replaced by underscores,
so the as-name is "<tt>finger_|_sort_-r</tt>".
</dl>
<p>
 Examples that make sense in binary mode (three equivalent forms are shown):
<p><dl>
<dt><tt>SEND /COMMAND /BINARY {tar cf - . | gzip -c} mydir.tar.gz</tt>
<dt><tt>SEND /COMMAND /BINARY /AS-NAME:mydir.tar.gz {tar cf - . | gzip -c}</tt>
<dt><tt>CSEND /BINARY {tar cf - . | gzip -c} mydir.tar.gz</tt>
<dd>Makes a tar archive of the current directory, compresses it with the GNU
gzip program, and sends it as "mydir.tar.gz".  The other Kermit can, of
course, just store it as a file, or it can use CRECEIVE to uncompress and
dearchive it as part of the transfer process.
</dl><p>
When using a "pipeline" of commands in the <i>command</i> field, obviously,
the first command must not require any input, and the last command should
produce some output, and all intermediate commands should get some input and
produce some output.

<p>
<hr>
<h4><a name="x4.2.2.2">4.2.2.2. Receiving to a Command</a></h4>

<dl>
<dt><b>RECEIVE /COMMAND</b> <i>command</i>
<dt><b>CRECEIVE</b> <i>command</i>
<dd>This is like RECEIVE, except incoming material is written to the standard
input of the given command, in text or binary mode according to the normal
rules for file reception.  Be sure to include a redirector to a file (if the
command normally writes to standard output), or the output of the command
won't go anywhere.  The <i>command</i> may contain spaces; braces are not
needed, but they are removed if used.
</dl>
<p>
WARNING: C-Kermit has no way of knowing anything about the <i>command</i>, or
even whether it is a command.  Thus this command will always cause C-Kermit to
enter protocol mode, as long as some text is specified in the <i>command</i>
field.  However, if the text does not correspond to a command, the transfer
will eventually fail with a message such as "Error writing data" or "Failure
to close file".
<p>
Examples for text mode (in UNIX):
<p><dl>
<dt><tt>RECEIVE /COMMAND sort -r &#62; reverse.txt</tt>
<dt><tt>CRECEIVE sort -r &#62; reverse.txt</tt>
<dd>The text that is received is sorted in reverse order and stored in
the file "reverse.txt".  The two forms shown are equivalent.
<p>
<dt><tt>RECEIVE /COMMAND {sort -r &#62; reverse.txt}</tt>
<dt><tt>CRECEIVE {sort -r &#62; reverse.txt}</tt>
<dd>The same as the previous example; if braces are included, they are
simply removed.
<p>
<dt><tt>RECEIVE /COMMAND {sort -r &#62; \flower(\v(filename)).reverse}</tt>
<dt><tt>CRECEIVE {sort -r &#62; \flower(\v(filename)).reverse}</tt>
<dd>Same but stores result under the incoming filename, lowercased, and
with ".reverse" appended to it.
<p>
<dt><tt>RECEIVE /COMMAND sort</tt>
<dt><tt>CRECEIVE sort</tt>
<dd>Does nothing useful, since the output of sort has nowhere to go.
<p>
<dt><tt>RECEIVE /COMMAND sort -r | pr -3 | lpr -Plaserjet</tt>
<dt><tt>CRECEIVE sort -r | pr -3 | lpr -Plaserjet</tt>
<dd>The text that is received is sorted in reverse order, arranged into
three columns, and sent to the "laserjet" printer.
</dl>
<p>
Examples for binary mode:
<p><dl>
<dt><tt>RECEIVE /COMMAND:{gunzip -c | tar xf -}</tt>
<dt><tt>CRECEIVE {gunzip -c | tar xf -}</tt>
<dd>Assuming the data that is received is a compressed tar archive,
uncompresses the archive and passes it to tar for extraction.  In this case
the braces are needed because otherwise the final "-" would be taken as a
command continuation character
(see <a href="ckb2.html"><cite>Using
C-Kermit</cite></a>, 2nd Edition, p.33).
</dl>
<p>
<dl>
<dt><b>GET /COMMAND</b> <i>remote-file</i> <i>command</i>
<dt><b>GET /COMMAND /AS-NAME:</b><i>command</i> <i>remote-file</i>
<dt><b>CGET</b> <i>remote-file</i> <i>command</i>
<dd>This command tells the Kermit client to send a GET request for the given
remote file to a Kermit server.  Unlike GET, however, the incoming material
is written to a command, rather than to a file.  If the <i>remote-file</i> or
the <i>command</i> contain spaces, they must be enclosed in braces.  The same
cautions about the <i>command</i> apply as for CRECEIVE.
</dl><p>
Examples (for UNIX):
<p><dl>
<dt><tt>GET /COMMAND oofa.txt sort -r &#62; oofa.new</tt>
<dt><tt>GET /COMMAND {oofa.txt} {sort -r &#62; oofa.new}</tt>
<dt><tt>CGET oofa.txt sort -r &#62; oofa.new</tt>
<dt><tt>CGET {oofa.txt} {sort -r &#62; oofa.new}</tt>
<dd>These four are equivalent.  Each of them requests the server to send
its "<tt>oofa.txt</tt>" file, and as it arrives, it is sorted in reverse order
and written to "<tt>oofa.new</tt>".
<p>
<dt><tt>GET /COMMAND {profile exec a} lpr</tt>
<dt><tt>GET /COMMAND {profile exec a} {lpr}</tt>
<dt><tt>GET /COMMAND /AS-NAME:lpr {profile exec a}</tt>
<dt><tt>GET /COMMAND /AS-NAME:{lpr} {profile exec a}</tt>
<dt><tt>GET /COMMAND /AS:lpr {profile exec a}</tt>
<dt><tt>CGET {profile exec a} lpr</tt>
<dt><tt>CGET {profile exec a} {lpr}</tt>
<dd>Here the remote filename contains spaces so it MUST be enclosed in
braces.  As it arrives it is sent to the lpr program for printing.
Braces are optional around "lpr" since it contains no spaces.
<p>
<dt><tt>GET /COMMAND *.txt {cat &#62;&#62; new.txt}</tt>
<dt><tt>GET /AS-NAME:{cat &#62;&#62; new.txt} /COMMAND *.txt</tt>
<dt><tt>CGET *.txt {cat &#62;&#62; new.txt}</tt>
<dd>This gets all the ".txt" files from the server and concatenates them
all into a single "new.txt" file on the client.
<p>
<dt><tt>GET /COMMAND *.txt {echo \v(filename)&#62;&#62;new.txt;cat&#62;&#62;new.txt}</tt>
<dt><tt>CGET *.txt {echo \v(filename)&#62;&#62;new.txt;cat&#62;&#62;new.txt}</tt>
<dd>As above, but inserts each file's name before its contents.
</dl>

<p>
<hr>
<h4><a name="x4.2.3">4.2.3. Using File-Transfer Filters</a></h4>

The commands described in 
<a href="#x4.2.2">Section 4.2.2</a> let you send the output of a command,
or receive data into a command.  But what if you want to specify preprocessing
for files that you send, or postprocessing of files that you receive, even
when multiple files are involved?  For this you need a way to specify send and
receive filters.  The commands are SET SEND FILTER and SET RECEIVE FILTER;
SHOW PROTOCOL displays the current settings.

<h4><a name="x4.2.3.1">4.2.3.1. The SEND Filter</a></h4>

<dl>
<dt><b>SET SEND FILTER</b> <i>[ command ]</i>
<dd>This command specifies a <i>command</i> to be run on any file that you
SEND (or MOVE, MSEND, etc).  It also applies to files sent when in server
mode, in response to GET commands, but not to the results of REMOTE commands
like REMOTE DIRECTORY, REMOTE TYPE, REMOTE HOST, etc.  The <i>command</i> may
be, but need not be, enclosed in braces; if it is, the braces are stripped
before use.  The output of this command is sent, rather than the file itself.
The current FILE TYPE setting (TEXT or BINARY) applies to the output of the
command.  The <i>command</i> must contain at least one instance of
\v(filename), for which the name of the actual file is substituted.  If the
<i>command</i> is omitted, the send filter is removed and files are sent in
the normal manner.
</dl>
<p>
The SET SEND FILTER sets up a "global" filter -- that is, one that applies to
all subsequent file-sending commands until you change or remove it.  You can
also specify a "local" filter to be used in a specific file-sending command by
using the /FILTER switch (see <a href="#x1.5">Section 1.5</a>); for example:
<p><pre>
  SEND /FILTER:<i>command [ other-switches ] filename</i>
</pre><p>
Besides <tt>\v(filename)</tt>, you can include any other script programming
notation in the send filter: variable names, array references, calls to
built-in string or other functions, and so on.  These are evaluated during
file transfer, NOT during parsing, and they are evaluated separately for each
file.
<p>
When the SEND or MOVE (SEND /DELETE) command is used with a send filter, the
output from the filter is sent under the file's original name unless you
specify an "as-name" or template.  The Attribute packet (if any) contains the
original file's attributes (size, creation date, etc).  So (for example) if
the filter changes the file's size, the progress thermometer might be wrong.
(We can't send the size of the output from the filter, because it is not known
until the transfer is finished.)  If you prefer that the size not be sent, use
"set attributes size off".
<p>
You can not use send filters with RESEND (SEND /RECOVER) or PSEND
(SEND /START).
<p>
Examples for text mode:
<p><dl>
<dt><tt>SET SEND FILTER sort -r \v(filename)     ; Braces may be omitted</tt>
<dt><tt>SET SEND FILTER {sort -r \v(filename)}   ; Braces may be included</tt>
<dt><tt>SEND *.txt</tt>
<dd>This sends every file in the current directory whose name ends with
"<tt>.txt</tt>" under its own name, but with its lines sorted in reverse order.
<p>
<dt><tt>SEND /FILTER:{sort -r \v(filename)} *.txt</tt>
<dd>Same as above, but the filter applies only to this SEND command.
Braces are required in this case.
<p>
<dt><tt>SET SEND FILTER {sort -r \v(filename)}</tt>
<dt><tt>SEND oofa.txt reverse.txt</tt>
<dd>Sends the oofa.txt file with its lines sorted in reverse order under
the name "reverse.txt".
<p>
<dt><tt>SET SEND FILTER {sort -r \v(filename)}</tt>
<dt><tt>SEND oofa.* \v(filename).reverse</tt>
<dd>Sends all the oofa.* files with their lines sorted in reverse order;
each file is sent under its own name but with ".reverse" appended to it.
<p>
<dt><tt>SET SEND FILTER {tr "[a-z]" "[A-Z]" &#60; \v(filename)}</tt>
<dt><tt>SEND *.txt</tt>
<dd>Sends all ".txt" files under their own names, but uppercasing their
contents.
</dl><p>
Note that the SEND FILTER applies not only to files that are sent with
SEND, MOVE, MSEND, etc, but also to files sent by the C-Kermit server in
response to GET requests.
<p>
Examples for binary mode:
<p><dl>
<dt><tt>SET SEND FILTER {gzip -c \v(filename)}</tt>
<dt><tt>SEND /BINARY oofa.txt oofa.txt.gz</tt>
<dd>Sends the oofa.txt file, compressed by gzip, as oofa.txt.gz.
<p>
<dt><tt>SEND /BINARY /FILTER:{gzip -c \v(filename)} oofa.txt oofa.txt.gz</tt>
<dd>As above, but the filter applies only to this SEND command.
<p>
<dt><tt>SET SEND FILTER {gzip -c \v(filename)}</tt>
<dt><tt>SEND /BINARY oofa.* \fupper(\replace(\v(filename),.,_)).GZ</tt>
<dd>Sends all the oofa.* files, compressed by gzip, each under its own name,
but with the name uppercased, all periods within the name converted to
underscores, and ".GZ" appended to it.  So, for example, "oofa.txt"
is sent as "OOFA_TXT.GZ".
</dl><p>
In the gzip examples, note that the amount of data that is sent is normally
less than the original file size because gzip compresses the file.  But Kermit
sends the original file size ahead in the attribute packet anyway (unless you
tell it not too).  Thus the transfer will probably appear to terminate early,
e.g. when the receiver's file-transfer display thermometer is only at 40%.
If this annoys you, tell Kermit to "set attribute length off".  On the other
hand, you can use the final position of the thermometer as a measure of the
effectiveness of compression.

<p>
<hr>
<h4><a name="x4.2.3.2">4.2.3.2. The RECEIVE Filter</a></h4>

<dl>
<dt><b>SET RECEIVE FILTER</b>  <i>[ command ]</i>
<dd>This command specifies that the given <i>command</i> will be run on any
file that is received before it is written to disk.  The <i>command</i> may
be, but need not be, enclosed in braces; if it is the braces are stripped
before use.  The following two commands are equivalent:
<p><pre>
  SET RECEIVE FILTER sort -r &#62; \v(filename)
  SET RECEIVE FILTER {sort -r &#62; \v(filename)}
</pre></dl><p>
The RECEIVE filter <i>command</i> may contain a "<tt>\v(filename)</tt>"
sequence to be replaced by the incoming filename from the file header packet,
but it is not required.  However you must use it whenever your filter would
normally write to Stdout, otherwise its output will be lost.
<p>
The RECEIVE filter <i>command</i> may contain one or more
"<tt>\v(filename)</tt>" sequence to be replaced by the incoming filename from
the file header packet, but it is not required.  However you must use it
whenever your filter would normally write to Stdout, otherwise its output will
be lost.
<p>
RECEIVE /FILTER:<i>command</i> and GET /FILTER:<i>command</i> can also be used
to specify a filter to be used for only one file-transfer operation.
<p>
UNIX examples for text mode:
<p><dl>
<dt><tt>SET RECEIVE FILTER lpr</tt>
<dt><tt>RECEIVE</tt>
<dd>All the files that are received are sent to the default UNIX print
spooler.
<p>
<dt><tt>RECEIVE /FILTER:lpr</tt>
<dd>Same as above, except the lpr filter is used only with this
RECEIVE command.
<p>
<dt><tt>RECEIVE lpr</tt>
<dd>This is probably not what you want; it creates a file called lpr.
<p>
<dt><tt>SET RECEIVE FILTER {sort -r &#62; \v(filename)}</tt>
<dt><tt>RECEIVE</tt>
<dd>Stores each incoming file with its lines sorted in reverse order,
under its own name.
<p>
<dt><tt>RECEIVE /FILTER:{sort -r &#62; \v(filename)}</tt>
<dd>As above, but the filter is used only for this RECEIVE command.
<p>
<dt><tt>SET RECEIVE FILTER sort -r &#62; \v(filename)</tt>
<dt><tt>RECEIVE reverse.txt</tt>
<dd>Stores each incoming file with its lines sorted in reverse order,
under the name "reverse.txt".  The actual result depends on the
FILE COLLISION setting.  If it is OVERWRITE and multiple files arrive,
then each incoming file destroys the previous one.  If it is BACKUP
(the default), filename conflicts are resolve by adding "version numbers"
to the filenames: reverse.txt, reverse.txt.~1~, reverse.txt.~2~, etc.
<p>
<dt><tt>SET RECEIVE FILTER sort -r &#62; \v(filename)</tt>
<dt><tt>RECEIVE \v(filename).reverse</tt>
<dd>Stores each incoming file with its lines sorted in reverse order,
under the name it arrived with, but with ".reverse" appended to it.
<p>
<dt><tt>SET RECEIVE FILTER sort -r &#62; \v(filename)</tt>
<dt><tt>RECEIVE \flower(\v(filename)).reverse</tt>
<dd>Like the previous example, but ensures that the filename is lowercase.
<p>
Examples for binary mode:
<p>
<dt><tt>SET RECEIVE FILTER gunzip -c &#62; \v(filename)</tt>
<dt><tt>RECEIVE</tt>
<dd>This receives one or more presumably compressed file and uncompresses
each one into a file having the same name it was sent with.  For example,
if the file is sent with the name OOFA.TXT.GZ, it is stored with that
name, even after decompression.
<p>
<dt><tt>SET RECEIVE FILTER gunzip -c &#62; \v(filename)</tt>
<dt><tt>RECEIVE \flower(\fsubstring(\v(filename),1,\flength(\v(filename))-3))</tt>
<dd>Like the previous example, but the resulting filename has its rightmost
three characters removed from it and the remainder is lowercased.  So if
the incoming filename is OOFA.TXT.GZ, it is stored as oofa.txt after
decompression.
</dl><p>
Of course you don't want to type such long hideous commands, so we have also
introduced several new functions:
<p>
<dl>
<dt><b><tt>\fstripx(<i>string[,character]</i>)</tt></b>
<dd>This function removes the rightmost segment of the string that starts with
the given character.  If no character is given, period (.) is used.  Thus
it is most conveniently used for stripping the extension from a filename
(or the decimal portion from a floating-point number written in US/UK
style).  Examples:
<p><pre>
   \fstripx(OOFA.TXT.GZ)             =&#62; OOFA.TXT
   \fstripx(OOFA.TXT.GZ,.)           =&#62; OOFA.TXT
   \fstripx(OOFA.TXT.GZ,X)           =&#62; OOFA.T
   \fstripx(\fstripx(OOFA.TXT.GZ))   =&#62; OOFA
   \fstripx($100.00)                 =&#62; $100
</pre><p>
<dt><b><tt>\fstripn(<i>string,number</i>)</tt></b>
<dd>Removes the rightmost <i>number</i> characters from the string.  Examples:
<p><pre>
   \fstripn(OOFA.TXT.GZ)             =&#62; OOFA.TXT.GZ
   \fstripn(OOFA.TXT.GZ,3)           =&#62; OOFA.TXT
   \fstripn(OOFA.TXT.GZ,7)           =&#62; OOFA
</pre><p>
<dt><b><tt>\fstripb(<i>string[,c1[,c2]]</i>)</tt></b>
<dd>Strips enclosing matching braces, brackets, parentheses, or quotes from
the string.  The second argument, c1, specifies which kind of enclosure
to look for; if not specified, any enclosing
<tt>()</tt>, <tt>[]</tt>, <tt>&#60;&#62;</tt>, <tt>{}</tt>, <tt>""</tt>,
<tt>''</tt>, or <tt>`'</tt> are removed.  If c1 is specified and c2 is not,
then if c1 is an opening brace, bracket, or parenthesis, the matching closing
one is supplied automatically as c2.  If both c1 and c2 are specified, then to
be stripped the string must begin with c1 and end with c2.  If the string is
not enclosed in the indicated manner, the result is the original string.
Examples:
<p><pre>
   \fstripb("abc")                   =&#62; abc
   \fstripb([abc])                   =&#62; abc
   \fstripb([abc)                    =&#62; [abc
   \fstripb(&#60;abc&#62;)                   =&#62; abc
   \fstripb(&#60;abc&#62;,[)                 =&#62; &#60;abc&#62;
   \fstripb((abc))                   =&#62; abc
   \fstripb((abc),[)                 =&#62; (abc)
   \fstripb((abc),{(})               =&#62; abc
   \fstripb(+abc+)                   =&#62; +abc+
   \fstripb(+abc+,+)                 =&#62; abc
   \fstripb(+abc+,+,^)               =&#62; +abc+
   \fstripb(+abc^,+,^)               =&#62; abc
   \fstripb('abc')                   =&#62; abc
   \fstripb(`abc')                   =&#62; abc
   \fstripb(``abc'')                 =&#62; `abc'
   \fstripb(\fstripb(``abc''))       =&#62; abc
</pre><p>
Notice the special syntax required for including a literal parenthesis
in the argument list.  As the last two examples illustrate, <tt>\fstripb()</tt>
strips only one level at at a time; nesting can be used to strip a small
fixed number of levels; loops can be used to strip larger or indeterminate
numbers of levels.
<p>
<dt><b><tt>\flop(<i>string[,char]</i>)</tt></b>
<dd>Removes the leftmost segment of the string that ends with the given
character.  If no character is given, period (<tt>.</tt>) is used.  Examples:
<p><pre>
  \flop(OOFA.TXT.GZ)               =&#62; TXT.GZ
  \flop(OOFA.TXT.GZ,.)             =&#62; TXT.GZ
  \flop(OOFA.TXT.GZ,X)             =&#62; T.GZ
</pre><p>
To remove the leftmost <i>number</i> characters, just use
<tt>\fsubstring(<i>s,number</i>+1)</tt>.
To return the rightmost <i>number</i> characters, use
<tt>\fright(<i>s,number</i>)</tt>.
</dl><p>
So the hideous example:
<p><pre>
  receive \flower(\fsubstring(\v(filename),1,\flength(\v(filename))-3))
</pre><p>
can now be written as:
<p><pre>
  receive \flower(\fstripx(\v(filename)))
</pre><p>
That is, the filename stripped of its extension and then lowercased.  This
is not only shorter and less hideous, but also does not depend on the
length of the extension being 3.
<p>
Note that when a receive filter is in effect, this overrides your FILE
COLLISION setting, since Kermit has no way of knowing what the final
destination filename will be (because it does not know, and can not be
expected to know, the syntax of every version of every command shell on
every platform on the planet).

<p>
<hr>
<h4><a name="x4.2.4">4.2.4. Implicit Use of Pipes</a></h4>

If you wish, C-Kermit can also examine incoming filenames to see if they
start with "!", and if so, the subsequent text is treated as a command to
read from or write to.  For example, if a Kermit client is given the following
command:
<p><pre>
  get {!finger | sort}
</pre><p>
the server on the other end, if it supports this feature, will run the
"finger" program, pipe its standard output to the "sort" program, and send
sort's standard output back to you.  Similarly, if you:
<p><pre>
  send oofa.txt !sort -r &#62; oofa.new
</pre><p>
or, equivalently:
<p><pre>
  send oofa.txt {!sort -r &#62; oofa.new}
</pre><p>
or:
<p><pre>
  send /as-name:{!sort -r &#62; oofa.new} oofa.txt
</pre><p>
this has the receiver send the contents of the incoming oofa.txt file to
the sort program, which sorts the text in reverse order and stores the
result in oofa.new.
<p>
This use of the exclamation mark should be familiar to UNIX users as the
"bang" feature that lets you run an external application or command from
within another application.
<p>
Kermit's "bang" feature is disabled by default, since it is not unheard for
filenames to actually begin with "!".  So if you want to use this feature,
you must enable it with the following command:
<p><dl>
<dt><b>SET TRANSFER PIPES </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>ON enables the recognition of "!" notation in incoming filenames during
file transfer as an indicator that the remaining text is the name of a
command.  OFF, the default, disables this feature and uses the text as
a filename in the normal fashion.  This command does NOT affect SEND
/COMMAND, GET /COMMAND, CSEND, etc.
</dl>
<p>
So using a combination of CSEND (SEND /COMMAND) and the "bang" feature, you
can transfer a directory tree all in one command (assuming the remote
Kermit supports pipe transfers and has them enabled):
<p><pre>
  CSEND {tar cf - . | gzip -c} {!gunzip -c | tar xf -}
</pre><p>
or:
<p><pre>
  SEND /COMMAND:{tar cf - . | gzip -c} /as:{!gunzip -c | tar xf -}
</pre><p>
Pay close attention to the syntax.  Braces are needed around the
<i>command</i> because it contains spaces; braces are needed around the
<i>as-name</i> because it ends with "-".  The <i>as-name</i> must begin with
"!" or receiving Kermit will not recognize it as a command.  The CSEND command
must NOT begin with "!"  unless you are running a command whose name really
does start that character.  <p> Similarly, you have a Kermit server send a
directory tree to be unpacked on the client end:
<p><pre>
  CGET {!tar cf - . | gzip -c} {gunzip -c | tar xf -}
</pre><p>
or:
<p><pre>
  GET /COMMAND {!tar cf - . | gzip -c} /as:{gunzip -c | tar xf -}
</pre><p>
Notice how, in this case, the bang is required in the remote command, to
distinguish it from a filename, but not in the local command, since by
definition of CGET (or GET /COMMAND), it is known to be a command.
<p>
SEND and RECEIVE FILTERs supersede the bang feature.  For example, if a
file arrives under the name "!gunzip -c | tar xf -", but the receiving Kermit
also has been given a command like:
<p><pre>
  set receive filter sort -r &#62; \v(filename)
</pre><p>
then the incoming data will be sorted rather than gunzipped.
<p>
Finally, if SET TRANSFER PIPES is ON (and in this case, this must be done in
your C-Kermit initialization file), you can send from a pipe on the C-Kermit
command line:
<p><pre>
  kermit -s "!finger | sort -r" -a userlist
</pre><p>
In this case the "filename" contains spaces and so must be quoting using
your shell's quoting rules.

<p>
<hr>
<h4><a name="x4.2.5">4.2.5. Success and Failure of Piped Commands</a></h4>

Commands or programs started by Kermit as a result of CSEND or CRECEIVE
commands, CGET, SEND /COMMAND, REDIRECT commands (see 
<a href="#x4.2.8.2">Section 4.2.8.2</a>),
implicit use of pipes, RUN commands, and so forth, should return their exit
status codes to the Kermit command that caused them to be run, and
therefore IF SUCCESS and IF FAILURE tests after these commands should work
as expected.  For example:
<p><pre>
  CSEND blah &#60; filename
</pre><p>
should fail if there is no command called "blah" or if there is no file called
"filename".  However, this is not foolproof and sometimes C-Kermit might think
a command succeeded when it failed, or vice versa.  This is most likely to
happen when the highly system-dependent methods that Kermit must use to
determine a command's exit status code do not supply the right information.
<p>
It can also happen because some commands might define success and failure
differently from what you expect, or because you are using a pipeline composed
of many commands, and one of them fails to pass failing exit status codes up
the chain.  The most likely culprit is the shell itself, which in most cases
must be interposed between Kermit and any external program to be run.
<p>
In any case, you can examine the following variable to find out the exit
status code returned to Kermit by the process most recently run by any command
that runs external commands or programs, including CSEND, CRECEIVE, REDIRECT,
RUN, etc:
<p><pre>
  \v(pexitstat)
</pre><p>
In UNIX, Windows and OS/2, the value should be -2 if no command has been run
yet, 0 if the most recent command succeeded, -1, -3, or -4 if there was an
internal error, and a positive number returned by the command itself if the
command failed.  If the number is in the range 1-127, this is the program's
exit status code.  If it is 128 or greater, this is supposed to indicate that
the command or program was interrupted or terminated from outside itself.
<p>
In Windows 95 and 98, the return values of the default shell are unreliable;
various third-party shells can be used to work around this deficiency.
<p>
In VMS, it is the actual exit status code of the command that was run.  This
is an odd number if the command succeeded, and an even number if it failed.
You can see the associated message as follows:
<p><pre>
  run write sys$output f$message(\v(pexitstat))
</pre><p>
Or, more conveniently, use the new Kermit function:
<p><pre>
  echo \ferrstring(\v(pexitstat))
</pre><p>
which converts a system error code (number) to the corresponding message.

<p>
<hr>
<h4><a name="x4.2.6">4.2.6. Cautions about Using Pipes to Transfer Directory Trees</a></h4>

Although utilities such as tar and zip/unzip might be available on different
platforms (such as UNIX and Windows), this does not necessarily mean you can
use them successfully to transfer directory trees between unlike platforms.
For example:
<p><pre>
  CSEND {tar cf - . | gzip -c} {!gunzip -c | tar xf -}
</pre><p>
when used from UNIX to Windows will have satisfactory results for binary
files, but not for text files.  UNIX text files have lines ending with
Linefeed (LF) only, whereas Windows text files have lines ending in Carriage
Return and Linefeed (CRLF).  Thus any text files that were in the archive
formed by the first tar command will be unpacked by the second tar command
in their original form, and will display and print incorrectly in Windows
(except in applications that have been explicitly coded to handle UNIX-format
text files).  On the other hand if you told gzip to use "text mode" to do
record format conversion (assuming there was a way to tell it, as there is
with most "zip" programs), this would destroy any binary files in the archive.
<p>
Furthermore, if the archive contains text files that are written in languages
other than English, the "special" (accented and/or non-Roman) characters are
NOT translated, and are therefore likely show up as gibberish on the target
system.  For example, West European languages are usually encoded in ISO Latin
Alphabet 1 in UNIX, but in PC code page 850 on the PC.  Capital A with acute
accent is code point 193 (decimal) Latin-1, but 181 in CP850.  So A-acute in
the UNIX file becomes Middle Box Bottom on the PC, and similarly for all the
other special characters, and for all other languages -- Greek, Russian,
Hebrew, Japanese, etc.
<p>
So when transferring text files between unlike platforms, you should use
direct Kermit file transfers so Kermit can apply the needed record-format and
character-set transformations.  Use pipelines containing archivers like tar or
zip only if all the files are binary or the two systems use the same record
format and character set for text files.
<p>
Also see 
<a href="#x4.3">Sections 4.3</a>, <a href="#x4.10">4.10</a>,
<a href="#x4.11">4.11</a>, and <a href="#x4.15">4.15</a> for how to transfer
directory 
trees between both like and unlike systems directly with Kermit.

<p>
<hr>
<h4><a name="x4.2.7">4.2.7. Pipes and Encryption</a></h4>

Of course pipelines could be used for encrypted file transfers, assuming
proper precautions could be taken concerning the transmission of the key.
But there is rarely a good way to do this.  To illustrate using UNIX crypt:
<p><pre>
  csend {crypt key &#60; filename} {!crypt key &#62; filename}
</pre><p>
Or, more ambitiously:
<p><pre>
  csend {tar cf - . | gzip -c | crypt key} {!crypt key | gunzip -c | tar xf -}
</pre><p>
transmits the key in the file header packet as part of the (clear-text) remote
command, defeating the entire purpose of encrypting the file data.
<p>
But if you are connected in terminal mode to the remote computer and type:
<p><pre>
  creceive {crypt key &#62; filename}
</pre><p>
at the remote Kermit prompt, you have also transmitted the key in clear text
over the communications link.
<p>
At present, the only secure way to use CSEND and CRECEIVE with an encryption
filter is to have a human operator at both ends, so the key does not have to
be transmitted.
<p>
Theoretically it would be possible to use PGP software (Pretty Good Privacy,
by Phil Zimmerman, Phil's Pretty Good Software) to avoid key transmission
(since PGP uses separate public and private key and "lets you communicate
securely with people you've never met, with no secure channels needed for
prior exchange of keys"), but the specific method has yet to be worked out.
<p><blockquote>
HINT: See the PGP User's Guide, e.g. at:<br>
<a href="http://www.telstra.com.au/docs/PGP/">http://www.telstra.com.au/docs/PGP/</a><br>
Especially the topic "Using PGP as a UNIX-Style Filter":<br>
<a href="http://www.telstra.com.au/docs/PGP/pgpdoc2/pgpdoc2_17.html">http://www.telstra.com.au/docs/PGP/pgpdoc2/pgpdoc2_17.html</a>
</blockquote><p>

In any case, better and more convenient security options are now available:
Kerberos authentication and encryption
(<a href="security.html">CLICK HERE</a>
for details) and the new ability to run C-Kermit "though" other communication
programs, described in <a href="#x2.7">Section 2.7</a>.

<p>
<hr>
<h4><a name="x4.2.8">4.2.8. Commands and Functions Related to Pipes</a></h4>
<h4><a name="4.2.8.1">4.2.8.1. The OPEN !READ and OPEN !WRITE Commands</a></h4>
<p>

These are described in
<a href="ckb2.html"><cite>Using
C-Kermit</cite></a>, and are generally useful with reading output from
commands that produce more than one line on their standard output, or writing
multiple lines into commands that accept them on their standard input.

<p>

In C-Kermit 7.0 CLOSE !READ is accepted as a synonym for CLOSE READ, and
CLOSE !WRITE for CLOSE WRITE.
<p>

Testing the success and failure of these commands, however, can be a bit
tricky.  Consider:
<p><pre>
  open !read lalaskjfsldkfjsldkfj
</pre><p>
(where "lalaskjfsldkfjsldkfj" is neither a valid command nor the name of a
program or script that can be run).  OPEN !READ, in UNIX at least, translates
this into execl(shellpath,shellname,"-c",command).  This means it starts your
preferred shell (e.g. from the SHELL environment variable) and asks it to
execute the given command.  It must be this way, because your command can be a
either an internal shell command (which only your shell can execute) or an
external command, which only your shell knows how to find (it knows your PATH
and interprets, etc).  Therefore unless OPEN !READ can't start your shell,
it always succeeds.
<p>
Continuing with the nonexistent-command example:
<p><pre>
  C-Kermit&#62; <u>open !read lalaskjfsldkfjsldkfj</u>
  C-Kermit&#62; <u>status</u>
   SUCCESS
  C-Kermit&#62; <u>read line</u>
  C-Kermit&#62; <u>status</u>
   SUCCESS
  C-Kermit&#62; <u>echo "\m(line)"</u>
  "bash: lalaskjfsldkfjsldkfj: command not found"
  C-Kermit&#62; <u>close read</u>
  C-Kermit&#62; <u>status</u>
   FAILURE
  C-Kermit&#62;
</pre><p>
In other words, the failure can not be detected on OPEN, since the OPEN
command succeeds if it can start your shell.  It can't be detected on READ,
since all this does is read output from the shell, which in this case happens
to be an error message.  However, failure IS detected upon close, since this
is the occasion upon which the shell gives Kermit its exit status code.
<p>
For an illustration of this situation, see 
<a href="#x2.14">Section 2.14</a>.

<p>
<hr>
<h4><a name="x4.2.8.2">4.2.8.2. The REDIRECT Command</a></h4>

A second method of I/O redirection is offered by the REDIRECT command.
This is a rather advanced and tricky feature that is presently supported
only in UNIX C-Kermit, in OS-9 C-Kermit, and in Kermit 95.  Syntax:
<p><dl>
<dt><b>REDIRECT</b> <i>command</i>
<dd>Runs the given <i>command</i>, sending its standard output to the current
communications channel (SET LINE, SET PORT, or SET HOST connection),
and reading its standard input from the same connection.  Works only in
local mode -- i.e. a connection is required -- and then only if the given
command uses Standard I/O.
</dl><p>
Example:
<p><pre>
  redirect finger
</pre><p>
runs the local "finger" command and sends its output over the connection as
plain text, where presumably there is a process set up to read it.  Another
example:
<p><pre>
  redirect finger | sort -r
</pre><p>
shows the use of a pipeline.
<p>
Note: REDIRECT differs from CSEND/CRECEIVE in two important ways: (1) it does
not use the Kermit protocol, and (2) it uses a bidirectional pipe rather than
a one-way pipe.
<p>
The primary use of the REDIRECT command is to run external protocols, such as
sz/rz in UNIX for ZMODEM, when they work over Standard I/O(*).  Example:
<p><pre>
  set host xyzcorp.com
  (login, etc)
  redirect sz oofa.zip
</pre><p>
lets you make a Telnet connection with C-Kermit and then do a ZMODEM transfer
over it.  ZMODEM protocol messages go both ways over the same connection
simultaneously.
<p>
It is possible to use C-Kermit on UNIX as your PPP dialer and then to REDIRECT
the connection to the PPP software, but C-Kermit 7.0 offers a better approach
to PPP dialing in its new EXEC command (<a href="#x1.23">Section 1.23</a>).
<p>
In theory, you can also redirect an interactive process.  For example, suppose
you tell Kermit 95 to wait for an incoming TCP/IP connection:
<p><pre>
  set host * 3000
</pre><p>
and then tell C-Kermit on UNIX to:
<p><pre>
  set host kermit95hostname 3000
  redirect ksh
</pre><p>
and then tell Kermit 95 to CONNECT: now you are talking to the UNIX K-shell;
you can give commands (pwd, ls, etc) and see the results.  In practice, the
K-shell's terminal modes are messed up because (a) it is not going through the
Unix terminal driver, and (b) it is "smart" and knows it is being redirected,
and so acts in a decidedly inhospitable manner (other applications like EMACS,
vi, etc, simply refuse to run if their standard i/o has been redirected).
<p>
<blockquote>(*) The publicly-distributed sz/rz programs do not work as
clients.  However, Omen Technology does offer
an up-to-date redirectable client XYZMODEM program called crzsz.</blockquote>

<p>
<hr>
<h4><a name="x4.2.8.3">4.2.8.3. Receiving Mail and Print Jobs</a></h4>

As of 7.0, and in UNIX only, files that are sent to C-Kermit as mail (when
the other Kermit uses a MAIL or SEND /MAIL command) or to be printed (via
REMOTE PRINT or SEND /PRINT) are now piped directly to the mail or print
program, rather than written to temporary files and then mailed or printed and
then deleted.  This has the advantages of (a) not requiring a temporary file,
and (b) allowing mail to have a proper subject in place of the filename.
Temporary files were bad not only because they required (a) space, and (b)
writeability of the current directory, but also because using them could
result in wiping out an existing file.  See 
<a href="#x4.7">Section 4.7</a> for more about SEND
/MAIL and SEND /PRINT.

<p>
<hr>
<h4><a name="x4.2.8.4">4.2.8.4. Pipe-Related Functions</a></h4>

The <tt>\fcommand(</tt><i>command</i><tt>)</tt> function runs the given shell
or system command and returns the command's standard output as its value (with
any newline characters stripped from the end), unless the result is too long,
in which case it returns the empty string.  The maximum length for the result
is at least 1022 bytes, and it might be longer on some platforms.  Examples
(UNIX):
<p><pre>
  C-Kermit&#62; <u>echo "\fcommand(date)"</u>
  "Fri Apr 18 13:31:42 1997"
  C-Kermit&#62; <u>echo "\fcommand(finger | wc -l)"</u> ; how many users logged in?
  "      83"
  C-Kermit&#62; <u>evaluate \fcommand(finger | wc -l) * 2</u>
  166
  C-Kermit&#62; <u>echo Welcome to \fcommand(tty) on \fcommand(date)</u>
  Welcome to /dev/ttyre on Fri Apr 18 13:31:42 1997
  C-Kermit&#62; <u>echo "\fcommand(ls oofa.*)"</u>
  "oofa.c
  oofa.h
  oofa.o"
  C-Kermit&#62; <u>cd /directory-with-thousands-of-files</u>
  C-Kermit&#62; <u>echo "\fcommand(ls -l)" ; This would be too long</u>
  ""
  C-Kermit&#62;
</pre><p>

If a command's output would be too long, you can use the other, more laborious
method of reading from a command: OPEN !READ <i>command</i>, READ each line,
CLOSE !READ.

<p>

The <tt>\frawcommand(<i>command</i>)</tt> function is identical to
<tt>\fcommand(<i>command</i>)</tt>, except it does not remove trailing newline
characters:
<p><pre>
  C-Kermit&#62; <u>echo "\frawcommand(date)"</u>
  "Fri Apr 18 13:31:42 1997
  "
  C-Kermit&#62; <u>echo "\frawcommand(ls oofa.*)"</u>
  "oofa.c
  oofa.h
  oofa.o
  "
  C-Kermit&#62;
</pre><p>

Use <tt>\frawcommand()</tt> if you want to retain the final line terminators,
or if the command's output is "binary".  But remember that if the result of
this (or any other) function contains any NUL (ASCII code 0) characters, the
first NUL will terminate the result string because this is how C strings work
(it's "C-Kermit", remember?).

<p>

These functions are useful not only locally, but also in the client/server
arena.  If you need to get the results from a system command on the server
end into a variable on the client end, just do:
<p><pre>
  <i>[</i> remote <i>]</i> query kermit command(date)
</pre><p>
The result is in the local <tt>\v(query)</tt> variable; see
<a href="ckb2.html"><cite>Using
C-Kermit</cite></a>, 2nd Ed., pp.359-360 for details.

<p>
<hr>
<h3><a name="x4.3">4.3. Automatic Per-File Text/Binary Mode Switching</a></h3>

When transferring files between like systems (e.g. UNIX-to-UNIX), binary mode
can be used for all files unless character-set translation is needed, and in
fact Kermit programs of recent vintage recognize each others' platforms and
switch to binary mode automatically when it is appropriate (e.g. DOS to OS/2,
or UNIX to UNIX).  (Exception: LABELED mode is chosen for VMS-to-VMS and
OS/2-to-OS/2 transfers so complex file formats can be preserved.)
<p>
On a client/server connection between like systems, the transfer mode is
currently determined by the file sender, rather than always by the client.
If the client is sending, it controls the transfer mode.  If a GET command is
sent to the server, the server sends all files in binary mode if its TRANSFER
CHARACTER-SET is TRANSPARENT; otherwise it uses text mode for text files
(according to its text-pattern list) and binary mode for binary files.  Of
course, the client can control the server's transfer character-set with the
REMOTE SET TRANSFER CHARACTER-SET command.
<p>
When transferring files between unlike systems, however, (e.g. UNIX-to-DOS),
some files (such as executable program images) must be transferred in binary
mode but others (such as plain-text files) must be transferred in text mode so
their record format and character sets can be appropriately converted.  If a
binary file is transferred in text mode, it is ruined.  If a text file is
transferred in binary mode, then at the very least, its format can be
incorrect; at worst it is also corrupted because its character set was not
converted (in extreme cases the corruption is total, e.g. because one system
is ASCII-based and the other EBCDIC).

<p>
<hr>
<h4><a name="x4.3.1">4.3.1. Exceptions</a></h4>

VMS C-Kermit, when sending files to a non-VMS system, switches to text or
binary mode automatically for each file, based on the record format in the
file's directory entry; thus the mechanisms described in this section do not
apply to VMS C-Kermit, yet the effect is the same: automatic text/binary mode
switching when VMS C-Kermit is sending files.  See the VMS Appendix of
<a href="ckb2.html"><cite>Using C-Kermit</cite></a> for details.

<p>
Kermit versions that support LABELED or IMAGE transfer mode are likewise
not affected by this feature when one of those modes is selected (normally
used only when transferring between like systems).
<p>
Kermit versions that support file-transfer pipes and filters are not affected
by this feature when pipes or filters are used, since the output of a pipe or
filter (such as gzip) is likely to require transfer in a different mode than
the original file.
<p>
Finally, SEND /TEXT or SEND /BINARY will force files to be sent in the
indicated mode, overriding all automatic transfer-mode-choosing mechanisms.

<p>
<hr>
<h4><a name="x4.3.2">4.3.2. Overview</a></h4>

Suppose you give C-Kermit a command like:
<p><pre>
  SEND *.*
</pre><p>
And suppose the pattern *.* matches a mixture of text files (such as program
source code) and binary files (such os object modules or executable programs).
<p>
C-Kermit 6.0 and earlier (except on VMS) send all files in the same mode:
whatever you said in your most recent SET FILE TYPE command, or else whatever
mode was chosen automatically according to the rules on page 236 of 
<cite>Using C-Kermit</cite>, 2nd Ed.
<p>
But when text and binary files are mixed in the same group, and the files are
being transferred to an unlike system (e.g. UNIX to IBM Mainframe), this
results in corruption of either all the text files or all the binary files.
<p>
Stream-oriented file systems such as in UNIX and DOS do not record any
information about the file to tell us whether the file should be transferred
in binary or text mode, making it impossible to select the transfer mode
for each file in a group automatically with any certainty.
<p>
However, we can use some fairly-well established file naming conventions for
this purpose.  C-Kermit 7.0 lets you provide lists of filename patterns that
are used to separately determine the file type for each individual file being
transfered.  A pattern is a string, possibly containing the special characters
"*" (asterisk, which matches any string of zero of more characters) and/or "?"
(question mark, which matches any single character).  For example "a*b"
matches all files whose names start with "a" and end with "b", such as "ab",
"arb", "ababababab", etc, but not "abba".  And "a?b" matches any file whose
name starts with "a", ends with "b", and is exactly 3 characters long.
<p><blockquote>
NOTE: When typing commands at the C-Kermit prompt, you must
prefix "?" with \ to override its normal function of giving help.
</blockquote><p>
(Also see 
<a href="#x4.9">Section 4.9</a> for additional pattern-matching notations that
might be available in your version of C-Kermit.)
<p>
When you have specified filename recognition patterns, C-Kermit can transfer
the ones whose names match any of the binary-mode patterns in binary mode, and
those with names that match any of the text-mode patterns in text mode, and
those whose names match neither in the prevailing mode you have chosen, or
that was chosen automatically via peer recognition.

<p>
<hr>
<h4><a name="x4.3.3">4.3.3. Commands</a></h4>

<dl>
<dt><b>SET FILE PATTERNS</b> <i>{</i> <b>ON, OFF, AUTO</b> <i>}</i>
<dd>This tells Kermit whether to do per-file filename pattern-matching to
determine text or binary mode.  The normal and default setting is AUTO,
which means to use pattern lists to switch transfer mode only when it is
certain that the other Kermit program supports automatic notification of
transfer mode (via Attribute packets) on a per-file basis (this information
is obtained automatically during protocol startup negotiation).  ON means to
always determine the transfer mode from the filename and pattern list when
sending files.  Use OFF to disable this feature (without resetting your
pattern lists).  Also note that if you have selected LABELED file transfer
(SET FILE TYPE LABELED), this takes precedence over filename-matching
patterns and all files are sent in labeled mode.
<p>
<dt><b>SET TRANSFER MODE MANUAL</b>
<dd>Disables the use of filename patterns, no matter what the FILE PATTERNS
  setting.
<p>
<dt><b>REMOTE SET TRANSFER MODE MANUAL</b>
<dd>Client command to disable automatic transfer mode, and therefore also
filename patterns, in the server.  Synonym: <b>REMOTE SET XFER MODE MANUAL</b>.
<p>
<dt><i>{</i> <b>GET, SEND</b>, <i>etc } {</i> <b>/BINARY, /TEXT</b> <i>}</i>
<dd>Including a /BINARY or /TEXT (or, where supported, /IMAGE or /LABELED)
switch with a file-transfer command changes the transfer mode to manual
for that command only, and therefore disables patterns that that command.
<p>
<dt><b>SET FILE BINARY-PATTERNS</b> <i>[ pattern [ pattern [ pattern ... ] ] ]</i>
<dd>A list of zero or more patterns, separated by spaces (not commas).  Letters
in a pattern are case-sensitive if the underlying filenames are case
sensitive (as in UNIX), and case-insensitive otherwise (as in Windows).  If
a file's name is matched by any pattern in the list and SET FILE PATTERNS is
ON, the file is sent in binary mode.  Examples:
<p><pre>
  SET FILE BINARY-PATTERNS *.gz *.Z *.tar *.zip *.o *.so *.a *.out ; UNIX
  SET FILE BINARY-PATTERNS *.EXE *.ZIP *.OBJ *.COM ; DOS or OS/2 or Windows
</pre><p>
If a pattern contains spaces, enclose it in braces.
<p>
<dt><b>SET FILE TEXT-PATTERNS</b> <i>[ pattern [ pattern [ pattern ... ] ] ]</i>
<dd>Like SET FILE BINARY-PATTERNS, but the patterns choose text files rather
than binary ones.  Examples:
<p><pre>
  SET FILE TEXT-PATTERNS *.TXT *.KSC *.HTM* *.BAT ; DOS, Windows, OS/2
</pre><p>
<dt><b>ADD BINARY-PATTERNS</b> <i>[ pattern [ pattern [ pattern ... ] ] ]</i>
<dd>Adds one or more patterns to the BINARY-PATTERN list.
<p>
<dt><b>ADD TEXT-PATTERNS</b> <i>[ pattern [ pattern [ pattern ... ] ] ]</i>
<dd>Adds one or more patterns to the TEXT-PATTERN list.
<p>
<dt><b>REMOVE BINARY-PATTERNS</b> <i>[ pattern [ pattern [ pattern ... ] ] ]</i>
<dd>Removes one or more patterns from the BINARY-PATTERN list.  The given
patterns are matched with the ones in the BINARY-PATTERNS list with
case sensitivity if the underlying file system has case-sensitive names
(as do UNIX and OS-9), otherwise with case independence.
<p>
<dt><b>REMOVE TEXT-PATTERNS</b> <i>[ pattern [ pattern [ pattern ... ] ] ]</i>
<dd>Removes one or more patterns from the TEXT-PATTERN list.
<p>
<dt><b>SHOW PATTERNS</b>
<dd>Displays the current pattern selections.
</dl><p>
Whenever you give a SET FILE BINARY-PATTERNS or SET FILE TEXT-PATTERNS
command, the previous list is replaced.  If you give one of these commands
without a pattern list, the previous list is removed.
<p>
When patterns are active and files are being sent, text patterns (if any) are
applied first (but only if not RESENDing and not sending in LABELED mode),
then binary patterns, so if the same pattern appears in both lists, binary
mode is chosen.

<p>
<hr>
<h4><a name="x4.3.4">4.3.4. Examples</a></h4>

Here's an example that might be used when sending files from UNIX:
<p><pre>
  set file type binary
  set file text-patterns *.c *.h *.w *.txt makefile
  set file binary-patterns *.o
  msend makefile wermit wart ck*.[cwho] ck*.txt
</pre><p>
Note that "wermit" and "wart" do not match any patterns so they are sent in
the prevailing mode, which is binary.  Also note the use of "makefile" as a
pattern that does not contain any wildcard characters (there is no other
convention to distinguish among "wermit" and "wart", which are binary
executables, and "makefile", which is a text file, purely by their names).
<p>
Most C-Kermit implementations have a default pattern list built in, which
includes patterns that are almost certain to succeed in picking the right
transfer mode.  Others are omitted due to ambiguity.  For example
"<tt>.hlp</tt>", and "<tt>.ini</tt>" are generally binary types in Windows but
text types everywhere else.
<blockquote>
NOTE: "<tt>.doc</tt>", used for decades to denote plain-text documentation
files, now more often than not denotes a Microsoft Word Document, so
"<tt>.doc</tt>" is now considered a binary type since it does less harm to
transfer a plain-text document in binary mode than it does to transfer
an MS Word file in text mode (except when IBM mainframes are involved!)
<p>
ANOTHER NOTE: "<tt>.com</tt>" files are binary in DOS-like operating systems,
but they are text (DCL command procedures) in VMS.  VMS C-Kermit sends
<tt>.COM</tt> files in text mode; K95 sends them in binary mode.  If you
download a <tt>.COM</tt> file from VMS to DOS or Windows, and then upload it
to another VMS system, be sure to use SEND /TEXT to preserve its textness.
</blockquote>
<p>
You can see the default pattern list by starting C-Kermit without its
initialization file (e.g. "<tt>kermit -Y</tt>") and using the SHOW PATTERNS
command.  If you will be depending on this feature, be sure to examine the list
carefully in conjunction with the applications that you use.
<p>
The default pattern list does not take "backup files" into account because
(a) people usually don't want to transfer them; and (b) it would make the
pattern lists more than twice as long.  For example, we would need to include
both <tt>*.txt</tt> and <tt>*.txt.~[0-9]*~</tt> for "<tt>.txt</tt>" files, and
similarly for all the others.  Instead, you can use SEND /NOBACKUP (or SET
SEND BACKUP OFF) to skip over all backup files.
<p>
Put your most commonly-used safe pattern declarations in your C-Kermit
customization file (ckermod.ini, .mykermrc, k95custom.ini, etc).
<p>
As noted, SET FILE PATTERNS is ON by default.  Sometimes, however, it is
desirable, or necessary, to force files to be sent in a particular mode, and
often this must be done from the command line (e.g. when using Kermit as a
download helper in a Web browser like Lynx).  The -V command-line options is
equivalent to SET FILE PATTERNS OFF and SET TRANSFER MODE MANUAL.  Example:
<p><pre>
  kermit -Vis oofa.txt
</pre><p>
forces oofa.txt to be sent in binary mode, even though ".txt" might match a
text pattern.

<p>
<hr>
<h3><a name="x4.4">4.4. File Permissions</a></h3>

"Permissions" refers to a code associated with a file that specifies who is
allowed to access it, and in what manner.  For example, the owner, the members
of one or more groups, the system administrator, and everybody else, might be
allowed various combinations of Read, Write, Append, Execute, or Listing
access.
<p>
The permission code goes by different names on different platforms.  In UNIX,
it might be called the filemode.  In VMS, it is called the file protection
(or protection mask).
<p>
The comments in this section presently apply only to the UNIX and VMS versions
of C-Kermit, to which these features were added in version 7.0; the DOS,
Windows, and OS/2 file systems embody no notions of protection, and so MS-DOS
Kermit and Kermit 95 do not send file permissions, and ignore them when
received.
<p>
The permissions for a received file are determined by a combination of the
file transfer mode (VMS-to-VMS transfers only), whether a file of the same
name exists already, whether permissions of the file are received in the file
attribute packet, and the setting of ATTRIBUTES PROTECTION.
<p>
The default for ATTRIBUTES PROTECTION is ON.  If no attributes are received,
the effect is the same as if attributes PROTECTION were OFF.
<p>
For VMS-to-VMS transfers, the default LABELED mode simply copies the
protection code from source to destination.

<p>
<hr>
<h4><a name="x4.4.1">4.4.1. When ATTRIBUTES PROTECTION is OFF</a></h4>

If no file of the same name exists, system defaults determine the permissions
of the new file.  Otherwise, the actions taken depend on the current FILE
COLLISION setting: BACKUP, OVERWRITE, RENAME, etc, as documented in
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>.  But now the new file (if it is created at all) automatically
inherits the permissions (mode bits) of the existing file in a way that is
appropriate for the platform.

<h4><a name="x4.4.1.1">4.4.1.1. Unix</a></h4>

All mode bits are inherited except the directory bit, since the
incoming file can not possibly be a directory.  (In any case, it is not
possible to receive a file that has the same name as an existing directory
unless FILE COLLISION is set to RENAME).

<h4><a name="x4.4.1.2">4.4.1.2. VMS</a></h4>

Files with the same name as an existing file, transferred in modes other than
LABELED between VMS systems, inherit the protection of the prior version.

<p>
<hr>
<h4><a name="x4.4.">4.4.2 When ATTRIBUTES PROTECTION is ON</a></h4>

File permissions can be conveyed as part of the file transfer process, in
accordance with the Kermit protocol definition.  If the file sender puts
system-dependent and/or system-independent versions of the file protection
(permissions) into the Attribute (A) packet, the file receiver can set the new
file's permissions from them.  Otherwise, the permissions are set the same as
for ATTRIBUTES PROTECTION OFF.
<p>
When the incoming A packet contains system-dependent permissions, the file
receiver checks to see if the sender has the same system ID (e.g. both the
sending and receiving systems are UNIX, or both are VMS); if so, it decodes
and uses the system-dependent permissions; otherwise it uses the generic ones
(if any) and applies them to the owner field, setting the other fields
appropriately as described in the following sections.
<p>
Setting the incoming file's protection from the A packet is controlled by SET
ATTRIBUTES PROTECTION (or PERMISSION), which is ON by default, and its status
is displayed by SHOW ATTRIBUTES.
<p>
The main benefit of this feature is to not have to "chmod +x" an executable
file after transfer from UNIX to UNIX.  Its cross-platform benefits are less
evident, perhaps to retain the status of the Unix 'x' bit on a VMS system,
for subsequent transfer back to a Unix system.

<p>
<hr>
<h4><a name="x4.4.2.1">4.4.2.1. System-Specific Permissions</a></h4>

System-specific file permissions are used when the two Kermit programs
recognize each other as running on the same type of system.  For example,
both are running under some form of UNIX (it doesn't matter which UNIX
variation -- HP-UX, Solaris, AIX, etc -- all use the same scheme for file
permissions); or both are running under VMS (even if one is on an Alpha and
the other on a VAX, and/or one is old and the other is new).

<h4><a name="x4.4.2.1.1">4.4.2.1.1. UNIX</a></h4>

UNIX supports three categories of users, File Owner, Group, and World,
and three types of file access permission: Read, Write, and Execute.  Thus,
a UNIX file's permissions are expressed in 9 bits.
<p>
The system-dependent permission string for UNIX is a 3-digit octal string, the
low-order 9 bits of the st_mode member of the stat struct; we deliberately
chop off the "file format" bits because they are not permissions, nor do we
convey the setuid/setgid bits, lock bit, sticky bit, etc.

<h4><a name="x4.4.2.1.2">4.4.2.1.2. VMS</a></h4>

VMS supports four categories of users, System, File Owner, Group, and World,
and four types of file access permission: Read, Write, Execute, and Delete.
Thus, a VMS file's permissions are expressed in 16 bits.
<p>
The system-dependent protection string for VMS is a 4-digit hexadecimal
string, corresponding to the internal-format protection word of the file
(RWED for each of World,Group,Owner,System).  A new file normally gets all 16
protection bits from the original file of the same name.
<p>
Note: VMS-to-VMS transfers take place in LABELED mode when the two C-Kermits
recognize each other's platform as VMS (unless you have disabled LABELED-mode
transfers).  In this case, all of a file's attributes are preserved in the
transfer and the protection mask (and other information) is taken from the
file's internal information, and this takes precedence over any information
in the Attribute packets.  You can defeat the automatic switching into
LABELED mode (if you want to) with SET TRANSFER MODE MANUAL.

<p>
<hr>
<h4><a name="x4.4.2.2">4.4.2.2. System-Independent Permissions</a></h4>

The system-independent ("generic") protection is used when the system IDs of
the two Kermit programs do not agree (e.g. one is UNIX, the other is VMS).
The generic protection attribute includes the following permissions (not all
are applicable to every file system): Read, Write, Append, Execute, Delete,
Search.  The generic permissions are derived from the owner permissions of
the source file, thus, a Unix 'w' permission becomes VMS Write,Delete.
<p>
The Owner field of the new file's permissions is set from the incoming
generic protection attribute.
<p>
In UNIX, the Group and World permissions are set according to your umask,
except that execute permission is NOT set in these fields if it was not also
set in the generic protection (and consequently, is set in the Owner field).
<p>
In VMS, the System, Group, and World permissions are set according to the
process default file permission (as shown in VMS by SHOW PROTECTION), except
that no permissions are allowed in these fields that are not included in the
generic permissions.
<p>
Note that the VMS and UNIX interpretations of Execute permission are not
identical.  In UNIX, a file (binary executable, shell script, etc) may not
be executed unless it has Execute permission, and normally files that are
not intended for execution do not have Execute permission.  In VMS, Read
permission implicitly supplies Execute capability.  Generally files that have
Read permission also have explicit Execute permission, but files (binary
executables, DCL command procedures) that have Read permission and not
Execute permission can still be executed.

<p>
<hr>
<h3><a name="x4.5">4.5. File Management Commands</a></h3>
<h4><a name="x4.5.1">4.5.1. The DIRECTORY Command</a></h4>
<p>
Prior to C-Kermit 7.0, the DIRECTORY command always ran an external system
command (such as "ls" on UNIX) or program to product the directory listing.
This had certain advantages, mostly that you could include system-dependent
options for customized listings, e.g. on UNIX:
<p><pre>
  dir -lt c* | more
</pre><p>
or in VMS:
<p><pre>
  directory /size/date/protection/except=*.obj oofa.*;0
</pre><p>
This approach, however, carries some disadvantages: C-Kermit can't return
SUCCESS or FAILURE status for (e.g.) "dir foo" according to whether the file
"foo" exists; and it runs an inferior process, which might be a problem in
some environments for resource and/or security reasons, and won't work at all
in a "nopush" environment (e.g. one in which C-Kermit is configured to forbid
access to exterior commands and programs, e.g. in a VMS "captive account").
<p>
In C-Kermit 7.0 on VMS and UNIX, and in K95 1.1.19 and later, the DIRECTORY
command is internal to Kermit.  It can be run in a "nopush" environment and
returns SUCCESS or FAILURE status appropriately.  In UNIX it prints all dates
and times in a consistent way (unlike ls).  In VMS it prints precise file
sizes, rather than "blocks".  It offers several formatting and other options,
but it is not necessarily more flexible than the corresponding external
commands or programs (the UNIX "ls" program, the VMS "directory" command).
The syntax is:
<p>
  <b>DIRECTORY</b> <i>[ switch [ switch [ ... ] ] ] [ filespec ]</i>
<p>
If no filespec is given, all files in the current directory are listed.
<p>
Optional switches include all the standard file-selection switches presented
in <a href="#x1.5.4">Section 1.5.4</a>, plus:
<p><dl>
<dt><b>/ALL</b>
<dd>Show both regular files and directories; this is the default.
<p>
<dt><b>/ARRAY:</b><i>x</i>
<dd>Instead of displaying a directory listing, put the files that would have
been shown (based on the filespec and other selection switches) in the given
array.  The array need not (and should not) be predeclared; if the array
already exists, it is destroyed and reused.  The array name can be a single
letter, like "a", or any fuller form, such as "<tt>&#38;a</tt>",
"<tt>\&#38;a</tt>", "<tt>\&#38;a[]</tt>", etc.  If the /ARRAY switch is
included, the following other 
switches are ignored: /BRIEF, /VERBOSE, /HEADING, /PAGE, /ENGLISHDATE,
/ISODATE, /XFERMODE, /MESSAGE, /SORT, /REVERSE, /ASCENDING.  In other words,
only file selection switches are meaningful with /ARRAY: /FILES, /DIRECTORIES,
/ALL, /DOTFILES, /NOBACKUP, /RECURSIVE, /SMALLER, /LARGER, /AFTER, /BEFORE,
/EXCEPT, etc.  The resulting array has the number of files (n) as its 0th
element, and the filenames in elements 1 through <i>n</i>  Example:
<p><pre>
  dir /array:&#38;a /files /nobackup /after:19990101 /larger:10000 [ab]*
  show array &#38;a
</pre><p>
<dt><b>/FILES</b>
<dd>Only show regular files.
<p>
<dt><b>/DIRECTORIES</b>
<dd>Only show directories.
<p>
<dt><b>/BACKUP</b>
<dd>In UNIX, OS-9, K-95, and other versions that support SET FILE COLLISION
BACKUP and create backup files by appending <tt>.~<i>n</i>~</tt> to the
filename (where <i>"n"</i> is a number), /BACKUP means to include these files
in directory listings.  This is the default.
<p>
<dt><b>/NOBACKUP</b>
<dd>This is the opposite of /BACKUP: that is, do not include backup files in
the listing.
<p>
<dt><b>/BRIEF</b>
<dd>List filenames only; use a compact format, as many filenames as will fit
across the screen (based on the longest name).  A brief listing is always
sorted alphabetically.
<p>
<dt><b>/VERBOSE</b>
<dd>List one file per line, and include date, size, and (in UNIX only)
permissions of each file.  This is the opposite of /BRIEF, and is the
default.
<p>
<dt><b>/PAGE</b>
<dd>Pause at the end of each screenful and give a "more?" prompt, even if
SET COMMAND MORE-PROMPTING is OFF.
<p>
<dt><b>/NOPAGE</b>
<dd>Don't pause at the end of each screenful and give a "more?" prompt, even if
SET COMMAND MORE-PROMPTING is ON.  If neither /PAGE or /NOPAGE is given,
paging is according to the prevailing COMMAND MORE-PROMPTING setting (which
can be displayed with SHOW COMMAND).
<p>
<dt><b>/ENGLISHDATE</b>
<dd>Show dates in dd-mmm-yyyy format; mmm is the first three letters of the
English month name.
<p>
<dt><b>/ISODATE</b>
<dd>Show dates in yyyy-mm-dd format; mm is the month number, 1-12.
This is the opposite of /ENGLISHDATE, and is the default.
<p>
<dt><b>/HEADINGS</b>
<dd>Print a heading before the listing and a summary at the end.
<p>
<dt><b>/NOHEADINGS</b>
<dd>Don't print a heading before the listing or a summary at the end.
This is the opposite of /HEADINGS, and is the default.
<p>
<dt><b>/XFERMODE</b>
<dd>Only in Kermit programs that support SET FILE PATTERNS.  If this switch is
included, and the filename matches any FILE BINARY-PATTERN (<a
href="#x4.3">Section 4.3</a>),
"(B)" is printed after the filename; otherwise, if it matches a FILE
TEXT-PATTERN, "(T)" is printed.
<p>
<dt><b>/NOXFERMODE</b>
<dd>Don't display transfer-mode indicators.  This is the opposite of /XFERMODE
and is the default.
<p>
<dt><b>/RECURSIVE</b>
<dd>Show files not only in the given directory, but also in its subdirectories
(if any), their subdirectories, etc.
<p>
<dt><b>/NORECURSIVE</b>
<dd>Don't show files in subdirectories.  This is the opposite of /RECURSIVE,
and is the default.
<p>
<dt><b>/MESSAGE:</b><i>text</i>
<dd>This lets you specify a short text string to be appended to the end of
each directory listing line (a space is supplied automatically).  If the
text contains any spaces, enclose it in braces, e.g. /MESSAGE:{two words}.
<p>
<dt><b>/NOMESSAGE</b>
<dd>Don't append any message to the end of each directory listing line
(default).
<p>
<dt><b>/SORT:</b><i>[{</i><b>NAME,SIZE,DATE</b><i>}]</i>
<dd>Sort the listing by name, size, or date.  If the /SORT switch is given
but the "sort-by" keyword is omitted, the listing is sorted by name.
/SORT:NAME /ASCENDING (alphabetic sort by name) is the default.
<p>
<dt><b>/NOSORT</b>
<dd>Don't sort the listing.  Files are listed in whatever order they are
supplied by the operating system, e.g. inode order in UNIX.
<p>
<dt><b>/REVERSE</b>
<dd>If the /SORT switch is given, reverse the order of the sort.
Synonym: <b>/DESCENDING</b>.
<p>
<dt><b>/ASCENDING</b>
<dd>If the /SORT switch is given, sort the listing in normal order.
This is the opposite of /REVERSE and is the default.
</dl><p>
Note that most of the DIRECTORY-specific switches come in pairs, in which
one member of a pair (e.g.  /NOHEADINGS) is the opposite of the other
(e.g. /HEADINGS).
<p>
If you always want to use certain options, you can set them with the SET
OPTIONS DIRECTORY command (<a href="#x1.5.5">Section 1.5.5</a>).  Use SHOW
OPTIONS to list the
options currently in effect.  To make the desired options apply every time you
run C-Kermit, put a SET OPTIONS DIRECTORY command in your C-Kermit
customization file, specifying the desired options.  Options set in this
manner apply to every subsequent DIRECTORY command.  Of course, if you include
switches in a DIRECTORY command, these override any defaults, built-in or
custom.  Example:
<p><pre>
  DIRECTORY            ; Use "factory defaults"
  SET OPTIONS DIRECTORY /SORT:SIZE /REVERSE /HEADINGS  ; Customize defaults
  DIRECTORY            ; Use customized defaults
  DIR /SORT:NAME       ; Override customized default SORT key
  SET OPT DIR /RECURS  ; Add /RECURSIVE to customized defaults
  DIR /ASCEND          ; Override customized default SORT order
</pre><p>
Notes:
<p><ul>
<li>Only a single sort key is supported; there is presently no way to
have multiple sort keys.
<p>
<li>If the /BRIEF switch is given, all other switches (except /[NO]RECURSIVE,
/[NO]DOTFILES, /DIRECTORIES, /FILES, and /ALL) are ignored.
<p>
<li>/SORT:<i>anything</i> gives incorrect results if any files have lengths
greater than 10 digits (i.e. that are more than 9999999999 bytes long, i.e.
if they are 10GB or more in size) because the overlong length field causes
the date and name fields to be misaligned.
<p>
<li>/SORT:NAME is redundant in VMS since VMS returns filenames in alphabetic
order anyway.
<p>
<li>/SORT:NAME ignores alphabetic case on platforms where case does not matter
in filenames, but this works only for unaccented Roman letters A-Z.
<p>
<li>/SORT:NAME is currently based on code values, and so works fine for ASCII,
but will probably produce unexpected results for files with non-ASCII or
8-bit characters in their names.  (Locale-based sorting raises rather
significant issues of portability, size, performance, etc.)
<p>
<li>/SORT:DATE works right only for ISO-format dates, not English ones.
<p>
<li>/SORT:SIZE sorts the size field lexically.  On some platforms
(e.g. Windows), the size of a directory file is listed as
"<tt>&#60;DIR&#62;</tt>" rather than as a number; in this case, the
"<tt>&#60;DIR&#62;</tt>" files are gathered at the end (or beginning,
depending on the sort order) of the listing.
<p>
<li>/RECURSIVE is accepted but ignored in AOS/VS.  Use the normal
system-specific filespec notation, e.g. "dir #.txt".
<p>
<li>/RECURSIVE has no affect when a full, absolute pathname is given; e.g.
"dir /recursive /tmp/foo" (where "foo" is a regular file) only shows the
"/tmp/foo" file.  If you want to see all "foo" files in the /tmp tree,
do "cd /tmp" and then "dir /recursive foo".
<p>
<li>If a file size of -1 is shown, or date-time of 0000-00-00 00:00:00, this
means the file was located, but access to information about the file was
denied to C-Kermit.
<p>
<li>In VMS, if <tt>FOO.DIR;1</tt> is a directory within your current directory,
"<tt>directory foo</tt>" and "<tt>directory [.foo]</tt>" list the files in the
<tt>[.FOO]</tt> subdirectory, but "<tt>directory foo.dir</tt>" lists the
directory file itself; similarly for "<tt>*.dir</tt>" versus "<tt>[.*]</tt>",
etc.
<p>
<li>In UNIX, if "foo" is a directory within your current directory,
"<tt>directory foo</tt>" lists the files in the foo directory.  If you want to
list the foo directory file itself, put an asterisk at the end:
"<tt>dir foo*</tt>".
</ul><p>
Hint: How to find the biggest files in a directory tree:
<p><pre>
  cd xxx ; (root of tree)
  directory /sort:size /recursive /reverse /dotfiles /page
</pre><p>
Another hint: If you often use several different directory-listing formats,
define macro shortcuts for them:
<p><pre>
  DEFINE WD DIRECTORY /SORT:DATE /REVERSE \%*  ; Reverse chronological order
  DEFINE SD DIRECTORY /SORT:SIZE /REVERSE \%*  ; Reverse order of size
  DEFINE ND DIRECTORY /SORT:NAME /ASCEND \%*   ; Alphabetical by name
  DEFINE DL DIR /DIR /SORT:NAME /ASCEND \%*    ; Alphabetical directory list
</pre><p>
Put these definitions in your C-Kermit customization file.  Note that "\%*"
(<a href="#x7.5">Section 7.5</a>) in these definitions lets you include other
switches in your macro invocations, e.g.:
<p><pre>
  wd /headings *.txt
</pre><p>
Of course you can still access your external directory listing program by
using RUN or "!", e.g. in VMS:
<p><pre>
  run directory /size/date/protection/except=*.obj oofa.*;0
</pre><p>
or:
<p><pre>
  !dir /size/date/prot/exc=*.obj oofa.*;0
</pre><p>
In UNIX, use "<tt>!ls</tt>" or just "<tt>ls</tt>" (which is a special synonym
for "<tt>!ls</tt>").

<p>
<hr>
<h4><a name="x4.5.2">4.5.2. The CD and BACK Commands</a></h4>

In C-Kermit 7.0, the CD command has a new friend, the BACK command.  BACK
means "CD to my previous current directory".  A second BACK brings you back
to where you were before the first one; thus successive BACK commands switch
back and forth between two directories.

<h4><a name="x4.5.2.1">4.5.2.1. Parsing Improvements</a></h4>

The CD command, as well as other commands that parse a directory name, were
changed in 7.0 to provide all the expected functions: completion on Tab
or Esc, directory-name lists on ?, etc.  Other affected commands include
SET SERVER GET-PATH, SET TEMP-DIRECTORY, SET FILE DOWNLOAD-DIRECTORY, and
SPACE.  CD and REMOTE CD also now work with logical names.
<p>
In VMS, the situation is a bit complicated since a directory name can look
like "<tt>DEV:</tt>", "<tt>[FOO.BAR]</tt>", "<tt>DEV:[FOO.BAR]</tt>",
"<tt>[FOO]BAR.DIR;1</tt>", etc.  Completion and ?-help might not always work,
but they do in many cases.  Examples:
<p><pre>
  cd ?           Lists all subdirectories of the current directory
  cd []?         Ditto
  cd k?          Ditto, but only those starting with K
  cd [foo]?      Lists all subdirectories of the [FOO] directory
  cd [-]?        Lists all subdirectories of the superior directory
  cd [--]?       Lists all subdirectories of the directory 2 levels up
  cd [...]?      Lists all directories below the current one
  cd [foo.?      Does not work.
</pre><p>
C-Kermit allows all of the following in VMS:
<p><pre>
  cd bar         CD to subdirectory BAR of the current directory
  cd .bar        Ditto
  cd [.bar]      Ditto
  cd bar.dir     etc...
  cd bar.dir;
  cd bar.dir;1
  cd [foo.bar]
  cd bar.baz     This can go more than 1 level deep...
  cd dir:        (where logical name DIR is defined as [FOO.BAR])
</pre><p>
As well as the following:
<p><pre>
  cd ..          Go up one level as in UNIX
  cd .           The current directory
  cd             My login directory
</pre><p>
Note that "<tt>cd -</tt>" (go up one level) does not work as expected, because
"<tt>-</tt>" is Kermit's command continuation character.  However, "<tt>cd
[-]</tt>", and "</tt>cd {-}</tt>" have the desired effect (and so does "<tt>cd
..</tt>", which is easier to type).

<p>
<hr>
<h4><a name="x4.5.2.2">4.5.2.2. The CDPATH</a></h4>

The CD command in the UNIX, Windows, OS/2, and VMS versions of C-Kermit, as of
version 6.1 / 1.1.12, searches the CDPATH for the given directory, if it is not
absolute and if a CDPATH environment variable is defined.  Example (in UNIX
ksh or bash):
<p><pre>
  $ <u>export CDPATH=$HOME:$HOME/kermit:/tmp</u>
</pre><p>
Now if you give a "cd xxx" command, no matter what your current directory is,
if the "xxx" directory is not a subdirectory of your current directory, then
the xxx subdirectory of your home directory is used or if that does not exist,
then the xxx subdirectory of the kermit subdirectory of your home directory is
used or if that does not exist, then /tmp/xxx is used.  This is how the ksh
"cd" command works, and now the C-Kermit CD command works the same way.
<p>
In VMS, you can define CDPATH to be a list of directories that contain actual
directory delimiters, and/or logical names representing directories, using
commas to separate them, e.g.:
<p><pre>
  $ <u>define cdpath [HOME],[SOMEOTHERDIR],[HOME.MISC]</u>
  $ <u>define cdpath SYS$LOGIN:,DISK1:[HOME],DISK2:[SCRATCH.IVAN]</u>
</pre><p>
Example:
<p><pre>
  $ <u>define cdpath SYS$LOGIN:,[IVAN],[OLAF],[OLGA.MISC]</u>
  $ <u>kermit</u>
  DISK1:[OLGA] C-Kermit&#62; <u>cd blah</u>
</pre><p>
tries the BLAH subdirectory of the user's login directory, then [OLGA.BLAH],
[IVAN.BLAH], [OLAF.BLAH], and [OLGA.MISC.BLAH], in that order, using the first
one it finds, failing if it finds none.
<p>
In C-Kermit 7.0, you may also set the CDPATH from the Kermit prompt:
<p><dl>
<dt><b>SET CD PATH</b> <i>path</i>
<dd>Allows the CD PATH to be set from within C-Kermit.
</dl><p>
<b>SHOW CD</b> shows the CD path and all other information relevant to the CD
command.

<p>
<hr>
<h4><a name="x4.5.2.3">4.5.2.3. CD Messages</a></h4>

Whenever you change directory, you can have C-Kermit display a "Read Me" file
from the new directory automatically.  The commands are:
<p><dl>
<dt><b>SET CD MESSAGE</b> <i>{</i> <b>ON, OFF, FILE</b> <i>list }</i>
<dd>ON enables this feature; OFF (the default) disables it.  File lets you
specify the name of the "Read Me" file.  A list of names to look for can be
given in the following format:
<p><pre>
  {{name1}{name2}{name3}{...}}
</pre><p>
e.g.:
<p><pre>
  SET SERVER CD-MESSAGE FILE {{./.readme}{README.TXT}{READ.ME}}
</pre><p>
The default list of CD-message files is system dependent.
</dl><p>
<b>SHOW CD</b> shows your current directory, previous directory, CD path, and
CD message info.

<p>
<hr>
<h4><a name="x4.5.3">4.5.3. Creating and Removing Directories</a></h4>

The <b>MKDIR</b> command now allows you to create multiple directories at once:
<p><pre>
  C-Kermit&#62; <u>mkdir a/b/c/d</u>
</pre><p>
creates the directory a in the current directory (if it doesn't exist
already), and then creates subdirectory b in the a directory (if it didn't
exist already), and so on.
<p>
If you use MKDIR to try to create a directory that already exists, C-Kermit
will print a warning ("?Directory already exists"), but the MKDIR command
will still succeed.  If you want to avoid the warning message, use
IF DIRECTORY first to check if the directory already exists.
<p>
The RMDIR command, however, will not remove more than one directory, nor
will it remove a directory that contains any files.  (There is, as yet, no
RMDIR /RECURSIVE command, although one might be added later.)
<p>
In VMS, these commands (like CD) are more forgiving of your syntax than is the
DCL command shell; "mkdir oofa" is equivalent to "mkdir [.oofa]" and so on.
Also in VMS, you'll find that C-Kermit's RMDIR command is easier than deleting
a directory in DCL, since it automatically first gives it owner delete
permission if you are the owner.

<p>
<hr>
<h4><a name="x4.5.4">4.5.4. The DELETE and PURGE Commands</a></h4>

The DELETE command now offers a selection of switches, and has a new
companion, the PURGE command.  First, DELETE:
<p><dl>
<dt><b>DELETE</b><i> [ switches... ] filespec</i>
<dd>Deletes the file or files that match the filespec, which may contain
wildcards (<a href="#x4.9">Section 4.9</a>).
</dl>
<p>
Optional switches include the standard file-selection switches presented in
<a href="#x1.5.4">Section 1.5.4</a>, plus:
<p><dl>
<dt><b>/ASK</b>
<dd>Before deleting each file, ask permission interactively.  Answers are
Yes or OK (delete the file), No (don't delete it), or Quit (stop executing
the DELETE command).
<p>
<dt><b>/NOASK</b>
<dd>Don't ask permission to delete each file.
<p>
<dt><b>/LIST</b>
<dd>List each file and show whether it was deleted.  Synonyms: /LOG, /VERBOSE.
<p>
<dt><b>/NOLIST</b>
<dd>Don't list files while deleting them.  Synonyms: /NOLOG, /QUIET.
<p>
<dt><b>/HEADING</b>
<dd>Print a heading and summary line.
<p>
<dt><b>/NOHEADING</b>
<dd>Don't print a heading and summary line.
<p>
<dt><b>/PAGE</b>
<dd>When listing, pause at the end of each screenful and give the "More?"
prompt.  If you reply "n" (no), the DELETE command terminates.
<p>
<dt><b>/SIMULATE</b>
<dd>Do everything implied by the given switches and filespec, except do not
actually delete any files.  This lets you preview which files would be
deleted; implies /LIST.
</dl><p>
Now the PURGE command:
<p><dl>
<dt><b>PURGE</b> <i>[ switches... ] [ filespec ]</i>
<dd>(VMS only) Runs the DCL PURGE command.  Switches and filespec, if any,
are passed directly to DCL without parsing or verification.  Deletes
excess versions of the given (or all) files.  The rest of this section
does not apply to VMS.
<p>
<dt><b>PURGE </b> <i>[ switches... ] [ filespec ]</i>
<dd>(UNIX only) Deletes "backup files" that match the filespec, which may
contain wildcards (<a href="#x4.9">Section 4.9</a>).  If no filespec is given,
all backup
files in the current directory are selected (subject to modification by
any switches).  Do not include backup notation in the filespec.
</dl><p>
Explanation:
<p>
To avoid destroying preexisting files when a new file arrives that has the
same name, C-Kermit backs up the old file by appending a "backup number" to
its name.  In UNIX, the backup suffix consists of a period, a tilde, a number,
and another tilde.  For example, if a file called <tt>oofa.txt</tt> exists and
a new <tt>oofa.txt</tt> file arrives, the original is renamed to
<tt>oofa.txt.~1~</tt>.  If another 
<tt>oofa.txt</tt> file arrives, the existing one is renamed to
<tt>oofa.txt.~2~</tt>.  And so
on.  This system is compatible with the one used by EMACS.  Thus over time, if
you receive a lot of files with C-Kermit or edit them with EMACS, backup files
can build up.  The new PURGE command lets you clean out accumulated backup
files:
<p>
Optional switches include the standard file-selection switches presented in
<a href="#x1.5.4">Section 1.5.4</a>, plus all the switches listed above for
the DELETE command, plus:
<p><dl>
<dt><b>/KEEP:</b><i>n</i>
<dd>Retains the <i>n</i> most recent (highest-numbered) backup files for
each file.  For example, if <tt>oofa.txt, oofa.txt.~1~, oofa.txt.~2~,
oofa.txt.~10~, oofa.txt.~12~</tt>, and <tt>oofa.txt.~100~</tt> exist,
"<tt>purge /keep:2 oofa.txt</tt>" deletes <tt>oofa.txt.~1~, oofa.txt.~2~</tt>,
and <tt>oofa.txt.~10~</tt>, and keeps <tt>oofa.txt, oofa.txt.~12~</tt>, and
<tt>oofa.txt.~100~</tt>.  If /KEEP is given without a number, one (the highest
numbered) backup file is kept.
</dl>
<p>

CAUTION: The PURGE command should be used only when <tt>*.~*~</tt> files truly
are backup files.  This is the case for EMACS, and it is the DEFAULT for
C-Kermit.  However, if C-Kermit's FILE COLLISION has been set to RENAME, newly
received files will look like backup files.  In that case, don't use the PURGE
command or you'll be removing new files rather than old ones.  (Use SHOW FILE
to find the FILE COLLISION setting.)
<p>
The PURGE command is presently available only in UNIX.  The command succeeds
if it deleted any files, or if it deleted no files but there were no errors.
It fails if it deleted no files and there were errors (i.e. deletion was
attempted but failed).  In VMS, backup file versions are handled automatically
by the OS, and a PURGE command can be used at the VMS prompt to clean them up.
<p>
If you want certain switches to be supplied automatically with each DELETE or
PURGE command, you can set them with SET OPTIONS (<a href="#x1.5.5">Section
1.5.5</a>) and you can
display any such settings with SHOW OPTIONS.  Of course you can override them
on a per-command basis by including switches in your PURGE or DELETE command.
<p>
Also see SET FILE COLLISION, SHOW FILE, SEND /NOBACKUP, SET SEND BACKUP, and
DIRECTORY /[NO]BACKUP.

<p>
<hr>
<h3><a name="x4.6">4.6. Starting the Remote Kermit Server Automatically</a></h3>

As noted on pages 275-276 of <a
href="ckb2.html"><cite>Using

C-Kermit</cite></a> 2nd edition, you can have Kermit send "kermit receive"
commands automatically when it is in local mode and you give a SEND or similar
command, to start the remote Kermit receiver in case it is not already
started.  The "kermit receive" commands are specified by:
<p><pre>
  SET PROTOCOL KERMIT <i>binary-receive-command</i> <i>text-receive-command</i>
</pre><p>
As of version 7.0, a Kermit protocol option has been added to send a string
to the host in advance of any Kermit packets when you give a GET-class or
REMOTE command.  This will switch the remote C-Kermit into the appropriate
mode or, if the remote system is at a system command (shell) prompt,
execute the string on the remote system.  The new syntax of the SET PROTOCOL
KERMIT command is:
<p><pre>
  SET PROTOCOL KERMIT [ <i>s1</i> [ <i>s2</i> [ <i>s3</i> ] ] ]
</pre><p>
where:
<p><pre>
       <u>Default</u>         <u>Meaning</u>
  s1  {kermit -ir}     Remote "kermit receive in binary mode" command.
  s2  {kermit -r}      Remote "kermit receive in text mode" command.
  s3  {kermit -x}      Remote "start kermit server" command.
</pre><p>
NOTE: If the remote Kermit is 6.0, the following are recommended for fast
startup and high-performance file transfer (see Appendix I in
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>, second Edition, for command-line options):
<p><pre>
  s1   kermit -YQir   (Kermit receive binary, skip init file, fast.)
  s2   kermit -YQTr   (Kermit receive text, skip init file, fast.)
  s3   kermit -YQx    (Kermit server, skip init file, fast.)
</pre><p>
If the remote is C-Kermit 7.0 or later, change the -x option (enter server
mode) to -O (uppercase letter O), which means "enter server mode for One
transaction only); this way, it is not stuck in server after the transfer.
Also note that the Q is redundant in version 7.0, since fast Kermit protocol
settings are now the default.
<p>
Note that in case the C-Kermit executable is called "wermit" or "ckermit"
you can change "kermit" in the strings above to "wermit" or "ckermit" and
C-Kermit 7.0 or later will recognize these as synonyms for "kermit", in case
it is at its command prompt when one of these strings is sent to it.

<p>
<hr>
<h3><a name="x4.7">4.7. File-Transfer Command Switches</a></h3>

Over the years, various new methods of transferring a file have accumulated,
until we had, in addition to the SEND command, also MOVE (send and then
delete), MAIL (send as email), REMOTE PRINT (send to be printed), CSEND (send
the output of a command), PSEND (send a part of a file), BSEND (send in binary
mode), RESEND (resume an interrupted SEND), etc etc.  Similarly: GET, REGET,
CGET, RETRIEVE, and so on.
<p>
Not only is it confusing to have different names for these commands, many of
which are not real words, but this also does not allow all combinations, like
"send a file as mail, then delete it".
<p>
In C-Kermit 7.0, the SEND, GET, and RECEIVE commands were restructured to
accept modifier switches (switches are explained in 
<a href="#x1.5">Section 1.5</a>).

<p>
<hr>
<h4><a name="x4.7.1">4.7.1. SEND Command Switches</a></h4>

Without switches, the SEND command still works exactly as before:
<p><pre>
  send oofa.txt      ; send a single file
  send oofa.*        ; send multiple files
  send oofa.txt x.x  ; send oofa.txt as x.x (tell receiver its name is x.x)
  send               ; send from SEND-LIST
</pre><p>
But now the following modifier switches may be included between "send" and the
filename.  Zero, one, two, or more switches may be included in any combination
that makes sense.  Switch names (such as /BINARY) can be abbreviated, just
like any other keywords.  Most of these switches work only when using Kermit
protocol (/TEXT and /BINARY are the exceptions).
<p><dl>
<dt><b>/AFTER:</b><i>date-time</i>
<dd>Specifies that only those files modified (or, in VMS, created) after
the given date-time (see 
<a href="#x1.6">Section 1.6</a>) are to be sent.  Examples:
<p><pre>
  send /text /after:{2-Feb-1997 10:28:30} *.txt
  send /text /after:\fdate(oofa.txt) *.txt
</pre><p>
Synonym: <b>/SINCE</b>.
<p>
<dt><b>/ARRAY:</b><i>arrayname</i>
<dd>Specifies that instead of sending a file, C-Kermit is to send the
contents of the given array.  Since an array does not have a filename,
you should include an /AS-NAME switch to specify the name under which
the array is to be sent (if you do not, the name "_array_x_" is used,
where 'x' is replaced by the array designator).  See 
<a href="#x7.10">section 7.10</a> for
array-name syntax.  As noted in that section, you can also include a
range to have a segment of the array sent, rather than the whole
thing; for example: "send /array:&#38;a[100:199]".  It is strongly
recommended that you accompany the /ARRAY switch with a /TEXT or
/BINARY switch to force the desired transfer mode, since otherwise the
various automatic mechanisms might switch to binary mode when you
really wanted text, or vice versa.  In text mode a line terminator is
added to the end of each array element, but not in binary mode.  For
details and examples see 
<a href="#x7.10.11">Section 7.10.11</a>.
<p>
<dt><b>/AS-NAME:</b><i>text</i>
<dd>Specifies "text" as the name to send the file under.
You can also still specify the as-name as the second filename on the
SEND command line.  The following two commands are equivalent:
<p><pre>
  send oofa.txt oofa.new
  send /as:oofa.new oofa.txt
</pre><p>
<dt><b>/BEFORE:</b><i>date-time</i>
<dd>Specifies that only those files modified (or, in VMS, created)
before the given date-time (<a href="#x1.6">Section 1.6</a>) are to be
sent.
<p>
<dt><b>/BINARY</b>
<dd>Performs this transfer in binary mode without affecting the global
    transfer mode, overriding not only the FILE TYPE and TRANSFER MODE
    settings, but also the FILE PATTERN setting, but for this SEND command
    only.  In other words, SEND /BINARY means what it says: send the file
    in binary mode, regardless of any other settings.  Example:
<p><pre>
  set file type text      ; Set global transfer mode to text
  send /binary oofa.zip   ; Send a file in binary
  send oofa.txt           ; This one is sent in text mode
</pre><p>
<dt><b>/COMMAND</b>
<dd>SEND /COMMAND is equivalent to CSEND (<a href="#x4.2.2">Section 4.2.2</a>)
-- it says to send
the output from a command, rather than the contents of a file.
The first "filename" on the SEND command line is interpreted as the name
of a command; the second (if any) is the as-name.  Examples:
<p><pre>
  send /command {grep Sunday oofa.txt} sunday.txt
  send /as-name:sunday.txt /command {grep Sunday oofa.txt}
  send /bin /command {tar cf - . | gzip -c} {!gunzip -c | tar xf -}
</pre><p>
<dt><b>/DELETE</b>
<dd>Deletes the file (or each file in the group) after it has been sent
    successfully (but does not delete it if it was not sent successfully).
    SEND /DELETE is equivalent to MOVE.  Has no effect when used with
    /COMMAND.  Example:
<p><pre>
  send /delete *.log
</pre><p>
<dt><b>/DOTFILES</b>
<dd>(UNIX and OS-9 only)  Normally files whose names begin with "<tt>.</tt>"
are skipped when matching wildcards that do not also beging with "<tt>.</tt>".
Include /DOTFILES to force these files to be included too.
<p>
<dt><b>/RECURSIVE</b>
<dd>Descend the through the directory tree when locating files to send.
Automatically sets /PATHNAMES:RELATIVE.  Explained in 
<a href="#x4.11">Section 4.11</a> .
<p>
<dt><b>/EXCEPT:</b><i>pattern</i>
<dd>See <a href="#x1.5.4">Section 1.5.4</a>.
<p>
<dt><b>/NOBACKUP</b>
<dd>This means to skip backup files when sending, even if they match the
SEND file specification.  This is equivalent to using SEND /EXCEPT and
including <tt>*.~[0-9]*~</tt> in the exception list (or <tt>*.~*~</tt> if
Kermit was built without pattern-matching support; see 
<a href="#x4.9.1">Section 4.9.1</a>).
Including this switch is equivalent to giving SET SEND BACKUP OFF
(<a href="#x4.0.6">Section 4.0.6</a>) prior to SEND, except its effect is
local to the SEND command with which it was given.
<p>
<dt><b>/NODOTFILES</b>
<dd>The opposite of /DOTFILES (q.v.)
<p>
<dt><b>/FILENAMES:</b><i>{</i><b>CONVERTED,LITERAL</b><i>}</i></b>
<dd>Use this switch to override the current global SET FILE NAMES setting
for this transfer only.
<p>
<dt><b>/FILTER:</b><i>command</i>
<dd>This specifies a filter to pass the file through before sending it.
See the 
<a href="#x4.2">section on file-transfer pipes and filters</a>.  The /FILTER
switch applies only to the file-transfer command it is given with; it does not
affect the global SEND FILTER setting, if any.
<p>
<dt><b>/IMAGE</b>
<dd>VMS: Sends in image mode.  Non-VMS: same as /BINARY.
<p>
<dt><b>/LABELED</b>
<dd>VMS and OS/2 only: Sends in labeled mode.
<p>
<dt><b>/LARGER-THAN:</b><i>number</i>
<dd>Specifies that only those files that are longer than the given number
    of bytes are to be sent.
<p>
<dt><b>/LISTFILE:</b><i>filename</i>
<dd>Specifies that the files to be sent are listed in a file with the given
filename.  The file contains one filename per line.  These filenames are
not checked in any way; each filename is taken and does not use or
depend on any Kermit-specific syntax.  In particular, backslashes are
not treated specially, leading and trailing spaces are not stripped,
etc.  However, if a filename contains wildcards, they are expanded.
Example: If a file named files.txt contains the following lines:
<p><pre>
  blah.txt
  oofa*
  x.x
</pre><p>
(but without leading or trailing spaces), then the C-Kermit command
"send /listfile:files.txt" will send the files blah.txt, x.x, and all
files whose names start with "oofa", assuming the files exist and are
readable.  The /LISTFILE switch, can, of course, be used with other
switches when it makes sense, for example, /EXCEPT, /BINARY, /AFTER,
/SMALLER, /MOVE-TO, /DELETE, /AS-NAME with a template, etc.
<p>
<dt><b>/MAIL:</b><i>address</i>
<dd>Sends the file as e-mail to the given address or addresses.
"send /mail:address filename" is equivalent to "mail filename address".
You can include multiple addresses separated by commas.  Examples:
<p><pre>
  send /mail:kermit-support@columbia.edu packet.log
  send /mail:cmg,fdc,jrd oofa.txt
</pre><p>
As with any switch argument, if the address or address list contains any
spaces, you must enclose it in braces.  The format of the addresses must
agree with that understood by the mail-sending program on the receiver's
computer.
<p>
<dt><b>/MOVE-TO:</b><i>directory-name</i>
<dd>Specifies that after each (or the only) source file is sent successfully,
and ONLY if it is sent successfully, it should be moved to the named
directory.  If the directory name contains spaces, enclose it in braces.
If the directory does not exist, it is created if possible; if it can't be
created, the command fails and an error message is printed.  Example:
<p><pre>
  send /text /move-to:/users/olga/backup/ *.txt
</pre><p>
<dt><b>/NOT-AFTER:</b><i>date-time</i>
<dd>Specifies that only those files modified at or before the given date and
time are to be sent.
<p>
<dt><b>/NOT-BEFORE:</b><i>date-time</i>
<dd>Specifies that only those files modified at or after the given date and
time are to be sent.
<p>
<dt><b>/PATHNAMES:</b><i>{</i><b>OFF,ABSOLUTE,RELATIVE</b><i>}</i>
<dd>Use this switch to override the current global SET SEND PATHNAMES setting
for this transfer only.  /PATHNAMES:ABSOLUTE or RELATIVE also sets
/FILENAMES:LITERAL (also for this transfer only) since pathnames are not
sent otherwise.
<p>
<dt><b>/RENAME-TO:</b><i>text</i>
<dd>Specifies that after the (or each) source file is sent successfully, and
ONLY if it is sent successfully, it should be renamed to the name given.
If the name contains spaces, enclose it in braces.  If a file group is
being sent, then the "text" must contain a variable reference such as
\v(filename) (see <a href="#x4.1">Section 4.1</a>).  Example:
<p><pre>
  send /rename-to:ok_\v(filename) *.*
</pre><p>
This sends each file in the current directory and if it was sent
successfully, changes its name to begin with "ok_".
<p>
<dt><b>/SMALLER-THAN:</b><i>number</i>
<dd>Specifies that only those files that are smaller than the given number
of bytes are to be sent.
<p>
<dt><b>/SUBJECT:</b><i>text</i>
<dd>Subject for email.  Actually, this is just a synonym for /AS-NAME.  If the
text includes spaces, you must enclose it in braces.  If you don't specify
a subject (or as-name), the name of the file is used as the subject.
Example:
<p><pre>
  send /mail:kermit-support@columbia.edu /subj:{As requested} packet.log
</pre><p>
<dt><b>/PRINT:</b><i>options</i>
<dd>Sends the file to be printed, optionally specifying options for the
printer.  Equivalent to REMOTE PRINT filename options.  Examples:
<p><pre>
  send /print oofa.txt              ; No options.
  send /print:/copies=3 oofa.txt    ; "/copies=3" is a VMS PRINT switch.
  send /print:-#3 oofa.txt          ; "-#3" is a UNIX lpr switch.
</pre><p>
<dt><b>/PROTOCOL:</b><i>name</i>
<dd>Uses the given protocol to send the file (Kermit, Zmodem, etc) for this
transfer without changing global protocol.  Only available in Kermit 95,
UNIX, and OS-9.  Example:
<p><pre>
  set protocol kermit               ; Set global protocol
  send /proto:zmodem /bin oofa.zip  ; Send just this file with Zmodem
  send oofa.txt                     ; This file is sent with Kermit
</pre><p>
<dt><b>/QUIET</b>
<dd>When sending in local mode, this suppresses the file-transfer display.
<p>
<dt><b>/RECOVER</b>
<dd>Used to recover from a previously interrupted transfer; SEND /RECOVER is
    equivalent to RESEND.  Recovery only works in binary mode; SEND /RECOVER
    and RESEND include an implied /BINARY switch.  Even then, recovery will
    successful only if (a) the original (interrupted) transfer was also in
    binary mode, or (b) if it was in text mode, the two Kermit programs run on
    platforms where text-mode transfers are not length-changing.
<p>
<dt><b>/STARTING:</b><i>number</i>
<dd>Starts sending the file from the given byte position.
SEND /STARTING:n filename is equivalent to PSEND filename <i>n</i>.
<p>
<dt><b>/TEXT</b>
<dd>Performs this transfer in text mode without affecting the global
    transfer mode, overriding not only the FILE TYPE and TRANSFER MODE
    settings, but also the FILE PATTERN setting, for this SEND command
    only.  In other words, SEND /TEXT really send the file in text mode,
    regardless of any other settings or negotiations.
</dl><p>
About mail...  Refer to 
<a href="#x4.7.1">Section 4.7.1</a>.  The same rules apply as for file
transfer.  If you are mailing multiple files, you can't use an as-name (in
this case, a subject) unless it contains replacement variables like
\v(filenum).  For example, if you:
<p><pre>
  send /mail:somebody@xyz.com *.txt
</pre><p>
Then each file will arrive as a separate email message with its name as the
subject.  But if you:
<p><pre>
  send /mail:somebody@xyz.com /subject:{Here is a file} *.txt
</pre><p>
Then each file message will have the same subject, which is probably not what
you want.  You can get around this with constructions like:
<p><pre>
  send /mail:somebody@xyz.com /subject:{Here is \v(filename)} *.txt
</pre><p>
which embed the filename in the subject.
<p>
The MOVE, CSEND, MAIL, and RESEND commands now also accept the same switches.
And the switches are also operative when sending from a SEND-LIST (see
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>, 2nd Ed, pp.191-192), so, for example, it is now possible to SEND
/PRINT or SEND /MAIL from a SEND-LIST.
<p>
The MSEND and MMOVE commands also take switches, but not all of them.  With
these commands, which take an arbitrary list of filespecs, you can use
/BINARY, /DELETE, /MAIL, /PRINT, /PROTOCOL, /QUIET, /RECOVER, and /TEXT (and
/IMAGE or /LABELED, depending on the platform).  MMOVE is equivalent to MSEND
/DELETE.  (If you want to send a group of files, but in mixed transfer modes
with per-file as-names, use ADD SEND-LIST and then SEND.)
<p>
The MSEND/MMOVE switches come before the filenames, and apply to all of them:
<p><pre>
  msend /print /text *.log oofa.txt /etc/motd
</pre><p>

If you type any of these commands (SEND, CSEND, MSEND, etc) followed by a
question mark (?), you will see a list of the switches you can use.  If you
want to see a list of filenames, you'll need to type something like "<tt>send
./?</tt>" (UNIX, OS/2, Windows, etc), or "<tt>send []?</tt>" (VMS), etc.  Of
course, you can also type pieces of a filename (anything that does not start
with "<tt>/</tt>") and then "<tt>?</tt>" to get a list of filenames that start
that way; e.g. "<tt>send x.?</tt>" still works as before.

<p>

In UNIX, where "<tt>/</tt>" is also the directory separator, there is usually
no ambiguity between a fully-specified pathname and a switch, except when a
file in the root directory has the same name as a switch (as noted in 
<a href="#x1.5">Section 1.5</a>):
<p><pre>
  send /etc/motd                        ; Works as expected
  send /command                         ; ???
</pre><p>

The second example interprets "<tt>/command</tt>" as a switch, not a filename.
To send a file actually called "<tt>command</tt>" in the root directory, use:
<p><pre>
  send {/command}
</pre><p>
or other system-dependent forms such as <tt>//command</tt>,
<tt>/./command</tt>, <tt>c:/command</tt>, etc, or <tt>cd</tt> to <tt>/</tt>
and then "<tt>send command</tt>".

<p>
<hr>
<h4><a name="x4.7.2">4.7.2. GET Command Switches</a></h4>

Without switches, the GET command still works about the same as before:
<p><pre>
  get oofa.txt                          ; GET a single file
  get oofa.*                            ; GET multiple files
</pre><p>
However, the mechanism for including an "as-name" has changed.  Previously,
in order to include an as-name, you were required to use the "multiline" form
of GET:
<p><pre>
  get
  <i>remote-filespec</i>
  <i>local-name</i>
</pre><p>
This was because the remote filespec might contain spaces, and so there would
be no good way of telling where it ended and where the local name began, e.g:
<p><pre>
  get profile exec a foo
</pre><p>
But now since we can use {braces} for grouping, we don't need the multiline
GET form any more, and in fact, support for it has been removed.  If you give
a GET command by itself on a line, it fails and an error message is printed.
The new form is:
<p><dl>
<dt><b>GET</b> <i>[ switches... ] remote-name [ local-name ]</i>
<dd>Ask the server to send the file whose name is <i>remote-name</i>.
If the optional <i>local-name</i> is given, store it locally under this name.
If the remote-name or local-name contains spaces, they must be enclosed in
braces:
<p><pre>
  get {profile exec a} foo
  get oofa.txt {~/My Files/Oofa text}
</pre>
</dl><p>
If you want to give a list of remote file specifications, use the MGET
command:
<p><dl>
<dt><b>MGET</b> <i>[ switches... ] remote-name [ remote-name [ remote-name ... ] ]</i>
<dd>Ask the server to send the files whose names are given.
</dl>
<p>

Now you can also include modifier switches between GET or MGET and the
remote-name; most of the same switches as SEND:
<p><dl>
<dt><b>/AS-NAME:</b><i>text</i>
<dd>Specifies "text" as the name to store the incoming file under.  (This
switch is not available for MGET.)  You can also still specify the
as-name as the second filename on the GET command line.  The following
two commands are equivalent:
<p><pre>
  get oofa.txt oofa.new
  get /as:oofa.new oofa.txt
</pre><p>
<dt><b>/BINARY</b>
<dd>Tells the server to send the given file(s) in binary mode without
affecting the global transfer mode.  Example:
<p><pre>
  set file type text      ; Set global transfer mode to text
  get /binary oofa.zip    ; get a file in binary mode
  get oofa.txt            ; This one is transferred in text mode
</pre><p>
Or, perhaps more to the point:
<p><pre>
  get /binary foo.txt     ; where "*.txt" is a text-pattern
</pre><p>
This has the expected effect only if the server is C-Kermit 7.0 or later or K95
1.1.19 or later.
<p>
<dt><b>/COMMAND</b>
<dd>GET /COMMAND is equivalent to CGET (<a href="#x4.2.2">Section 4.2.2</a>)
-- it says to receive
the file into the standard input of a command, rather than saving it on
disk.  The /AS-NAME or the second "filename" on the GET command line is
interpreted as the name of a command.  Examples:
<p><pre>
  get /command sunday.txt {grep Sunday oofa.txt}
  get /command /as-name:{grep Sunday oofa.txt} sunday.txt
  get /bin /command {!gunzip -c | tar xf -} {tar cf - . | gzip -c}
</pre><p>
<dt><b>/DELETE</b>
<dd>Asks the Kermit server to delete the file (or each file in the group)
after it has been transferred successfully (but not to delete it if it
was not sent successfully).  GET /DELETE is equivalent to RETRIEVE.
Example:
<p><pre>
  get /delete *.log
</pre><p>
<dt><b>/EXCEPT:</b><i>pattern</i>
<dd>Specifies that any files whose names match the pattern, which can be a
regular filename, or may contain "*" and/or "?" metacharacters,
are to be refused upon arrival.  To specify multiple patterns (up to 8),
use outer braces around the group, and inner braces around each pattern:
<p><pre>
  /EXCEPT:{{<i>pattern1</i>}{<i>pattern2</i>}...}
</pre><p>
See the description of SEND /EXCEPT in 
<a href="#x4.7.1">Section 4.7.1</a> for examples, etc.
Refusal is accomplished using the Attribute Rejection mechanism (reason
"name"), which works only when Attribute packets have been successfully
negotiated.
<p>
<dt><b>/FILENAMES:</b><i>{</i><b>CONVERTED,LITERAL</b><i>}</i>
<dd>Use this switch to override the current global SET FILE NAMES setting
for this transfer only.
<p>
<dt><b>/FILTER:</b><i>command</i>
<dd>This specifies a filter to pass the incoming file through before writing
to disk.  See the 
<a href="#x4.2">section on file-transfer pipes and filters</a>.  The /FILTER
switch applies only to the file-transfer command it is given with; it does
not affect the global RECEIVE FILTER setting, if any.
<p>
<dt><b>/IMAGE</b>
<dd>VMS: Transfer in image mode.  Non-VMS: same as /BINARY.
<p>
<dt><b>/LABELED</b>
<dd>VMS and OS/2 only: Specifies labeled transfer mode.
<p>
<dt><b>/MOVE-TO:</b><i>directory</i>
<dd>This tells C-Kermit to move each file that is successfully received to
the given directory.  Files that are not successfully received are not
moved.  By default, files are not moved.
<p>
<dt><b>/PATHNAMES:</b><i>{</i><b>OFF,ABSOLUTE,RELATIVE,AUTO</b><i>}</i>
<dd>Use this switch to override the current global SET RECEIVE PATHNAMES
setting for this transfer only.  /PATHNAMES:ABSOLUTE or RELATIVE also sets
/FILENAMES:LITERAL (also for this transfer only) since incoming pathnames
would not be treated as pathnames otherwise.  See <a href="#x4.10">Section
4.10</a>. 
<p>
<dt><b>/QUIET</b>
<dd>When sending in local mode, this suppresses the file-transfer display.
<p>
<dt><b>/RECOVER</b>
<dd>Used to recover from a previously interrupted transfer; GET /RECOVER
    is equivalent to REGET.  Recovery only works in binary mode; SEND /RECOVER
    and RESEND include an implied /BINARY switch.  Even then, recovery will
    successful only if (a) the original (interrupted) transfer was also in
    binary mode, or (b) if it was in text mode, the two Kermit programs run
    on platforms where text-mode transfers are not length-changing.
<p>
<dt><b>/RECURSIVE</b>
<dd>Tells the server that the GET file specification applies recursively.
    This switch also automatically sets /PATHNAMES:RELATIVE in both the server
    AND the client.  When used in conjunction with /DELETE, this "moves" a
    directory tree from the server's computer to the client's computer (except
    that only regular files are deleted from the server's computer, not
    directories; thus the original directories will be left, but will contain
    no files).  Note that all servers that support /RECURSIVE do not
    necessarily do so in combination with other switches, such as /RECOVER.
    (Servers that do include C-Kermit 7.0 and later, K95 1.1.19 and later.)
<p>
<dt><b>/RENAME-TO:</b><i>string</i>
<dd>This tells C-Kermit to rename each file that is successfully received to
    the given string.  Files that are not successfully received are not
    renamed.  By default, files are not renamed.  The <i>string</i> can be a
    literal string, which is appropriate when only one file is being received,
    or it can contain one or more variables that are to be evaluated at the
    time each file is received, such as \v(filename), \v(filenumber),
    \v(ntime), \v(pid), \v(user), etc.  WARNING: if you give a literal string
    and more than one file arrives, each incoming file will be given the same
    name (but SET FILE COLLISION BACKUP or RENAME can be used to keep the
    incoming files from overwriting each other).
<p>
<dt><b>/TEXT</b>
<dd>Tells the server to perform this transfer in text mode without affecting
    its global transfer mode.  See /BINARY for additional info.
</dl><p>
The /MAIL and /PRINT options are not available (as they are for SEND), but you
can use /COMMAND to achieve the same effect, as in these UNIX examples:
<p><pre>
  get /command oofa.txt {mail kermit@columbia.edu}
  get /command oofa.txt lpr
</pre><p>
In OS/2 or Windows, you can GET and print like this:
<p><pre>
  get oofa.txt prn
</pre><p>
The CGET, REGET, RETRIEVE commands also accept the same switches as GET.  CGET
automatically sets /COMMAND; REGET automatically sets /RECOVER and /BINARY,
and RETRIEVE automatically sets /DELETE.

<p>
<hr>
<h4><a name="x4.7.3">4.7.3. RECEIVE Command Switches</a></h4>

Without switches, the RECEIVE command still works as before:
<p><pre>
  receive            ; Receives files under their own names
  receive /tmp       ; Ditto, but into the /tmp directory
  r                  ; Same as "receive"
  receive foo.txt    ; Receives a file and renames to foo.txt
</pre><p>
Now you can also include modifier switches may be included between "receive"
and the as-name; most of the same switches as GET:
<p><dl>
<dt><b>/AS-NAME:</b><i>text</i>
<dd>Specifies "text" as the name to store the incoming file under.
You can also still specify the as-name as a filename on the
command line.  The following two commands are equivalent:
<p><pre>
  r oofa.new
  r /as:oofa.new
</pre><p>
<dt><b>/BINARY</b>
<dd>Performs this transfer in binary mode without affecting the global
    transfer mode.  NOTE: This does not override the incoming filetype (as
    it does with GET), so this switch is useful only if ATTRIBUTE TYPE is
    OFF, or if the other Kermit does not send a TYPE (text or binary)
    attribute.  In any case, it has no affect whatsoever on the file sender.
<p>
<dt><b>/COMMAND</b>
<dd>RECEIVE /COMMAND is equivalent to CRECEIVE (<a href="#x4.2.2">Section 4.2.2</a>)
-- it says to
receive the file into the standard input of a command, rather than saving
it on disk.  The /AS-NAME or the "filename" on the RECEIVE command line
is interpreted as the name of a command.
<p><pre>
  r /command {grep Sunday oofa.txt}
  r /command /as-name:{grep Sunday oofa.txt}
  r /bin /command {tar cf - . | gzip -c}
</pre><p>
<dt><b>/EXCEPT:</b><i>pattern</i>
<dd>Specifies that any files whose names match the pattern, which can be a
    regular filename, or may contain "*" and/or "?" metacharacters,
    are to be refused upon arrival.  To specify multiple patterns (up to 8),
    use outer braces around the group, and inner braces around each pattern:
<p><pre>
  /EXCEPT:{{<i>pattern1</i>}{<i>pattern2</i>}...}
</pre><p>
See the description of SEND /EXCEPT in 
<a href="#x4.7.1">Section 4.7.1</a> for examples, etc.
Refusal is accomplished using the Attribute Rejection mechanism (reason
"name"), which works only when Attribute packets have been successfully
negotiated.
<p>
<dt><b>/FILENAMES:</b><i>{</i><b>CONVERTED,LITERAL</b><i>}</i>
<dd>Use this switch to override the current global SET FILE NAMES setting
    for this transfer only.
<p>
<dt><b>/FILTER:</b><i>command</i>
<dd>This specifies a filter to pass the incoming file through before writing
to disk.  See the 
<a href="#x4.2">section on file-transfer pipes and filters</a>.  The /FILTER
switch applies only to the file-transfer command it is given with; it does
not affect the global RECEIVE FILTER setting, if any.
<p>
<dt><b>/IMAGE</b>
<dd>VMS: Transfer in image mode.  Non-VMS: same as /BINARY.
    See comments under RECEIVE /BINARY.
<p>
<dt><b>/LABELED</b>
<dd>VMS and OS/2 only: Specifies labeled transfer mode.
    See comments under RECEIVE /BINARY.
<p>
<dt><b>/MOVE-TO:</b><i>directory</i>
<dd>This tells C-Kermit to move each file that is successfully received to
    the given directory.  Files that are not successfully received are not
    moved.  By default, files are not moved.
<p>
<dt><b>/PATHNAMES:</b><i>{</i><b>ABSOLUTE,RELATIVE,OFF,AUTO</b><i>}</i>
<dd>Use this switch to override the current global SET RECEIVE PATHNAMES
setting for this transfer only.  See 
<a href="#x4.10">Section 4.10</a>.
<p>
<dt><b>/RECURSIVE</b>
<dd>When used with the RECEIVE command, /RECURSIVE is simply a synonym
    for /PATHNAMES:RELATIVE.
<p>
<dt><b>/RENAME-TO:</b><i>string</i>
<dd>This tells C-Kermit to rename each file that is successfully received to
    the given string.  Files that are not successfully received are not
    renamed.  By default, files are not renamed.  The <i>string</i> can be a
    literal string, which is appropriate when only one file is being received,
    or it can contain one or more variables that are to be evaluated at the
    time each file is received, such as \v(filename), \v(filenumber),
    \v(ntime), \v(pid), \v(user), etc.  WARNING: if you give a literal string
    and more than one file arrives, each incoming file will be given the same
    name (but SET FILE COLLISION BACKUP or RENAME can be used to keep the
    incoming files from overwriting each other).
<p>
<dt><b>/QUIET</b>
<dd>When receiving in local mode, this suppresses the file-transfer display.
<p>
<dt><b>/TEXT</b>
<dd>Receives in text mode without affecting the global transfer mode.  See
    comments under RECEIVE /BINARY.
</dl><p>
The /MAIL and /PRINT options are not available, but you can use /COMMAND
to achieve the same effect, as in these UNIX examples:
<p><pre>
  r /command {mail kermit@columbia.edu}
  r /command lpr
</pre><p>
In OS/2 or Windows, you can RECEIVE and print like this:
<p><pre>
  receive prn
</pre><p>
The CRECEIVE command now also accepts the same switches.

<p>
<hr>
<h3><a name="x4.8">4.8. Minor Kermit Protocol Improvements</a></h3>
<h4><a name="x4.8.1">4.8.1. Multiple Attribute Packets</a></h4>

C-Kermit 7.0 now sends more than one Attribute packet if a file's attributes
do not fit into a single packet of the negotiated length.  If a particular
attribute (such as file creation date-time) does not fit within the negotiated
length (which will only happen when the negotiated length is around 20 or
less), that attribute is not sent at all.

<h4><a name="x4.8.2">4.8.2. Very Short Packets</a></h4>

There are certain situations where extremely short packets must be used;
20 or 30 bytes at most.  This can happen when one or more devices along the
communication path have very small buffers and lack an effective means of
flow control.  Examples are sometimes cited involving radio modems.
<p>
When the maximum packet length is shorter than certain packets that would be
sent, those packets are either truncated or else broken up into multiple
packets.  Specifically:
<p><ol>
<li>Parameter negotiation packets (I, S, and their ACKs) are truncated to
the negotiated length.  Any parameters that do not fit are reset to
their default values.  There is no provision in the Kermit protocol for
fragmentation and reassembly of parameter strings.
<p>
<li>File header packets (containing the filename) are simply truncated.
There is no provision in the Kermit protocol for fragmentation and
reassembly of filenames.
<p>
<li>Attribute packets are fragmented and reassembled as described in 4.8.1
without loss of data, except in case a field will not fit at all in
the negotiated length (the longest attribute is usually the date and
time of file creation/modification) because of the rule that attributes
may not be broken across packets.
<p>
<li>Data packets and other packets are unaffected -- they can be as short
as they need to be, within reason.
</ol>

<p>
<hr>
<h3><a name="x4.9">4.9. Wildcard / File Group Expansion</a></h3>

"Wildcard" refers to the notation used in filenames to specify a group of
files by pattern matching.

<h4><a name="x4.9.1">4.9.1. In UNIX C-Kermit</a></h4>

Prior to C-Kermit 7.0, C-Kermit was capable of expanding wildcard strings
containing only the "metacharacters" '*' and '?':
<p><dl>
<dt><b><tt>*</tt></b>
<dd>Matches any sequence of zero or more characters.  For example: "ck*.c"
matches all files whose names start with "ck" and end with ".c", including
"ck.c".
<p>
<dt><b><tt>?</tt></b>
<dd>Matches any single character.  For example, "ck?.c" matches all files whose
names are exactly 5 characters long and start with "ck" and end with ".c".
When typing commands at the prompt, you must precede any question mark to
be used for matching by a backslash (\) to override the normal function of
question mark, which is providing menus and file lists.
</dl>
<p>
C-Kermit 7.0 adds the additional features that users of ksh, csh, and bash
are accustomed to:
<p><dl>
<dt><b><tt>[abc]</tt></b>
<dd>Square brackets enclosing a list of characters matches any single
  character in the list.  Example: ckuusr.[ch] matches ckuusr.c and ckuusr.h.
<p>
<dt><b><tt>[a-z]</tt></b>
<dd>Square brackets enclosing a range of characters; the hyphen separates the
low and high elements of the range.  For example, [a-z] matches any
character from a to z.
<p>
<dt><b><tt>[acdm-z]</tt></b>
<dd>Lists and ranges may be combined.  This example matches a, c, d, or m
through z.
<p>
<dt><b><tt>{<i>string1,string2,...</i>}</tt></b>
<dd>Braces enclose a list of strings to be matched.  For example:
<tt>ck{ufio,vcon,cmai}.c</tt> matches <tt>ckufio.c, ckvcon.c,</tt> or
<tt>ckcmai.c</tt>.  The <i>string</i>s  may themselves contain metacharacters,
bracket lists, or indeed, other lists of strings, but (when matching
filenames) they may not contain   directory separators.
<p>
Thus, the metacharacters in filenames (and in any other field that can be a
pattern, such as the IF MATCH pattern, SEND or GET exception lists, etc) are:
<p><pre>
 * ? [ {
</pre><p>
And within braces only, comma (,) is a metacharacter.
</dl>
<p>
To include a metacharacter in a pattern literally, precede it with a backslash
'\' (or two if you are passing the pattern to a macro).  Examples:
<p><pre>
  send a*b      ; Send all files whose names start with 'a' and end with 'b'.
  send a?b      ; Ditto, but the name must be exactly three characters long.
  send a[a-z]b  ; Ditto, but the second character must be a lowercase letter.
  send a[x\-z]b ; Ditto, except the second character must be 'x', '-', or 'y'.
  send a[ghi]b  ; Ditto, except the second character must be 'g', 'h', or 'i'.
  send a[?*]b   ; Ditto, except the second character must be '?' or '*'.
  send a[\?\*]b ; Same as previous.
  send *?[a-z]* ; All files with names containing at least one character
                ; that is followed by a lowercase letter.
</pre><p>
Or, more practically:
<p><pre>
  send ck[cuw]*.[cwh]  ; Send the UNIX C-Kermit source files.
</pre><p>
To refer to the C-Kermit sources files and makefile all in one filespec:
<p><pre>
  {{makefile,ck[cuw]*.[cwh]}}
</pre><p>
(NOTE: if the entire pattern is a {stringlist}, you must enclose it it TWO
pairs of braces, since the SEND command strips the outer brace pair, because
of the "enclose in braces if the filename contains spaces" rule).
<p>
If the makefile is called ckuker.mak:
<p><pre>
  ck[cuw]*.{[cwh],mak}
</pre><p>
(NOTE: double braces are not needed here since the pattern does not both
begin and end with a brace.)
<p>
To add in all the C-Kermit text files:
<p><pre>
  ck[cuw]*.{[cwh],mak,txt}
</pre><p>
All of these features can be used anywhere you would type a filename that
is allowed to contain wildcards.
<p>
When you are typing at the command prompt, an extra level of quoting is
required for the '?' character to defeat its regular function of producing a
list of files that match what you have typed so far, for example:
<p><pre>
  send ck[cu]?
</pre><p>
lists all the files whose names start with ckc and cku.  If you quote the
question mark, it is used as a pattern-matching character, for example:
<p><pre>
  send ck\?[ft]io.c
</pre><p>
sends all the file and communications i/o modules for all the platforms:
ckufio.c, ckutio.c, ckvfio.c, ckvtio.c, etc.
<p>
If, however, a filename actually contains a question mark and you need to
refer to it on the command line, you must use three (3) backslashes.  For
example, if the file is actually called ck?fio.c, you would use:
<p><pre>
  send ck\\\?fio.c
</pre><p>
Further notes on quoting:
<p><ul>
<li>A single backslash is sufficient for quoting a special character at the
command prompt or in a command file.  However, when passing patterns to
macros you'll need double backslashes, and when referring to these
patterns within the macro, you'll need to use \fcontents(\%1) (see
<a href="#x1.11.5">Section 1.11.5</a>).  You should enclose macro argument
references in braces in case grouped arguments were passed.  Example:
<p><pre>
 define ismatch {
     if match {\fcont(\%1)} {\fcont(\%2)} {
         end 0 MATCH
     } else {
         end 1 NO MATCH
     }
 }
 ismatch ab*yz a*\\**z           ; Backslash must be doubled
 ismatch {abc def xyz} *b*e*y*   ; Braces must be used for grouping
</pre><p>
<li>Watch out for possible conflicts between {} in filename patterns and
<tt>{}</tt> used for grouping multiple words into a single field, when the
pattern has outer braces.  For example, in:
<p><pre>
     if match {abc xyz} {a* *z} echo THEY MATCH
</pre><p>
braces must be used to group "abc xyz" into a single string.  Kermit strips
off the braces before comparing the string with the pattern.  Therefore:
<p><pre>
 if match makefile {makefile,Makefile} echo THEY MATCH
</pre><p>
does not work, but:
<p><pre>
 if match makefile {{makefile,Makefile}} echo THEY MATCH
</pre><p>
does.
<p>
<li>If you use a pattern that has outer braces, like {*.txt,*.doc},
in a field that accepts a pattern list (like SEND /EXCEPT:xxx), you'll
need to add two extra sets of outer braces:
<p><pre>
 send /except:{{{*.txt,*.doc}}} *.*
</pre></ul>
<p>

C-Kermit's new pattern matching capabilities are also used when C-Kermit is
in server mode, so now you can send requests such as:
<p><pre>
  get ck[cuw]*.[cwh]
</pre><p>
to a C-Kermit server without having to tell it to SET WILD SHELL first.
Previously this would have required:
<p><pre>
  mget ckc*.c ckc*.w ckc*.h cku*.c cku*.w cku*.h ckw*.c ckw*.w ckw*.h
</pre><p>
The new pattern matching features make SET WILD SHELL redundant, and barring
any objections, it will eventually be phased out.  (One possible reason for
retaining it would be as an escape mechanism when Kermit does not understand
the underlying file system.)
<p>
By the way, patterns such as these are sometimes referred to as "regular
expressions", but they are not quite the same.  In a true regular expression
(for example), "*" means "zero or more repetitions of the previous item", so
(for example), "([0-9]*)" would match zero or more digits in parentheses.  In
Kermit (and in most shells), this matches one digit followed by zero or more
characters, within parentheses.  Here are some hints:
<p><ul>
<li>Although you can't match any sequence of digits (or letters, etc), you
can match (say) 1, 2, or 3 of them in row.  For example, the following
pattern matches Kermit backup files (with backup numbers from 1 to 999):
<p><pre>
 *.~{[1-9],[1-9][0-9],[1-9][0-9][0-9]}~
</pre><p>
<li>There is presently no NOT operator, so no way to match any character or
   string EXCEPT the one(s) shown.
</ul><p>
In other wildcarding news...
<p><ul>
<li>You may now "send xxx" where "xxx" is a directory name, and this will send
all the files from the directory xxx, as if you had typed "send xxx/*".
You can also use the special shorthand "send ." to send all the files from
the current directory.
<p>
<li>To easily skip over backup files (the ones whose names end like .~22~)
when sending, you can use SEND /NOBACKUP (see 
<a href="#x4.0.6">Section 4.0.6</a> for details).
<p>
<li>When choosing Kermit to expand wildcards, rather than the shell, you can
choose whether "dot files" -- files whose names begin with "<tt>.</tt>", which
are normally "invisible" -- should be matched:
<p><pre>
 SET WILD KERMIT /NO-MATCH-DOT-FILES (this is the default)
 SET WILD KERMIT /MATCH-DOT-FILES    (this allows matching of "." files)
</pre><p>
or include the /DOTFILES or /NODOTFILES switch on the command you are
using, such as SEND or DIRECTORY.
<p>
<li>Commands such as DIRECTORY and SEND allow recursive directory traversal.
There are also new functions for this to use in scripts.  See 
<a href="#x4.11">Section 4.11</a> for details.
</ul><p>
When building file lists in UNIX, C-Kermit follows symbolic links.  Because of
this, you might encounter any or all of the following phenomena:
<p><ul>
<li>Multiple copies of the same file; e.g. one from its real directory and
others from links to its real directory, if both the real directory and
the links to it are in the wildcard expansion list.
<p>
<li>A command might unexpectedly "hang" for a long time because an NFS link
might not be responding, or the directory you are looking at contains
a link to a huge directory tree (example: "directory /recursive /etc"
when /etc/spool is a symlink to /var/spool, which is a large organization's
incoming email directory, containing tens of thousands of subdirectories).
</ul><p>
The size of the file list that Kermit can build is limited in most C-Kermit
implementations.  The limit, if any, depends on the implementation.  Use the
SHOW FEATURES command and look in the alphabetized options list for MAXWLD to
see the value.

<h4><a name="x4.9.2">4.9.2. In Kermit 95</a></h4>

Kermit 95 1.1.19 and later uses the same pattern matching syntax as in UNIX,
but (as always) you will encounter numerous difficulties if you use backslash
(<tt>\</tt>) as the directory separator.  In any command where K95 parses
filenames itself (that is, practically any file-oriented command except RUN),
you can use forward slash (<tt>/</tt>) as the directory separator to avoid all
the nasty conflicts.

<h4><a name="x4.9.3">4.9.3. In VMS, AOS/VS, OS-9, VOS, etc.</a></h4>

Platforms other than UNIX, Windows 95/98/NT, and OS/2 have their own filename
matching capabilities that are, in general, different from Kermit's built-in
ones and in any case might conflict with them.  For example, <tt>[]</tt>
encloses directory names in VMS.

<p>
Nevertheless you can still use all the pattern-matching capabilities described
in 
<a href="#x4.9.1">Section 4.9.1</a> by loading a file list into an array (e.g.
with <tt>\ffiles(*,&#38;a)</tt>, see 
<a href="#x4.11.3">Section 4.11.3</a>) and then using IF MATCH
on the members.

<p>
<hr>
<h3><a name="x4.10">4.10. Additional Pathname Controls</a></h3>

In version 6.0 and earlier, C-Kermit's SET { SEND, RECEIVE } PATHNAMES command
had only ON and OFF as options.  In version 7.0, there are more choices:
<p><dl>
<dt><b>SET SEND PATHNAMES OFF</b>
<dd>When sending a file, strip all disk/directory information from the name.
  Example: "send /usr/olga/letters/oofa.txt" sends the file as "oofa.txt".
  This applies to actual filenames, not to any as-name you might specify.
<p>
<dt><b>SET SEND PATHNAMES RELATIVE</b>
<dd>When sending a file, leave the pathname on as given.  For example, if your
  current directory is /usr/olga, "send letters/oofa.txt" sends the file as
  "letters/oofa.txt", not "/usr/olga/letters/oofa.txt" or "letters.txt".
<p>
<dt><b>SET SEND PATHNAMES ABSOLUTE</b>
<dd>When sending a file, convert its name to the full, absolute local pathname.
  For example, if your current directory is /usr/olga, "send letters/oofa.txt"
  sends the file as "/usr/olga/letters/oofa.txt".  NOTE: Even with this
  setting, device and/or node names are not included.  For example, in VMS,
  any node or device name is stripped; in Windows or OS/2, any disk letter
  is stripped.
<p>
<dt><b>SET RECEIVE PATHNAMES OFF</b>
<dd>When receiving a file, strip all disk/directory information from the name
before attempting to store it.  This applies to incoming filename, not to any
as-name you might specify.  Example: If a file arrives under the name
"<tt>/usr/olga/letters/oofa.txt</tt>" it is stored simply as
"<tt>oofa.txt</tt>" in your download directory or, if no download directory
has been specified, in your current directory.
<p>
<dt><b>SET RECEIVE PATHNAMES RELATIVE</b>
<dd>When receiving a file, leave the pathname on as it appears in the incoming
name, but if the incoming name appears to be absolute, make it relative to
your current or download directory.  Examples:
<p><ul>
<li>"oofa.txt" is stored as "oofa.txt".
<p>
<li>"letters/oofa.txt" is stored as "letters/oofa.txt"; the "letters"
subdirectory is created if it does not already exist.
<p>
<li>"/usr/olga/letters/oofa.txt" is stored as "usr/olga/letters/oofa.txt"
in your current or download directory, and the "usr", "usr/olga", etc,
directories are created if they do not exist.
</ul><p>
<dt><b>SET RECEIVE PATHNAMES ABSOLUTE</b>
<dd>The incoming filename is used as given.  Thus it cannot be stored unless
the given path (if any) already exists or can be created.  In this case, node,
device, or disk designations are NOT stripped, since they most likely were
given explicitly by the user as an as-name, meant to be used as given.
<p>
<dt><b>SET RECEIVE PATHNAMES AUTO</b>
<dd>This is the default, and means RELATIVE if the sender tells me it is a
  recursive transfer, OFF otherwise.
</dl><p>

Set FILE NAMES CONVERTED now also affects pathnames too.  When PATHNAMES are
RELATIVE or ABSOLUTE and FILE NAMES are CONVERTED, the file sender converts
its native directory-name format to UNIX format, and the file receiver
converts from UNIX format to its native one; thus UNIX format is the common
intermediate representation for directory hierarchies, as it is in the
ZIP/UNZIP programs (which is why ZIP archives are transportable among, UNIX,
DOS, and VMS).
<p>
Here's an example in which a file is sent from Windows to UNIX with relative
pathnames and FILE NAMES CONVERTED:
<p><pre>
  Source name                Intermediate name      Destination Name
  C:\K95\TMP\OOFA.TXT        K95/TMP/OOFA.TXT       k95/tmp/oofa.txt
</pre><p>
In a more complicated example, we send the same file from Windows to VMS:
<p><pre>
  Source name                Intermediate name      Destination Name
  C:\K95\TMP\OOFA.TXT        K95/TMP/OOFA.TXT       [.K95.TMP]OOFA.TXT
</pre><p>
(Note that disk letters and device designations are always stripped when
pathnames are relative).
<p>
As you can imagine, as more and more directory formats are considered, this
approach keeps matters simple: on each platform, Kermit must know only its
own local format and the common intermediate one.  In most cases, the receiver
can detect which format is used automatically.

<p>
<hr>
<h3><a name="x4.11">4.11. Recursive SEND and GET: Transferring Directory Trees</a></h3>

C-Kermit 7.0 in selected versions (UNIX, VMS, VOS, AOS/VS, Windows, and OS/2
at this writing) now permits the SEND command to traverse directories
"recursively" if you ask it to; that is, to send files from the current or
specified directory and all of its subdirectories too, and their
subdirectories, etc.  (Some other commands can do this too, including
DIRECTORY.)
<p>
This feature is new to UNIX, Windows, VOS, and OS/2.  VMS and AOS/VS have
always included "wildcard" or "template" characters that allow this, and in
this case, recursive directory traversal could happen behind Kermit's back,
i.e. Kermit does not have to do it itself (in VMS, the notation is
"<tt>[...]</tt>"  or "<tt>[<i>directory</i>...]</tt>"; in AOS/VS is
"<tt>#</tt>").  In C-Kermit 7.0, however, SEND /RECURSIVE is supported by
C-Kermit itself for VMS.

<p>
<hr>
<h4><a name="x4.11.1">4.11.1. Command-Line Options</a></h4>

To descend a directory tree when sending files, use the -L command-line option
to indicate that the send operation is to be recursive, and include a name or
pattern to be sent.  When giving a pattern, you should enclose it in quotes to
prevent the shell from expanding it.  Examples:
<p><pre>
  $ kermit -Ls "/usr/olga/*" # send all of Olga's files in all her directories
  $ kermit -Ls foo.txt       # send all foo.txt files in this directory tree
  $ kermit -Ls "*.txt"       # send all .txt files in this directory tree
  $ kermit -Ls "letters/*"   # send all files in the letters directory tree
  $ kermit -Ls letters       # send all files in the letters directory tree
  $ kermit -Ls "*"           # send all files in this directory tree
  $ kermit -Ls .             # UNIX only: send all files in this directory tree
  $ kermit -s .              # UNIX only: a filename of . implies -L
</pre><p>
If you let the shell expand wildcards, Kermit only sends files whose names
match files in the current or given directory, because the shell replaces an
unquoted wildcard expression with the list of matching files -- and the shell
does not build recursive lists.  Note that the "<tt>.</tt>" notation for the
tree rooted at the current directory is allowed only in UNIX, since in Windows
and OS/2, it means "<tt>*.*</tt>" (nonrecursive).

<p>
<hr>
<h4><a name="x4.11.2">4.11.2. The SEND /RECURSIVE Command</a></h4>

If you include the /RECURSIVE switch in a SEND (or MOVE, or similar) command,
it means to descend the current or specified directory tree searching for
files whose names match the given name or pattern.  Since this is not terribly
useful unless you also include pathnames with the outbound files, the
/RECURSIVE switch also includes an implicit /PATHNAMES:RELATIVE switch (which
you can undo by including an explicit /PATHNAMES switch after the /RECURSIVE
switch).
<p>
Examples:
<p><dl>
<dt><tt>SEND /RECURSIVE *</tt>
<dd>Sends all of the files in the current directory and all the files in
  all of its subdirectories, and all of their subdirectories, etc, including
  their relative pathnames.  Empty directories are not sent.
<p>
<dt><tt>SEND /RECURSIVE /PATHNAMES:ABSOLUTE *</tt>
<dd>Sends all of the files in the current directory and all the files in
  all of its subdirectories, and all of their subdirectories, etc, including
  their absolute pathnames.
<p>
<dt><tt>SEND /RECURSIVE /PATHNAMES:OFF *</tt>
<dd>Sends all of the files in the current directory and all the files in
  all of its subdirectories, and all of their subdirectories, etc, without
  pathnames.
<p>
<dt><tt>SEND /RECURSIVE /usr/olga/*</tt>
<dd>Sends all of the files in the /usr/olga directory and all the files in
  all of its subdirectories, and all of their subdirectories, etc.
<p>
<dt><tt>SEND /RECURSIVE /usr/olga  (or /usr/olga/)</tt>
<dd>Same as above.  If the name is a directory name (with or without a
  trailing slash), its files are sent, and those of its subdirectories,
  and their subdirectories, etc (see 
<a href="#x4.9">Section 4.9</a>).
<p>
<dt><tt>SEND /RECURSIVE /TEXT /usr/olga/*.txt</tt>
<dd>As above, but only files whose names end with ".txt" are sent, and they
  are sent in text mode (as they would be by default anyway if SET FILE
  PATTERNS is ON or AUTO).
<p>
<dt><tt>SEND .</tt>
<dd>UNIX only: Send all the files in the current directory.
<p>
<dt><tt>SEND /RECURSIVE .</tt>
<dd>UNIX only: Sends all of the files in the current directory and all of its
subdirectories, etc (<a href="#x4.9">Section 4.9</a>).
</dl><p>

The /RECURSIVE switch is different from most other switches in that its effect
is immediate (but still local to the command in which it is given), because it
determines how filenames are to be parsed.  For example, "<tt>send *.txt</tt>"
fails with a parse error ("No files match") if there are no <tt>*.txt</tt>
files in the current directory, but "send /recursive *.txt" succeeds if there
are "<tt>.txt</tt>" files anywhere in the tree rooted at the current
directory.

<p>

The /RECURSIVE switch also affects the file lists displayed if you type
"<tt>?</tt>" in a filename field.  "<tt>send ./?</tt>" lists the regular files
in the current directory, but "<tt>send /recursive ./?</tt>" lists the entire
directory tree rooted at the current directory.

<p>
<hr>
<h4><a name="x4.11.3">4.11.3. The GET /RECURSIVE Command</a></h4>

In a client/server setting, the client can also request a recursive
transfer with:
<p>
<b>GET /RECURSIVE</b> <i>[ other switches ] remote-filespec [ local-spec ]</i>
<p>

In which remote file specification can be a directory name, a filename, a
wildcard, or any combination.  If the <i>local-spec</i> is not given (and
PATHNAMES are RELATIVE), incoming files and directories go into the current
local directory.  If <i>local-spec</i> is given and is a directory, it becomes
the root of the tree into which the incoming files and directories are placed.
If <i>local-spec</i> has the syntax of a directory name (e.g. in UNIX it ends
with /), C-Kermit creates the directory and then places the incoming files
into it.  If <i>local-spec</i> is a filename (not recommended), then all
incoming files are stored with that name with collisions handled according to
the FILE COLLISION setting.

<p>

Again, the normal method for transferring directory trees uses relative
pathnames, and this is the default when the sender has been given the
/RECURSIVE switch.  The action at the receiver depends on its RECEIVE
PATHNAMES setting.  The default is AUTO, meaning that if the sender tells
it to expect a recursive transfer, then it should automatically switch to
relative pathnames for this transfer only; otherwise it obeys the RECEIVE
PATHNAMES setting of OFF, ABSOLUTE, or RELATIVE.

<p>

What happens if a file arrives that has an absolute pathname, when the
receiver has been told to use only relative pathnames?  As a security
precaution, in this case the receiver treats the name as if it was relative.
For example, if a file arrives as:
<p><pre>
  /usr/olga/oofa.txt
</pre><p>
The receiver creates a "usr" subdirectory in its current directory, and
then an "olga" subdirectory under the "usr" subdirectory in which to store
the incoming file.
<p>
Suppose, however there is a sequence of directories:
<p><pre>
  /usr/olga/a/b/c/d/
</pre><p>
in which "a" contains nothing but a subdirectory "b", which in turn contains
nothing but a subdirectory "c", which in turn contains nothing but a
subdirectory "d", which contains nothing at all.  Thus there are no files in
the "/usr/olga/a/" tree, and so it is not sent, and therefore it is not
reproduced on the target computer.

<p>
<hr>
<h4><a name="x4.11.4">4.11.4. New and Changed File Functions</a></h4>

C-Kermit 7.0 adds the following functions:
<p><dl>
<dt><tt><b>\ffiles(</b><i>pattern[,&#38;a]</i><b>)</b></tt>
<dd>This function has been changed to match only regular files in the current
  or given directory, and to take an optional array name as a second argument
  (explained below).
<p>
<dt><tt><b>\fdirectories(</b><i>pattern[,&#38;a]</i><b>)</b></tt>
<dd>Returns the number of directories that match the given pattern.
  If the pattern does not include a directory, then the search is performed
  in the current directory.
<p>
<dt><tt><b>\frfiles(</b><i>pattern[,&#38;a]</i><b>)</b></tt>
<dd>Returns the number of files in the current or given directory and all of
  its subdirectories, and their subdirectories, etc, that match the given
  pattern.  Warning -- this one can take quite some time if performed at the
  root of a large directory tree.
<p>
<dt><tt><b>\frdirectories(</b><i>pattern[,&#38;a]</i><b>)</b></tt>
<dd>Returns the number of directories in the current or given directory and all
of its subdirectories, and their subdirectories, etc, that match the given
pattern.
</dl>

<p>
Each of these functions builds up a list of files to be returned by the
<tt>\fnextfile()</tt> function, just as <tt>\ffiles()</tt> always has done.
(This can also be done with the /ARRAY switch of the DIRECTORY command; see
<a href="#x4.5.1">Sections 4.5.1</a> and <a href="#x7.10">7.10</a>).
<p>
Each of these functions can be given an array name as an optional second
argument.  If an array name is supplied, the array will contain the number of
files as its 0th element, and the filenames in elements 1 through last.  If
the array already existed, its previous contents are lost.  For example, if
the current directory contains two files, oofa.txt and foo.bar, then
"<tt>\ffiles(*,&#38;a)</tt>" creates an array \&#38;a[] with a dimension of 2,
containing the following elements:
<p><pre>
 \&#38;a[0] = 2
 \&#38;a[1] = oofa.txt
 \&#38;a[2] = foo.bar
</pre><p>
If no files match the specification given in the first argument, the array
gets a dimension of 0, which is the same as undeclaring the array.
<p>
Note that the order in which the array is filled (and in which
<tt>\fnextfile()</tt> returns filenames) is indeterminate (but see 
<a href="#x7.10.5">Section 7.10.5</a>).
<p>
Here's an example that builds and prints a list of all the file whose names
end in .txt in the current directory and all its descendents:
<p><pre>
  asg \%n \frfiles(*.txt)
  declare \&#38;a[\%n]
  for \%i 1 \%n 1 {
      asg \&#38;a[\%i] \fnextfile()
      echo \flpad(\%i,4). "\&#38;a[\%i]"
  }
</pre><p>
Alternatively, using the array method, and then printing the filenames in
alphabetic order (see 
<a href="#x7.10.3">Section 7.10.3</a> and <a href="#x7.10.5">7.10.5</a>):
<p><pre>
  asg \%n \frfiles(*.txt,&#38;a)
  sort &#38;a
  for \%i 1 \%n 1 {
      echo \flpad(\%i,4). "\&#38;a[\%i]"
  }
</pre><p>
Or even more simply:
<p><pre>
  asg \%n \frfiles(*.txt,&#38;a)
  sort &#38;a
  show array &#38;a
</pre><p>
As noted elsewhere, the file lists built by <tt>\ffiles()</tt>,
<tt>\frfiles()</tt>, etc, are now "safe" in the sense that SEND and other
file-related commands can reference <tt>\fnextfile()</tt> without resetting
the list:
<p><pre>
  set send pathnames relative
  for \%i 1 \frfiles(*.txt) 1 {
      asg \%a \fnextfile()
      echo Sending \%a...
      send \%a
      if fail break
  }
</pre><p>
Copying to an array (as shown on p.398 of <a href="ckb2.html"><cite>Using C-Kermit</cite></a> 2nd Ed) is no
longer necessary.

<p>
<hr>
<h4><a name="x4.11.5">4.11.5. Moving Directory Trees Between Like Systems</a></h4>
<h4><a name="x4.11.5.1">4.11.5.1. UNIX to UNIX</a></h4>

Transferring a directory tree from one computer to another replicates the file
sender's arrangement of files and directories on the file receiver's computer.
Normally this is done using relative pathnames, since the user IDs might not
be identical on the two computers.  Let's say both computers are UNIX based,
running C-Kermit 7.0 or later.  On the sending computer (leaving out the
connection details, etc):
<p><pre>
  C-Kermit&#62; <u>cd /usr/olga</u>
  C-Kermit&#62; <u>send /recursive .</u>
</pre><p>
The /RECURSIVE switch tells C-Kermit to descend through the directory tree
and to include relative pathnames on outbound filenames.
<p>
On the receiving computer:
<p><pre>
  C-Kermit&#62; <u>mkdir olgas-files</u>           ; Make a new directory.
  C-Kermit&#62; <u>cd olgas-files</u>              ; CD to it.
  C-Kermit&#62; <u>receive /recursive</u>          ; = /PATHNAMES:RELATIVE
</pre><p>
Each Kermit program recognizes that the other is running under UNIX and
switches to binary mode and literal filenames automatically.  Directories
are automatically created on the receiving system as needed.  File dates
and permissions are automatically reproduced from source to destination.

<h4><a name="x4.11.5.2">4.11.5.2. VMS to VMS</a></h4>

To send recursively from VMS, simply include the /RECURSIVE switch, for
example at the sender:
<p><pre>
  $ <u>kermit</u>
  C-Kermit&#62; <u>cd [olga]</u>
  C-Kermit&#62; <u>send /recursive *.*;0</u>
</pre><p>
And at the receiver:
<p><pre>
  C-Kermit&#62; <u>cd [.olga]</u>
  C-Kermit&#62; <u>receive /recursive</u>
</pre><p>
The notation "<tt>...</tt>" within directory brackets in VMS means "this
directory and all directories below it"; the /RECURSIVE switch, when given to
the sender, implies the use of "<tt>...</tt>" in the file specification so you
don't have to include "<tt>...</tt>"; but it makes no difference if you do:
<p><pre>
  $ <u>kermit</u>
  C-Kermit&#62; <u>send /recursive [olga...]*.*;0</u>
</pre><p>
And at the receiver:
<p><pre>
  C-Kermit&#62; <u>cd [.olga]</u>
  C-Kermit&#62; <u>receive /recursive</u>
</pre><p>
In either case, since both systems recognize each other as VMS, they switch
into LABELED transfer mode automatically.

<p>
<hr>
<h4><a name="x4.11.6">4.11.6. Moving Directory Trees Between Unlike Systems</a></h4>

There are several difficulties with recursive transfers between unlike
systems:
<p><ul>
<li>File formats can be different, especially text files character sets and
record formats.  This can now be handled by using SET FILE PATTERN,
SET FILE TEXT-PATTERNS, and SET FILE BINARY-PATTERNS (<a
href="#x4.3">Section 4.3</a>).
<p>
<li>File naming conventions are different.  For example, one system might allow
   (and use) longer filenames than the other.  You can tell Kermit how to
   handle file names with the normal "set file names" and "set file
   collision" mechanisms.  Most modern Kermits are fairly tolerant of illegal
   filenames and should not fail simply because of an incoming filename;
   rather, it will do its best to convert it to a recognizable and unique
   legal filename.
<p>
<li>Directory notations can be different, e.g. backslashes instead of slashes,
brackets, parentheses, spaces, etc.  But this is now handled by converting
pathnames to a standard format during transfer (<a href="#x4.10">Section 4.10</a>).
</ul>
<p>

So now, for the first time, it is possible to send directory trees among
any combination of UNIX, DOS, Windows, OS/2, VMS, AOS/VS, etc.  Here's an
example sending files from an HP-UX system (where text files are encoded in
the HP Roman8 character set) to a PC with K95 (where text files are encoded
in CP850):
<p><pre>
 <u><i>Sender:</i></u>
  cd xxx                           ; CD to root of source tree
  set file type binary             ; Default transfer mode
  set file character-set hp-roman8 ; Local character set for text files
  set xfer character-set latin1    ; Transfer character set
  set file patterns on             ; Enable automatic file-type switching...
  set file binary-patterns *.Z *.gz *.o  ; based on these patterns...
  set file text-patterns *.txt *.c *.h   ; for binary and text files.
  send /recursive *                ; Send all the file in this directory tree

 <u><i>Receiver:</i></u>
  cd yyy                           ; CD to root of destination tree
  set file character-set cp850     ; Local character set for text files
  receive /pathnames:relative      ; Receive with pathnames
</pre><p>
Notes:<ul>
<li>Replace "xxx" and "yyy" with the desired directories.
<li>Replace the file character sets appropriately.
<li>Change the patterns as needed (or just use the built-in default lists).
<li>SEND /RECURSIVE also implies /PATHNAMES:RELATIVE.
<li>The file sender tells the file receiver the transfer mode of each file.
<li>The file sender tells the file receiver the transfer character set.
<li>By default, destination file dates will be the same as on the source.
<li>Many of the settings shown might already be set by default.
<li>See 
<a href="#x4.3">Sections 4.3</a>, <a href="#x4.10">4.10</a>, and <a
href="#x4.15">4.15</a> for additional explanation.
</ul><p>
If you are refreshing an existing directory on the destination computer,
use "set file collision update" or other appropriate file collision option
to handle filename collisions.

<p>
<hr>
<h3><a name="x4.12">4.12. Where Did My File Go?</a></h3>

Now that Kermit can be started by clicking on desktop icons (thus obscuring
the concept of "current directory"), and can have a download directory, and
can create directories for incoming files on the fly, etc, sometimes it is
easy to lose a file after transfer.  Of course, if you keep a transaction log:
<p><pre>
  LOG TRANSACTIONS
</pre><p>
it will record the fate and final resting place of each file.  But in case
you did not keep a log, the new command:
<p><pre>
  WHERE
</pre><p>
added in C-Kermit 7.0, gives you as much information as it has about the
location of the last files transferred, including the pathname reported by
the receiving Kermit, if any, when C-Kermit is the sender.  This information
was also added to SHOW FILE in somewhat less detail.

<p>
<hr>
<h3><a name="x4.13">4.13. File Output Buffer Control</a></h3>

(UNIX only).  The new command SET FILE OUTPUT lets you control how incoming
files are written to disk:
<p><dl>
<dt><b>SET FILE OUTPUT BUFFERED</b> <i>[ size ]</i>
<dd>Chooses buffered file output; this is the default.  UNIX does its normal
sort of disk buffering.  The optional <i>size</i> specifies Kermit's own file
output buffer size, and therefore the frequency of disk accesses
(<tt>write()</tt> system calls) -- the bigger the size, the fewer the disk
accesses.
<p>
<dt><b>SET FILE OUTPUT UNBUFFERED</b>  <i>[ size ]</i>
<dd>This forces each file output <tt>write()</tt> call to actually commit the
data to disk immediately.  Choosing this option will usually slow file
reception down.
<p>
<dt><b>SET FILE OUTPUT BLOCKING</b>
<dd><tt>Write()</tt> calls should not return until they are complete.  This is
the normal setting, and it lets Kermit detect disk-write errors immediately.
<p>
<dt><b>SET FILE OUTPUT NONBLOCKING</b>
<dd><tt>Write()</tt> calls should return immediately.  This can speed up file
reception, but also delay the detection of disk-write errors.
</dl><p>
Experimentation with these parameters should be harmless, and might (or might
not) have a perceptible, even dramatic, effect on performance.

<p>
<hr>
<h3><a name="x4.14">4.14. Improved Responsiveness</a></h3>

In version 7.0, C-Kermit's file-transfer protocol engine has been tuned
for additional speed and responsiveness.
<p><ul>
<li>Binary-mode transfers over 8-bit connections, a very common case, are
now handled in a special way that minimizes overhead.
<p>
<li>SET TRANSFER CRC-CALCULATION is now OFF by default, rather than ON.
(This affects only the overall per-transfer CRC, \v(crc16), not the
per-packet CRCs)
<p>
<li>Connection loss during file transfer is now detected immediately in most
cases on Internet connections and on serial connections when CARRIER-WATCH
is not set to OFF.
</ul>

<p>
<hr>
<h3><a name="x4.15">4.15. Doubling and Ignoring Characters for Transparency</a></h3>

The following commands were added in 7.0, primarily to allow successful
file transfer through ARPAnet TACs and with Honeywell DPS6 systems, but can
be used in any setting where they might be needed:
<p><dl>
<dt><b>SET SEND DOUBLE-CHAR</b> <i>{ [ char [ char [ ... ] ] ]</i>, <b>NONE</b> <i>}</i>
<dd>Tells C-Kermit to double the specified characters (use decimal notation)
in packets that it sends.  For example, if you are sending files through
a device that uses @ as an escape character, but allows you to send a
single copy of @ through by doubling it, use "set send double 64".
<p>
<dt><b>SET RECEIVE IGNORE-CHAR</b> <i>[ char [ char [ ... ] ] ]</i>
<dd>Tells C-Kermit to ignore the specified character(s) in incoming packets.
Use this, for example, when something between the sender and receiver is
inserting linefeeds for wrapping, NULs for padding, etc.
</dl>

<p>
<hr>
<h3><a name="x4.16">4.16. New File-Transfer Display Formats</a></h3>

<dl>
<dt><b>SET TRANSFER DISPLAY</b> <i>{</i> <b>BRIEF, CRT, FULLSCREEN, NONE, SERIAL</b> <i>}</i>
<dd>Selects the file-transfer display format.
</dl><p>

BRIEF is the new one.  This writes one line to the screen per file, showing
the file's name, transfer mode, size, the status of the transfer, and when the
transfer is successful, the effective data rate in characters per second (CPS).
Example:
<p><pre>
  SEND ckcfn3.o (binary) (59216 bytes): OK (0.104 sec, 570206 cps)
  SEND ckcfns.o (binary) (114436 bytes): OK (0.148 sec, 772006 cps)
  SEND ckcmai.c (text) (79147 bytes): OK (0.180 sec, 438543 cps)
  SEND ckcmai.o (binary) (35396 bytes): OK (0.060 sec, 587494 cps)
  SEND ckcnet.o (binary) (62772 bytes): REFUSED
  SEND ckcpro.o (binary) (121448 bytes): OK (0.173 sec, 703928 cps)
  SEND ckcpro.w (text) (63687 bytes): OK (0.141 sec, 453059 cps)
  SEND makefile (text) (186636 bytes): OK (0.444 sec, 420471 cps)
  SEND wermit (binary) (1064960 bytes): OK (2.207 sec, 482477 cps)
</pre><p>
Note that transfer times are now obtained in fractional seconds, rather than
whole seconds, so the CPS figures are more accurate (the display shows 3
decimal places, but internally the figure is generally precise to the
microsecond).

<p>
<hr>
<h3><a name="x4.17">4.17. New Transaction Log Formats</a></h3>

The new command:
<p><pre>
  <b>SET TRANSACTION-LOG</b> <i>{</i> <b>VERBOSE, FTP, BRIEF</b> <i>[ separator ] }</i>
</pre><p>
lets you choose the format of the transaction log.  VERBOSE (the default)
indicates the traditional format described in the book.  BRIEF and FTP are
new.  This command must be given prior to the LOG TRANSACTION command if a
non-VERBOSE type is desired.

<h4><a name="x4.17.1">4.17.1. The BRIEF Format</a></h4>

BRIEF chooses a one-line per file format suitable for direct importation into
databases like Informix, Oracle, or Sybase, in which:
<p><ul>
<li>Each record has 8 fields.
<li>Fields are separated by a non-alphanumeric separator character.
<li>The default separator character is comma (,).
<li>Any field containing the separator character is enclosed in doublequotes.
<li>The final field is enclosed in doublequotes.
<p></ul>
The fields are:
<p><ol>
<li>Date in yyyymmdd format
<li>Time in hh:mm:ss format
<li>Action: SEND or RECV
<li>The local filename
<li>The size of the file
<li>The transfer mode (text, binary, image, labeled)
<li>The status of the transfer: OK or FAILED
<li>Additional status-dependent info, in doublequotes.
</ol><p>
Examples:
<p><pre>
  20000208,12:08:52,RECV,/u/olga/oofa.txt,5246,text,OK,"0.284sec 18443cps"
  20000208,12:09:31,SEND,/u/olga/oofa.exe,32768,binary,OK,"1.243sec 26362cps"
  20000208,12:10:02,SEND,"/u/olga/a,b",10130,text,FAILED,"Refused: date"
</pre><p>
Note how the filename is enclosed in doublequotes in the final example,
because it contains a comma.
<p>
To obtain BRIEF format, you must give the SET TRANSACTION-LOG BRIEF command
before the LOG TRANSACTIONS command.  (If you give them in the opposite order,
a heading is written to the log by the LOG command.)

<p>
<hr>
<h4><a name="x4.17.2">4.17.2. The FTP Format</a></h4>

SET TRANSACTION-LOG FTP (available only in UNIX) chooses a format that is
compatible with the WU-FTPD (Washington University FTP daemon) log, and so can
be processed by any software that processes the WU-FTPD log.  It logs only
transfers in and out, both successful and failed (but success or failure is
not indicated, due to lack of a field in the WU-FTPD log format for this
purpose).  Non-transfer events are not recorded.
<p>
Unlike other logs, the FTP-format transaction log is opened in append mode
by default.  This allows you to easily keep a record of all your kermit
transfers, and it also allows the same log to be shared by multiple
simultaneous Kermit processes or (permissions permitting) users.  You can, of
course, force creation of a new logfile by specifying the NEW keyword after
the filename, e.g.
<p><pre>
  log transactions oofa.log new
</pre><p>
All records in the FTP-style log are in a consistent format.  The first field
is fixed-length and contains spaces; subsequent fields are variable length,
contain no spaces, and are separated by one or more spaces.  The fields are:
<p><dl>
<dt><b>Timestamp</b>
<dd>This is an asctime-style timestamp, example: "Wed Sep 16 20:19:05 1999"
  It is always exactly 24 characters long, and the subfields are always in
  fixed positions.
<p>
<dt><b>Elapsed time</b>
<dd>The whole number of seconds required to transfer the file, as a string
  of decimal digits, e.g. "24".
<p>
<dt><b>Connection</b>
<dd>The name of the network host to which C-Kermit is connected, or the name
  of the serial device through which it has dialed (or has a direct
  connection), or "/dev/tty" for transfers in remote mode.
<p>
<dt><b>Bytes transferred</b>
<dd>The number of bytes transferred, decimal digits, e.g. "1537904".
<p>
<dt><b>Filename</b>
<dd>The name of the file that was transferred, e.g.
  "/pub/ftp/kermit/a/README.TXT".  If the filename contains any spaces or
  control characters, each such character is replaced by an underscore ('_')
  character.
<p>
<dt><b>Mode</b>
<dd>The letter 'b' if the file was transferred in binary mode, or 'a'
  if it was transferred in text (ASCII) mode.
<p>
<dt><b>Options</b>
<dd>This field always contains an underscore ('_') character.
<p>
<dt><b>Direction</b>
<dd>The letter 'o' if the file was transferred Out, and 'i' if the file was
  transferred In.
<p>
<dt><b>User class</b>
<dd>The letter 'r' indicates the file was transferred by a Real user.
<p>
<dt><b>User identification</b>
<dd>The ID of the user who transferred the file.
<p>
<dt><b>Server identification</b>
<dd>The string "kermit".  This distinguishes a Kermit transfer log
  record from a WU-FTPD record, which contains "ftp" in this field.
<p>
<dt><b>Authentication class</b>
<dd>The digit '1' if we know the user's ID on the client system,
  otherwise '0'.  Currently, always '0'.
<p>
<dt><b>Authenticated user</b>
<dd>If the authentication class is '1', this is the user's ID on the client
  system.  Otherwise it is an asterisk ('*').  Currently it is always an
  asterisk.
</dl>
<p>
Examples:
<p><pre>
  Thu Oct 22 17:42:48 1998 0 * 94 /usr/olga/new.x a _ i r olga kermit 0 *
  Thu Oct 22 17:51:29 1998 1 * 147899 /usr/olga/test.c a _ o r olga kermit 0 *
  Thu Oct 22 17:51:44 1998 1 * 235 /usr/olga/test.o b _ i r olga kermit 0 *
  Fri Oct 23 12:10:25 1998 0 * 235 /usr/olga/x.ksc a _ o r olga kermit 0 *
</pre><p>
Note that an ftp-format transaction log can also be selected on the Kermit
command line as follows:
<p><pre>
  kermit --xferfile:<i>filespec</i>
</pre><p>
This is equivalent to:
<p><pre>
  SET TRANSACTION-LOG FTP
  LOG TRANSACTIONS <i>filespec</i> APPEND
</pre><p>
Conceivably it could be possible to have a system-wide shared Kermit log,
except that UNIX lacks any notion of an append-only file; thus any user who
could append to the log could also delete it (or alter it).  This problem
could be worked around using setuid/setgid tricks, but these would most likely
interfere with the other setuid/setgid tricks C-Kermit must use for getting
at dialout devices and UUCP logfiles.

<p>
<hr>
<h3><a name="x4.18">4.18. Unprefixing NUL</a></h3>

As of 6.1.193 Alpha.10, C-Kermit can finally send and receive file-transfer
packets in which NUL (ASCII 0) is unprefixed (no more NUL-terminated
packets!).  NUL is, of course, extremely prevalent in binary files such as
executables, and this has been a significant source of packet overhead.  For
example, when transferring itself (the SunOS C-Kermit executable) with minimal
prefixing and 9000-byte packets, we see:
<p><pre>
  File size:                       1064960
  Packet chars with 0 prefixed:    1199629  overhead = 12.65%
  Packet chars with 0 unprefixed:  1062393  overhead = -0.03%
</pre><p>
Transfer rates go up accordingly, not only because of the reduced amount of
i/o, but also because less computation is required on each end.

<p>
<hr>
<h3><a name="x4.19">4.19. Clear-Channel Protocol</a></h3>

Now that C-Kermit itself is capable of sending and receiving any byte at all
on a clear channel (<a href="#x4.18">Section 4.18</a>), it is, for the first
time, in a position to
negotiate a clear channel with the other Kermit, giving it permission (but not
requiring it) to unprefix any and all characters that it knows are safe.  In
general this means all but the Kermit start-of-packet character (normally
Ctrl-A), Carriage Return (not only Kermit's end-of-packet character, but also
treated specially on Telnet NVT links), and IAC (255, also special to Telnet).
<p>
By default, C-Kermit will say it has a clear channel only if it has opened a
TCP socket.  Since the Kermit program on the far end of a TCP/IP connection
generally does not know it has a TCP/IP connection, it will not announce a
clear channel unless it has been told to do so.  The command is:
<p>
<b>SET CLEAR-CHANNEL</b> <i>{</i> <b>ON, OFF, AUTO</b> <i>}</i>
<p>
AUTO is the default, meaning that the clear-channel status is determined
automatically from the type of connection.  ON means to announce a clear
channel, OFF means not to announce it.  Use SHOW STREAMING
(<a href="#x4.20">Section 4.20</a>)
to see the current CLEAR-CHANNEL status.  Synonym: <b>SET CLEARCHANNEL</b>.
<p>
CLEAR-CHANNEL is also set if you start C-Kermit with the -I switch (see
<a href="#x4.20">Section 4.20</a>).
<p>
Whenever a clear channel is negotiated, the resulting control-character
unprefixing is "sticky"; that is, it remains in effect after the transfer so
you can use SHOW CONTROL to see what was negotiated.
<p>
You can also see whether a clear channel was negotiated in the STATISTICS
/VERBOSE Display.
<p>
The advantage of the clear channel feature is that it can make file transfers
go faster automatically.  The disadvantage would be file-transfer failures if
the channel is not truly clear, for example if C-Kermit made a Telnet
connection to a terminal server, and then dialed out from there; or if
C-Kermit made an Rlogin connection to host and then made a Telnet connection
from there to another host.  If a file transfer fails on a TCP/IP connection,
use SHOW CONTROL to check whether control characters became unprefixed as a
result of protocol negotiations, and/or SHOW STREAMING
(<a href="#x4.20">Section 4.20</a>) to see
if "clear-channel" was negotiated.  If this happened, use SET CLEAR-CHANNEL
OFF and SET PREFIXING CAUTIOUS (or whatever) to prevent it from happening
again.

<p>
<hr>
<h3><a name="x4.20">4.20. Streaming Protocol</a></h3>

A new Kermit protocol option called "streaming" was added in C-Kermit 7.0.
The idea is that if the two Kermit partners have a reliable transport (such as
TCP/IP or X.25) between them, then there is no need to send ACKs for Data
packets, or NAKs, since a reliable transport will, by definition, deliver all
packets in order and undamaged.  On such a connection, streaming cuts down not
only on Kermit program overhead (switching back and forth between reading and
sending packets), but also tends to make the underlying transport use itself
more efficiently (e.g. by defeating the Nagle algorithm and/or Delayed ACK
stratagem of the TCP layer).  Furthermore, it allows transfers to work
smoothly on extremely slow network congestions that would otherwise cause
timeouts and retransmissions, and even failure when the retry limit was
exceeded.
<p>
The trick is knowing when we can stream:
<p><ol>
<li>If C-Kermit has opened a TCP socket or X.25 connection, it offers stream.
<p>
<li>If C-Kermit has been started with the -I (uppercase) option, or if it
has been told to SET RELIABLE ON, it offers to stream.
<p>
<li>If C-Kermit is in remote mode, and has been told to SET RELIABLE AUTO
(or ON), it always offers to stream, and also always agrees to stream,
if the other Kermit offers.  Unless you take explicit actions to override
the defaults, this allows the local Kermit (the one that made the
connection, and so knows whether it's reliable) to control streaming.
</ol><p>
(Note that an offer to stream also results in a Clear-Channel announcement if
CLEAR-CHANNEL is set to AUTO; see 
<a href="#x4.19">Section 4.19</a>.)
<p>
When BOTH Kermits offer to stream, then they stream; otherwise they don't.
Thus streaming-capable Kermit programs interoperate automatically and
transparently with nonstreaming ones.  If the two Kermits do agree to stream,
you'll see the word "STREAMING" on the fullscreen file-transfer display in the
Window Slots field.  You can also find out afterwards with the STATISTICS or
SHOW STREAMING commands.
<p><blockquote>
  WARNING: Automatic choice of streaming is based on the assumption of a
  "direct" end-to-end network connection; for example, a Telnet or Rlogin
  connection from host A to host B, and transferring files between A and
  B.  However, if your connection has additional components -- something
  "in the middle" (B) that you have made a network connection to, which
  makes a separate connection to the destination host (C), then you don't
  really have a reliable connection, but C-Kermit has no way of knowing
  this; transferring files between A and C will probably fail.  In such
  cases, you'll need to tell the *local* C-Kermit to "set reliable off"
  before transferring files (it does no good to give this command to the
  remote Kermit since the local one controls the RELIABLE setting).
</blockquote><p>

Streaming is like using an infinite window size, with no timeouts and no
tolerance for transmission errors (since there shouldn't be any).  It relies
on the underlying transport for flow control, error correction, timeouts, and
retransmission.  Thus it is very suitable for use on TCP/IP connections,
especially slow or bursty ones, since Kermit's packet timeouts won't interfere
with the transfer -- each packet takes as long to reach its destination as it
takes TCP to deliver it.  If TCP can't deliver the packet within its own
timeout period (over which Kermit has no control), it signals a fatal error.
Just like FTP.
<p>
Streaming goes much faster than non-streaming when a relatively small packet
length is used, and it tends to go faster than non-streaming with even the
longest packet lengths.  The Kermit window size is irrelevant to streaming
protocol, but still might affect performance in small ways since it can result
in different paths through the code.
<p>
The definition of "reliable transport" does not necessarily demand 8-bit and
control-character transparency.  Streaming can work with parity and/or
control-character prefixing just as well (but not as fast) as without them;
in such cases you can leave RELIABLE set to ON, but set CLEARCHANNEL and/or
PARITY appropriately.
<p>
Maximum performance -- comparable to and often exceeding FTP -- is achieved on
socket-to-socket connections (in which the considerable overhead of the
terminal driver and Telnet or Rlogin server is eliminated) with long packets
and the new "brief" file-transfer display (<a href="#x4.16">Section 4.16</a>).

<p>
<hr>
<h4><a name="x4.20.1">4.20.1. Commands for Streaming</a></h4>

<dl>
<dt><b>SET RELIABLE</b> <i>{</i> <b>ON, OFF, AUTO</b> <i>}</i>
<dd>SET RELIABLE ON tells Kermit that it has a reliable transport.<br>
SET RELIABLE OFF tells Kermit the transport is not reliable.<br>
SET RELIABLE AUTO tells Kermit that it should SET RELIABLE ON whenever
it makes a reliable connection (e.g. TELNET or SET HOST on a TCP/IP or
X.25 network), and when in remote mode it should believe the transport is
reliable if the other Kermit says it is during Kermit protocol negotiation.
</dl><p>
AUTO is the default; the Kermit program that makes the connection knows
whether it is reliable, and tells the remote Kermit.
<p>
The RELIABLE setting has several effects, including:
<p><ul>
<li>It can affect the timeouts used during normal ACK/NAK protocol.
<li>It can affect the clear-channel announcement.
<li>It can affect streaming.
</ul><p>
If you TELNET or SET HOST somewhere, this includes an implicit SET RELIABLE ON
command.  The -I command-line option is equivalent to SET RELIABLE ON.
<p>
Since SET RELIABLE ON (and -I) also implies SET CLEAR CHANNEL ON, you might
find that in certain cases you need to tell Kermit that even though the
connection is reliable, it doesn't have a clear channel after all:
<p><pre>
  SET CLEAR-CHANNEL OFF
  SET PREFIXING CAUTIOUS ; or whatever...
</pre><p>
You can control streaming without affecting the other items with:
<p><pre>
  SET STREAMING { ON, OFF, AUTO }
</pre><p>
AUTO is the default, meaning streaming will occur if Kermit has made a TCP/IP
connection or if RELIABLE is ON (or it was started with the -I command line
option).  OFF means don't stream; ON means offer to stream no matter what.

<p>
<hr>
<h4><a name="x4.20.2">4.20.2. Examples of Streaming</a></h4>

Here we look at the use and behavior of streaming on several different kinds
of connections, and compare its performance with non-streaming transfers.

<h4><a name="x4.20.2.1">4.20.2.1. Streaming on Socket-to-Socket Connections</a></h4>

Here we get streaming automatically when both Kermit programs are capable of
it, since they both make socket connections.  For example, on the far end:
<p><pre>
  C-Kermit&#62; <u>set host * 3000</u>
  C-Kermit&#62; <u>server</u>
</pre><p>
and on the near end:
<p><pre>
  C-Kermit&#62; <u>set host foo.bar.xyz.com 3000</u>
  (now give SEND and GET command)
</pre><p>
All subsequent file transfers use streaming automatically.
<p>
Here are the results from 84 trials, run on a production network,
disk-to-disk, in which a 1-MB binary file (the SunOS C-Kermit Sparc
executable) was sent from a Sun Sparc-10 with SunOS 4.1.3 to an IBM Power
Server 850 with AIX 4.1, socket-to-socket, over a 10Mbps 10BaseT Ethernet,
using minimal control-character unprefixing, window sizes from 10 to 32, and
packet sizes from 1450 to 9010:
<p><pre>
                <u><i>Streaming</i></u>    <u><i>Nonstreaming</i></u>
  Max CPS         748955        683354
  Min CPS         221522        172491
  Mean CPS        646134        558680
  Median CPS      678043        595874
  Std Dev         101424        111493
</pre><p>
Correlations:
<p><pre>
  CPS and window size:   -0.036
  CPS and packet length:  0.254
  CPS and streaming:      0.382
</pre><p>
Note that the relationship between streaming and throughput is significantly
stronger than that between CPS and window size or packet length.
<p>
Also note that this and all other performance measurements in this section
are snapshots in time; the results could be much different at other times when
the load on the systems and/or the network is higher or lower.
<p>
In a similar socket-to-socket trial, but this time over a wide-area TCP/IP
connection (from New York City to Logan, Utah, about 2000 miles), the
following results were obtained:
<p><pre>
                <u><i>Streaming</i></u>    <u><i>Nonstreaming</i></u>
  Max CPS         338226        318203
  Min CPS         191659        132314
  Mean CPS        293744        259240
  Median CPS      300845        273271
  Std Dev          41914         52351
</pre><p>
Correlations:
<p><pre>
  CPS and window size:    0.164
  CPS and packet length:  0.123
  CPS and streaming:      0.346
</pre>

<p>
<hr>
<h4><a name="x4.20.2.2">4.20.2.2. Streaming on Telnet Connections</a></h4>

In this case the local copy of Kermit is told to TELNET or SET HOST, and so it
knows it has a reliable connection and -- unless it has been told not to --
will offer to stream, and the other Kermit program, since it has STREAMING set
to AUTO, agrees.
<p>
Since we have a reliable connection, we'll also get control-character
unprefixing automatically because of the new clear-channel protocol
(<a href="#x4.19">Section 4.19</a>).
<p>
Any errors that occur during streaming are fatal to the transfer.  The
message is "Transmission error on reliable link".  Should this happen:
<p><ol>
<li>Check the remote Kermit's flow control setting (SHOW COMMUNICATIONS).
    If it is NONE, change it to XON/XOFF, or vice versa.  If it is XON/XOFF
    (or you just changed it to XOFF/XOFF), make sure the file sender is
    prefixing the XON and XOFF characters.  In the most drastic case, use
    "set prefix all" to force prefixing of all control characters.
<p>
<li>The remote Telnet server might chop off the 8th bit.  In that case, tell
    C-Kermit to "set parity space".  Or, you might be able to force the
    Telnet to allow eight-bit data by telling C-Kermit to "set telopt binary
    request accept" -- that is, request the Telnet server to enter binary
    mode, and accept binary-mode bids from the server.
<p>
<li>The remote Telnet server might have a buffering limitation.  If a and b
    don't cure the problem, tell the file receiver to "set receive
    packet-length 1000" (or other number -- use the largest one that works).
    This too, is no different from the non-streaming case (more about this
    in <a href="#x4.20.2.3">Section 4.20.2.3</a>).
</ol><p>
And remember you can continue interrupted binary-mode transfers where they
left off with the RESEND (= SEND /RECOVER) command.
<p>
Here are the figures for the same 84 trials between the same Sun and IBM
hosts as in 4.20.2.1, on the same network, but over a Telnet connection rather
than socket-to-socket:
<p><pre>
                  <u><i>Streaming</i></u>    <u><i>Nonstreaming</i></u>
  Max CPS         350088        322523
  Min CPS          95547        173152
  Mean CPS        321372        281830
  Median CPS      342604        291469
  Std Dev          40503         29948
</pre><p>
Correlations:
<p><pre>
  CPS and window size:    0.001
  CPS and packet length:  0.152
  CPS and streaming:      0.128
</pre><p>
Here the effect is not as emphatic as in the socket-to-socket case, yet on
the whole streaming tends to be beneficial.
<p>
Additional measurements on HP-UX using C-Kermit 7.0 Beta.06:
<p><pre>
                  <u><i>Windowing</i></u>     <u><i>Streaming</i></u>
  HP-UX 8-&#62;8      not tested       14Kcps
  HP-UX 8-&#62;9      not tested       76Kcps
  HP-UX 8-&#62;10      36Kcps          66Kcps
  HP-UX 9-&#62;9      not tested      190Kcps
  HP-UX 9-&#62;10     160Kcps         378Kcps
</pre>

<p>
<hr>
<h4><a name="x4.20.2.3">4.20.2.3. Streaming with Limited Packet Length</a></h4>

The IRIX telnet server (at least the ones observed in IRIX 5.3 and 6.2) does
not allow Kermit to send packets longer than 4096 bytes.  Thus when sending
from IRIX C-Kermit when it is on the remote end of a Telnet connection, the
packet length must be 4K or less.  Trials in this case (in which packet
lengths range from 1450 to 4000) show a strong advantage for streaming, which
would be evident in any other case where the packet length is restricted, and
stronger the shorter the maximum packet length.
<p><pre>
                  <u><i>Streaming</i></u>    <u><i>Nonstreaming</i></u>
  Max CPS         426187        366870
  Min CPS         407500        276517
  Mean CPS        415226        339168
  Median CPS      414139        343803
  Std Dev           6094         25851
</pre><p>
Correlations:
<p><pre>
  CPS and window size:    0.116
  CPS and packet length:  0.241
  CPS and streaming:      0.901
</pre><p>

<p>
<hr>
<h4><a name="x4.20.2.4">4.20.2.4. Streaming on Dialup Connections</a></h4>

Here "dialup" refers to a "direct" dialup connection, not a SLIP or PPP
connection, which is only a particular kind of TCP/IP connection.
<p>
Attempt this at your own risk, and then only if (a) you have error-correcting
modems, and (b) the connections between the modems and computers are also
error-free, perfectly flow-controlled, and free of interrupt conflicts.
Streaming can be used effectively and to fairly good advantage on such
connections, but remember that the transfer is fatal if even one error is
detected (also remember that should a binary-mode transfer fail, it can be
recovered from the point of failure with RESEND).
<p>
To use streaming on an unreliable connection, you must tell both Kermits that
the connection is reliable:
<p><pre>
  kermit -I
</pre><p>
or:
<p><pre>
  C-Kermit&#62; <u>set reliable on</u>
</pre><p>
In this case, it will probably be necessary to prefix some control characters,
for example if your connection is through a terminal server that has an escape
character.  Most Cisco terminal servers, for example, require Ctrl-^ (30, as
well as its high-bit equivalent, 158) to be prefixed.  To unprefix these,
you'll need to defeat the "clear channel" feature:
<p><pre>
  C-Kermit&#62; <u>set reliable on</u>
  C-Kermit&#62; <u>set clear-channel off</u>
  C-Kermit&#62; <u>set prefixing none</u>
  C-Kermit&#62; <u>set control prefix 1 13 30 158</u> ; and whatever else is necessary
</pre><p>
Dialup trials were done using fixed large window and packet sizes.  They
compare uploading and downloading of two common types of files, with and
without streaming.  Configuration:
<p><blockquote>
  HP-9000/715/33 -- 57600bps, RTS/CTS -- USR Courier V.34 -- V.34+V.42,
  31200bps -- USR V.34+ Rackmount -- 57600bps, RTS/CTS -- Cisco terminal
  server -- Solaris 2.5.1.  Packet size = 8000, Window Size = 30, Control
  Character Unprefixing Minimal (but including the Cisco escape character).
</blockquote><p>
Since this is not a truly reliable connection, a few trials failed when a bad
packet was received (most likely due to UART overruns); the failure was
graceful and immediate, and the message was informative.  The results of ten
successful trials uploading and downloading the two files with and without
streaming are:
<p><pre>
	    <i>Streaming..</i>
            <u>Off    On</u>
   <i>Upload</i>   5194   5565   txt (= C source code, 78K)
            3135   3406   gz  (= gzip file, compressed, 85K)
 <i>Download</i>   5194   5565   txt
            3041   3406   gz
</pre><p>
Each CPS figure is the mean of 10 results.
<p>
A brief test was also performed on a LAT-based dialout connection from a VAX
3100 with VMS 5.5 to a USR Courier V.34 connected to a DECserver 700 at 19200
bps.  The 1-MB Sparc executable downloaded from a Sun to the VAX at 1100cps
without streaming and 1900cps with streaming, using 8000-byte packets, 30
window slots, and minimal prefixing in both cases.

<p>
<hr>
<h4><a name="x4.20.2.5">4.20.2.5. Streaming on X.25 Connections</a></h4>

We have only limited access to X.25 networks.  One trial was performed in
which the 1MB Solaris 2.4 Sparc executable was transferred over a SunLink X.25
connection; nothing is known about the actual physical connection.  With a
packet length of 8000 and a window size of 30, the file transferred at 6400
cps (using a maximum of 6 window slots).  With the same packet length, but
with streaming, it transferred without mishap at 6710 cps, about 5% faster.

<p>
<hr>
<h4><a name="x4.20.3">4.20.3. Streaming - Preliminary Conclusions</a></h4>

The results vary with the particular connection, but are good overall.
Although numerous lower-level tricks can be used to improve performance on
specific platforms or connection methods, streaming occurs at a high,
system-independent level of the Kermit protocol and therefore can apply to all
types of platforms and (reliable) connections transparently.

<p>
<hr>
<h3><a name="x4.21">4.21. The TRANSMIT Command</a></h3>

Prior to C-Kermit 7.0, the TRANSMIT command transmitted in text or binary
mode according to SET FILE TYPE { TEXT, BINARY }.  But now that binary mode
is likely to be the default for protocol transfers, it is evident that this
not also an appropriate default for TRANSMIT, since binary-mode TRANSMIT is
a rather specialized and tricky operation.  Therefore, TRANSMIT defaults to
text mode always, regardless of the FILE TYPE setting.
<p>
C-Kermit 7.0 expands the capabilities of the TRANSMIT command by adding the
following switches (see <a href="#x1.5">Section 1.5</a>).  The new syntax is:
<p><pre>
  TRANSMIT [ switches... ] filename
</pre><p>
Zero or more switches may be included:
<p><dl>
<dt><b>/PIPE</b>
<dd>When /PIPE is included, "filename" is interpreted as a system command
or program whose output is to be sent.  Synonym: <b>/COMMAND</b>.  Example:
<p><pre>
  transmit /pipe finger
</pre><p>
You may enclose the command in braces, but you don't have to:
<p><pre>
  xmit /pipe {ls -l | sort -r +0.22 -0.32 | head}
</pre><p>
<dt><b>/BINARY</b>
<dd>Transmits the file (or pipe output) in binary mode.
<p>
<dt><b>/TEXT</b>
<dd>Transmits the file (or pipe output) in line-oriented text mode.
  Current FILE CHARACTER-SET and TERMINAL CHARACTER-SET selections govern
  translation.  Default.
<p>
<dt><b>/TRANSPARENT</b>
<dd>Specifies text mode without character-set translation, no matter what the
  FILE and TERMINAL CHARACTER-SET selections are.
<p>
<dt><b>/NOWAIT</b>
<dd>This is equivalent to SET TRANSMIT PROMPT 0, but for this TRANSMIT command
  only.  Applies only to text mode; it means to not wait for any kind of
  echo or turnaround character after sending a line before sending the next
  line.  (Normally Kermit waits for a linefeed.)
</dl><p>
When TRANSMIT ECHO is ON, C-Kermit tries to read back the echo of each
character that is sent.  Prior to C-Kermit 7.0, 1 second was allowed for each
echo to appear; if it didn't show up in a second, the TRANSMIT command would
fail.  Similarly for the TRANSMIT PROMPT character.  However, with today's
congested Internet connections, etc, more time is often needed:
<p>
<dt><b>SET TRANSMIT TIMEOUT</b> <i>number</i>
<dd>Specifies the number of seconds to wait for an echo or the prompt character
  when TRANSMIT PROMPT is nonzero; the default wait is 1 second.  If you
  specify 0, the wait is indefinite.  When a timeout interval of 0 is
  specified, and a desired echo or prompt does not show up, the TRANSMIT
  command will not terminate until or unless you interrupt it with Ctrl-C;
  use SET TRANSMIT TIMEOUT 0 with caution.
</dl><p>
Note: to blast a file out the communications connection without any kind of
synchronization or timeouts or other manner of checking, use:
<p><pre>
  SET TRANSMIT ECHO OFF
  SET TRANSMIT PROMPT 0 (or include the /NOWAIT switch)
  SET TRANSMIT PAUSE 0
  TRANSMIT <i>[ switches ] filename</i>
</pre><p>
In this case, text-file transmission is not-line oriented and large blocks
can be sent, resulting in a significant performance improvement over
line-at-at-time transmission.  Successful operation depends (even more than
usual for the TRANSMIT command!) on a clean connection with effective flow
control.
<p>
For details on TRANSMIT and character sets, see
<a href="#x6.6.5.4">Section 6.6.5.4</a>.

<p>
<hr>
<h3><a name="x4.22">4.22. Coping with Faulty Kermit Implementations</a></h3>

Kermit protocol has been implemented in quite a few third-party commercial,
shareware, and freeware software packages, with varying degrees of success.
In most cases operation is satisfactory but slow -- only the bare minimum
subset of the protocol is available -- short packets, no sliding windows,
no attributes, etc.  In other cases, the implementation is incorrect,
resulting in failures at the initial negotiation stage or corrupted files.
<p>
C-Kermit 7.0 and Kermit 95 1.1.19 include some new defense mechanisms to
help cope with the most common situations.  However, bear in mind there is
only so much we can do in such cases -- the responsibility for fixing the
problem lies with the maker of the faulty software.

<p>
<hr>
<h4><a name="x4.22.1">4.22.1. Failure to Accept Modern Negotiation Strings</a></h4>

The published Kermit protocol specification states that new fields can be
added to the parameter negotiation string.  These are to be ignored by any
Kermit implementation that does not understand them; this is what makes the
Kermit protocol extensible.  Unfortunately, some Kermit implementations become
confused (or worse) when receiving a negotiation string longer than the one
they expect.  You can try working around such problems by telling Kermit to
shorten its negotiation string (and thus disable the corresponding new
features):
<p><pre>
  SET SEND NEGOTIATION-STRING-MAX-LENGTH number
</pre><p>
Try a number like 10.  If that doesn't work, try 9, 8, 7, 6, and so on.

<p>
<hr>
<h4><a name="x4.22.2">4.22.2. Failure to Negotiate 8th-bit Prefixing</a></h4>

The published Kermit protocol specification states that 8th-bit prefixing
(which allows transfer of 8-bit data over a 7-bit connection) occurs if the
file sender puts a valid prefix character (normally "&#38;") in the
8th-bit-prefix field of the negotiation string, and the receiver puts either a
letter "Y" or the same prefix character.  At least one faulty Kermit
implementation exists that does not accept the letter "Y".  To force C-Kermit
/ K-95 to reply with the other Kermit's prefix character rather than a "Y",
give the following (invisible) command:
<p><pre>
  SET Q8FLAG ON
</pre><p>
Use SET Q8FLAG OFF to restore the normal behavior.

<p>
<hr>
<h4><a name="x4.22.3">4.22.3. Corrupt Files</a></h4>

Refer to 
<a href="#x4.22.2">Section 4.22.2</a>.  Some Kermit implementations mistakenly
interpret the 
"Y" as a prefix character.  Then, whenever a letter Y appears in the data, the 
Y and the character that follows it are replaced by a garbage character.  At
this writing, we are not sure if there is any solution, but try "set send
negotiation-string-max-length 6" and/or "set q8flag on".
<p>
File corruption can also occur when control characters within the file data
are sent without prefixing, as at least some are by default in C-Kermit 7.0
and K-95.  Some Kermit implementations do not handle incoming "bare" control
characters.  To work around, "set prefixing all".

<p>
<hr>
<h4><a name="x4.22.4">4.22.4. Spurious Cancellations</a></h4>

The Kermit protocol specification states that if an ACK to a Data packet
contains X in its data field, the transfer of the current file is canceled,
and if it contains a Z, the entire transfer is canceled.  At least one
overzealous Kermit implementation applies this rule to non-Data packets as
well, the typical symptom being that any attempt to transfer a file whose name
begins with X or Z results in cancellation.  This is because the file receiver
typically sends back the name under which it stored the file (which might not
be the same as the name it was sent with) in the ACK to the File Header
packet.  This is information only and should not cause cancellation.  To work
around the problem, use:
<p><pre>
  SET F-ACK-BUG <i>{</i> ON, OFF <i>}</i>
</pre><p>
ON tells Kermit not to send back the filename in the ACK to the file header
packet as it normally would do (OFF puts Kermit back to normal after using ON).
<p>
A variation on the this bug occurs in an obscure Kermit program for MUMPS:
When this Kermit program sends a file called (say) FOO.BAR, it requires that
the ACK to its F packet contain exactly the same name, FOO.BAR.  However,
C-Kermit likes to send back the full pathname, causing the MUMPS Kermit to
fail.  SET F-ACK-BUG ON doesn't help here.  So a separate command has been
added to handle this situation:
<p><pre>
  SET F-ACK-PATH <i>{</i> ON, OFF <i>}</i>
</pre><p>
Normally it is ON (regardless of the SET SEND PATHNAMES setting).  Use
SET F-ACK-PATH OFF to instruct Kermit to send back only the filename without
the path in the ACK to the F packet.

<p>
<hr>
<h4><a name="x4.22.5">4.22.5. Spurious Refusals</a></h4>

Some Kermit implementations, notably PDP-11 Kermit 3.60 and earlier, have bugs
in their handling of Attribute packets that can cause unwarranted refusal of
incoming files, e.g. based on date or size.  This can be worked around by
telling one or both of the Kermit partners to:
<p><pre>
  SET ATTRIBUTES OFF
</pre>

<p>
<hr>
<h4><a name="x4.22.6">4.22.6. Failures during the Data Transfer Phase</a></h4>

This can be caused by control-character unprefixing (<a
href="#x4.22.3">Section 4.22.3</a> ), and fixed by:
<p><pre>
  SET PREFIXING ALL
</pre><p>
It can also have numerous other causes, explained in Chapter 10 of
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>: the connection is not 8-bit transparent (so use "set parity space"
or somesuch), inadequate flow control, etc.  Consult the manual.

<p>
<hr>
<h4><a name="x4.22.7">4.22.7. Fractured Filenames</a></h4>

At least one well-known PC-based communications package negotiates data
compression, which (according to the protocol specification) applies to both
the filename and the file data, but then fails to decompress the filename.
Example: C-Kermit sends a file called <tt>R000101.DAT</tt> (where
<tt>000101</tt> might be non-Y2K-wise YYMMDD notation), and the package in
question stores the files as <tt>R~#0101.DAT</tt>.  Workaround: Tell C-Kermit
to SET REPEAT COUNTS OFF.

<p>
<hr>
<h4><a name="x4.22.8">4.22.8. Bad File Dates</a></h4>

At least one well-known PC-based communications package negotiates the
passing of file timestamps from sender to receiver, but when it is sending
files, it always gives them a timestamp of 1 February 1970.  Workaround:
tell C-Kermit to SET ATTRIBUTE DATE OFF.  You don't get the file's real date,
but you also don't get 1 Feb 1970; instead the file gets the current date
and time.

<p>
<hr>
<h3><a name="x4.23">4.23. File Transfer Recovery</a></h3>

Prior to C-Kermit 7.0, RESEND (SEND /RECOVER) and REGET (GET /RECOVER) refused
to work if FILE TYPE was not BINARY or the /BINARY switch was not included.
Now these commands include an implied /BINARY switch, meaning they set the
file type to binary for the duration of the command automatically.
<p>
In the client/server arrangement, this also forces the server into binary
mode (if it is C-Kermit 7.0 or greater, or K95 1.1.19 or greater) so the
recovery operation proceeds, just as you asked and expected.
<p>
BUT...  Just as before, the results are correct only under the following
conditions:
<p><ul>
<li>If the prior interrupted transfer was also in binary mode; or:
<p>
<li>If the prior transfer was in text mode and the other computer was
   a "like platform" (e.g. UNIX-to-UNIX, Windows-to-Windows, DOS-to-Windows)
   AND there was no character-set translation (i.e. TRANSFER CHARACTER-SET
   was TRANSPARENT).
</ul><p>
Note that these circumstances are more likely to obtain in C-Kermit 7.0,
in which:
<p><ul>
<li>The default FILE TYPE in C-Kermit 7.0 is BINARY.
<p>
<li>The default FILE INCOMPLETE setting is AUTO, which means KEEP if the
   transfer is in binary mode, DISCARD otherwise.
<p>
<li>C-Kermit 7.0, Kermit 95 1.1.17, and MS-DOS Kermit 3.15 and later can
   recognize "like platforms" and switch into binary mode automatically.
   Transfers between like platforms are always binary unless character-set
   translation has been requested, and then is still binary for all files
   whose names match a binary pattern, unless the automatic mechanisms
   have been disabled (with a /TEXT switch, or with SET TRANSFER MODE
   MANUAL).
<p>
<li>SEND /BINARY and GET /BINARY always force binary-mode transfers,
   even when FILE TYPE is TEXT, even when TRANSFER MODE is AUTOMATIC,
   even when PATTERNS are ON and the file's name matches a text pattern.
</ul><p>
But also note that the automatic client/server transfer-mode adjustments
do not work with versions of C-Kermit prior to 7.0 or K95 prior to 1.1.16.
<p>
If the prior transfer was in text mode:
<p><ul>
<li>If text-mode transfers between the two platforms are "length-changing"
   (as they are between UNIX -- which terminates text lines with LF -- and
   DOS or Windows -- which terminates text lines with CRLF), the recovered
   file will be corrupt.
<p>
<li>If text-mode transfers between the two platforms are not length-changing,
   but character-set translation was active in the prior transfer, the result
   will be a file in which the first part has translated characters and the
   second part does not.
</ul><p>
But in C-Kermit 7.0 and K95 1.1.19 and later, incompletely transferred text
files are not kept unless you change the default.  But if you have done this,
and you have an incompletely transferred text file, you'll need to:
<p><ul>
<li>Transfer the whole file again in text mode, or:
<p>
<li>Use SEND /STARTING-AT: to recover the transfer at the correct point;
   but you have to find out what that point is, as described in the
   manual.
</ul><p>
Kermit has no way of knowing whether the previous transfer was in text or
binary mode so it is your responsibility to choose the appropriate recovery
method.
<p>
If you use C-Kermit to maintain parallel directories on different computers,
using SET FILE COLLISION to transfer only those files that changed since last
time, and the files are big enough (or the connection slow enough) to require
SEND /RECOVER to resume interrupted transfers, you should remember that SEND
/RECOVER (RESEND) overrides all FILE COLLISION settings.  Therefore you
should use SEND /RECOVER (RESEND) only on the file that was interrupted, not
the file group.  For example, if the original transfer was initiated with:
<p><pre>
  SEND *
</pre><p>
and was interrupted, then after reestablishing your connection and starting
the Kermit receiver with SET FILE COLLISION UPDATE on the remote end, use the
following sequence at the sender to resume the transfer:
<p><pre>
  SEND /RECOVER <i>name-of-interrupted-file</i>
</pre><p>
and then:
<p><pre>
  SEND *
</pre><p>
(In C-Kermit 7.0 and later, \v(filename) contains the name of the file
most recently transferred, as long you have not EXITed from Kermit or
changed directory, etc.

<p>
<hr>
<h3><a name="x4.24">4.24. FILE COLLISION UPDATE Clarification</a></h3>

In UNIX, file modification dates are used when comparing the file date with
the date in the attribute packet.  In VMS, however, the file creation date
is used.  These two policies reflect the preferences of the two user
communities.
<p>
Also, remember that the file date/time given in the attribute packet is the
local time at the file sender.  At present, no timezone conversions are
defined in or performed by the Kermit protocol.  This is primarily because
this feature was designed at a time when many of the systems where Kermit runs
had no concept of timezone, and therefore would be unable to convert (say,
to/from GMT or UTC or Zulu time).
<p>
As a consequence, some unexpected results might occur when transferring files
across timezones; e.g. commands on the target system that are sensitive to
file dates might work (UNIX "make", backups, etc).
<p>
Timezone handling is deferred for a future release.

<p>
<hr>
<h3><a name="x4.25">4.25. Autodownload Improvements</a></h3>

Refer to pages 164-165 of <a href="ckb2.html"><cite>Using C-Kermit</cite></a> about the hazards of autodownload
when C-Kermit is "in the middle".  As of C-Kermit 7.0, no more hazards.  If
C-Kermit has TERMINAL AUTODOWNLOAD ON and it detects a packet of the current
protocol type (Kermit or Zmodem), it "erases" the visual aspect of the packet
that would be seen by the terminal (or, more to the point, the emulator, such
as K95).  This way, only C-Kermit goes into RECEIVE mode, and not also the
terminal emulator through which C-Kermit is accessed.  And therefore, it is no
longer necessary to SET TERMINAL AUTODOWNLOAD OFF to prevent multiple Kermits
from going into receive mode at once, but of course it is still necessary to
ensure that, when you have multiple Kermits in a chain, that the desired one
receives the autodownload.
<p>
The defaults have not been changed; Kermit 95 still has autodownload ON by
default, and C-Kermit has it OFF by default.

<p>
<hr>
<h3><a name="x5">5. CLIENT/SERVER</a></h3>
<h3><a name="x5.0">5.0. Hints</a></h3>

If you use SET SERVER GET-PATH to set up your server, and the GET-PATH does
not include the server's current directory, clients can become quite confused.
For example, "remote dir oofa.txt" shows a file named oofa.txt, but "get
oofa.txt" fails.  In this situation, you should either DISABLE DIR or make
your GET-PATH include the current directory.

<p>
<hr>
<h3><a name="x5.1">5.1. New Command-Line Options</a></h3>

The -G command-line option is like -g (GET), except the incoming file is
sent to standard output rather than written to disk.
<p>
The -I option ("Internet") is used to tell a remote C-Kermit program that you
are coming in  via Internet Telnet or Rlogin and therefore have a reliable
connection.  The -I option is equivalent to SET RELIABLE ON and SET FLOW
NONE.
<p>
The -O option ("Only One") tells C-Kermit to enter server mode but then exit
after the first client operation.
<p>
See <a href="#x9.3">Section 9.3</a> for details.

<p>
<hr>
<h3><a name="x5.2">5.2. New Client Commands</a></h3>

BYE and FINISH no longer try to do anything if a connection is not active.
Thus a sequence like "hangup" followed by "bye" or "finish" will no longer get
stuck in a long timeout-and-retransmission cycle, nor will it try to open a
new connection.
<p><dl>
<dt><b>REMOTE EXIT</b>
<dd>Similar to FINISH, except it ensures that the Kermit server program exits
  back to the operating system or shell prompt.  (FINISH would return it to
  its interactive prompt if it was started in interactive mode, and would
  cause it to exit if it entered server mode via command-line option.)  When
  C-Kermit is to be the server, you can use { ENABLE, DISABLE } EXIT to
  control the client's access to this feature.
<p>
<dt><b>REMOTE MKDIR</b> <i>directory-name</i>
<dd>Tells the client to ask the server to create a directory with the given
name, which can be absolute or relative.  The syntax of the directory name
depends on the Kermit server (see <a href="x5.2.1">next section</a>); in all
cases, it can be in the syntax of the system where the server is running
(UNIX, VMS, DOS, etc) but newer servers also accept UNIX syntax, no matter
what the underlying platform.  The server will not execute this command if (a)
it does not understand it, (b) a DISABLE MKDIR command has been given, or (c)
a DISABLE CWD command has been given; otherwise, the command is executed, but
will fail if the directory can not be created, in which cases most servers
will attempt to return a message giving the reason for failure.  The REMOTE
MKDIR command succeeds if the remote directory is created, or if it already
exists and therefore does not need to be created, and fails otherwise.
<p>
<dt><b>REMOTE RMDIR</b> <i>directory-name</i>
<dd>Tells the client to ask the server to remove (delete) a directory with the
given name.  The same considerations apply as for REMOTE MKDIR.
<p>
<dt><b>REMOTE SET FILE INCOMPLETE</b> <i>{</i> <b>DISCARD, KEEP, AUTO</b> <i>}</i>
<dd>Previously this was only available in its earlier form, REMOTE SET
INCOMPLETE (no FILE).  The earlier form is still available, but invisible.
Also, AUTO was added, meaning KEEP if in binary mode, DISCARD otherwise.
<p>
<dt><b>REMOTE SET TRANSFER MODE</b> <i>{</i> <b>AUTOMATIC, MANUAL</b> <i>}</i>
<dd>Tells the client to ask the server to set the given file-transfer mode.
Automatic means (roughly): if the client and the server are running on the
same kind of computer (e.g. both are on UNIX), then use binary mode
automatically; if the system types are different, use some other method
to automatically determine text or binary mode, such as filename pattern
matching.  MANUAL means, in this context, obey the client's FILE TYPE
setting (TEXT or BINARY).  Synonym: <b>REMOTE SET XFER MODE</b>.
<p>
<dt><i>[</i> <b>REMOTE</b> <i>]</i> <b>QUERY KERMIT</b> <i>function</i><t>(</t><i>args</i><t>...)</t>
<dd>Prior to C-Kermit 7.0, the arguments were not evaluated locally.  Thus it
was not possible to have the server run the function with client-side
variables as arguments.  Now:
<p><pre>
  define \%a oofa.*
  remote query kermit files(\%a)    ; Client's \%a
  remote query kermit files(\\%a)   ; Server's \%a
</pre><p>
<dt><i>[</i> <b>REMOTE</b> <i>]</i> <b>LOGIN</b> <i>[ user [ password ] ]</i>
<dd>LOGIN is now a synonym for REMOTE LOGIN.
<p>
<dt><b>LOGOUT</b>
<dd>This command, when given in local mode, is equivalent to REMOTE LOGOUT.
  When given at the IKSD prompt, it logs out the IKSD.  When given at the
  C-Kermit prompt when it has no connection, it does nothing.
</dl><p>
Note that in C-Kermit 7.0, the REMOTE (or R) prefix is not required for QUERY,
since there is no local QUERY command.  The new top-level QUERY command does
exactly what REMOTE QUERY (RQUERY) does.
<p>
All REMOTE commands now have single-word shortcuts:
<p><pre>
 <u>Shortcut</u>   <u>Full Form</u>
  RASG       REMOTE ASSIGN
  RCD        REMOTE CD
  RCOPY      REMOTE COPY
  RDEL       REMOTE DELETE
  RDIR       REMOTE DIRECTORY
  REXIT      REMOTE EXIT
  RHELP      REMOTE HELP
  RHOST      REMOTE HOST
  RPWD       REMOTE PWD
  RSET       REMOTE SET
  etc.
</pre><p>
The R prefix is not applied to LOGIN because there is already an RLOGIN
command with a different meaning.  It is not applied to LOGOUT either, since
LOGOUT knows what to do in each case, and for symmetry with LOGIN.

<p>
<hr>
<h4><a name="x5.2.1">5.2.1. Remote Procedure Definitions and Calls</a></h4>

This is nothing new, but it might not be obvious...  REMOTE ASSIGN and REMOTE
QUERY may be used to achieve remote procedure execution.  The remote procedure
can be defined locally or remotely.
<p>
A remote procedure call is accomplished as noted in the previous section:
<p><pre>
  <i>[</i> remote <i>]</i> query kermit <i>function-name</i>(<i>args...</i>)
</pre><p>
This invokes any function that is built in to the Kermit server, e.g.:
<p><pre>
  <i>[</i> remote <i>]</i> query kermit size(foo.bar)
</pre><p>
returns the size of the remote file, foo.bar.
<p>
Now note that C-Kermit includes an <tt>\fexecute()</tt> function, allowing it
to execute any macro as if it were a built-in function.  So suppose MYMACRO
is the name of a macro defined in the server.  You can execute it from
the client as follows (the redundant "remote" prefix is omitted in the
remaining examples):
<p><pre>
  query kermit execute(mymacro <i>arg1 arg2</i>...)
</pre><p>
The return value, if any, is the value of the RETURN command that terminated
execution of the macro, for example:
<p><pre>
  define addtwonumbers return \feval(\%1+\%2)
</pre><p>
The client invocation would be:
<p><pre>
  query kermit execute(addtwonumbers 3 4)
  7
</pre><p>
The result ("7" in this case) is also assigned to the client's
<tt>\v(query)</tt> variable.
<p>
To execute a remote system command or command procedure (shell script, etc)
use:
<p><pre>
  query kermit command(<i>name args</i>...)
</pre><p>
Finally, suppose you want the client to send a macro to the server to be
executed on the server end.  This is done as follows:
<p><pre>
  remote assign <i>macroname definition</i>
  query kermit execute(<i>macroname arg1 arg2...</i>)
</pre><p>
Quoting is required if the definition contains formal parameters.

<p>
<hr>
<h3><a name="x5.3">5.3. New Server Capabilities</a></h3>
<h4><a name="x5.3.1">5.3.1. Creating and Removing Directories</a></h4>

The C-Kermit 7.0 server responds to REMOTE MKDIR and REMOTE RMDIR commands.
The directory name may be in either the native format of the server's
computer, or in UNIX format.  For example, a server running on VMS with a
current directory of [IVAN] can accept commands from the client like:
<p><pre>
  remote mkdir olga         ; Makes [IVAN.OLGA] (nonspecific format)
  remote mkdir .olga        ; Makes [IVAN.OLGA] (VMS format without brackets)
  remote mkdir olga/        ; Makes [IVAN.OLGA] (UNIX relative format)
  remote mkdir /ivan/olga   ; Makes [IVAN.OLGA] (UNIX absolute format)
  remote mkdir [ivan.olga]  ; Makes [IVAN.OLGA] (VMS absolute format)
  remote mkdir [.olga]      ; Makes [IVAN.OLGA] (VMS relative format)
</pre>

<h4><a name="x5.3.1.1">5.3.1.1. Creating Directories</a></h4>

If a directory name is given that contains more than one segment that does not
exist, the server attempts to create all the segments.  For example, if the
client says:
<p><pre>
  REMOTE MKDIR letters/angry
</pre><p>
a "letters" subdirectory is created in the server's current directory if it
does not already exist, and then an "angry" subdirectory is created beneath
it, if it does not already have one.  This can repeated to any reasonable
depth:
<p><pre>
  REMOTE MKDIR a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/z/y/z
</pre><p>

<h4><a name="x5.3.1.2">5.3.1.2. Removing Directories</a></h4>

When attempting to execute a REMOTE RMDIR, the server can remove only a single
directory, not an entire sequence or tree.  The system service that is called
to remove the directory generally requires not only that the server process
has write delete access, but also that the directory contain no files.
<p>
In the future, a REMOTE RMDIR /RECURSIVE command (and the accompanying
protocol) might be added.  For now, use the equivalent REMOTE HOST command(s),
if any.

<p>
<hr>
<h4><a name="x5.3.2">5.3.2. Directory Listings</a></h4>

Directory listings are generated by C-Kermit itself, rather than by running
the underlying system's directory command.  Some control over the listing
format can be obtained with the SET OPTIONS DIRECTORY command
(<a href="#x4.5.1">Section 4.5.1</a>).
The following options affect listings sent by the server: /[NO]HEADING,
/[NO]DOTFILES, and /[NO]BACKUP.  In UNIX and VMS, the listing is always sorted
by filename.  There is, at present, no protocol defined for the client to
request listing options of the server; this might be added in the future.
<p>
The server's directory listings are in the following format:
<p><dl>
<dt><b>Protection or permissions:</b>
<dd>In UNIX and OS-9, this is a 10-character field, left adjusted.  In VMS it
  is a 22-character field, left-adjusted.  In each case, the protection /
  permission codes are shown in the server platform's native format.  In
  other operating systems, this field is not shown.
<p>
<dt><b>Size in bytes:</b>
<dd>This is always a 10-character field.  The file's size is shown as a decimal
number, right adjusted in the field.  If the file is a directory and its
size can not be obtained, the size is shown as "<tt>&#60;DIR&#62;</tt>".
Two blanks 
follow this field.
<p>
<dt><b>Date:</b>
<dd>Always in yyyy-mm-dd hh:mm:ss numeric format, and therefore 19 characters
  long.   If the file's date/time can't be obtained, zeros (0) are shown for
  all the digits.  This field is followed by two blanks.
<p>
<dt><b>Filename:</b>
<dd>This field extends to the end of the line.  Filenames are shown relative
to the server's current directory.  In UNIX, symbolic links are shown as
they are in an "<tt>ls</tt> <tt>-l</tt>" listing as
"<tt>linkname</tt> <tt>-&#62;</tt> <tt><i>filename</i></tt>".
<p></dl>
In UNIX and VMS, listings are returned by the server in alphabetical order of
filename.  There are presently no other sort or selection options.
<p>
However, since these are fixed-field listings, all fields can be used as
sort keys by external sort programs.  Note, in particular, that the format
used for the date allows a normal lexical on that field to achieve the date
ordering.  For example, let's assume we have a UNIX client and a UNIX server.
In this case, the server's listing has the date in columns 22-40, and thus
could be sorted by the UNIX sort program using "<tt>sort +0.22 -0.40</tt>" or
in reverse order by "<tt>sort +0.22 -0.40r</tt>".
<p>
Since the UNIX client can pipe responses to REMOTE commands through filters,
any desired sorting can be accomplished this way, for example:
<p><pre>
C-Kermit&#62; <u>remote directory | sort +0.22 -0.40</u>
</pre><p>
You can also sort by size:
<p><pre>
  C-Kermit&#62; <u>remote directory | sort +0.11 -0.19</u>
</pre><p>
You can use sort options to select reverse or ascending order.  "man sort"
(in UNIX) for more information.  And of course, you can pipe these listings
through any other filter of your choice, such as grep to skip unwanted lines.

<p>
<hr>
<h3><a name="x5.4">5.4. Syntax for Remote Filenames with Embedded Spaces</a></h3>

C-Kermit and K95, when in server mode, assume that any spaces in the file
specification in an incoming GET command are filename separators.  Thus if
the client gives a command like:
<p><pre>
  get {oofa.txt oofa.bin}
</pre><p>
or, equivalently:
<p><pre>
  mget oofa.txt oofa.bin
</pre><p>
the server tries to send the two files, oofa.txt and oofa.bin.  But what if
you want the server to send you a file named, say:
<p><pre>
  D:\HP OfficeJet 500\Images\My Pretty Picture Dot PCL
</pre><p>
How does the server know this is supposed to be one file and not seven?
In this case, you need to the send file name to the server enclosed in either
curly braces:
<p><pre>
  {D:\HP OfficeJet 500\Images\My Pretty Picture Dot PCL}
</pre><p>
or ASCII doublequotes:
<p><pre>
  "D:\HP OfficeJet 500\Images\My Pretty Picture Dot PCL"
</pre><p>
The method for doing this depends on your client.  If your client is C-Kermit
7.0, any recent version of Kermit 95, or MS-DOS Kermit 3.16, then you have
to enclose the name in braces just so the client can parse it, so to send
braces or doublequotes to the server, you must put them inside the first,
outside pair of braces.  And you also need to double the backslashes to
prevent them from being interpreted:
<p><pre>
  get {{D:\\HP OfficeJet 500\\Images\\My Pretty Picture Dot PCL}}
  get {"D:\\HP OfficeJet 500\\Images\\My Pretty Picture Dot PCL"}
</pre><p>
To get around the requirement to double backslashes in literal filenames,
of course you can also use:
<p><pre>
  set command quoting off
  get {{D:\HP OfficeJet 500\Images\My Pretty Picture Dot PCL}}
  get {"D:\HP OfficeJet 500\Images\My Pretty Picture Dot PCL"}
  set command quoting on
</pre><p>
If you are giving a "kermit" command to the UNIX shell, you have to observe
the shell's quoting rules, something like this:
<p><pre>
  kermit -ig "{D:\HP OfficeJet 500\Images\My Pretty Picture Dot PCL}"
</pre><p>
Here, the quotes go on the outside so UNIX will pass the entire filename,
spaces, braces, and all, as a single argument to Kermit, and the backslashes
are not doubled because (a) the UNIX shell ignores them since they are in a
quoted string, and (b) Kermit ignores them since the interactive command parser
is not activated in this case.

<p>
<hr>
<h3><a name="x5.5">5.5. Automatic Orientation Messages upon Directory Change</a></h3>

C-Kermit 7.0, when acting as a server, can send an orientation message to
the client whenever the server directory changes.  For example, when the
client gives a REMOTE CD command, the server sends the contents of the
new directory's "Read Me" file to the client's screen.  The following commands
govern this feature:
<p><dl>
<dt><b>SET SERVER CD-MESSAGE FILE</b> <i>name</i>
<dd>Given to the servr, allows the message-file name to be specified at
runtime.  A list of names to look for can be given in the following format:
<p><pre>
  {{<i>name1</i>}{<i>name2</i>}{<i>name3</i>}{...}}
</pre><p>
e.g. <tt>SET SERVER CD-MESSAGE FILE {{./.readme}{README.TXT}{READ.ME}}</tt>
<p>
<dt><b>REMOTE SET SERVER CD-MESSAGE </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Given to the client, lets the client control whether the server sends
automatic CD messages.
<p>
<dt><b>SHOW SERVER</b>
<dd>Given to server, includes CD-Message status.
</dl><p>
The default CD message file name is system dependent.  SHOW CD or SHOW SERVER
displays the list.  Also see 
<a href="#x4.5.2">Section 4.5.2</a>.

<p>
<hr>
<h3><a name="x5.6">5.6. New Server Controls</a></h3>

<dl>
<dt><b>DISABLE ENABLE</b>
<dd>Allows the server to configured such that DISABLEd features can not be
re-enabled by any means -- e.g. if the client is somehow able to get the
server into command mode.  Once DISABLEd, ENABLE can not be re-ENABLEd.
<p>
<dt><b>SET SERVER IDLE-TIMEOUT <i>seconds</i></b>
<dd>This was available previously in Kermit 95 only.  Now it can be used in
  C-Kermit also to specify a maximum number of seconds the server is allowed
  to be idle before exiting server mode.  0 seconds means no idle timeout.
  In C-Kermit (but not K-95), SET SERVER TIMEOUT and SET SERVER IDLE-TIMEOUT
  are mutually exclusive -- you can have one or the other (or neither), but
  not both.  (Server timeouts are for the benefit of primitive Kermit clients
  that are not capable of timing out on their own; to our knowledge, no such
  clients are still in circulation.)
<p>
<dt><b>SET SERVER KEEPALIVE </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd><i>(See next section).</i>
</dl>

<p>
<hr>
<h3><a name="x5.7">5.7. Timeouts during REMOTE HOST Command Execution</a></h3>

Prior to C-Kermit 7.0, the C-Kermit server would block waiting for output
from a system command invoked via REMOTE HOST from the client.  If the system
command took a long time to execute, the client would time out and send NAK
packets.  If the command took too long, the client would reach its retry limit
and give up.  Even if it didn't, the NAKs would cause unnecessary
retransmissions.
<p>
In version 7.0, the C-Kermit server (VMS and <tt>select()</tt>-capable UNIX
versions only), sends "keepalive packets" (empty data packets) once per second
while waiting for the system command to complete.  This procedure should be
entirely transparent to the Kermit client, and should prevent the unwanted
timeouts and NAKs.  When C-Kermit 7.0 itself (or K95 1.1.19) is the client, it
prints dots to show the keepalive packets.
<p>
The keepalive feature can be turned off and on with:
<p><pre>
  SET SERVER KEEPALIVE <i>{</i> ON, OFF <i>}</i>
</pre><p>
Normally it should be on.  Turn it off it if causes trouble with the client,
or if it seems to slow down the server (as it might on some platforms under
certain circumstances).

<p>
<hr>
<h3><a name="x6">6. INTERNATIONAL CHARACTER SETS</a></h3>

Support for several new single-byte character sets was added in C-Kermit
7.0.  Unicode / ISO 10646 is not yet supported, but is a high priority for
forthcoming releases.

<h3><a name="x6.0">6.0. ISO 8859-15 Latin Alphabet 9</a></h3>

To accommodate the Euro currency symbol, and to correct several other
longstanding problems with ISO Latin Alphabet 1, ISO 8859-15 Latin Alphabet 9
was issued in May 1998.  It is supported by C-Kermit 7.0 as a transfer
character set, a file character set, and a terminal character set.
Translations that preserve the new characters are available between Latin-9
and several other sets including:
<p><pre>
  PC Code Page 858         (Western European languages, similar to CP850)
  Windows Code Page 1252   (Western European languages, similar to Latin-1)
  Windows Code Page 1250   (Eastern European languages, similar to Latin-2)
</pre><p>
The Latin-9 transfer character set also allows for the OE digraph character,
used primarily in French, to be preserved in transfers involving the DEC MCS
or NeXT character sets.
<p>
The Euro character is also present in the Universal Character Set, described
in <a href="#x6.6">Section 6.6</a>.

<h3><a name="x6.1">6.1. The HP-Roman8 Character Set</a></h3>

The HP-Roman8 character set is supported in C-Kermit 6.0 and later
but was omitted from
Table VII-4 in the 2nd Edition of <cite>Using C-Kermit</cite>
due to lack of space.  It is listed in <a href="#xiii">Appendix III</a>.

<h3><a name="x6.2">6.2. Greek Character Sets</a></h3>

Greek character sets were added in 6.1:
<p><pre>
  SET FILE CHARACTER-SET { CP869, ELOT927, GREEK-ISO }
  SET TRANSFER CHARACTER-SET { GREEK-ISO }
</pre><p>
GREEK-ISO is ISO 8859-7, which the same as ELOT 928.
<p>
The new Greek character sets are listed in
<a href="#xiii">Appendix III</a>.

<h3><a name="x6.3">6.3. Additional Latin-2 Character Sets</a></h3>

The following have been added as FILE and TERMINAL CHARACTER-SETs:
<p><dl>
<dt><b>MAZOVIA-PC</b>
<dd>A PC code page used in Poland, equivalent to CP437, but with 18
  substitutions needed for Polish.
<p>
<dt><b>CP1250</b>
<dd>The Windows Latin 2 Code Page.  Equivalent to ISO 8859-2, but with
  different encoding.
</dl>

<h3><a name="x6.4">6.4. Additional Cyrillic Character Sets</a></h3>

The following have been added as FILE and TERMINAL CHARACTER-SETs:
<p><dl>
<dt><b>BULGARIA-PC</b>
<dd>This is the Cyrillic PC code page used in Bulgaria, where it is called
  Code Page 856.  It is attributed to a company called DATEC, Inc, but CP856
  is not a proper designation, since it refers to a Hebrew Code Page (see
  the IBM Registry).
<p>
<dt><b>CP855</b>
<dd>This PC Code Page
  contains all the Cyrillic letters that are also in ISO 8859-5, and is
  therefore useful for non-Russian Cyrillic text (Ukrainian, Belorussian,
  etc), unlike CP866, which has a smaller repertoire of Cyrillic letters.
<p>
<dt><b>CP1251</b>
<dd>The Windows Cyrillic Code Page.  Equivalent to CP855, but with different
  encoding.
<p>
<dt><b>KOI8R</b>
<dd>An extension to "Old KOI-8" that adds upper and lower case Cyrillic letter
Io (looks like Roman E with diaeresis) plus a selection of box-drawing
characters to columns 8 through 11, which are vacant in original Old KOI-8.
KOI8-R is used for the Russian language.  It is specified in 
<a href="ftp://ftp.isi.edu/in-notes/rfc1489.txt">RFC 1489</a>.
<p>
<dt><b>KOI8U</b>
<dd>A similar extension of Old KOI-8, but for Ukrainian.  It is specified in
<a href="ftp://ftp.isi.edu/in-notes/rfc2319.txt">RFC 2319</a>.
</dl>

<p>
<hr>
<h3><a name="x6.5">6.5. Automatic Character-Set Switching</a></h3>

Prior to version 7.0, C-Kermit's file character-set always had to be set
explicitly.  In 7.0 and later, it is set automatically when:
<p><ol>
<li>This feature is enabled (as it is unless you disable it).
<p>
<li>An incoming text-mode transfer includes a transfer-character-set
    announcer and you have not previously given a SET FILE CHARACTER-SET
    command.  In this case, C-Kermit switches to an appropriate file
    character set.  For example, on an HP-UX workstation, an incoming
    Latin-1 file automatically selects HP-Roman8 for the local copy of
    the file; in Data General AOS/VS, it would select DG International.
<p>
<li>You give a SET TRANSFER CHARACTER-SET command without having
    previously specified a FILE CHARACTER-SET.  An appropriate file
    character-set is chosen automatically.
</ol>
<p>

In addition, when you give a SET FILE CHARACTER-SET command, the appropriate
transfer character-set is automatically chosen, to be used when you are
sending files (but this does not override the one announced by the sender
when you are receiving files).
<p>
You might not agree about what is "appropriate", so of course you can disable
or change all of the above actions.
<p>
You can disable (or re-enable) the new automatic character-set switching
feature in each direction separately:
<p><dl>
<dt><b>SET RECEIVE CHARACTER-SET-SELECTION</b> <i>{</i> <b>AUTOMATIC, MANUAL</b> <i>}</b>
<dd>AUTOMATIC is the default, causing the behavior described above when an
incoming file arrives.   Choose MANUAL to defeat this behavior and force
your current FILE CHARACTER-SET setting to be used, no matter what it is.
Note that SET RECEIVE CHARACTER-SET MANUAL does not disable recognition
of the incoming transfer character-set announcer, and translation from the
corresponding character-set to your current file character-set.  To disable
that, use SET ATTRIBUTE CHARACTER-SET OFF.
<p>
<dt><b>SET SEND CHARACTER-SET-SELECTION</b> <i>{</i> <b>AUTOMATIC, MANUAL</b> <i>}</i>
<dd>Again AUTOMATIC is the default, causing the behavior described above when
you give a SET <i>{</i> FILE, TRANSFER <i>}</i> CHARACTER-SET command.  Use
MANUAL to allow you to specify the transfer and file character-sets
independently.
<p>
<dt><b>SHOW CHARACTER-SETS</b>
<dd>Tells settings of <i>{</i> SEND, RECEIVE <i>}</i> CHARACTER-SET-SELECTION.
</dl><p>
Normally, however, it is more convenient to leave automatic switching active,
and change any associations that are not appropriate for your application,
area, or country.  The commands are:
<p><dl>
<dt><b>SHOW ASSOCIATIONS</b>
<dd>This command lists all the associations in each direction: for each
possible transfer character-set, it lists the associated file character-set,
and vice versa.  These are two separate and independent lists.
<p>
<dt><b>ASSOCIATE TRANSFER-CHARACTER-SET</b> <i>name1 [ name2 ]</i>
<dd>Changes the association for the transfer character-set <i>name1</i> to be
the file character-set <i>name2</i>.  If <i>name2</i> is omitted, automatic
switching is disabled for this transfer character-set only.
<p>
<dt><b>ASSOCIATE FILE-CHARACTER-SET</b> <i>name1 [ name2 ]</i>
<dd>Changes the association for the file character-set <i>name1</i> to be the
transfer character-set <i>name2</i>.  If <i>name2</i> is omitted, automatic
switching is disabled for this file character-set only.
</dl>

<p>
<hr>
<h3><a name="x6.6">6.6. UNICODE</a></h3>

C-Kermit 7.0 adds support for Unicode, the Universal Character Set, for:
<p><ul>
<li>File Transfer (SEND, RECEIVE, GET, etc)
<li>Terminal connection (CONNECT)
<li>Unguarded file capture (LOG SESSION)
<li>Unguarded file transmission (TRANSMIT)
<li>Local file character-set conversion (TRANSLATE)
</ul><p>

C-Kermit is not, however, a "Unicode application" in the sense that its
commands, messages, or user interface are Unicode.  Rather, it is "Unicode
aware" in its ability to handle and convert Unicode text in the course of file
transfer and terminal connection, and you can also use Kermit to convert local
files between Unicode and other character sets.  TLA's:
<p><pre>
  BMP - Base Multilingual Plane
  BOM - Byte Order Mark
  CJK - Chinese, Japanese, and Korean
  ISO - International Standards Organization
  TLA - Three-Letter Acronym
  UCS - Universal Character Set
  UTF - UCS Transformation Format
</pre><p>

Unicode and ISO 10646 are the coordinated and compatible corporate and
international standards for the Universal Character Set (UCS).  Unlike
single-byte and even most multibyte character sets, the UCS can represent all
characters in every existing writing system.  A flat plain-text file encoded
in some form of UCS can contain any mixture of English, Spanish, Italian,
German, Hebrew, Arabic, Greek, Russian, Armenian, Georgian, Japanese, Chinese,
Korean, Vietnamese, Tibetan, Hindi, Bengali, Tamil, Thai, Ethiopic, and so on,
plus scientific and mathematical notation, as well as texts in Runes, Ogham,
Glagolitic, and other historic scripts.
<p>
The UCS already covers these scripts and many more, but it's an evolving
standard with efforts underway to accommodate even more languages and writing
systems.  Support is growing for native UCS use on many platforms and in many
applications.  The goal of the framers of the UCS is for it to replace ASCII,
the ISO Latin Alphabets, ISCII, VISCII, the Chinese, Japanese, and Korean
(CJK) multibyte sets, etc, as well as the many private character sets in use
today, in other words to become *the* Universal Character Set.
<p>
Until that time, however, conversions between existing sets and the UCS will
be necessary when moving text between platforms and applications.  Now Kermit
can help.

<p>
<hr>
<h4><a name="x6.6.1">6.6.1. Overview of Unicode</a></h4>

For a more complete picture, please visit:
<p><pre>
  <a href="http://www.unicode.org/">http://www.unicode.org/</a>
</pre><p>
and access the various online introductions, FAQs, technical reports, and
other information.  For greater depth, order the latest version of the
published Unicode Standard.  The following overview contains a great many
oversimplifications and perhaps an opinion or two.
<p>
At present, the UCS is a 16-bit (2-byte) character set, but with provisions to
grow to a 4-byte set.  UCS-2 refers to the two-byte set, also called the Base
Multilingual Plane (BMP), in which each character has 16 bits, and therefore
there are 2^16 = 65536 possible characters.  The first 128 characters are the
same as US ASCII (C0 control characters and DEL included), the next 32 are the
C1 control characters of ISO 6429, and the next 96 are the Right Half of ISO
8859-1 Latin Alphabet 1.  The remaining tens of thousands of characters are
arranged newly for the UCS, usually (but not always) in sections corresponding
to existing standards, such as ISO Latin/Cyrillic, often plus additional
characters not appearing in the existing standards due to lack of space (or
other reasons).
<p>
ISO 10646 allows for additional planes, e.g. for Egyptian hieroglyphics or
ancient (or other esoteric) CJK characters, but these planes are not yet
defined and so we will say nothing more about them here, except that their use
will require the 4-byte form of UCS, called UCS-4, in some form (more about
"forms" in <a href="#x6.6.2">Section 6.6.2</a>).
<p>
Unicode and ISO 10646 are constantly under revision, mainly to add new
characters.  The Unicode revision is denoted by a version number, such as 1.0,
1.1, 2.0, 3.0.  The ISO 10646 standard revision is identified by Edition (such
as ISO 10646-1 1993), plus reference to any amendments.  The first versions of
these standards included encodings for Korean Hangul syllables (Jamos); these
encodings were changed in version 1.1 of Unicode and by Amendment 5 to ISO
10646-1.  The Unicode Technical Committee and the ISO acknowledge that this
was a bad thing to do, and promise never change encodings or character names
again, since this poses serious problems for conformance and data interchange.
<p>
A UCS-2 value is customarily written like this:
<p><pre>
  U+<i>xxxx</i>
</pre><p>
where "<i>xxxx</i>" represents four hexadecimal digits, 0-9 and A-F.  For
example, U+0041 is "A", U+00C1 is A-acute, U+042F is uppercase Cyrillic "Ya",
U+FB4F is Hebrew Ligature Alef Lamed, and U+FFFD is the special character that
means "not a character".
<p>
Most characters from widely-used alphabetic writing systems such as the West
European ones, Cyrillic, Greek, Hebrew, Vietnamese, etc, are available in
"precomposed" form; for example Uppercase Latin Letter A with Acute Accent is
a single character (as it is in Latin-1).  However, the UCS also permits
composition of a base character with one or more nonspacing diacritics.  This
means the same character can be represented in more than one way, which can
present problems in many application areas, including transfer and
character-set conversion of text.
<p>
Conversion from ASCII or Latin-1 to UCS-2 text is "trivial": simply insert a
NUL (0) byte before each ASCII or Latin-1 byte.  Converting in the reverse
direction (provided the UCS-2 file contains only U+0000 to U+00FF) is equally
simple (if we ignore the issue of composition): remove every second (NUL)
byte.  Conversion of other character sets to and from UCS, however, requires
tables or algorithms specific to each set.  Nevertheless, the relatively
transparent upwards compatibility from ASCII and Latin-1, in which a very
large share of the world's textual data is encoded, gives the UCS an entree
onto existing platforms.
<p>
But the 2-byte format and the preponderance of NUL and other control bytes in
UCS-2 text pose problems for current applications and transmission methods.
And to make matters worse, different hardware platforms store UCS-2 characters
in different byte order.  Thus a UCS-2 file transferred by FTP (or accessed
via NFS, etc) between two computers with different architecture might have its
bytes in the wrong order (or worse; see <a href="#x6.6.5.1">Section
6.6.5.1</a> ).

<p>
<hr>
<h4><a name="x6.6.2">6.6.2. UCS Byte Order</a></h4>

Consider the number 1.  In an 8-bit byte, this would be represented by the
following series of 0- and 1-bits:
<p><pre>
  +-----------------+
  | 0 0 0 0 0 0 0 1 |
  +-----------------+
</pre><p>
Therefore in a 16-bit "word" the representation might be:
<p><pre>
  +-----------------+-----------------+
  | 0 0 0 0 0 0 0 0 | 0 0 0 0 0 0 0 1 |
  +-----------------+-----------------+
</pre><p>
Now consider the number 256, which is 2 to the 8th power.  The binary
representation is 100000000 (1 followed by 8 zeros).  256 would go into a
16-bit word like this:
<p><pre>
  +-----------------+-----------------+
  | 0 0 0 0 0 0 0 1 | 0 0 0 0 0 0 0 0 |
  +-----------------+-----------------+
</pre><p>
When a computer works this way, it is said to be Big Endian, meaning it puts
the most significant (biggest) byte first (on the "left") in a 16-bit word, and
the least significant byte second (on the right).
<p>
However, some other computers have the opposite arrangement, called Little
Endian, in which 1 is:
<p><pre>
  +-----------------+-----------------+
  | 0 0 0 0 0 0 0 1 | 0 0 0 0 0 0 0 0 |
  +-----------------+-----------------+
</pre><p>
and 256 is:
<p><pre>
  +-----------------+-----------------+
  | 0 0 0 0 0 0 0 0 | 0 0 0 0 0 0 0 1 |
  +-----------------+-----------------+
</pre><p>
Computers such as Sparc, MIPS, PA-RISC, and PowerPC are Big Endian, whereas
the PC and the Alpha are Little Endian.  Endianness has never been an issue
with 7- or 8-bit characters, but it is with UCS characters.  It can be a
tricky business to share or transfer a UCS-2 file between two different kinds
of computers.
<p>
To alleviate (but not entirely solve) the problem, UCS-2 files are supposed to
begin with the Unicode character U+FEFF, Zero-Width No-Break Space (ZWNBS).
This is a kind of "no-op" (note: any such assertion must normally be qualified
with many "but ifs" and "excepts" which are omitted here in the interest of
brevity).  If the bytes are reversed the ZWNBS becomes U+FFFE, which is not
(and never will be) a defined UCS character.  U+FEFF at the beginning of a UCS
file is therefore called a Byte Order Mark, or BOM.
<p>
Any application that creates a UCS-2 (or UTF-16, or UCS-4) file should include
a BOM, and any application that reads one should test for a BOM, and if one is
found, infer the byte order from it.  This is a convention, however -- not a
standard or a requirement -- and applications vary in their ability to handle
BOMs and "backwards" UCS-2 files.
<p>
Note that a BOM is useful only at the beginning of a file.  If you append one
UCS-2 file to another, and both have BOMs, the internal BOM is no longer a
BOM.  And if the byte orders of the two files differ, then either the first
part or the second will be backwards.  (Various other undesirable effects
might also occur, not discussed here.)

<p>
<hr>
<h4><a name="x6.6.2">6.6.2. UCS Transformation Formats</a></h4>

UCS textual data can be modified in various ways for transmission or storage.
Any officially sanctioned method of doing this is called a UCS Transformation
Format, or UTF.  One such method, called UTF-16, is essentially identical with
UCS-2 except that it designates certain code values as "escape sequences"
(called surrogate pairs) to access characters in other planes without having
to use full UCS-4.  We won't discuss UTF-16 further here, since at the moment
there are no other planes.  Several other UTF's (such as UTF-1, UTF-2, and
UTF-7) have fallen into disuse and are not discussed here.  The most important
transformation format today is UTF-8.
<p>
UTF-8, so called because it "serializes" UCS-2 data into a stream of 8-bit
bytes, is designed to allow the UCS to work with present-day communications
gear, computers, and software.  The most important properties of UTF-8 are
that byte order is constant (no byte swapping) and all (7-bit) ASCII
characters represent themselves.  Therefore conversion between ASCII and UTF-8
is no conversion at all, and applications or platforms (such as Plan 9 from
Bell Labs) that use UTF-8 "for everything" can still run traditional
ASCII-only applications and be accessed from them.  In particular, unlike
UCS-2, ASCII characters are not padded with NUL bytes.  But also unlike UCS-2,
there is no transparency for Latin-1 or any other non-ASCII character set.
Every non-ASCII UCS-2 character is represented by a sequence of 2 or 3 UTF-8
bytes.  Thus UTF-8 is more compact than UCS-2 for text containing a
preponderance of ABC's (or other ASCII characters), about the same as UCS-2
for other alphabetic scripts (Cyrillic, Roman, Greek, etc), and larger than
UCS-2 for Chinese, Japanese, and Korean.
<p>
The UTF-8 uncoding of the UCS has been adopted by the Internet as the
preferred character set for new applications, and is gradually being
retrofitted into traditional applications like FTP 
(<a href="ftp://ftp.isi.edu/in-notes/rfc2640.txt">RFC 2640</a>).

<p>
<hr>
<h4><a name="x6.6.3">6.6.3. Conformance Levels</a></h4>

Although the Unicode and ISO 10646 standards both describe the same character
set, these standards differ in many ways, including their stated requirements
for conformance and their classification of conformance levels.
<p>
Kermit has always abided by ISO character-set standards, including ISO
character-set designation and invocation methods.  In adapting Unicode,
therefore, we had to choose from among the available ISO designations which,
in turn, correspond with ISO 10646 conformance levels.  At present, Kermit
claims the lowest conformance level, 1, meaning (roughly) that it does not
handle combining forms and it does not handle Korean Hangul Jamos (just as,
at present, it does not handle Korean in general).  Note that ISO 10646
Conformance Levels 1 and 2 sidestep the issue of the code changes for Korean
Hangul by announcing non-support for Hangul regardless of encoding.
<p>
ISO 10646 Conformance Level 1 is approximately equivalent to Unicode
Normalization Form C (described in Unicode Technical Report 15, incorporated
into Unicode 3.0).
<p>
As noted in 
<a href="#x6.6.2">Section 6.6.2</a>, Kermit does not claim to support UTF-16
at the
present time, hence the UCS-2 nomenclature.  Kermit treats surrogates just as
if they were any other UCS-2 characters, rather than as escapes to other
planes, which means that (except when converting between UCS-2 and UTF-8) they
are translated to "error" characters, since (a) no other planes are defined
yet (and if they were, no other character sets supported by Kermit would
encode their characters), and (b) no valid surrogate character corresponds to
any other UCS-2 character.
<p>
A minor yet significant aspect of Unicode 3.0 and some recent perturbation of
ISO 10646-1 (probably Amendment 18, "Symbols and Other Characters") is the
addition of the Euro Sign at U+20AC.  As noted in 
<a href="#x6.0">Section 6.0</a>, Kermit's "Euro
compliance" includes conversion between Latin Alphabet 9 and various PC code
pages.  Text can also be converted between UCS-2 or UTF-8 and any other
Euro-compliant character set (Latin-9, CP858, CP1250, CP1252) without loss of
the Euro Sign.

<p>
<hr>
<h4><a name="x6.6.4">6.6.4. Relationship of Unicode with Kermit's Other Character Sets</a></h4>

Kermit's character sets are divided into two groups: single-byte sets (such
as Roman, Hebrew, Cyrillic, Greek) and multibyte (various Japanese sets).  The
two groups are distinct since one normally would not expect to convert Kanji
ideograms to Roman (or other) letters, or vice versa.
<p>
Unicode character-set conversion works with both groups, but obviously the
result depends on the repertoires of the source and destination character-sets
both including the characters in the file.  For example, you can translate a
Hungarian text file between Latin-2 and Unicode, but not between (say) Unicode
and Latin/Greek.  By the same token you can convert Japanese text from
Shift-JIS or EUC or JIS-7 to Unicode and back, but you can't convert the same
file to (say) Latin-1 if it contains Japanese characters.
<p><blockquote>
  JIS-7 is equivalent to DEC Kanji and ISO-2022-JP except that the latter
  two do not support halfwidth Katakana.  Kermit treats all three of these
  sets the same way, i.e. as JIS-7.
</blockquote><p>

As noted, Kermit presently does not handle combining diacritics, and so will
not correctly convert UCS files that use them into a single-byte character
set.  For example, if a UCS file contains Latin Capital Letter A (U+0041)
followed by Combining Acute Accent (U+0301), the result will be a
two-character sequence, A followed by another character.  This is what is
meant by Conformance Level 1.  (The situation grows worse with multiple
diacritics, since they can occur in any order.)
<p>
A higher level of conformance is possible, in which "canonical equivalences"
are handled via algorithms and databases, at some (perhaps considerable) cost
in performance, since a fair amount of additional code must be executed for
every character during data transfer (database lookup, sorting of combining
sequences into canonical order, etc).  This can be added in future releases if
there is a need (but in many cases, pre- and postpostprocessing might be a
better option).
<p>
Within these constraints, Kermit converts between the UCS and its other
character sets.  For example, a mixture of Russian and English (and/or Dutch,
or Latin) text can bet converted between the UCS and ISO Latin/Cyrillic or
KOI-8.  But since Kermit does not presently support Arabic character-set
conversion, the new availability of UCS conversion does not mean that Kermit
can convert from Arabic UCS text to some other character set, because Kermit
does not support any other character set that includes Arabic.  Ditto for
Thai, Armenian, Georgian, Tibetan, Chinese, Korean, etc.  However, Kermit CAN
convert Arabic (or any other script) between UCS-2 and UTF-8.
<p>
Considering Cyrillic more carefully, note that the UCS also contains numerous
Cyrillic characters not found in any of the Cyrillic sets (ISO Latin/Cyrillic,
KOI8, CP866, etc) that Kermit supports; characters needed for Abkhasian,
Yakut, Tatar, Bashkir, Altaic, Old Church Slavonic, etc; UCS text containing
any of these historic or "extended" Cyrillic characters can not be converted
to any of Kermit's current single-byte Cyrillic sets without loss.  The
situation is similar for Greek, Hebrew, etc, and even worse for Japanese
since Unicode contains thousands of Kanjis that are lacking from the Japanese
character sets based on JIS X 0208, such as EUC-JP, JIS-7, and Shift-JIS.
<p>
In general, when converting from UCS to a single-byte set, there is always the
possibility of data loss, just as there is when converting from any larger set
to a smaller one.  For example, if a UCS file contains Devanagari characters,
these characters will be lost when converting to (say) Latin-1, just as Roman
vowels with acute accents are lost when converting from Latin-1 (an 8-bit set)
to German ISO 646 (a 7-bit set).

<p>
<hr>
<h4><a name="x6.6.5">6.6.5. Kermit's Unicode Features</a></h4>

C-Kermit can convert between UCS-2 or UTF-8 and any of its other character
sets, and also between UCS-2 and UTF-8.  When converting between UCS-2 or
UTF-8 and a non-Unicode character set (such as Latin-1), the UCS Line
Separator (LS, U+2028) and Paragraph Separator (PS, U+2029) characters are
converted to the appropriate line terminator (CR, LF, or CRLF).  When
converting from a non-Unicode set to UCS-2 or UTF-8, however, line terminators
are not converted to LS or PS.  This is in accordance with the recommendations
of Unicode Technical Report #13.
<p>
When C-Kermit starts, it tests the native byte order of the computer.  You can
see the result in the SHOW FEATURES or SHOW FILE display.  It's also available
in the variable <tt>\v(byteorder)</tt>: 0 means Big Endian, 1 means Little
Endian.
<p>
When UCS-2 is involved in file transfer or translation, the following commands
tell C-Kermit what to do about byte order:
<p><dl>
<dt><b>SET FILE UCS BYTE-ORDER { BIG-ENDIAN, LITTLE-ENDIAN }</b>
<dd>This is for reading UCS-2 files that don't have a BOM, and also for
  writing UCS-2 files.  If this command is not given, the machine's native
  byte order is used when writing UCS-2 files, and also when reading UCS-2
  files that don't have a BOM.
<p>
<dt><b>SET FILE UCS BOM </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>This setting is used when creating UCS-2 files.  A BOM is added at the
  beginning by default.  Use OFF to not add the BOM.  This command has
  no affect when writing files.
<p>
<dt><b>COPY /SWAP-BYTES</b> <i>sourcefile</i> <i>destinationfile</i>
<dd>Use this for fixing a UCS-2 file whose bytes are in the wrong order.
</dl><p>
Use SHOW FILE to display the FILE UCS settings.
<p>
Please note, again, that C-Kermit's user interface, including its script
language, is not internationalized in any way.  String comparisons, case
conversion, and so on, work only for US ASCII (comparisons for equality work
with other sets, but not lexically-greater-or-less-than or caseless
comparisons; even comparisons for equality can fail when composed characters
or byte order are involved).  String functions such as <tt>\findex()</tt> and
<tt>\fsubstring()</tt> that reference byte positions do just that; they won't
work with UTF-8 text that contains any non-ASCII characters, and they will not
work with UCS-2 text at all since they use C strings internally, which are
NUL-terminated.  These are just a few examples to illustrate that neither
Unicode nor any other character-set beyond ASCII is supported at the
user-interface, command, or scripting level in this version of C-Kermit.

<p>
<hr>
<h4><a name="x6.6.5.1">6.6.5.1. File Transfer</a></h4>

Kermit supports both UCS-2 and UTF-8 as file and transfer character sets
in text-mode file transfer.
<p>
To select UCS-2 or UTF-8 as a file character-set, use:
<p><pre>
  SET FILE CHARACTER-SET <i>{</i> UCS2, UTF8 <i>}</i>
</pre><p>
If you want to send a UCS-2 text file (or save an incoming file in UCS-2
format), tell Kermit to:
<p><pre>
  SET FILE CHARACTER-SET UCS2
</pre><p>
and if you want to send a UTF-8 text file (or store an incoming file in
UTF-8 format), tell Kermit to:
<p><pre>
  SET FILE CHARACTER-SET UTF8
</pre><p>
When sending UCS-2 files, Kermit determines the byte order from the BOM, if
there is one (and if there is a BOM, it is stripped, i.e. not sent).  If there
is no BOM, the byte order is the one specified in the most recent SET FILE UCS
BYTE-ORDER command, if any, otherwise the computer's native byte order is
assumed.  When storing incoming files as UCS-2, the byte order is according
SET FILE UCS BYTE-ORDER, if given, otherwise the native one; a BOM is written
according to SET FILE UCS BOM.
<p>
A transfer character-set should be chosen that includes all of the characters
in the source file.  So, for example, if you are sending a UCS-2 file
containing only German-language text, your transfer character-set can be
Latin-1, Latin-2, Latin-9, UCS-2, or UTF-8.  But if you are sending a file
that contains a combination of Hebrew and Greek, your transfer character-set
must be UCS-2 or UTF-8 if you don't want to lose one script or the other.
Furthermore, the transfer character-set must be one that is supported by the
receiving Kermit program.  Since UCS support is new, it is possible that the
other Kermit program (if it supports character sets at all) does not support
it, but does support single-byte sets such as Latin-1, Latin/Cyrillic, etc.
<p>
To select UCS-2 or UTF-8 as a transfer character-set, use:
<p><pre>
  SET TRANSFER CHARACTER-SET { UCS2, UTF8 }
</pre><p>
It is up to the receiving Kermit program to convert the transfer format to its
own local format, if necessary.  If it does not understand the UTF-8 or UCS-2
transfer character-set, and your file can not be adequately represented by any
single-byte transfer character-set (such as Latin-1 or Latin/Cyrillic) then,
if UTF-8 format is acceptable on the receiving computer, use UTF-8 as the
transfer character-set, with the receiver told to "set unknown-char keep", or
with the sender told to "set attribute char off".  If you want the file to be
stored in UCS-2 format at the receiver, send it it binary mode if the source
file is also UCS-2, or else use the TRANSLATE command (next section) to
convert it to UCS-2 first, then send it in binary mode.  You should not use
UCS-2 as a transfer character-set in text-mode transfers to Kermit programs
that don't support it, because they are likely to corrupt the result the same
way FTP would (see the final paragraph of this section).
<p>
When UCS-2 is the transfer character set, it always goes into Kermit packets
in Big Endian format, with no BOM.  As always, the transfer character-set is
announced by the sender to the receiver.  The announcement for UCS-2 is "I162"
(ISO Registration 162 = UCS-2 Level 1) and by definition it is Big Endian (the
standards say that when UCS-2 is serialized into bytes, the order must be Big
Endian).  The announcement for UTF-8 is "I190" (UTF-8 Level 1).
<p>
When receiving a file whose transfer character-set is UCS-2 or UTF-8, you must
choose the appropriate file character set for the result.  There is no way
Kermit can do this for you automatically, since UCS data can be in any script
at all, or any combination.
<p>
In general, UTF-8 or UCS-2 should be chosen as a transfer character-set if the
source file is also encoded in some form of UCS and it contains more than one
script.  But there are other situations where where UTF-8 or UCS-2 offer
advantages.  For example, suppose the source file is on a NeXTstation and the
destination file is on VMS.  Both the NeXT and the DEC Multinational character
sets include the French OE digraph, but Latin-1 does not.  Therefore French
words containing this character might not arrive intact when Latin-1 is the
transfer character-set, but will with UTF-8 or UCS-2, since the UCS includes
the OE digraph (but so does Latin-9).
<p>
UCS-2 should be chosen as a transfer character-set only for Japanese text
files that contain a large preponderance of Kanji, since in this case (and
only this case) UCS-2 (two bytes per Kanji) is more efficient than UTF-8
(threebytes per Kanji).  The same will be true for Chinese and Korean when
they are supported by Kermit.  UCS-2 should never be used as a transfer
character-set with a transfer partner that does not support UCS-2 since this
can cause file corruption (see last paragraph in this section).
<p>
Note that Kermit's repeat-count compression is 100% ineffective for UCS-2,
and is also ineffective for multibyte characters in UTF-8 and EUC-JP; this is
because repeat-compression is a transport-level mechanism that operates on
a per-byte basis; it has no knowledge of the distinction between a byte and
a character.
<p>
When C-Kermit starts, it sets up associations (<a href="#x6.5">Section 6.5</a>)
for incoming files
whose transfer character sets are UCS-2 or UTF-8 appropriately for the
platform so that the file character-set for the incoming file is UCS-2 in
Windows and UTF-8 elsewhere.  Otherwise, C-Kermit does not make any default
associations for UCS-2 or UTF-8, but of course you may add or change
associations to suit your needs and preferences by including the appropriate
ASSOCIATE commands in your Kermit startup file.  For example, if you are a PC
user and deal only with text written in Greek and English, you can:
<p><pre>
  ASSOCIATE TRANSFER-CHARACTER-SET UTF8 CP869
  ASSOCIATE TRANSFER-CHARACTER-SET UCS2 CP869
  ASSOCIATE FILE-CHARACTER-SET CP869 UTF8
</pre><p>
Note that when file transfer involves conversion between a single-byte
character set and UCS-2 or UTF-8, the file-transfer thermometer and estimated
time left might be inaccurate, since they are based on the source file size,
not the transfer encoding.  This is purely a cosmetic issue and does not
effect the final result.  (And is not, strictly speaking, a bug; Kermit
protocol presently includes no method for the sender to furnish an "estimated
transfer size" to the receiver, and in any case any such guess could be as
far off as the file size, given the many other factors that come into play,
such as compression and prefixing).
<p>
A caution about FTP and UCS-2.  As noted previously, if you transfer a UCS-2
file with FTP in binary mode between two computers with opposite Endianness,
the result will have its bytes in the wrong order.  However, if you use FTP to
transfer a UCS-2 file in "ascii" (text) mode to ANY computer, even if it is
identical to yours, the result will be corrupted because FTP's line-terminator
conversions do not account for UCS-2.  The same holds when sending from a
UCS-aware Kermit program to an older Kermit program in text mode with a
transfer character-set of UCS-2.  So use UCS-2 as a transfer character-set
ONLY with a UCS-2-aware Kermit partner.

<p>
<hr>
<h4><a name="x6.6.5.2">6.6.5.2. The TRANSLATE Command</a></h4>

In Kermit versions that have Unicode support included, TRANSLATE now always
goes through Unicode; that is, the source set is converted to UCS-2 and thence
to the target set.  This is a major improvement, since in prior releases,
C-Kermit had to pick the "most appropriate" transfer character-set as the
intermediate set, and this would result in the loss of any characters that the
source and target sets had in common but were lacking from the intermediate
set (for example the OE digraph when translating from NeXT to DEC MCS through
Latin-1).  This never happens when Unicode is the intermediate set because
Unicode is a superset of all other character sets supported by Kermit.  A more
dramatic example would be translation between Cyrillic PC code page 866 and
KOI8-R (<a href="#x6.4">Section 6.4</a>);
formerly all the line- and box-drawing characters would
be lost (since ISO 8859-5 does not have any); now the ones that these two sets
have in common are preserved.
<p>
UCS-2 and UTF-8 are now both supported as source-file and destination-file
character sets by C-Kermit's TRANSLATE command, for example:
<p><pre>
  translate oofa.txt ucs2 latin1 oofa-l1.txt
</pre><p>
translates <tt>oofa.txt</tt> from UCS-2 to Latin-1, storing the result as
<tt>oofa-l1.txt</tt>.  Similarly:
<p><pre>
  translate oofa.txt utf8 latin1 oofa-l1.txt
  translate oofa.txt latin1 ucs2 oofa-ucs2.txt
  translate oofa.txt latin1 utf8 oofa-utf8.txt
  translate oofa.txt ucs2 utf8 oofa-utf8.txt
  translate oofa.txt utf8 ucs2 oofa-ucs2.txt
</pre><p>
Treatment of the UCS-2 BOM is exactly the same as for file transfer.  Note
that if a UCS-2 source file is in the "wrong" byte order and lacks a BOM, and
you don't tell Kermit about it with SET FILE UCS BYTE-ORDER, the result of the
translation is total gibberish.  Recall that you can use COPY /SWAP-BYTES to
switch the byte order of an errant UCS-2 file (or any other file for that
matter, if you can think of a reason to).  Also note that:
<p><pre>
  translate oofa.txt ucs2 ucs2 new.txt
</pre><p>
Produces a result in the native (or SET FILE UCS) byte-order as long as
oofa.txt has a BOM.
<p>
As a side benefit of the Unicode work, the TRANSLATE command now works
for the first time also for all Japanese character sets that Kermit supports.
In other words, if you have a Japanese text file in any of the following
encodings:
<p><pre>
  EUC-JP
  Shift-JIS
  JIS-7
  UCS-2
  UTF-8
</pre><p>
You can use the TRANSLATE command to convert to any other encoding from the
same list.

<p>
<hr>
<h4><a name="x6.6.5.3">6.6.5.3. Terminal Connection</a></h4>

The CONNECT command now allows UTF-8 as a local or remote terminal
character-set:
<p><pre>
  SET TERMINAL CHARACTER-SET { ..., UTF8 } { ..., UTF8 }
  SET TERMINAL REMOTE-CHARACTER-SET { ..., UTF8 }
  SET TERMINAL LOCAL-CHARACTER-SET { ..., UTF8 }
</pre><p>
(Recall that Kermit's terminal character-set has two "ends" -- the set used
on the host to which Kermit is connected, and the set used on the local
keyboard and screen.)
<p>
UCS-2 is not supported as a terminal character-set (either end) since (a) it
is not used that way anywhere to our knowledge, and (b) the problems of
Endianness and the high likelihood of loss of synchronization make it
impractical.  (Telecommunications is byte-oriented; if one byte, or any odd
number of bytes, is lost because of buffer overruns, circuit resets, etc (or
likewise if a burst of noise appears that takes the guise of an odd number of
bytes), the byte order of the subsequent data stream will be backwards; unlike
UTF-8 and traditional byte-based character sets, UCS-2 is not "self
synchronizing".)
<p>
UTF-8 does not have byte-order or synchronization problems and is growing in
popularity as a terminal character set as well as in other application areas.
It allows a single terminal session to use multiple scripts (Roman, Cyrillic,
Greek, etc) without ISO 2022 character-set switching (which terminal emulators
like Kermit 95 can handle but few host applications understand or use), and
meshes nicely with the Unicode screen fonts that are beginning to appear.
<p>
UTF-8 was first used in Plan 9 and soon will be available in Linux.  It will
probably spread from there (Unicode in some form is, of course, also used in
Windows NT, but only internally -- not for access from outside).
<p>
To use UTF-8 or any other character set that uses 8-bit bytes in your terminal
session, be sure to tell C-Kermit to:
<p><pre>
  SET TERMINAL BYTESIZE 8
  SET COMMAND BYTESIZE 8
  SET PARITY NONE
</pre><p>
(or use the shortcut command, EIGHTBIT, which does all three at once).
<p>
In a setup where your local Kermit program uses a single-byte character set
such as PC Code Page 850 and the remote host uses UTF-8:
<p><pre>
  SET TERM CHAR UTF8 CP850
</pre><p>
or:
<p><pre>
  SET TERM REMOTE CHAR UTF8
  SET TERM LOCAL CHAR CP850
</pre><p>
all works as expected.  UTF-8 text on the remote displays correctly on your
screen, and when you type CP850 characters, they are translated to UTF-8
sequences for transmission, and the echo from the host is translated from
UTF-8 back to CP850.  Telnet negotiations and autodownload take place before
any character-set translation and work as before.  The session log (if text
mode was selected for it) contains only the local terminal character-set.
And so on.
<p>
Kermit merely supplies translations from UTF-8 to your local terminal
character-set (this includes treating UTF-8 Line Separator and Paragraph
separator as CRLF).  However, Kermit does does not, at present, perform
"canonicalization" of composed sequences, nor does it automatically execute
bidirectionality algorithms for display of mixed-direction text (e.g. Hebrew
and English).  Such presentation issues, like all others in the terminal-host
regime, are left to the host.
<p>
By the way, C-Kermit also allows UTF-8 to be the local end of the terminal
character-set, but so far this code is not tested, since we don't have a UTF-8
console or terminal to work with.  However, it can be stated without doubt
that C-Kermit's key mapping will not work for UTF-8 values, since (a) the key
map is indexed by 8-bit byte values and (b) C-Kermit reads keystrokes a byte
at a time (these comments do not apply to K95, which has direct access to the
keyboard and can read "wide" keycodes and uses them to index a "wide" keymap).
<p>
Restrictions: As noted, the CONNECT command does not support UCS-2 as a REMOTE
TERMINAL character-set.  Neither does it support the Japanese sets EUC-JP,
JIS-7, and Shift-JIS.  Support for the Japanese sets (and possibly Chinese and
Korean too) might be added in a future release.  Since the TRANSMIT command
(next section) uses the same REMOTE TERMINAL character-sets as the CONNECT
command, it has the same restrictions.

<p>
<hr>
<h4><a name="x6.6.5.4">6.6.5.4. The TRANSMIT Command</a></h4>

As described in Chapter 15 of <a
href="ckb2.html"><cite>Using
C-Kermit</cite></a> and 
<a href="#x4.21">Section 4.21</a> of this
document, the TRANSMIT command can be used to upload a file without protocol,
more or less as if you were typing it on your keyboard while connected to the
host.  When TRANSMITting in text mode, the file's character set is converted
to the host's unless you have SET TERMINAL CHARACTER-SET TRANSPARENT, or you
include the new TRANSMIT switch, /TRANSPARENT.
<p>
Before C-Kermit 7.0, the file character-set was assumed to be the same as the
local end of the terminal character-set, and the TRANSMIT command used the
same translations as the CONNECT command, ignoring the file character-set.
<p>
In C-Kermit 7.0, that assumption (a poor one to begin with) can no longer be
made, since UCS-2 can be a file character-set but not a terminal
character-set.  So now the file's character-set is given by your most recent
SET FILE CHARACTER-SET command.  The host's character set is the remote end of
your most recent SET TERMINAL CHARACTER-SET command:
<p><pre>
  SET TERMINAL CHARACTER-SET <i>remote-set</i> [ <i>local-set</i> ]
</pre><p>
or:
<p><pre>
  SET TERMINAL REMOTE-CHARACTER-SET <i>remote-set</i>
</pre><p>
The TRANSMIT command converts each source-file character from the FILE
character-set to the REMOTE TERMINAL character-set, and then transmits the
translated characters according to your SET TRANSMIT preferences (Chapter 15).
<p>
If you have SET TRANSMIT ECHO ON, and the host is echoing the transmitted
characters, the echos are converted from the remote terminal character-set to
the local terminal character-set.
<p><pre>
  <i>[ A picture would help... ]</i>
</pre><p>
Confused?  Let's work through an example.  Suppose your local computer is a
NeXTstation, on which text files are encoded in the NeXT character set, and
that the remote computer is a Data General AViiON, which uses the Data General
International character set.  Further suppose that you are logged in to the
NeXT from a VT220 terminal which uses the DEC Multinational character set.
<p>
You need to convert the file from NeXT encoding to DG encoding and convert the
echoes from DG encoding to DEC encoding.  So on the NeXT, tell C-Kermit to:
<p><pre>
  eightbit
  set file character-set next
  set term character-set dg-international dec-mcs
  transmit /text nextdata.txt
</pre><p>
(This assumes you have some sort of collection process already set up on the
Data General, such as a text editor or the venerable "cat &#62; foo".  The
EIGHTBIT command is equivalent to SET TERMINAL BYTESIZE 8, SET COMMAND
BYTESIZE 8, SET PARITY NONE.)
<p>
To further complicate matters, suppose your local terminal character set is
the same as the remote one, so you don't need terminal character-set
translation, but you need to TRANSMIT a file that is in a different character
set and you want it translated to the host set.  In this case, use SET TERM
CHARACTER-SET to actually specify the character set used on each end, rather
than specifying TRANSPARENT:
<p><pre>
  eightbit
  set file character-set ucs2
  set term character-set latin1 latin1
  transmit /text ucs2data.txt
</pre><p>
The distinction between:
<p><pre>
  SET TERMINAL CHARACTER-SET xxx yyy
</pre><p>
(where xxx and yyy are the same set) and:
<p><pre>
  SET TERMINAL CHARACTER-SET TRANSPARENT
</pre><p>
is new to C-Kermit 7.0, but affects only the TRANSMIT command.
<p>
The TRANSMIT command currently does nothing special with UCS-2/UTF-8 Line and
Paragraph Separator characters; more experience is required to find out how
these behave in a genuine Unicode terminal-host setting.
<p>
Restrictions: As noted, the TRANSMIT command translates from the FILE
character-set to the REMOTE TERMINAL character-set.  This rules out
translations to any character set that is not supported as a REMOTE TERMINAL
character-set, such as UCS-2, EUC-JP, JIS-7, and Shift-JIS.

<p>
<hr>
<h4><a name="x6.6.5.5">6.6.5.5. Summary of Kermit Unicode Commands</a></h4>

<dl>
<dt><b>Specifying file character-set and byte order:</b>
<dd>SET FILE CHARACTER-SET <i>{</i> ..., UCS2, UTF8 <i>}</i><br>
  REMOTE SET FILE CHARACTER-SET <i>{</i> ..., UCS2, UTF8 <i>}</i> (See next section)<br>
  SET FILE UCS BOM <i>{</i> ON, OFF <i>}</i><br>
  SET FILE UCS BYTE-ORDER <i>{</i> BIG-ENDIAN, LITTLE-ENDIAN <i>}</i>
<p>
<dt><b>Specifying the transfer character-set:</b>
<dd>SET TRANSFER CHARACTER-SET <i>{</i> ..., UCS-2, UTF-8 <i>}</i><br>
  REMOTE SET TRANSFER CHARACTER-SET <i>{</i> ..., UCS-2, UTF-8 <i>}</i>
<p>
<dt><b>Specifying the terminal character-set:</b>
<dd>SET TERMINAL CHARACTER-SET <i>{</i> ..., UTF8 <i>}</i> <i>{</i> ..., UTF8 <i>}</i><br>
  SET TERMINAL REMOTE-CHARACTER-SET <i>{</i> ..., UTF8 <i>}</i><br>
  SET TERMINAL LOCAL-CHARACTER-SET <i>{</i> ..., UTF8 <i>}</i>
<p>
<dt><b>Displaying settings:</b>
<dd>SHOW FILE<br>
  SHOW TRANSFER<br>
  SHOW TERMINAL<br>
  SHOW CHARACTER-SETS
<p>
<dt><b>Commands that use these settings include:</b>
<dd>SEND, RECEIVE, GET, etc.<br>
  CONNECT<br>
  TRANSMIT<br>
  LOG SESSION
<p>
<dt><b>Converting files:</b>
<dd>TRANSLATE <i>infile</i> <i>{</i> ..., UCS-2, UTF-8 <i>}</i> <i>{</i> ..., UCS-2, UTF-8 <i>}</i> <i>outfile</i><br>
COPY /SWAP-BYTES <i>infile</i> <i>outfile</i>
</dl>

<p>
<hr>
<h3><a name="x6.7">6.7. Client/Server Character-Set Switching</a></h3>

A simple mechanism has been added to allow the client to change the server's
FILE CHARACTER-SET:
<p><dl>
<dt><b>REMOTE SET FILE CHARACTER-SET</b> <i>name</i>
<dd>The client asks the server to change its file character-set to the one
given.  The <i>name</i> must match one of the server's file character-set
names.  For convenience, C-Kermit uses its own file character-set keyword list
for parsing this command so you can use ? for help and Tab or Esc for
completion.  However, since the server might have a different repertoire (or
even use different names for the same sets), C-Kermit accepts any string you
supply and sends it to the server.  The server, if it supports this command
(C-Kermit 7.0 and K95 1.1.19 do), sets its file character-set as requested,
and also disables automatic character-set switching
(<a href="#x6.5">Section 6.5</a>).  If the
server does not support this command or if it does not support the given
character set, the REMOTE SET FILE CHARACTER-SET command fails.
</dl>
<p>
Here's an example that sends a Japanese text file encoded in Shift-JIS to
a server using every combination of Kermit's Japanese-capable file and
transfer character sets:
<p><pre>
  dcl \&#38;x[] = euc ucs2 utf8             ; transfer character-sets
  dcl \&#38;y[] = eu uc ut                  ; 2-letter abbreviations for them
  dcl \&#38;f[] = shift euc jis7 ucs2 utf8  ; file character-sets
  dcl \&#38;g[] = sj eu j7 uc ut            ; 2-letter abbreviations

  set file char shift-jis               ; local file character-set is Shift-JIS
  for \%i 1 \fdim(&#38;x) 1 {               ; for each transfer character-set...
      set xfer char \&#38;x[\%i]            ; set it
      for \%j 1 \fdim(&#38;f) 1 {           ; for each remote file character-set...
	  remote set file char \&#38;f[\%j] ; set it
	  if fail exit 1 SERVER REJECTED CHARSET
	  send /text meibo-sj.html meibo-sj-\&#38;y[\%i]-\&#38;g[\%j].txt ; send the file
	  if fail exit 1 TRANSFER FAILED
      }
  }
</pre><p>
The Kermit-370 server does not support REMOTE SET FILE CHARACTER-SET, but
since it supports REMOTE KERMIT commands, you can get the same effect with
REMOTE KERMIT SET FILE CHARACTER-SET <i>name</i>.

<p>
<hr>
<h3><a name="x7">7. SCRIPT PROGRAMMING</a></h3>

(Also see <a href="#x2.8">Section 2.8</a>, Scripting Local Programs.)

<h3><a name="x7.0">7.0. Bug Fixes</a></h3>

The following script programming bugs were fixed in C-Kermit 7.0:
<p><ul>
<li>IF EXIST and IF DIRECTORY were fixed to properly strip braces from around
   their arguments, so "if directory {C:\Program Files}", etc, would work as
   expected.  However, this means that if the file or directory name is
   actually enclosed in braces, the braces must be doubled.
<p>
<li>The READ command did not fail if the READ file wasn't open; now it does.
<p>
<li>The READ command refused to read the last or only line of a file if it did
   not end with a proper line terminator; now it does.
<p>
<li>The END command, when given from within a SWITCH statement, did not exit
   from the current macro or command file; instead it just terminated the
   SWITCH.
</ul>

<p>
<hr>
<h3><a name="x7.1">7.1. The INPUT Command</a></h3>

7.1.1. INPUT Timeouts
<p>
The description of the INPUT command on page 422 fails to mention the
following two points about the timeout (which apply to C-Kermit 6.0 and later):
<p><ol>
<li>"<tt>INPUT -1 <i>text</i></tt>" (or "<tt>INPUT \%x <i>text</i></tt>", where
<tt>\%x</tt> is any variable whose value is -1 or less) means "wait forever".
This form of the INPUT command fails only if it is interrupted, since it will
never time out.
<p>
<li>INPUT 0 performs a nonblocking read of material that has already arrived
but has not yet been read, and succeeds immediately if the target string
is found, or fails immediately if it is not found.
</ol><p>
The same points apply to MINPUT.  REINPUT ignores its timeout parameter.

<p>
<hr>
<h4><a name="x7.1.2">7.1.2. New INPUT Controls</a></h4>

The following new INPUT controls were added in version 7.0:
<p><dl>
<dt><b>SET INPUT AUTODOWNLOAD </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Explained in <a href="#x7.7">Section 7.7</a>.
<p>
<dt><b>SET INPUT CANCELLATION </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>This governs whether an INPUT command can be canceled by "pressing any key"
  on the keyboard.  Normally it can be, in which case the INPUT command fails
  immediately and \v(instatus) is set to 2, indicating interruption.  SET INPUT
  CANCELLATION OFF disables keyboard cancellations; thus if the search text is
  not encountered, the INPUT command will run for its entire timeout interval.
  SET INPUT CANCELLATION OFF does not disable interruption by Ctrl-C, however;
  every command needs an emergency exit.  (If you really want to disable
  interruption by Ctrl-C, use SET COMMAND INTERRUPTION OFF.)
</dl><p>
Also see
<a href="#x7.2">Section 7.2</a> for any new variables related to INPUT.

<p>
<hr>
<h4><a name="x7.1.3">7.1.3. INPUT with Pattern Matching</a></h4>

C-Kermit 7.0 allows INPUT, MINPUT, and REINPUT targets to be a pattern
(explained in 
<a href="#x1.19">Sections 1.19</a> and <a href="#x4.9">4.9</a>).  This solves
a long-standing problem illustrated by the following scenario: a certain
company has a bank of TCP/IP
modem servers, with hostnames server1, server2, server3, and so on.  Each
server's prompt is its name, followed by a colon (:), for example "Server72:".
Without INPUT patterns, it would be rather difficult to wait for the prompt.
The brute force approach:
<p><pre>
  minput 20 Server1: Server2: Server3: ... (enumerating each one)
</pre><p>
is subject to failure whenever a new server is added.  A more subtle approach:
<p><pre>
  input 20 Server
  if fail ...
  input 2 :
</pre><p>
is liable to false positives, e.g. "Welcome to the XYZ Corp Modem Server.
Please read the following message:"...
<p>
With patterns, you can match the prompt with "Server*:" (which doesn't solve
the "false positives" problem, but certainly is more compact than the brute
force method), or with more specific patterns such as "Server[1-9]:" and
"Server[1-9][0-9]:", or equivalently:
<p><pre>
  Server{[1-9],[1-9][0-9]}:
</pre><p>
meaning the word "Server" followed by a single digit (1-9) or by two digits
representing a number from 1 to 99, followed by a colon.
<p>
INPUT pattern matching has been added in a way that does not interfere with
existing scripts.  No new commands or switches are used.  The simple rule is:
if an INPUT search target is the argument of the (new) <tt>\fpattern()</tt>
function, it is a pattern.  Otherwise it is taken literally, as before.  For
example:
<p><pre>
  input 5 a*b
</pre><p>
searches for an 'a' followed by an asterisk ('*'), followed by a 'b'.  But:
<p><pre>
  input 5 \fpattern(a*b)
</pre><p>
searches for an 'a' followed by anything at all up to and including the first
'b'.  This means that any search target to INPUT, MINPUT, or REINPUT can be a
pattern or a literal string, and in particular that MINPUT can accommodate any
mixture of patterns and literal strings.
<p>
In selecting patterns, note that:
<p><ul>
<li>A leading '*' is always implied so there is no need to include one.
<li>A trailing '*' is meaningless and ignored.
<li>A '*' by itself matches the first character that arrives.
</ul><p>
A syntax note: If your pattern is a selection list, meaning a list of
alternatives separated by commas and enclosed in braces, then the outer braces
will be stripped by various levels of parsers, so you must include three of
each:
<p><pre>
  input 10 \fpattern({{{abc,mno,xyz}}})
</pre><p>
Note that this is equivalent to:
<p><pre>
  minput 10 abc mno xyz
</pre><p>
except for the setting of the \v(minput) variable.
<p>
And a caution: INPUT pattern matching has a limitation that you probably never
noticed with literal-string matching, namely that there is a limit on the size
of the match.  For example, if the pattern is "a*b", the match will succeed
if the 'a' and 'b' are not separated by more than (say) 8K bytes, but will
fail if they are farther apart than that.  In such cases, it better to use
two INPUTs (e.g. "input 10 a" and then "input 100 b").

<p>
<hr>
<h4><a name="x7.1.4">7.1.4. The INPUT Match Result</a></h4>

The result of any INPUT, MINPUT, or REINPUT command, no matter whether the
search targets are patterns or literal strings, is available in the new
\v(inmatch) variable.  For example:
<p><pre>
  minput 10 cat \fpattern([dh]og)
  if success echo MINPUT matched "\v(inmatch)"
</pre><p>
This is especially useful when a pattern was matched, since it makes the
string that matched the pattern available to Kermit; there would be no way
to get it otherwise.
<p>
After an INPUT command, you can view all the INPUT-related variables by
typing "show variables in" (abbreviate as "sho var in"), which shows the
values of all built-in variables whose names start with "in".

<p>
<hr>
<h3><a name="x7.2">7.2. New or Improved Built-In Variables</a></h3>

<dl>
<dt><b><tt>\v(blockcheck)</tt></b>
<dd>Current BLOCK-CHECK setting, 1, 2, 3, or 4.  4 is the code for BLANK-FREE-2.
<p>
<dt><b><tt>\v(byteorder)</tt></b>
<dd>The machine's byte order: 0 = Big Endian, 1 = Little Endian.
<p>
<dt><b><tt>\v(cmdbufsize)</tt></b>
<dd>The length of the command buffer, which is the maximum
size for a macro, a command, a variable, or anything else
in C-Kermit's script language.
<p>
<dt><b><tt>\v(ctty)</tt></b>
<dd>The device name of C-Kermit's controlling (login) terminal.
<p>
<dt><b><tt>\v(filename)</tt></b>
<dd>Described in 
<a href="#x4.1">Sections 4.1</a> and <a href="#x4.2">4.2</a>.
<p>
<dt><b><tt>\v(filenumber)</tt></b>
<dd>Described in 
<a href="#x4.1">Sections 4.1</a> and <a href="#x4.2">4.2</a>.
<p>
<dt><b><tt>\v(filespec)</tt></b>
<dd>As of C-Kermit 7.0, contains fully qualified filenames rather
than (usually) relative ones.
<p>
<dt><b><tt>\v(return)</tt></b>
<dd>Now holds the END <i>n</i> value of the macro that most recently
returned, in case END was used rather than RETURN.
<p>
<dt><b><tt>\v(editor)</tt></b>
<dd>Pathname of preferred text editor
<dt><b><tt>\v(editopts)</tt></b>
<dd>Command-line options for editor
<dt><b><tt>\v(editfile)</tt></b>
<dd>File most recently edited
<p>
<dt><b><tt>\v(browser)</tt></b>
<dd>Pathname of preferred Web browser
<dt><b><tt>\v(browsopts)</tt></b>
<dd>Command-line options for Web browser
<dt><b><tt>\v(browsurl)</tt></b>
<dd>URL most recently given to Web browser
<p>
<dt><b><tt>\v(dialtype)</tt></b>
<dd>Type of call most recently placed (see 
<a href="#x2.1.11">Section 2.1.11</a>).
<p>
<dt><b><tt>\v(kbchar)</tt></b>
<dd>The character, if any, that was typed at the keyboard to
to interrupt the most recent PAUSE, SLEEP, WAIT, MSLEEP,
or INPUT command; empty if the most recent such command was
not interrupted from the keyboard.
<p>
<dt><b><tt>\v(lockdir)</tt></b>
<dd>UNIX only - The name of the UUCP lockfile directory, if
known, otherwise "(unknown)".
<p>
<dt><b><tt>\v(lockpid)</tt></b>
<dd>UNIX only - PID of process that owns the communication port
that you tried to open with a SET LINE command that failed
because the port was in use, otherwise empty.  This variable
is set with every SET LINE command.
<p>
<dt><b><tt>\v(cx_time)</tt></b>
<dd>If no connection (SET HOST, SET LINE, DIAL, TELNET, etc)
is active, this is 0.  If a connection is active, this is
the number of seconds since the connection was made.
<p>
<dt><b><tt>\v(hwparity)</tt></b>
<dd>If hardware parity is in effect, this variable gives its
value, such as "even" or "odd" (in which case, the \v(parity)
variable will be "none").  Otherwise this variable is empty.
<p>
<dt><b><tt>\v(serial)</tt></b>
<dd>Current serial port settings in 8N1 format
(<a href="#x2.10">Section 2.10</a>).
<p>
<dt><b><tt>\v(errno)</tt></b>
<dd>In UNIX, the current value of the C runtime errno variable,
which is quite volatile (meaning that often an "interesting"
error code can be overwritten by some other library call or
system service that sets errno before you have a chance to
look at it).
In VMS, the error code returned by the system or library
call that most recently failed (success codes are not saved).
Not available in other operating systems.
<p>
<dt><b><tt>\v(errstring)</tt></b>
<dd>The UNIX or VMS system error message that corresponds to
<tt>\v(errno)</tt>.  Not available in all OS's.
Also see <a href="#ferrstring"><tt>\ferrstring()</tt></a>.
<p>
<dt><b><tt>\v(setlinemsg)</tt></b>
<dd>The error message, if any, from the most recent SET LINE,
SET PORT, SET HOST, TELNET, or other connection-making
command.  This is not necessarily the same as \v(errstring)
since these commands might fail without generating a system
error code, for example (in UNIX) because a lockfile existed
indicating the device was assigned by another user.
<p>
<dt><b><tt>\v(exitstatus)</tt></b>
<dd>The exit status C-Kermit would return if it exited now.
<p>
<dt><b><tt>\v(pexitstat)</tt></b>
<dd>The exit status of the inferior process most recently invoked
by C-Kermit (by RUN, !, REDIRECT, SEND /COMMAND, etc).  In
VMS, this code can be given to <tt>\ferrstring()</tt> to get the
corresponding error message (in UNIX, program/command return
codes are not the same as system error codes).  Not available
in operating systems other than UNIX and VMS.  See 
<a href="#x4.2.5">Section 4.2.5</a> for details.
<p>
<dt><b><tt>\v(inmatch)</tt></b>
<dd>The incoming string of characters, if any, that matched the 
most recent INPUT, REINPUT, or MINPUT command.
<p>
<dt><b><tt>\v(intime)</tt></b>
<dd>The number of milliseconds (thousandths of seconds) it took
for the most recent INPUT command to find its match, or -1
if no INPUT command has been given yet.  If the INPUT command
timed out, the value is approximately equal to 1000 times the
INPUT timeout.  If INPUT failed for some other reason, the
value is undefined (\v(instatus) gives INPUT completion
status).  If your version of C-Kermit is built without
high-precision floating-point timers, this number will always
be a multiple of 1000.
<p>
<dt><b><tt>\v(inwait)</tt></b>
<dd>The number of seconds specified as the timeout in the most
recent INPUT command.
<p>
<dt><b><tt>\v(dialsuffix)</tt></b>
<dd>Dialing suffix for use during PDIAL sequence; see 
<a href="#x2.1.10">Section 2.1.10</a>.
<p>
<dt><b><tt>\v(pid)</tt></b>
<dd>UNIX, VMS, and K95 only.  C-Kermit's primary process ID,
numeric, decimal.  If you want to show it in hex, use
<tt>\fn2hex(\v(pid))</tt> If you want to show it in octal, use
<tt>\fn2octal(\v(pid))</tt>.
<p>
<dt><b><tt>\v(printer)</tt></b>
<dd>Current printer name or SET PRINTER value.
<p>
<dt><b><tt>\v(p_ctl)</tt></b>
<dd>Control prefix char
\v(p_8bit)
8-bit prefix char (if parity not none)
<dt><b><tt>\v(p_rpt)</tt></b>
<dd>Repeat prefix char (if repeat compression enabled)
<p>
<dt><b><tt>\v(herald)</tt></b>
<dd>Kermit's version herald
<p>
<dt><b><tt>\v(test)</tt></b>
<dd>Kermit's test version, if any, or 0 if this is not a test
version.  Typical values for test versions are "Alpha.03"
or "Beta.14".
<p>
<dt><b><tt>\v(sendlist)</tt></b>
<dd>The number of entries in the SEND-LIST, 0 if none.  Note:
entries do not necessarily correspond to files, since an
entry might contain wildcards.  Also note that the value does
not go back to 0 after the files in the list are sent.  To
reset this variable, use CLEAR SEND-LIST.  The purpose of
this variable is to determine if a SEND command, when given
without any filenames, will be legal.  Example:
<p><pre>
  xif \v(sendlist) { send } else { send oofa.txt }
</pre><p>
<dt><b><tt>\v(trigger)</tt></b>
<dd>If the most recent CONNECT session was terminated
automatically by a trigger, this variable contains the
trigger value.
<p>
<dt><b><tt>\v(ty_ln)</tt></b>
<dd>TYPE line number (during TYPE)
<dt><b><tt>\v(ty_lc)</tt></b>
<dd>TYPE line count  (after TYPE)
<dt><b><tt>\v(ty_mc)</tt></b>
<dd>TYPE match count (after TYPE)
<p>
<dt><b><tt>\v(xferstat)</tt></b>
<dd>Status of most recent file transfer:
<p><pre>
-1: No transfer yet
 0: Succeeded
 1: Failed
</pre><p>
<dt><b><tt>\v(xfermsg)</tt></b>
<dd>If the most recent file transfer failed, this is the reason.
If it succeeded, \v(xfermsg) is an empty string.
<p>
<dt><b><tt>\v(tftime)</tt></b>
<dd>Total elapsed time of most recent file transfer operation,
in seconds.
<p>
<dt><b><tt>\v(textdir)</tt></b>
<dd>Directory that holds (or is supposed to hold) Kermit text
files such as installation instructions, release notes,
update notes, read-me files, "beware" files, etc.
<p>
<dt><b><tt>\v(name)</tt></b>
<dd>The name with which the Kermit program was invoked, e.g.
"kermit", "wermit", "k95", "k2", etc (see 
<a href="#x9.1">Section 9.1</a>).
<p>
<dt><b><tt>\v(osname)</tt></b>
<dd>Name of operating system on computer where C-Kermit is
running, obtained at runtime (from uname or equivalent).
<p>
<dt><b><tt>\v(osversion)</tt></b>
<dd>Version of operating system on computer where C-Kermit is
running, obtained at runtime (from uname or equivalent).
<p>
<dt><b><tt>\v(osrelease)</tt></b>
<dd>Release of operating system on computer where C-Kermit is
running, obtained at runtime (from uname or equivalent).
<p>
<dt><b><tt>\v(model)</tt></b>
<dd>The specific hardware model of the computer where C-Kermit
is running, if known.
<p>
<dt><b><tt>\v(math_pi)</tt></b>
<dd>The value of Pi (see 
<a href="#x7.23">Section 7.23</a>)
\v(math_e)
The value of e  (see 
<a href="#x7.23">Section 7.23</a>)
\v(math_precision)
How many significant digits in a floating-point number.
<p>
<dt><b><tt>\v(f_count)</tt></b>
<dd>Result of the most recent FILE COUNT (FCOUNT) command.
<dt><b><tt>\v(f_error)</tt></b>
<dd>Numeric error code of most recent FILE command.
<dt><b><tt>\v(f_max)</tt></b>
<dd>Maximum number of files open simultaneously.
</dl>
<p>

The math constants are given in the precision of underlying computer's
floating-point arithmetic.
<p>
Note the distinction between \v(osname)-\v(osversion) and \v(platform); the
latter refers to the platform for which and/or upon which C-Kermit was built,
as opposed to the one on which it is actually running.  Also note that each
operating system can, and probably will, interpret and fill in the os*
variables differently, or not at all.
<p>
The SHOW VARIABLES command now accepts a variable name, prefix, or pattern:
<p><pre>
  show variables         Shows all variables.
  show variables t       Shows all variables that start with "t".
  show variables *ver*   Shows all variables whose names contain "ver".
  show variables *ver    Ditto (an implied "*" is appended).
</pre>

<p>
<hr>
<h3><a name="x7.3">7.3. New or Improved Built-In Functions</a></h3>

The following new file-i/o functions are explained in 
<a href="#x1.22">Section 1.22</a>.
<p><pre>
  \f_status(<i>channel</i>)           <i>Status of file open on channel</i>
  \f_pos(<i>channel</i>)              <i>Read/write (byte) pointer of given file</i>
  \f_line(<i>channel</i>)             <i>Current line of file</i>
  \f_handle(<i>channel</i>)           <i>Handle of file</i>
  \f_eof(<i>channel</i>)              <i>Whether given file is at EOF</i>
  \f_getchar(<i>channel</i>)          <i>Read a char from given file</i>
  \f_getline(<i>channel</i>)          <i>Read a line from given file</i>
  \f_getblock(<i>channel,n</i>)       <i>Read a block from given file</i>
  \f_putchar(<i>channel,c</i>)        <i>Write a char to given file</i>
  \f_putline(<i>channel,string</i>)   <i>Write a line to given file</i>
  \f_putblock(<i>channel,string</i>)  <i>Write a block to given file</i>
</pre><p>
The following new date-time-related functions are explained in 
<a href="#x1.6">Section 1.6</a>:
<p><pre>
  \fday()                <i>Returns day of week of given date</i>
  \fnday()               <i>Returns numeric day of week of given date</i>
  \ftime()               <i>Returns time portion of given date-time</i>
  \fntime()              <i>Converts time to seconds since midnight</i>
  \fn2time()             <i>Converts seconds since midnight to hh:mm:ss</i>
  \fcvtdate(<i>date-time</i>)   <i>Converts free-format date to yyyymmdd hh:mm:ss</i>
  \fdayofyear(<i>date-time</i>) <i>Converts date to yyyyddd (day-of-year) format</i>
  \fdoy(<i>date-time</i>)       <i>Synonym for \fdayofyear()</i>
  \fdoy2date(<i>dayofyear</i>)  <i>Converts yyyyddd to yyyymmdd</i>
  \fmjd(<i>date-time</i>)       <i>Converts free-format date to Modified Julian Date</i>
  \fmjd2date(<i>mjd</i>)        <i>Converts modified Julian date to yyyymmdd</i>
</pre><p>
The new floating-point arithmetic functions are explained in 
<a href="#x7.23">Section 7.23</a>.  f1
and f2 are floating-point (real) numbers; d is the number of decimal places to
show:
<pre><p>
  \ffpabsolute(<i>f1,d</i>)     <i>Absolute value of f1</i>
  \ffpadd(<i>f1,f2,d</i>)       <i>f1 + f1</i>
  \ffpcosine(<i>f1,d</i>)       <i>Cosine of f1</i>
  \ffpdivide(<i>f1,f2,d</i>)    <i>f1 divided by f2</i>
  \ffpexp(<i>f1,d</i>)          <i>e to the f1 power</i>
  \ffpint(<i>f1</i>)            <i>Integer part of f1</i>
  \ffplog10(<i>f1,d</i>)        <i>Log base 10 of f1</i>
  \ffplogn(<i>f1,d</i>)         <i>Natural log of f1</i>
  \ffpmaximum(<i>f1,f2,d</i>)   <i>Maximum of f1 and f2</i>
  \ffpminimum(<i>f1,f2,d</i>)   <i>Minimum of f1 and f2</i>
  \ffpmodulus(<i>f1,f2,d</i>)   <i>Modulus of f1 and f2</i>
  \ffpmultiply(<i>f1,f2,d</i>)  <i>Product of f1 and f2</i>
  \ffpraise(<i>f1,f2,d</i>)     <i>Raise f1 to power f2</i>
  \ffpround(<i>f1,d</i>)        <i>Round f1 to d places</i>
  \ffpsine(<i>f1,d</i>)         <i>Sine of f1</i>
  \ffpsqrt(<i>f1,d</i>)         <i>Square root of f1</i>
  \ffpsubtract(<i>f1,f2,d</i>)  <i>f2 - f1</i>
  \ffptangent(<i>f1,d</i>)      <i>Tangent of f1</i>
</pre><p>
Integer number functions:
<p><dl>
<dt><tt><b>\fabsolute(</b><i>n</i><b>)</b></tt>
<dd>Absolute value of integer <i>n</i>.
<p>
<dt><tt><b>\frandom(</b><i>n</i><b>)</b></tt>
<dd>Returns a random integer between 0 and n-1.
<p>
<dt><tt><b>\fradix(</b><i>s,n1,n2</i><b>)</b></tt>
<dd>If the string <i>s</i> is an integer in radix <i>n1</i>, the result is the
same number expressed in radix <i>n2</i>, where <i>n1</i> and <i>n2</i> may be
any number from 2 through 36, 
expressed as decimal numbers, or variables (etc) that evaluate to decimal
numbers.  For the source and result, the digits of any radix, <i>r</i>, are the
first <i>r</i> characters in the sequence 0-9,a-z (case doesn't matter for the
letters).  The string s may have a sign, <tt>+</tt> or <tt>-</tt>; if it
starts with a minus (<tt>-</tt>) sign, the result also has a minus sign.
</dl><p>

The <tt>\fradix()</tt> function does not work with floating-point numbers.  It
does not reveal the internal storage format of a number; for example,
<tt>\fradix(-1,10,16)</tt> is -1, not something like FFFFFFFFFF.  If all three
arguments are not given, or if n1 or n2 are not numbers between 2 and 36
inclusive, or s is not a number in radix n1, an error occurs and the empty
string is returned.  <tt>\fradix()</tt> also does not offer extended-precision
arithmetic; number values are limited to those expressed as a long integer in
the architecture of the underlying computer, usually 32 or 64 bits.  If you
give it an argument whose absolute value is larger than can be held in an
unsigned long, the result is -1.

<p>
The next four are shorthand functions for decimal/hexadecimal and
decimal/octal number conversion:
<p><dl>
<dt><tt><b>\fn2hex(</b><i>n</i><b>)</b></tt>
<dd>Returns the hexadecimal (base 16) representation of the integer <i>n</i>.  This is
different from \fhexify(s), which treats its argument as a string rather
than a number.  The result is always left-padded with 0's to make its
length even.  Examples:
<p><pre>
  \n2hex(0)   = "00"                    \fhexify(0)   = "30"
  \n2hex(255) = "ff"                    \fhexify(255) = "323535"
  \n2hex(256) = "0100"                  \fhexify(256) = "323536"
</pre><p>
<dt><tt><b>\fhex2n(</b><i>x</i><b>)</b></tt>
<dd>Converts hexadecimal number x to decimal equivalent decimal number.
This is the inverse of <tt>\fn2hex()</tt>.  Equivalent to
</tt>\fradix(<i>s</i>,16,10)</tt>.
<p>
<dt><tt><b>\fn2octal(</b><i>n</i><b>)</b></tt>
<dd>Returns the octal (base 8) representation of the number <i>n</i>.
Examples:
<pre>
  \n2octal(0) = "0"
  \n2oct(255) = "377"
  \n2oct(256) = "400"
  Equivalent to \fradix(n,10,8).
</pre><p>
<dt><tt><b>\foct2n(</b><i>n</i><b>)</b></tt>
<dd>Returns the decimal representation of the given octal number, <i>n</i>.
The inverse of <tt>\fn2octal()</tt>.  Equivalent to
<tt>\fradix(<i>n</i>,8,10)</tt>.
</dl><p>
String functions:
<p><dl>
<dt><tt><b>\s(</b><i>name</i>[<i>n</i>:<i>m</i>]<b>)</b></tt>
<dd>Equivalent to \fsubstring(\m(name),n,m)
(<a href="#x7.24">Section 7.24</a>).
<p>
<dt><tt><b>\:(</b><i>name</i>[<i>n</i>:<i>m</i>]<b>)</b></tt>
<dd>Equivalent to \fsubstring(name,n,m) (where "name" is any \-quantity)
(<a href="#x7.24">Section 7.24</a>).
<p>
<dt><tt><b>\fleft(</b><i>s,n</i><b>)</b></tt>
<dd>The leftmost <i>n</i>characters of string s; equivalent to \fsubstring(s,1,n).
<p>
<dt><tt><b>\fstripx(</b><i>string,char</i><b>)</b></tt>
<dd>Returns the part of the string up to the rightmost occurrence, if any, of
the given character.  The default character is period (<tt>.</tt>)  Examples:
<pre>
  \fstripx(foo/bar,/)                 = "foo"
  \fstripx(foo/bar/baz,/)             = "foo/bar"
  \fstripx(autoexec.bat,.)            = "autoexec"
  \fstripx(autoexec.bat)              = "autoexec"
  \fstripx(fstripx(foo/bar/baz,/),/)  = "foo"
</pre><p>
<dt><tt><b>\flop(</b><i>string,character</i><b>)</b></tt>
<dd>Returns the portion of the string starting after the first occurrence of
the given character.  The default character is period (.)  Examples:
<pre>
  \flop(autoexec.bat)                 = "bat"
  \flop(baz.foo/bar)                  = "foo/bar"
  \flop(baz.foo/bar,/)                = "bar
</pre><p>
<dt><tt><b>\fstripn(</b><i>string,n</i><b>)</b></tt>
<dd>Returns the string with <i>n</i>characters removed from the end.  Example:
<pre>
  \fstripn(12345678,3)                = "12345"
</pre><p>
(For more discussion of <tt>\fstripx()</tt>, <tt>\fstripn()</tt>, and
<tt>\flop()</tt> see
<a href="#x4.2.3">Section 4.2.3</a>).
<p>
<dt><tt><b>\fb64encode(</b><i>s</i><b>)</b></tt>
<dd>Returns the Base-64 encoding of the string s.
<p>
<dt><tt><b>\fb64decode(</b><i>s</i><b>)</b></tt>
<dd>Returns the decoding of the Base-64 string s.  Fails if s is not a Base-64
  string, or if its length is not a multiple of 4.  Note that if any of the
  result bytes are null (0), the result string stops there.  There is no way
  to represent strings that contain null bytes in C-Kermit (the same is true
  for <tt>\funhexify()</tt>).
<p>
<dt><tt><b>\fword(</b><i>s1,n,s2,s3</i><b>)</b></tt>
<dd>Extracts word number <i>n</i>from string s1.  By default, a "word" is any
sequence of ASCII letters or digits; <i>n</i>is 1-based.  If <i>n</i>is
omitted, "1" is used.
  Examples:
<p><pre>
  \fword(one two three)    = "one"
  \fword(one two three,1)  = "one"
  \fword(one two three,2)  = "two"
  \fword(one two three,3)  = "three"
</pre><p>
and:
<p><pre>
    \fword(\v(dialresult),2) = "31200"
</pre><p>
is "<tt>31200</tt>" if \v(dialresult) is (e.g.)
"<tt>CONNECT 31200/ARQ/V32/LAPM/V42BIS</tt>".
<p>
If you include s2, this replaces the default break set.  For example,
suppose you have a string <tt>\%a</tt> whose value is:
<p><pre>
  $150.00 $300.00 $39.95
</pre><p>
and you want each dollar amount to be a word; use:
<p><pre>
  \fword(\%a,\%n,{ })
</pre><p>
This returns dollar amount number <tt>\%n</tt>, e.g. "$300.00" for
<tt>\%n = 2</tt>.  "<tt>{ }</tt>"
denotes a space (you must enclose it in braces, otherwise it is squeezed
out).  Note that ASCII control characters are always included in the break
set; you don't have to specify them (and you can't not specify them).
<p>
The optional s3 argument lists characters (even control characters) that
normally would be considered separators that you want included in words.
So the dollars-and-cents example could also be handled this way:
<p><pre>
  \fword(\%a,\%n,,$.)
</pre><p>
in other words, use the default separator list, but remove "$" and "<tt>.</tt>"
from it so they will be considered part of a word.
<p>
<dt><tt><b>\fsplit(</b><i>s1,&#38;a,s2,s3</i><b>)</b></tt>
<dd>This is like <tt>\fword()</tt>, except instead of extracting and returning
a particular word from string s1, it counts the words and optionally assigns
them to the array whose identifying letter, a-z, is given after the
"<tt>&#38;</tt>" in the second argument, with the first word going into
element 1, the second into element 2, and so on.  The rules regarding break
and include lists (s2 and s3) are exactly the same as for <tt>\fword()</tt>.
<tt>\fsplit()</tt>
returns the number of words that were assigned, which is either the number of
words in the string, or the dimension of the array, whichever is less.  If the
array is not declared, <tt>\fsplit()</tt> creates it and returns a number
which is both the number of words in s1 and the dimension of the new array.
Examples:
<p><pre>
  declare \&#38;w[20]        ; (Optional.)
  ...
  read \%s               ; \%s is "This is a sentence with seven words."
  ...
  echo "\fsplit(\%s)"    ; This would print "7".
  echo "\fsplit(\%s,&#38;w)" ; Ditto, and also assigns them to array \&#38;w[].

  echo "\&#38;w[7]"          ; This would print "words".
</pre><p>
If the line contained fields that were delimited by colon (:), you would use
<tt>\fsplit(\%s,&#38;w,:)</tt>.  If the fields were delimited by comma, then
you would  use <tt>\fsplit(\%s,&#38;w,{,})</tt>; in this case the literal
comma must be enclosed in 
braces to distinguish it from the comma that separates function arguments.
To get a word count without loading an array, but still specify break
and/or include lists, leave the array argument empty:
<p><pre>
   echo "\fsplit(\%s,,:)" ; Use colon as the separator.
</pre><p>
WARNINGS:
<ol>
<li>If you use the same array repeatedly, <tt>\fsplit()</tt> leaves any
trailing members undisturbed.  For example:
<pre>
  dcl \&#38;w[10]
  \fsplit(1 2 3 4 5,&#38;w) ; Sets \&#38;w[1] thru \&#38;w[5].
  \fsplit(a b c,&#38;w)     ; Sets \&#38;w[1]-[3] leaving [4]-[5] as they were.
</pre><p>
<li>If you allow \fsplit to create the array (by not declaring it first),
it is dimensioned to the number of elements it was created with:
<pre>
  \fsplit(1 2 3,&#38;x)     ; Creates an array \&#38;x[] with 3 elements.
  \fsplit(a b c d e,&#38;x) ; This overflows the array.
</pre></ol><p>
Thus if you want to use <tt>\fsplit()</tt> repeatedly on the same array, either
dimension it in advance to the maximum expected size (and then some --
more efficient), or else destroy it after each use (to allow for
unexpectedly large arguments).  Example using a dynamic array:
<p><pre>
  fopen /read \%c some-file
  if fail ...
  set function error on    ; See <a href="#x7.12">Section 7.12</a>
  while true {
      dcl \&#38;w[]            ; Destroy \&#38;[w] each time thru the loop
      fread /line \%c \%a
      if fail break
      asg \%x \fsplit(\%a,&#38;w)
      if fail ...
      ; (do what you want with \&#38;w[] here...)
  }
  fclose \%c
</pre><p>
<dt><tt><b>\frindex(</b><i>s1,s2,n</i><b>)</b></tt>
<dd>The "n" argument to <tt>\frindex()</tt> now works consistently (in mirror
image) with the corresponding <tt>\findex()</tt> argument.  In each case, the
(<i>n</i>-1)-most 
characters of <i>s2</i> are ignored in the search; for findex, this means the
starting position of the search is <i>n</i> (the default <i>n</i>is 1, and 0 is
treated like 1).  For <tt>\frindex()</tt> it means the default starting point
is:
<p><pre>
  length(<i>s2</i>) - length(<i>s1</i>) - <i>n</i> (with the same defaults for <i>n</i>).
</pre><p>
<dt><tt><b>\fsearch(</b><i>pattern,string</i>[,<i>position</i>]<b>)</b></tt>
<dd>Exactly like <tt>\findex()</tt>, except with a pattern (see 
<a href="#x7.9">Section 7.9</a>) rather
than a literal string.
<p>
<dt><tt><b>\frsearch(</b><i>pattern,string[,position]</i><b>)</b></tt>
<dd>Exactly like <tt>\frindex()</tt>, except with a pattern rather than a
literal string.
<p>
File Functions:
<p>
<dt><tt><b>\ffiles()</b>, <b>\fnextfile()</b></tt>
<dd>It is no longer necessary to copy the file list to an array before use, as
shown on p.398 of
<a href="ckb2.html"><cite>Using
C-Kermit</cite></a> 2nd Edition.  <tt>\ffiles()</tt> and friends now make
their own safe copies of the file list.  Thus constructions like the following
are now possible:
<p><pre>
  for \%i 1 \ffiles(*.txt) 1 { send \fnextfile() }
</pre><p>
The same is true for the new function <tt>\frfiles()</tt>,
<tt>\fdirectories()</tt>, and <tt>\frdirectories()</tt>, described in
<a href="#x4.11.3">Section 4.11.3</a>.
<p>
But note that each reference to <tt>\fnextfile()</tt> still gets you the next
file.   So "<tt>if newer \fnextfile() foo.txt send \fnextfile()</tt>" compares
one file's age with that of <tt>foo.txt</tt>, and then sends an entirely
different file.  If you're going to refer to the same file more than once,
assign it to a  variable:
<p><pre>
  asg \%f \fnextfile()
  if newer \%f foo.txt send \%f
</pre><p>
(note: assign, <i>not</i> define).
<p>
Also note that <tt>\ffiles()</tt>, <tt>\frfiles()</tt>,
<tt>\fdirectories()</tt>, and <tt>\frdirectories()</tt>
all now accept on optional 2nd argument: the name of an array to load with
the resulting file or directory list, explained in 
<a href="#x4.11.3">Section 4.11.3</a>.
So you can also load an array with the filelist when you need to refer to
the same file more than once:
<p><pre>
  for \%i 1 \ffiles(*,&#38;a) 1 { if newer \&#38;a[\%i] foo.txt send \&#38;a[\%i] }
</pre><p>
<dt><tt><b>\fpermissions(</b><i>file</i><b>)</b></tt>
<dd>Returns the platform-specific permissions string for the file, such as
"-rw-rw-r--" in UNIX or "(RWE,RWE,RE,E)" in VMS.
<p>
<dt><tt><b>\fdirname(</b><i>f</i><b>)</b></tt>
<dd>Given a file specification f, this function returns the complete pathname
of directory the file is in.
</dl><p>
Array Functions:
<p><dl>
<dt><tt><b>\fdimension(</b><i>&#38;a</i><b>)</b></tt>
<dd>Returns the dimension declared for the array whose identifying letter, a-z,
or special character "_" or "@", is given after the "<tt>&#38;</tt>" in the
argument.  If the array is not declared, 0 is returned.  Note that when used
with the macro argument vector array, <tt>\&#38;_[]</tt> (see 
<a href="#x7.5">Section 7.5</a>),
the value of this function is one less than <tt>\v(argc)</tt>, and when used
with the C-Kermit 
command-line argument vector array, <tt>\&#38;@[]</tt>, it is equal to the
</tt>\v(args)</tt> variable.  Examples:
<p><pre>
  echo \fdimension(&#38;a)       ; Not declared.
  0
  declare \&#38;a[12]            ; Now it's declared.
  echo \fdim(&#38;a)
  12
</pre><p>
<dt><tt><b>\farraylook(</b><i>pattern,arrayname</i><b>)</b></tt>
<dd>Looks in the given array for the pattern and returns the index of the first
element that matches, if any, or -1 if none match.  The arrayname can
include a range specifier to restrict to search to a segment of the array,
e.g. <tt>\farraylook(*xyz*,&#38;a[32:63])</tt>.  For greater detail see
<a href="#x7.10.7">Section 7.10.7</a>.
<p>
<dt><tt><b>\ftablelook(</b><i>keyword,arrayname[,delimiter]</i><b>)</b></tt>
<dd>Looks in the given "table", which must be sorted, for the given keyword.
Returns the index of the table element that uniquely matches the given
keyword, or -1 if none match, or -2 if more than 1 match.
For greater detail see 
<a href="#x7.10.7">Section 7.10.7</a>.
</dl><p>
Other new functions:
<p><dl>
<dt><tt><b>\fip2hex(</b><i>s</i><b>)</b></tt>
<dd>Converts a dotted decimal IP address to an 8-digit hexadecimal number.
<tt><b>\fip2hex(</b>128.59.39.2<b>)</b> = 803b2702</tt>.
<p>
<dt><tt><b>\fhex2ip(</b><i>x</i><b>)</b></tt>
<dd>Converts an 8-digit hexadecimal IP address to dotted decimal form, e.g.
<tt>\fhex2ip(803b2702) = 128.59.39.2</tt>.  The inverse of <tt>\fip2hex()</tt>.
<p>
<dt><tt><b>\fcommand(</b><i></i><b>)</b></tt>
<dt><tt><b>\frawcommand(</b><i></i><b>)</b></tt>
<dd>These run an external command and return its output; see 
<a href="#x4.2.8.4">Section 4.2.8.4</a>.
<p>
<dt><tt><b>\fdialconvert(</b><i>s</i><b>)</b></tt>
<dd>s is a phone number in either literal or portable format (not a dialing
directory entry name).  The function returns the dial string that would
actually be used when dialing from the current location (after processing
country code, area code, and other SET DIAL values).
<p>
<dt><a name="ferrstring"><tt><b>\ferrstring(</b><i>n</i><b>)</b></tt></a>
<dd>Returns the system error message associated with the (numeric) error code
<i>n</i>. UNIX and VMS only.  Use in conjunction with <tt>\v(errno)</tt> or
<tt>\v(pexitstat)</tt>.  See 
<a href="#x4.2.5">Section 4.2.5</a> for a usage example.  Note: This
function doesn't work in Windows because there is not a consistent
error-code-to-message mapping; error code "x" means something completely
different depending on whether it comes from the C runtime library, Winsock, a
Windows-32 API, TAPI, etc,
<p>
<dt><tt><b>\fpattern(</b><i>s</i><b>)</b></tt>
<dd>Used in INPUT, REINPUT, and MINPUT commands to denote search strings that
are to be treated as patterns rather than literally.
</dl>
<p>
Also see 
<a href="#x7.8">Section 7.8</a> on built-in help for functions.

<p>
<hr>
<h3><a name="x7.4">7.4. New IF Conditions</a></h3>

<dl>
<dt><b>IF AVAILABLE</b> <i>feature</i> <i>command</i>
<dd>Executes the <i>command</i> if the given <i>feature</i> is available.
Presently used only to determine if specific authentication and encryption
options are available.  Type "if available ?" to see which features may be
tested.
<p>
<dt><b>IF FLOAT</b> <i>f1 command</i>
<dd>Executes <i>command</i> if f1 is a legal floating point number (which
includes integers).  Use this to preverify arguments for the <tt>\ffp...()</tt>
floating-point arithmetic functions, e.g. "<tt>if float \%1 echo
\ffpint(\%1)</tt>".
<p>
<dt><b>IF<tt> ==</tt></b> <i>n1 n2 command</i>
<dd>Synonym for "if =" (numeric equality).  Note that as of C-Kermit 7.0, this
and all other numeric comparison operators also work for floating-point
numbers.
<p>
<dt><b>IF<tt> !=</tt></b> <i>n1 n2 command</i>
<dd>Executes the <i>command</i> if n1 and n2 are both numbers or variables
containing numbers and the value of n1 is not equal to the value of n2.  This
is equivalent to "if not = n1 n2".
<p>
<dt><b>IF <tt>&#60;=</tt></b> <i>n1 n2 command</i>
<dd>Executes the <i>command</i> if n1 and n2 are both numbers or variables
containing numbers and the value of n1 is less than or equal to the value of
n2.  This is equivalent to "if not &#62; n1 n2".
<p>
<dt><b>IF <tt>&#62;=</tt></b> <i>n1 n2 command</i>
<dd>Executes the <i>command</i> if n1 and n2 are both numbers or variables
containing numbers and the value of n1 is greater than or equal to the value
of n2.   Equivalent to "if not &#60; n1 n2".
<p>
<dt><b>IF COMMAND</b> <i>word</i> <i>command</i>
<dd>Executes the <i>command</i> if <i>word</i> is a built-in C-Kermit command.
Example:<p><pre>
  if not command copy define { copy run copy \%1 \%2 }".
</pre><p>
This defines a COPY macro that runs an external COPY command if COPY
is not already a built-in command.
<p>
<dt><b>IF LOCAL</b> <i>command</i>
<dd>Executes the <i>command</i> if Kermit is in local mode, i.e. if it has a
SET LINE, SET PORT, or SET HOST (TELNET, RLOGIN, etc) device or connection
open.  Does not execute the command if in remote mode.
<p>
<dt><b>IF MATCH</b> <i>string</i> <i>pattern</i> <i>command</i>
<dd>Executes the <i>command</i> if the <i>string</i> matches the
<i>pattern</i>.  For a description of the syntax for the pattern, see
<a href="#x4.9.1">Section 4.9.1</a>.  If you want to test if the string
contains pattern, use <tt>IF \fsearch(<i>pattern,string</i>)</tt>.
<p>
<dt><b>IF OPEN</b> <i>{</i> <b>DEBUG-LOG, SESSION-LOG, TRANSACTION-LOG</b>, <tt>...</tt> <i>} command</i>
<dd>Executes the <i>command</i> if the given file is open, fails if it is not
open.   Type IF OPEN ? for a complete list of files that can be checked (all
the files that can be opened with the OPEN or LOG commands).
<p>
<dt><b>IF QUIET</b> <i>command</i>
<dd>Executes the command if SET QUIET is ON, and does not execute it if
SET QUIET is OFF.  Example: IF NOT QUIET ECHO { This is a message.}.
<p>
<dt><b>IF READABLE</b> <i>name</i>
<dd>Succeeds if <i>name</i> is the name of an existing file or directory that
is readable.
<p>
<dt><b>IF WRITEABLE</b> <i>name</i>
<dd>Succeeds if <i>name</i> is the name of an existing file or directory that
is writeable, e.g.:
<pre>
  if not writeable \v(lockdir) echo Please read installation instructions!
</pre><p>
<dt><b>IF FLAG</b> <i>command</i>
<dd>This tests a user-settable condition, which can mean anything you like.
SET FLAG ON causes subsequent IF FLAG commands to succeed; SET FLAG OFF
causes them to fail.  One way to use it would be for debugging your
scripts; precede any debugging statements with IF FLAG.  Then SET FLAG on
to debug your script, SET FLAG OFF to run it without debugging.  Another
common use is for causing an inner loop to cause an outer loop to exit.
<p>
<dt><b>IF C-KERMIT</b> <i>command</i>
<dd>C-Kermit, but not Kermit 95 or MS-DOS Kermit, executes the <i>command</i>.
<p>
<dt><b>IF K-95</b> <i>command</i>
<dd>Kermit 95, but not C-Kermit or MS-DOS Kermit, executes the <i>command</i>.
<p>
<dt><b>IF MS-KERMIT</b> <i>command</i>
<dd>MS-DOS Kermit, but not C-Kermit or Kermit 95, executes the <i>command</i>.
</dl>

<p>
<hr>
<h3><a name="x7.5">7.5. Using More than Ten Macro Arguments</a></h3>

The <tt>\v(argc)</tt> variable now gives the actual number of arguments, even
if the number is greater than 9:
<p><pre>
  C-Kermit&#62; <u>define xx echo \v(argc)</u>
  C-Kermit&#62; <u>xx a b c d e f g h i j k l m n o p q r s t u v w x y z</u>
  27
</pre><p>
Remember that <tt>\v(argc)</tt> includes the name of the macro itself, so it
is always at least 1, and is always 1 greater than the actual number of
arguments.  As in versions 6.0 and earlier, if more than 9 arguments are
given, only the first nine are assigned to the variables <tt>\%1..\%9</tt>.
<p>
The <tt>\&#38;_[]</tt> array, discussed on page 353 of <a
href="ckb2.html"><cite>Using
C-Kermit</cite></a>, 2nd ed, now holds all the arguments, up to some
implementation-dependent limit (64 or greater), rather than only the first 9.
To illustrate: the following macro tells the number of arguments it was called
with and then prints them:
<p><pre>
  define show_all_args {
      local \%i
      echo \&#38;_[0] - Number of arguments: \feval(\v(argc)-1)
      for \%i 1 \v(argc)-1 1 { echo \flpad(\%i,3). "\&#38;_[\%i]" }
  }
</pre><p>
Within a macro <tt>\&#38;_[0]</tt>, like <tt>\%0</tt>, contains the name of
the macro.
<p>
At top level, the <tt>\&#38;_[]</tt> array is filled as follows:
<p><ul>
<li>If the first argument on the C-Kermit command line was a filename,
or C-Kermit was invoked from a "Kerbang" script
(<a href="#x7.19">Section 7.19</a>), element
0 contains the filename, and elements 1 through <tt>\v(argc)-1</tt> hold the
remaining command-line arguments.
<p>
<li>Otherwise the program name goes in element 0, and elements 1 through
<tt>\v(argc)-1</tt> hold any arguments that were included after "--" or "="
</ul><p>
The new <tt>\%*</tt> variable, when used within a macro, is replaced by the
text that followed the macro name in the macro invocation.  If no arguments
were given, <tt>\%*</tt> is replaced by the empty string.  Examples:
<p><pre>
  C-Kermit&#62; <u>define xx echo [\%*]</u>
  C-Kermit&#62; <u>define \%a oofa</u>
  C-Kermit&#62; <u>xx</u>
  []
  C-Kermit&#62; <u>xx \%a</u>
  [oofa]
  C-Kermit&#62; <u>xx a</u>
  [a]
  C-Kermit&#62; <u>xx a b</u>
  [a b]
  C-Kermit&#62; <u>xx a b c</u>
  [a b c]
  C-Kermit&#62; <u>xx a b c d e f g h i j k l m n o p q r s t u v w x y z</u>
  [a b c d e f g h i j k l m n o p q r s t u v w x y z]
</pre><p>
Note that <tt>\%*</tt> can not be used at top level, since Kermit does not have
access to the raw command line (only to its elements separately, after they
have been processed by the shell and the C library).
<p>
C-Kermit 7.0 also adds a SHIFT command:
<p><dl>
<dt><b>SHIFT</b> <i>[ number ]</i>
<dd>Shifts the macro arguments (except argument 0) the given number of places
to the left and adjusts \v(argc) accordingly.  The default number is 1.
</dl><p>
To illustrate, suppose macro XXX is invoked as follows:
<p><pre>
  xxx arg1 arg2 arg3
</pre><p>
Then inside XXX, <tt>\%1</tt> is "arg1", <tt>\%2</tt> is "arg2", and
<tt>\%3</tt> is "arg3".  After a SHIFT command is given inside XXX, then
<tt>\%1</tt> is "arg2", <tt>\%2</tt> is "arg3", and <tt>\%3</tt>
is empty.  <tt>\%0</tt> (the name of the macro) remains unchanged.
<p>
If more than 9 arguments were given, then arguments are shifted into the
<tt>\%1..9</tt> variables from the argument vector array.
<p>
At top level, the SHIFT command operates on the <tt>\&#38;_[]</tt> array and
<tt>\%1..9</tt> variables; the <tt>\&#38;@[]</tt> array is not affected.  See
<a href="#x7.16">Section 7.16</a> for details.
<p>
The <tt>\%*</tt> variable is not affected by the SHIFT command.

<p>
<hr>
<h3><a name="x7.6">7.6. Clarification of Function Call Syntax</a></h3>

Spaces are normally stripped from the front and back of each function
argument; to prevent this enclose the argument in braces:
<p><pre>
  \fsplit(\%a,&#38;a,{ })
</pre><p>
However, function calls that contain spaces can make trouble when the function
is to be used in a "word" field, since space separates words.  For example:
<p><pre>
  for \%i 1 \fsplit(\%a,&#38;a,{ }) 1 {
    echo \%i. "\&#38;a[\%i]"
  }
</pre><p>
In most cases, the trouble can be averted by enclosing the function reference
in braces:
<p><pre>
  for \%i 1 {\fsplit(\%a,&#38;a,{ })} 1 {
    echo \%i. "\&#38;a[\%i]"
  }
</pre><p>
or by replacing spaces with \32 (the ASCII code for space):
<p><pre>
  for \%i 1 \fsplit(\%a,&#38;a,\32) 1 {
    echo \%i. "\&#38;a[\%i]"
  }
</pre><p>
Braces are also used in function calls to indicate grouping.  For example:
<p><pre>
  \fsubstring(abcd,2,2) = "bc"
</pre><p>
But suppose "abcd" needed to contain a comma:
<p><pre>
  \fsubstring(ab,cd,2,2)
</pre><p>
This would cause an error, since "cd" appears to be the second argument, when
really you want the first "2" to be the second argument.  Braces to the rescue:
<p><pre>
  \fsubstring({ab,cd},2,2) = "b,"
</pre><p>
Similarly, leading and trailing spaces are stripped from each argument, so:
<p><pre>
  \fsubstring( abcd ,2,2) = "bc"
</pre><p>
but braces preserve them:
<p><pre>
  \fsubstring({ abcd },2,2) = "ab"
</pre><p>
Given these special uses for braces, there is no way to pass literal braces to
the function itself.  For example:
<p><pre>
  \fsubstring(ab{cd,2,2)
</pre><p>
causes an error.
<p>
So if you need a function to include braces, define a variable containing the
string that has braces.  Example:
<p><pre>
  define \%a ab{cd
  \fsubstring(\%a,2,2) = "b{"
</pre><p>
If the string is to start with a leading brace and end with a closing brace,
then double braces must appear around the string (which itself is enclosed in
braces):
<p><pre>
  define \%a {{{foo}}}
  \fsubstring(\%a) = "{foo}"
</pre><p>
This also works for any other kind of string:
<p><pre>
  define \%a {{ab{cd}}
  echo \fsubstring(\%a) = "ab{cd"
</pre>

<p>
<hr>
<h3><a name="x7.7">7.7. Autodownload during INPUT Command Execution</a></h3>

As of 6.1 / 1.1.12, C-Kermit can be told to look for incoming Kermit (or
Zmodem) packets during execution of an INPUT command.  By default (for
consistency with earlier releases), this is not done.  You can enable this
feature with:
<p><pre>
  SET INPUT AUTODOWNLOAD ON
</pre><p>
(and disable it again with OFF.)
<p>
One possible use for this feature is as a server mode with a time limit:
<p><pre>
  INPUT 3600 secret-string-to-end-the-INPUT-command
</pre><p>
In this example, any GET, SEND, or REMOTE commands received within one hour
(3600 seconds) of when the INPUT command was issued will be executed.  Here's
another example, in which we want to stay open until 11:30pm, or until
interrupted by seven consecutive Ctrl-C (\3) characters:
<p><pre>
  INPUT 23:30:00 \3\3\3\3\3\3\3
</pre><p>
The INPUT AUTODOWNLOAD setting is displayed by SHOW SCRIPTS or SHOW INPUT.

<p>
<hr>
<h3><a name="x7.8">7.8. Built-in Help for Functions.</a></h3>

Beginning in C-Kermit 7.0, you may obtain a description of the calling
conventions and return values of any built-in function, such as
<tt>\fsubstring()</tt>, with the new HELP FUNCTION command; give the function's
name without the leading "<tt>\f</tt>", e.g. "help func substring".  You can
use <tt>?</tt>, completion, and abbreviation in the normal manner.

<p>
<hr>
<h3><a name="x7.9">7.9. Variable Assignments</a></h3>
<h4><a name="x7.9.1">7.9.1. Assignment Operators</a></h4>

Programmers accustomed to languages such as C or Fortran might find Kermit's
method of assigning values to variables unnatural or awkward.  Beginning in
C-Kermit 7.0, you can use the following alternative notation:
<p><pre>
 .name = value    <i>is equivalent to</i>   DEFINE <i>name value</i>
 .name := value   <i>is equivalent to</i>   ASSIGN <i>name value</i>
 .name ::= value  <i>is equivalent to</i>   ASSIGN <i>name</i> \feval(<i>value</i>)
</pre><p>
When the command begins with a period (.), this indicates an assignment.
The name can be a macro name, a \%{digit,letter} variable, or an array
element.  There can be space(s) between "<tt>.</tt>" and the name.  Examples:
<p><pre>
  .\%a = This is a string  ; Same as "define \%a This is a string"
  echo \%a
  This is a string

  .xxx = \%a               ; Same as "define xxx \%a"
  echo \m(xxx)
  \%a

  .xxx := \%a              ; Same as "assign xxx \%a"
  echo \m(xxx)
  This is a string

  declare \&#38;a[2]           ; Use with arrays...
  define \%i 2
  .\&#38;a[1] = first
  .\&#38;a[\%i] = second
</pre><p>

The following sequence illustrates the differences among three levels of
evaluation:
<p><pre>
  .\%x = 2          ; Define a variable to have a numeric value
  .\%y = (3 + \%x)  ; Define another variable as an arithmetic expression

  .xxx = 4 * \%y    ; "=" simply copies the right-hand side.
  echo \m(xxx)
  4 * \%y

  .xxx := 4 * \%y   ; ":=" evaluates the variables first, then copies.
  echo \m(xxx)
  4 * (3 + 2)

  .xxx ::= 4 * \%y  ; "::=" evaluates the expression, then copies.
  echo \m(xxx)
  20
</pre><p>
You can also use this syntax to clear (undefine) a variable:
<p><pre>
  .\%a = oofa       ; Define the variable
  echo "\%a"
  "oofa"
  .\%a              ; Clear the variable
  echo "\%a"
  ""
</pre><p>
Extra credit: Can you guess what happens below when the file "abc" does not
exist?
<p><pre>
  fopen /read \%c abc
  if fail ...
</pre>

<p>
<hr>
<h4><a name="x7.9.2">7.9.2. New Assignment Commands</a></h4>

Recall the DEFINE and ASSIGN commands, and their hidden counterparts,
_DEFINE and _ASSIGN.  The former take the variable name literally, the latter
evaluate the variable-name field to form the variable name dynamically.
Examples:
<p><pre>
  DEFINE \%x foo    ; Sets the value of the variable \%x to "foo".
  DEFINE \%a \%x    ; Sets the value of the variable \%a to "\%x".
  _DEFINE x_\%a \%x ; Sets the value of the variable x_foo to "\%x".
  ASSIGN \%a \%x    ; Sets the value of the variable \%a to the "foo".
  _ASSIGN x_\%a \%x ; Sets the value of the variable x_foo to "foo".
</pre><p>
This concept has been carried over to the remaining variable-assignment
commands: EVALUATE, INCREMENT, and DECREMENT:
<p><dl>
<dt><b>EVALUATE</b> <i>variablename</i> <i>expression</i>
<dd>Evaluates the arithmetic <i>expression</i> and assigns its value to the
  variable whose name is given.  Example: "eval \%a 1+1" assigns "2" to \%a.
<p>
<dt><b>_EVALUATE</b> <i>metaname</i> <i>expression</i>
<dd>Evaluates the arithmetic <i>expression</i> and assigns its value to the
  variable whose name is computed from the given <i>metaname</i>.  Example:
  "<tt>eval foo&#60;\%a&#62;::\%1 \%2 * (\%3 + \%4)</tt>" assigns the value of
  "<tt>\%2 * (\%3 + \%4)</tt>" to the variable whose name is computed from
  "<tt>foo&#60;\%a&#62;::\%1</tt>".
<p>
<dt><b>INCREMENT</b> <i>variablename</i> <i>[ expression ]</i>
<dd>Evaluates the arithmetic <i>expression</i> and adds its value to the
  value of the variable whose name is given.  Example: "increment \%a".
<p>
<dt><b>_INCREMENT</b> <i>metaname</i> <i>[ expression ]</i>
<dd>Evaluates the arithmetic <i>expression</i> and adds its value to the
  value of the variable whose name is computed from the given <i>metaname</i>.
  Example: "<tt>_increment Words::\%1.count[\%2]</tt>".
<p>
<dt><b>DECREMENT</b> <i>variablename</i> <i>[ expression ]</i>
<dd>Evaluates the arithmetic <i>expression</i> and subtracts its value from the
value of the variable whose name is given.
<p>
<dt><b>_DECREMENT</b> <i>metaname</i> <i>[ expression ]</i>
<dd>Evaluates the arithmetic <i>expression</i> and subtracts its value from the
value of the variable whose name is computed from the given <i>metaname</i>.
</dl><p>
WARNING: The syntax of the EVALUATE command has changed since C-Kermit 6.0
and K95 1.1.17.  Previously, it did not include a variable name, only an
expression.  To restore the old behavior, use SET EVALUATE OLD.  To return
to the new behavior after restoring the old behavior, use SET EVALUATE NEW.
<p>
NOTE: There are no analogs to the "_" commands for the operators described in 
<a href="#x7.9.1">Section 7.9.1</a>; those operators can not be used to assign
values to variables whose names must be computed.

<p>
<hr>
<h3><a name="x7.10">7.10. Arrays</a></h3>

C-Kermit 7.0 adds lots of new array-related features, and groups them together
under the NEW ARRAY command:
<p>
<b>ARRAY</b> <i>{</i> <b>CLEAR, COPY, DECLARE, DESTROY, RESIZE, SHOW, SORT</b> <i>}</i>
<p>
In each of the ARRAY commands, wherever an array name is expected, "short
forms" may be used.  For example, all of the following are acceptable:
<p><pre>
  array show \&#38;a[]  (or SHOW ARRAY...)
  array show &#38;a[]
  array show a[]
  array show &#38;a
  array show a
</pre><p>
In addition, ranges are accepted in the ARRAY COPY, ARRAY CLEAR, ARRAY SET,
ARRAY SHOW, and ARRAY SORT commands:
<p><pre>
  array clear \&#38;a[16]     ; Clears 16 thru end
  array clear &#38;a[16]      ; Ditto
  array clear a[16]       ; Ditto

  array clear \&#38;a[16:32]  ; Clears 16 thru 32
  array clear &#38;a[16:32]   ; Ditto
  array clear a[16:32]    ; Ditto
</pre><p>
When using array names as function arguments, you must omit the "\" and you
must include the "<tt>&#38;</tt>".  You may optionally include empty brackets.
Examples:
<p><pre>
  \fsplit(\%a,a)          ; Bad
  \fsplit(\%a,\&#38;a)        ; Bad
  \fsplit(\%a,&#38;a[3])      ; Bad

  \fsplit(\%a,&#38;a)         ; Good
  \fsplit(\%a,&#38;a[])       ; Good
</pre>

<p>
<hr>
<h4><a name="x7.10.1">7.10.1. Array Initializers</a></h4>

Beginning in C-Kermit 7.0, you may initialize an array -- in whole or in part
-- in its declaration:
<p>
<i>[</i> <b>ARRAY</b> <i>]</i> <b>DECLARE</b> <i>array-name</i>[<i>size</i>] <i>[</i> <b>=</b> <i>] [ value1 [ value2 [...] ] ]</i>
<p>

For compatibility with versions 5A and 6.0, the ARRAY keyword is optional.
DECLARE can also be spelled DCL.
<p>

Initializers are (a) optional, (b) start with element 1, (c) must be enclosed
in braces if they contain spaces, and (d) are evaluated according to normal
rules by the DECLARE command prior to assignment.  Thus the assignments made
here are the same as those made by the ASSIGN command.  This allows you to
initialize array elements from the values of other variables.  If you actually
want to initialize an array element to variable's name, as opposed to its
value, use double backslashes (as in "\\&#38;a", "\\v(time)", etc).
<p>

The <i>size</i> (dimension) of the array is optional.  If the size is omitted,
as in "<tt>\&#38;a[]</tt>", then the array sizes itself to the number of
initializers; if there are no initializers the array is not declared or, if it
was declared previously, it is destroyed.  If a size is given, any extra
elements in the initialization list are discarded and ignored.

<p>
NOTE: Unlike in C, the list of initializers is NOT enclosed in braces.
Instead, braces are used to group multiple words together.  So:
<p><pre>
  ARRAY DECLARE \&#38;a[] = { one two three }
</pre><p>
would create an array with two elements (0 and 1), with element 1 having
the value " one two three ".
<p>
Examples:
<p><dl>
<dt><tt>ARRAY DECLARE \&#38;a[16]</tt>
<dd>Declares the array \&#38;a with 17 elements (0 through 16), in which all
elements are initially empty.  If the array \&#38;a[] existed before, the
earlier copy is destroyed.
<p>
<dt><tt>ARRAY DECLARE &#38;a[16]</tt>
<dt><tt>ARRAY DECLARE a[16]</tt>
<dt><tt>ARRAY DCL \&#38;a[16]</tt>
<dt><tt>ARRAY DCL &#38;a[16]</tt>
<dt><tt>ARRAY DCL a[16]</tt>
<dt><tt>DECLARE \&#38;a[16]</tt>
<dt><tt>DECLARE &#38;a[16]</tt>
<dt><tt>DECLARE a[16]</tt>
<dt><tt>DCL \&#38;a[16]</tt>
<dt><tt>DCL &#38;a[16]</tt>
<dt><tt>DCL a[16]</tt>
<dd>All of the above are the same as the first example.
<p>
<dt><tt>ARRAY DECLARE \&#38;a[16] = alpha beta {gamma delta}</tt>
<dd>Declares the array <tt>\&#38;a</tt> with 17 elements (0 through 16),
initializing <tt>\&#38;a[1]</tt> to "alpha", <tt>\&#38;a[2]</tt> to "beta",
and <tt>\&#38;a[3]</tt> to "gamma delta".  The remaining elements are empty.
<p>
<dt><tt>ARRAY DECLARE \&#38;a[] = alpha beta {gamma delta}</tt>
<dd>Same as the previous example, but the array is automatically dimensioned
to 3.
<p>
<dt><tt>ARRAY DECLARE \&#38;a[3] = alpha beta {gamma delta} epsilon zeta</tt>
<dd>Too many initializers; only the first three are kept.
<p>
<dt><tt>ARRAY DECLARE \&#38;a[0]</tt>
<dt><tt>ARRAY DECLARE \&#38;a[]</tt>
<dt><tt>ARRAY DECLARE &#38;a[]</tt>
<dt><tt>ARRAY DECLARE &#38;a</tt>
<dt><tt>ARRAY DECLARE a</tt>
<dt><tt>DECLARE \&#38;[0]</tt>
<dt><tt>DECLARE a</tt>
<dt><tt>DCL a</tt>
<dd>All of these are equivalent.  Each destroys <tt>\&#38;a[]</tt> if it
exists.  Declaring an array with a dimension of 0 is the same as ARRAY DESTROY
<i>arrayname</i>.
<p>
<dt><tt>ARRAY DECLARE \&#38;a[] = \%1 \%2 \%3</tt>
<dd>Declares the array \&#38;a with 3 elements (0 through 3), initializing
<tt>\&#38;a[1]</tt> to the value of <tt>\%1, \&#38;a[2]</tt> to the value of
<tt>\%2</tt>, and <tt>\&#38;a[3]</tt> to the value of 
<tt>\%3</tt>.  In this case, any reference to one of these array elements is
replaced by the value of the corresponding \%n variable at the time the
declaration was executed (immediate evaluation; the array element's value does
not change if the initializer variable's value changes).
<p>
<dt><tt>ARRAY DECLARE \&#38;a[] = \\%1 \\%2 \\%3</tt>
<dd>Declares the array <tt>\&#38;a</tt> with 3 elements (0 through 3),
initializing <tt>\&#38;a[1]</tt>
to the string "<tt>\%1</tt>", <tt>\&#38;a[2]</tt> to "<tt>\%2</tt>", and
<tt>\&#38;a[3]</tt> to "<tt>\%3</tt>".  In this case any 
reference to one of these array elements is replaced by the CURRENT value
of the corresponding \%n variable (deferred evaluation -- the array element's
value follows the value of the initializer variable).
</dl>
<p>

The equal sign (<tt>=</tt>) preceding the initializer list is optional, but is
recommended for clarity.  If you need to initialize element 1 to a literal
equal sign, use two of them, separated by a space, as in this example:
<p><pre>
  ARRAY DECLARE \&#38;a[] = = + - * /
</pre><p>
Remember, element 0 is not initialized by the DECLARE command.  To initialize
element 0, use a regular DEFINE or ASSIGN command:
<p><pre>
  ARRAY DECLARE \&#38;a[] one two three four five six seven eight nine
  DEFINE \&#38;a[0] zero
</pre><p>
Finally, remember that every command level has its own local array, \&#38;_[],
containing all the macro arguments (\%0, \%1, ...) for that level.  See
<a href="#x7.5">Section 7.5</a> for details.

<p>
<hr>
<h4><a name="x7.10.2">7.10.2. Turning a String into an Array of Words</a></h4>

The <tt>\fsplit(<i>s1</i>,&#38;<i>a,s2,s3</i>)</tt> function assigns the words
of string <i>s1</i> to successive 
elements of the array (beginning with element 1) whose identifying letter,
a-z, is given after the "<tt>&#38;</tt>" in the second argument, using break
and include characters given in <i>s2</i> and <i>s3</i>.  See 
<a href="#x7.3">Section 7.3</a> for
details.

<p>
<hr>
<h4><a name="x7.10.3">7.10.3. Arrays of Filenames</a></h4>

See 
<a href="#x4.11.3">Section 4.11.3</a> for news about how <tt>\ffiles()</tt>
and related functions can assign a list of filenames to an array.  To
recapitulate briefly here:
<p><pre>
  \ffiles(*,&#38;a)
</pre><p>
assigns all files that match the first argument to the array denoted by the
second argument.  If the array has not been declared, it is declared
automatically, with exactly the number of elements needed to hold the file
list; if it was previously declared, it is destroyed and reused.  The
filenames are assigned starting at array element 1.  Element 0 holds the
number of files in the list.
<p>
The DIRECTORY command (<a href="#x4.5.1">Section 4.5.1</a>) can also create
filename arrays if you
give it the /ARRAY: switch; this allows selection criteria beyond whether the
filename matches the given pattern.
<p>
All functions and commands that create filename arrays store the number of
filenames, <i>n</i>, as element 0 of the array, and the filenames as elements 1
through <i>n</i>.

<p>
<hr>
<h4><a name="x7.10.4">7.10.4. Automatic Arrays</a></h4>

In a command file or macro, you can now have local (automatic) arrays.
Just give the name followed by empty subscript brackets (no spaces inside
the brackets please) in a LOCAL command, and then declare the array:
<p><pre>
  LOCAL \%a \&#38;a[] oofa
  ARRAY DECLARE \&#38;a[32] = value1 value2 value3 ...
</pre><p>

This declares the scalar variable <tt>\%a</tt>, the array <tt>\&#38;a[]</tt>,
and the macro name "oofa" to be local, and then declares the new local copy of
<tt>\&#38;a[]</tt> with 32 elements, perhaps assigning some initial values.
When C-Kermit exits from the command file or macro containing these command,
the previous <tt>\&#38;a[]</tt> array is restored (and if there was no
<tt>\&#38;a[]</tt> at any higher level, this will still be true).  The process
can be repeated to any level.  Thus it is now safe to write scripts or macros
containing arrays without danger of interfering with global arrays of the same
name.

<p>

Just as scalars are inherited by lower command levels, so are arrays.  So, for
example, if <tt>\&#38;a[]</tt> is declared at top level, all lower levels will
see it unless they include a "<tt>local \&#38;a[]</tt>" statement, in which
case all levels at and beneath the level where the LOCAL statement was
executed will see the local copy.  This too can be repeated to any level.

<p>
On the other hand, if you DECLARE an array at a lower command level without
also making it LOCAL, this replaces the copy that was declared at the lowest
command level above this one.

<p>
<hr>
<h4><a name="x7.10.5">7.10.5. Sorting Arrays</a></h4>

Although arrays can be sorted using FOR loops as shown on page 383 of
<cite>Using C-Kermit</cite>, 2nd Ed., this involves quite a bit of repetitive
interpretation by the command parser, and so can be slow for large arrays.
For this reason, C-Kermit 7.0 adds a built-in SORT command:
<p><dl>
<dt><b>ARRAY SORT</b> <i>[ switches ] array [ array2 ]</i>
<dd>Sorts the given array in place.  Sorting is strictly lexical (string
based).  The array name can be given fully, e.g. "<tt>\&#38;a[]</tt>", or the
"<tt>\</tt>" and/or "<tt>&#38;</tt>" and/or brackets can be omitted, e.g.
"<tt>array sort \&#38;a[]</tt>", 
"<tt>sort &#38;a</tt>", "<tt>sort a</tt>".  Also, a range can be indicated in
the brackets as noted in 
<a href="#x7.10">Section 7.10</a>, to restrict the sort to a range of
elements (equivalent to the /RANGE switch, described just below), e.g.
"<tt>array sort &#38;a[20:30]</tt>".
</dl>
<p>
A second array may be specified.  If it is, and if it is at least as big as
the first array, it is sorted according to the first array.  For a sample
application, see 
<a href="#x7.10.10">Section 7.10.10</a>.
<p>
See 
<a href="#x1.5">Section 1.5</a> for an explanation of switches.  The optional
switches are:
<p><dl>
<dt><b>/CASE:</b><i>{</i><b>ON,OFF</b><i>}</i>
<dd>/CASE:ON means that alphabetic case is significant in comparisons;
uppercase letters are sorted before lowercase ones.  /CASE:OFF means case is
ignored, e.g. "A" is the same as "a".  If this switch is not given, sorting is
according the current SET CASE setting.
<p>
<dt><b>/KEY:</b><i>n</i>
<dd>Comparison begins at position <i>n</i>(1-based) in each string.  If no
key is given, the entire strings are compared.  Only one key can be
given.  If an array element is shorter than the key value, <i>n</i>, that
element is considered empty for comparison purposes, and therefore lexically
less than any element at least <i>n</i>characters long.
<p>
<dt><b>/NUMERIC</b>
<dd>If this switch is included, it means sorting should be numeric, rather than
lexical.  The sort key is the string starting at the key position, skipping
any leading blanks or tabs, and then as much of the string from that point
on that fits the definition of "numeric", terminating at the first character
that does not qualify.  A numeric string has an optional sign (+ or -)
followed by one or more digits, and (if your version of Kermit was built
with floating-point support; see 
<a href="#x7.23">Section 7.23</a> ) zero or one decimal point
(period).  If both /CASE and /NUMERIC are given, /NUMERIC takes precedence.
<p>
<dt><b>/RANGE:</b><i>n[</i>:<i>m]</i>

<dd>Sort elements <i>n</i>through m of the array.  By default, the entire
array from element 1 to its dimensioned size is sorted, which might produce
surprising results if the array is not full; see example in 
<a href="#x7.10.7">Section 7.10.7</a>.
If ":<i>m</i>" is omitted from the range, the dimensioned size is used.  Thus,
to sort an entire array, <tt>\&#38;a[]</tt>, including its 0th element, use
"<tt>sort /range:0 &#38;a</tt>".  You can also sort any desired section of an
array, e.g. "<tt>sort /range:10:20 &#38;a</tt>" or "<tt>sort /range:\%i:\%j-1
&#38;b</tt>".  As noted above, you can also specify a range in the array-name
brackets.  If you specify a range in the array-name brackets AND with a /RANGE
switch, the ones in the brackets take precedence.

<p>
<dt><b>/REVERSE</b>
<dd>Sort in reverse order.  If this switch is not given, the array is
sorted in ascending order.
</dl><p>

Remember that numeric switch arguments can be numbers, arithmetic expressions,
or variables whose values are numbers or expressions, as illustrated in the
/RANGE examples above.
<p>
A typical sorting application might be to list students' test scores in
descending order.  Suppose you had the following records:
<p><pre>
  olaf      65
  olga      98
  ivan      83
  xena     100
</pre><p>
(and so on) stored in array <tt>\&#38;s[]</tt> (e.g. by reading them from a
file as illustrated in 
<a href="#x7.10.7">section 7.10.7</a>).  In these records, the student's name
is in columns 1-9 and the score in 10-12.  So to rearrange the list in
descending order of score:
<p><pre>
  sort /key:10 /reverse &#38;s
</pre><p>
Then to list your top five students:
<p><pre>
  for \%i 1 5 1 { echo \&#38;s[\%i] }
</pre><p>
Or more simply (see next section):
<p><pre>
  show array a[1:5]
</pre><p>
To illustrate the difference between a lexical and a numeric sort, suppose
you have the following records (the lines that are numbered, starting at
column 1) in array \&#38;a[]:
<p><pre>
    Column   1         2
    12345678901234567890
</pre><p>
 1. Ivan      10.0
 2. Olaf      9.95
 3. Olga       101.5
<p>
<tt>ARRAY SORT /KEY:10 &#38;a[]</tt> would order them 3,1,2, but
<tt>ARRAY SORT /KEY:10 /NUMERIC &#38;a[]</tt> would order them 2,1,3.

<p>
<hr>
<h4><a name="x7.10.6">7.10.6. Displaying Arrays</a></h4>

The SHOW ARRAY command (or ARRAY SHOW) now accepts an optional array-name
argument:
<p><pre>
  SHOW ARRAY \&#38;a[]
</pre><p>
(you can leave off the <tt>\</tt>, the <tt>\&#38;</tt>, and/or the
<tt>[]</tt>'s if you like; "<tt>show array a</tt>" is equivalent to
"show array <tt>\&#38;a[]</tt>").  When an array is specified, its 
dimension is shown and all defined (non-empty) elements are listed.
<p>
Example:
<p><pre>
  assign \%n \ffiles(*,&#38;a)  ; Fill an array with filenames (<a href="#x4.11.3">Section 4.11.3</a>)
  show array \&#38;a[]          ; Show the array we just read
  array show \&#38;a[]          ; Same as previous
  array sort \&#38;a[]          ; Sort the array
  array show \&#38;a[]          ; Show it after sorting
  array show \&#38;a            ; Show it again
  array show &#38;a             ; Show it again
  array show a              ; Show it again
</pre><p>
(The final four commands demonstrate the alternative forms that are accepted
for the array name.)
<p>
If you SHOW ARRAY without giving an array name, all defined arrays are
listed by name and dimension, but their contents are not shown.
<p>
You can also show a piece of an array by including a subscript or range
within the array brackets:
<p><pre>
  array show \&#38;a[5]         ; Shows \&#38;a[5]
  array show &#38;a[3:8]        ; Shows \&#38;a[3] through \&#38;a[8]
  array show a[:\%n-1]      ; Shows \&#38;a[0] through \&#38;a[\%n-1]
</pre><p>

<p>
<hr>
<h4><a name="x7.10.7">7.10.7. Other Array Operations</a></h4>

<dl>
<dt><b>ARRAY DESTROY</b> <i>arrayname</i>
<dd>Destroys and undeclares the named array.  Subscripts or ranges are not
  accepted in this command.
<p>
<dt><b>ARRAY COPY</b> <i>array1</i> <i>array2</i>
<dd>Copies the first array to the second array.  If the target array has not
been declared, it is created automatically with the same size as the first.
If it has been declared, it will be used as declared; if the source array
is larger, only as much of it as will fit is copied to the target array.
Syntax for <i>array1</i> and <i>array2</i> is as in ARRAY SHOW (SHOW ARRAY).
Example:
<p><pre>
  .\%n := \ffiles(*,&#38;a)  ; Create and load array A with a file list.
  array copy &#38;a &#38;b       ; Copy array A to array B.
</pre><p>
The ARRAY COPY command also lets you copy pieces of arrays by including
range specifiers, as in these examples:
<p><dl>
<dt><tt>ARRAY COPY \&#38;a[4:27] \&#38;b</tt>
<dd>This copies <tt>\&#38;a[]</tt> elements 4-27 to <tt>\&#38;b[]</tt>
elements 1-23, creating <tt>\&#38;b[]</tt> if necessary or, if
<tt>\&#38;b[]</tt> is already declared, stopping early if its size is less
than 23.
<p>
<dt><tt>ARRAY COPY \&#38;a[4:27] \&#38;b[12]</tt>
<dd>This copies <tt>\&#38;a[]</tt> elements 4-27 to <tt>\&#38;b[]</tt>
elements 12-35, creating <tt>\&#38;b[]</tt>
if necessary or, if <tt>\&#38;b[]</tt> is already declared, stopping early if
its size is less than 35.
<p>
<dt><tt>ARRAY COPY \&#38;a[4:27] \&#38;b[12:14]</tt>
<dd>This copies <tt>\&#38;a[]</tt> elements 4-6 to <tt>\&#38;b[]</tt> elements
12-14, creating <tt>\&#38;b[]</tt> if necessary or, if <tt>\&#38;b[]</tt> is
already declared, stopping early if its size is less than 14.
<p>
<dt><tt>ARRAY COPY \&#38;a[17] \&#38;b</tt>
<dd>This copies all the elements of <tt>\&#38;a[]</tt> starting with 17 until
the last to <tt>\&#38;b[]</tt>, creating <tt>\&#38;b[]</tt> if necessary or,
if <tt>\&#38;b[]</tt> is already declared,
stopping early if <tt>\&#38;b[]</tt> is not big enough.
</dl><p>
<dt><b>ARRAY CLEAR</b> <i>arrayname</i>
<dd>Sets all the elements of the array to the empty value.  You may also
include a range specifier to clear only a selected portion of the array; for
example "<tt>array clear \&#38;a[37:214]</tt>".  If the range is out of
bounds, only the part of the array that is in bounds is cleared.
<p>
<dt><b>ARRAY SET</b> <i>arrayname</i> [ <i>value</i> ]
<dd>Sets all the elements of the array to the given value.  If no value is
given, the array is cleared.  You may also include a range specifier to set
only a selected portion of the array; for example "<tt>array set \&#38;a[1:9]
-1</tt>".  If the range is out of bounds, only the part of the array that is
in bounds is set.
<p>
<dt><b>ARRAY RESIZE</b> <i>arrayname</i> <i>size</i>
<dd>Resizes the given array.  If the <i>size</i> is greater than the array's
current dimension, new empty elements are added to the end.  If the
<i>size</i> is less than the current dimension, the extra elements are
discarded.  Note: If you have stored the array size in element 0, ARRAY RESIZE
does not change this value.  Alternative notation: ARRAY RESIZE
<i>arrayname</i>[<i>size</i>].  For a practical example, see 
<a href="#x7.10.11">Section 7.10.11</a>.
<p>
<dt><tt><b>\farraylook(</b><i>pattern</i>,<i>arrayname</i><b>)</b></tt>
<dd>This function returns the index of the first element of the given array
that matches the given pattern (for details about pattern syntax, see
<a href="#x4.9">section 4.9</a>).  The array name can include a range
specification to restrict the search to a given segment of the array.  If no
elements match the pattern, -1 is returned.
<p>
<dt><tt><b>\ftablelook(</b><i>keyword,arrayname</i>[,<i>delimiter</i>]<b>)</b></tt>
<dd>Looks in the given "table", which must be sorted, for the given keyword.
  The keyword need not be spelled out in full.  Pattern-matching characters
  should not be included as part of the keyword.  The function returns the
  index of the table element that uniquely matches the given keyword, or -1
  if none match, or -2 if more than 1 match.
</dl><p>
A "table" is an array that is sorted in lexical order; each of its elements
may contain multiple fields, delimited by the given delimiter character or,
if no delimiter is specified, a colon (<tt>:</tt>).
<p>
The <tt>\farraylook()</tt> function does exactly what you tell it.  If you
give it a pattern that does not include wildcard characters (such as
<tt>*</tt>, <tt>?</tt>, etc), it requires an exact match.  For example:
<p><pre>
  \farraylook(oofa,&#38;a)
</pre><p>
searches for the first element of <tt>\&#38;a[]</tt> whose value is "oofa".
But:
<p><pre>
  \farraylook(oofa*,&#38;a)
</pre><p>
finds the first element whose value starts with "oofa", and;
<p><pre>
  \farraylook(*oofa,&#38;a)
</pre><p>
finds the first element whose value ends with "oofa", and;
<p><pre>
  \farraylook(*oofa*,&#38;a)
</pre><p>
finds the first element whose value contains "oofa".
<p>
Here's a simple demonstration of looking up patterns in arrays:
<p><pre>
  local \&#38;a[] \%x \%n
  declare \&#38;a[] = zero one two three four five six seven eight nine ten
  while true {
      .\%x = 1
      .\%n = 0
      ask \%a { Pattern? }
      if not def \%a exit 0 Done.
      while &#60;= \%x \fdim(&#38;a) {
	  .\%x := \farraylook(\%a,&#38;a[\%x])
	  if ( &#60; \%x 0 ) break
          echo \flpad(\%x,3). \&#38;a[\%x]
          increment \%x
          increment \%n
      }
      if ( &#60; \%n 1 ) echo Pattern not found - "\%a"
  }
</pre><p>
The array need not be sorted.  When a pattern is given, a search is performed;
if there is a match, the matching element's index and the element itself are
printed, and the search begins again at the next element.  Thus each matching
element is printed.  If none match, the "Pattern not found" message is
printed.  The process repeats for as many patterns as the user wants to type,
and terminates when the user types an empty pattern.
<p>

Now let's build a little command parser, consisting of a keyword table, and a
loop to look up the user's commands in it with <tt>\ftablelook()</tt>.  In
this case the array elements have "fields" separated by colon (<tt>:</tt>) --
a keyword and a value.  Keyword tables must be sorted if <tt>\tablelook()</tt>
is to work right, so after declaring and initializing the table array, we sort
it.

<p><pre>
  local \&#38;k[] \%a \%i \%n

  array declare \&#38;k[] = drive:9 do:8 discuss:7 live:6 spend:5 help:4 quit:0

  array sort &#38;k                             ; Make sure array is sorted
  echo Type "help" for help.                ; Print greeting &#38; instructions

  while true {                              ; Loop to get commands
      undefine \%a
      while not defined \%a {               ; Get a command
          ask \%a { Command? }
      }
      .\%n := \ftablelook(\%a,&#38;k)           ; Look up the command
      switch \%n {                          ; Handle errors
        :-1, echo Not found - "\%a"         ; Doesn't match
             continue
        :-2, echo Ambiguous - "\%a"         ; Matches too many
             continue
      }
      switch \fword(\&#38;k[\%n],2) {           ; Dispatch according to value
	 :9, echo Driving..., break
	 :8, echo Doing..., break
	 :7, echo Discussing..., break
	 :6, echo Living..., break
	 :5, echo Spending..., break
         :4, echo { Commands (may be abbreviated):}
             for \%i 1 \fdim(&#38;k) 1 {
                echo {  \%i. \fword(\&#38;k[\%i],1) }
             }
             break
         :0, exit 0 Bye!
         :default, stop 1 Internal error
      }
  }
</pre><p>

In this example, keywords are "drive", "do", "discuss", etc, and their values
are unique numbers (values need not be numbers, and there need not be only one
value -- there can be 0, 1, 2, or more of them).  The user types a command,
which can be the whole word (like "help") or any abbreviation (like "hel",
"he", or just "h").  If this does not match any keywords,
<tt>\ftablelook()</tt> returns -1; if it matches more than one (as would "d"),
it returns -2.  Otherwise the array index is returned, 1 or higher.

<p>

Given the array index \%n, we can get the table values as follows:
<p><pre>
  \fword(\&#38;k[\%n],1) <i>is the keyword (first field)</i>
  \fword(\&#38;k[\%n],2) <i>is the value (second field, in this case a number)</i>
</pre><p>

In our example, we use the value (number) as the SWITCH variable.  As noted,
<tt>\fablelook()</tt> expects the array elements to contain multiple fields
separated by colon (<tt>:</tt>) (or other character that you specify,
e.g. <tt>\ftablelook(\%a,&#38;a,^)</tt>) and when matching the keyword,
ignores the first delimiter and everything after it.

<p>
<hr>
<h4><a name="x7.10.8">7.10.8. Hints for Using Arrays</a></h4>

C programmers are accustomed to out-of-bounds array references causing core
dumps or worse.  In C-Kermit:
<p><ul>
<li>A reference to an an out-of-bounds array element returns the empty string.
<p>
<li>An attempt to set the value of an array element that is out of bounds
or that has not been declared simply fails.
</ul>
<p>

C programmers expect an array of size <i>n</i>to have elements 0 through n-1.
Fortran programmers expect the same array to have elements 1 through <i>n</i>.
C-Kermit accommodates both styles; when you declare an array of size <i>n</i>, it
has <i>n</i>=1 elements, 0 through <i>n</i>, and you can use the array in your accustomed
manner, 0-based or 1-based.
<p>
However, note that C-Kermit has certain biases towards 1-based arrays:
<p><ul>
<li>Assignment of file lists starts with element 1
(<a href="#x7.10.3">Section 7.10.3</a>).
<p>
<li>Assignment by <tt>\fsplit()</tt> starts with element 1
(<a href="#x7.3">Section 7.3</a>).
<p>
<li>Array initialization skips the 0th element.  To initialize a 0-based
array, use something like this:
<p><pre>
  declare \&#38;a[3] = one two three
  .\&#38;a[0] = zero
</pre><p>
<li>The ARRAY SORT command skips the 0th element unless you include /RANGE:0
<p>
<li>The SHIFT command ignores element 0 of the \&#38;_[] array.
</ul><p>
The distinction between an array's dimensioned size and the number of elements
in the array is important when sorting.  To illustrate:
<p><pre>
  declare \&#38;a[100]                  ; Declare array &#38;a with 100 elements
  fopen /read \%c oofa.txt          ; Open a file
  if fail...
  for \%i 1 \fdim(&#38;a) 1 {           ; Read the file into the array
      fread \%c \&#38;a[\%i]
      if fail break
  }
  fclose \%c
  if &#62; \%i \fdim(&#38;a) end 1 File has too many lines for array.
  .\%n ::= \%i - 1
  echo File has \%n line(s).
</pre><p>
Let's say the file had 95 lines.  This leaves elements 96-100 of the array
empty.  Now suppose you sort the array and write out the result:
<p><pre>
  sort &#38;a                           ; Sort the whole array
  fopen /write \%o oofa.txt.sorted  ; Open an output file
  if fail ...
  for \%i 1 \%n 1 {                 ; Write out 95 records
      fwrite /line \%o \&#38;a[\%i]
      if fail end 1 Write error
  }
  close write
</pre><p>
You might be surprised at the contents of "oofa.txt.sorted" -- five empty
elements, 96-100, floated to the top of the array in the sort, and since your
write loop only had 95 iterations, the final 5 lines of the sorted file are
lost.
<p>
Therefore, when dealing with partially filled arrays -- especially when
sorting them -- remember to specify the number of elements.  A handy way of
recording an array's "true" size is to put it in the 0th element.  That way,
it "travels with the array".  To illustrate (continuing the previous example
at the "close read" statement):
<p><pre>
  close read
  if &#62; \%i \fdim(&#38;a) end 1 File has too many lines for array.
  .\&#38;a[0] ::= \%i - 1     ; Assign number of lines to \&#38;a[0].
  echo File has \&#38;a[0] line(s).
  sort /range:1:\&#38;a[0] &#38;a
  open write oofa.txt.sorted
  if fail ...
  for \%i 1 \&#38;a[0] 1 {
      writeln file \&#38;a[\%j]
      if fail end 1 Write error
  }
  close write
</pre><p>
Note the SORT switch, <tt>/RANGE:1:\&#38;a[0]</tt>.  This keeps the sort
1-based, and uses element 0 of the array as its size indicator.
<p>
Finally, note that even though some commands or functions might put a size
in array element 0, no built-in functions or commands depend on a size
actually being there.  Thus you are perfectly free to replace the size with
something else and treat the array as 0-based.

<p>
<hr>
<h4><a name="x7.10.9">7.10.9. Do-It-Yourself Arrays</a></h4>

Kermit's <tt>\&#38;x[]</tt> arrays are nice because of the accompanying
built-in functionality -- ARRAY commands, built-in functions that load and
search arrays, automatic evaluation of arithmetic expressions within the
subscript brackets, and so on.  Yet they also have certain limitations:
<p><ol>
<li>Except when created by dynamic loading (e.g. by <tt>\ffiles()</tt>) they
must be declared and dimensioned in advance.
<p>
<li>Indices must be numeric, positive, and in range.
<p>
<li>There can be only one dimension.  Matrices or other higher-dimensioned
arrays are not available.
</ol>
<p>

But none of this is to say you can't invent any kind of data structure you
like.  In 
<a href="#x7.9.2">Section 7.9.2</a> you can see some examples.  Here's another
(courtesy of Dat Thuc Nguyen), in which a pair of matrices is created and then
added: no dimensioning necessary.
<p><pre>
  .row = 4
  .col = 9

  ; MACRO TO PRINT A MATRIX
  define PMATRIX {
      echo Matrix \%1:
      for \%r 1 \m(row) 1 {
	  for \%c 1 \m(col) 1 {
	      xecho \flpad(\m(\%1[\%r][\%c]),4)
	  }
	  echo
      }
      echo
  }
  ; CREATE MATRICES A AND B
  for \%r 1 \m(row) 1 {
      for \%c 1 \m(col) 1 {
	  _eval A[\%r][\%c] \%r + \%c
	  _eval B[\%r][\%c] \%r * \%c
      }
  }
  ; CREATE MATRIX C = SUM OF MATRIX A AND MATRIX B
  for \%r 1 \m(row) 1 {
      for \%c 1 \m(col) 1 {
	  _eval C[\%r][\%c] \m(A[\%r][\%c]) + \m(B[\%r][\%c])
      }
  }
  pmatrix A  ; Print Matrix A
  pmatrix B  ; Print Matrix B
  pmatrix C  ; Print Matrix C
</pre><p>
In the example, we use matrix-like notation to create macros with names
like "<tt>A[1][1]</tt>", "<tt>B[3][7]</tt>", and so on.

<p>
<hr>
<h4><a name="x7.10.10">7.10.10. Associative Arrays</a></h4>

An associative array is a special kind of Do-It-Yourself array.  It differs
from a regular array in that its indices need not be numbers -- they can be
anything at all -- words, filenames, names of months, any character string at
all, and that it doesn't have to be (and in fact can't be) declared.  An
associative array element is simply a macro whose name ends with an index
enclosed in angle brackets, for example:
<p><pre>
  file&#60;oofa.txt&#62;
</pre><p>
More formally:
<p><pre>
  basename&#60;index&#62;
</pre><p>
An associative array is a collection of all associative array elements that
have the same basename.  Any number of associative arrays, each with any
number of elements, can exist at the same time.
<p>
An associative array element can be assigned a value, such as "1", just like
any other macro:
<p><pre>
  define file&#60;oofa.txt&#62; 1     ; Give "file&#60;oofa.txt&#62;" the value "1".
</pre><p>
or:
<p><pre>
  assign file&#60;oofa.txt&#62; \%a   ; Give it the value of the variable \%a.
</pre><p>
However, since an associative array element is a macro, it may not have an
empty (null) value, since assigning an empty value to a macro undefines the
macro.
<p>
You can refer to the value of an associative array element using the familiar
notation for macro values:
<p><pre>
  echo \m(file&#60;oofa.txt&#62;)     ; Echo the value of "file&#60;oofa.txt&#62;".
</pre><p>
Associative arrays are most useful, however, when the value of the index is
a variable.  In that case, you must use the "hidden" forms of the DEFINE or
ASSIGN commands that evaluate the macro name before making the assignment (see
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>, page 457).  Example:
<p><pre>
  define \%f oofa.txt
  _define file&#60;\%f&#62; 1
  echo file&#60;\%f&#62; = \m(file&#60;\%f&#62;)
</pre><p>
prints:
<p><pre>
  file&#60;oofa.txt&#62; = 1
</pre><p>
and then:
<p><pre>
  _increment file&#60;\%f&#62;
  echo file&#60;\%f&#62; = \m(file&#60;\%f&#62;)
</pre><p>
prints:
<p><pre>
  file&#60;oofa.txt&#62; = 2
</pre><p>

What are associative arrays good for?  The classic example is "word counts":
finding the number of times each word is used in a text without knowing in
advance what the words are.  Without associative arrays, your program would
have to build a table of some kind, and every time a word was encountered,
look it up in the table to find its position and counter, or add it to the
table if it wasn't found -- a time-consuming and laborious process.
Associative arrays, however, let you use the word itself as the table index
and therefore sidestep all the table building and lookups.
<p>
Let's work through a practical example.  Suppose you have a file-transfer log
in which each line is composed of a number of blank-separated fields, and the
9th field is a filename (which happens to be the format of certain FTP server
logs, as well as of C-Kermit's new FTP-format transaction log, described in
<a href="#x4.17.2">Section 4.17.2</a>), for example:
<p><pre>
  Wed Jul 14 09:35:31 1999 22 xx.mit.edu 13412 /pub/ftp/mm/intro.txt ....
</pre><p>
and you want to find out how many times each file was transferred.  The
following code builds an associative array, file&#60;&#62;, containing the
counts for each file:
<p><pre>
  local name line max \%c \%n          ; Declare local variables
  fopen /read \%c /var/log/ftpd.log    ; Open the log file (<a href="#x1.22">Section 1.22</a>)
  if fail exit 1 Can't open log        ; Check
  while true {                         ; Loop for each record
      fread /line \%c line             ; Read a line
      if fail break                    ; Check for end of file
      .name := \fword(\m(line),9,{ })  ; Get 9th field = filename (Sec 7.3)
      _increment file&#60;\m(name)&#62;        ; Increment its counter (Sec 7.9.2)
  }
  fclose \%c                           ; Close file when done.
</pre><p>

Note that _INCREMENT (and INCREMENT, and [_]DECREMENT) treat an empty (i.e.
nonexistent) variable as having a value of 0, and therefore creates the
variable with a value of 1.
<p>
At this point, if you told Kermit to "show macro file&#60;", it would list the
associative array.  But since you don't necessarily know the names of the
files in the array, or even how many elements are in the array, how can you
use it in a script program?
<p>
The idea of creating macro names that include character-string indices
enclosed in angle brackets is perfectly arbitrary and doesn't depend on any
Kermit features that weren't already there -- we could just as easily have
used some other notation, such as "file[index]", "file:index", or
"file.index", and the code above would have worked just as well (with the
corresponding syntax adjustments).  But to be able to use an associative array
in a program after the array is built, we need a method of accessing all its
elements without knowing in advance what they are.  That's where the chosen
notation comes in.
<p>

First of all, any macro name that ends with "<tt>&#60;xxx&#62;</tt>" (where
"xxx" is any string) is case sensitive, unlike all other macro names, which
are case independent.  To illustrate, "<tt>file&#60;oofa.txt&#62;</tt>" and
"<tt>file&#60;OOFA.TXT&#62;</tt>" are two 
distinct macros, whereas "OOFA", "Oofa", and "oofa", when used as macro names,
are all the same.
<p>
Second, the new <tt>\faaconvert()</tt> function converts an associative array
(that is, all macros with names of the form "<tt>base&#60;index&#62;</tt>"
that have the same "base" part) into a pair of regular arrays and returns the
number of elements:
<p><pre>
  \faaconvert(name,&#38;a[,&#38;b])
</pre><p>
"name" is the name of the associative array, without the angle brackets or
index ("file" in our example).
<p>
The second argument is the name of a regular array in which to store the
indices of the associative array (filenames in our example); if an array of
this name already exists, it is destroyed unless the array is LOCAL.  The
third argument is the name of another regular array in which to store the
values (the counts in our example), with the same rules about array name
collisions.  If you care only about the indices and not the values, you can
omit the third argument to <tt>\faaconvert()</tt>.  In any case, the
associative array is converted, not copied: its elements are moved to the
specified regular arrays, so after conversion the original associative array
is gone.
<p>
As with other array-loading functions, <tt>\faaconvert()</tt> sets element 0
of each array to the number of elements in the array.
<p>
To continue our example:
<p><pre>
  .max := 0                                   ; Maximum count
  .\%n := \faaconvert(file,&#38;a,&#38;b)             ; Convert
  for \%i 1 \%n 1 {                           ; Loop through values
      echo \flpad(\%i,3). \&#38;a[\%i]: \&#38;b[\%i]  ; Echo this pair
      if ( &#62; \&#38;b[\%i] \m(max) ) {             ; Check for new maximum
          .name := \&#38;a[\%i]
          .max  := \&#38;b[\%i]
      }
  }
  echo Most popular file: \m(name), accesses: \m(max)
</pre><p>
This lists the files and counts and then announces which file has the highest
count.
<p>

Now suppose you want to sort the array pair created from an associative array.
In our example, <tt>\&#38;a[]</tt> contains filenames, and <tt>\&#38;b[]</tt>
contains the associated counts.  Here we take advantage of the ARRAY SORT
command's ability to sort a second array according to the first one:
<p><pre>
  array sort /reverse /numeric &#38;b &#38;a          ; Descending sort by count
</pre><p>
Now to see the top five files and their counts:
<p><pre>
  echo The top 5 files are:
  for \%i 1 5 1 {                             ; Loop through top 5 values
      echo \flpad(\%i,3). \&#38;a[\%i]: \&#38;b[\%i]  ; Echo this pair
  }
</pre><p>

<p>
<hr>
<h4><a name="x7.10.11">7.10.11. Transferring Array Contents to Other Computers</a></h4>

The SEND /ARRAY:arrayname command
(<a href="#x4.7.1">Section 4.7.1</a>) allows you to send the
contents of any array, or any contiguous segment of it, in either text or
binary mode to another computer, using Kermit protocol.  When used in
conjunction with C-Kermit's other features (the array features described in
this section; the file i/o package from 
<a href="#x1.22">Section 1.22</a>; its decision-making,
pattern-matching, and string manipulation capabilities, and so on) the
possibilities are endless: extracts of large files, remote database queries,
<tt>...</tt>, all without recourse to system-dependent mechanisms such UNIX
pipes and filters, thus ensuring cross-platform portability of scripts that
use these features.
<p>
When sending an array in text mode, Kermit appends a line terminator to each
array element, even empty ones, and it also converts the character set from
your current FILE character-set to your current TRANSFER character-set, if
any.  No conversions are made or line terminations added in binary mode.  For
example, the following array:
<p><pre>
  dcl \&#38;a[] = One Two Three Four Five Six
</pre><p>
is sent as six lines, one word per line, in text mode, and as the bare
unterminated string "OneTwoThreeFourFiveSix" in binary mode.
<p>
You should always include a /TEXT or /BINARY switch in any SEND /ARRAY command
to force the desired transfer mode, otherwise you're likely to be surprised
by the effects described in 
<a href="#x4.3">Section 4.3</a>.
<p>
Here are some examples:
<p><dl>
<dt><tt>send /text /array:\&#38;a[]</tt>
<dd>Sends the entire contents of the array <tt>\&#38;a[]</tt> in text mode.
Since an as-name is not included, the receiver is told the filename is
<tt>_array_a_</tt>.
<p>
<dt><tt>send /text /array:&#38;a[]</tt>
<dt><tt>send /text /array:a[]</tt>
<dt><tt>send /text /array:&#38;a</tt>
<dt><tt>send /text /array:a</tt>
<dd>These are all equivalent to the previous example.
<p>
<dt><tt>send /text /array:&#38;a /as-name:foo.bar</tt>
<dd>As above, but the array is sent under the name foo.bar.
<p>
<dt><tt>send /text /array:&#38;a[100:199] /as:foo.bar</tt>
<dd>As above, but only the elements from 100 through 199 are sent.
</dl>
<p>

In text-mode transfers, character sets are translated according to your
current settings, just as for text files.  In binary mode, of course, there
is no character-set translation or other conversion of any kind.  But
remember that array elements can not contain the NUL (ASCII 0) character,
since they are implemented as NUL-terminated strings.
<p>
Here's an example that shows how to send all the lines (up to 1000 of them)
from a file animals.txt that contain the words "cat", "dog", or "hog" (see
<a href="#x4.9">Section 4.9</a> about pattern matching):
<p><pre>
  declare \&#38;a[1000]
  fopen /read \%c animals.txt
  if fail exit 1
  .\%i = 0
  while true {
      fread \%c line
      if fail break
      if match {\m(line)} {*{cat,[dh]og}*} {
          increment \%i
          if ( &#62; \%i \fdim(&#38;a) ) break
          .\&#38;a[\%i] := \m(line)
      }
  }
  fclose \%c
  send /array:a[1:\%i] /text
</pre><p>
Note that we are careful to send only the part of the array that was filled,
not the entire array, because there are likely to be lots of unused elements
at the end, and these would be sent as blank lines otherwise.
<p>
This example raises an interesting question: what if we want to send ALL the
matching lines, even if there are more than 1000 of them, but we don't know
the number in advance?  Clearly the problem is limited by Kermit's (and the
computer's) memory.  If there are a thousand trillion matching lines, they
most likely will not fit in memory, and in this case the only solution is to
write them first to a temporary file on mass storage and then send the
temporary file and delete it afterwards.
<p>
However, when the selection is likely to fit in memory, the once-familiar
technique of initial allocation with extents can be used:
<p><pre>
  if match {\m(line)} {*{cat,[dh]og}*} {
      increment \%i
      if ( &#62; \%i \fdim(&#38;a) ) {
	  array resize a \fdim(&#38;a)+100
	  if fail stop 1 MEMORY FULL
	  echo NEW DIMENSION: \fdim(&#38;a)
      }
      .\&#38;a[\%i] := \m(line)
  }
</pre><p>
This grows the array in chunks of 100 as needed.

<p>
<hr>
<h3><a name="x7.11">7.11. OUTPUT Command Improvements</a></h3>

<dl>
<dt><b>LINEOUT</b> <i>[ text ]</i>
<dd>This command is exactly like OUTPUT, except it supplies a carriage return
at the end of the <i>text</i>.  "<tt>lineout exit</tt>" is exactly the same as
"<tt>output exit\13</tt>".
<p>
<dt><b>SET OUTPUT SPECIAL-ESCAPES</b> <i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>This command lets you tell C-Kermit whether to process <tt>\N,</tt>
<tt>\L,</tt> and <tt>\B</tt> specially in an OUTPUT command, as distinct from
other <tt>\</tt> sequences (such as <tt>\%a</tt>, <tt>\13</tt>,
<tt>\v(time)</tt>, etc).  Normally the special escapes are handled.
Use SET OUTPUT SPECIAL-ESCAPES OFF to disable them.
</dl><p>
Disabling special escapes is necessary in situations when you need to transmit
lines of data and you have no control over what is in the lines.  For example,
a file oofa.txt that contains:
<p><pre>
  This is a file
  It has \%a variables in it
  And it has \B in it.
  And it has \L in it.
  And it has \N in it.
  And this is the last line.
</pre><p>
can be sent like this:
<p><pre>
  local line
  set output special-escapes off
  fopen /read \%c oofa.txt
  if fail stop 1 Can't open oofa.txt
  while success {
      fread \%c line
      if fail break
      ; Add filtering or processing commands here...
      output \m(line)\13
  }
</pre><p>

<p>
<hr>
<h3><a name="x7.12">7.12. Function and Variable Diagnostics</a></h3>

In C-Kermit 6.0 and earlier, the only diagnostic returned by a failing
function call was an empty value, which (a) could not be distinguished from
an empty value returned by a successful function call; (b) did not give any
indication of the cause of failure; and (c) did not cause the enclosing
statement to fail.  C-Kermit 7.0 corrects these deficiencies.
<p><dl>
<dt><b>SET FUNCTION DIAGNOSTICS </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>when ON, allows built-in functions to return diagnostic messages when
  improperly referenced, instead of an empty string.  FUNCTION DIAGNOSTICS are
  ON by default.  When OFF, improperly referenced functions continue to return
  an empty string.  This command also affects built-in variables; in this case,
  an error message is returned only if the variable does not exist.  When
  FUNCTION DIAGNOSTICS are ON, the error message is also printed.
</dl><p>
For variables, the only message is:
<p><pre>
  &#60;ERROR:NO_SUCH_VARIABLE:\v(name)&#62;
</pre><p>
where "name" is the name of the nonexistent variable.
<p>
For functions, the diagnostic message is:
<p><pre>
  &#60;ERROR:message:\fname()&#62;
</pre><p>
where "message" is replaced by a message, and "name" is replaced by the
function name, e.g. <tt>&#60;ERROR:ARG_NOT_NUMERIC:\fmod()&#62;</tt>.
Messages include:
<p><pre>
  ARG_BAD_ARRAY       <i>An argument contains a malformed array reference.</i>
  ARG_BAD_DATE        <i>An argument contains a malformed date and/or time.</i>
  ARG_BAD_PHONENUM    <i>An argument contains a malformed telephone number.</i>
  ARG_BAD_VARIABLE    <i>An argument contains a malformed \%x variable.</i>
  ARG_INCOMPLETE      <i>An argument is incomplete (e.g. a broken Base64 string).</i>
  ARG_EVAL_FAILURE    <i>An argument could not be evaluated (internal error).</i>
  ARG_NOT_ARRAY       <i>An argument references an array that is not declared.</i>
  ARG_NOT_NUMERIC     <i>An argument that must be integer contains non-digits.</i>
  ARG_NOT_FLOAT       <i>An argument has bad floating-point number format.</i>
  ARG_NOT_VARIABLE    <i>An argument that must be a variable is not a variable.</i>
  ARG_OUT_OF_RANGE    <i>An argument's numeric value is too big or too small,</i>
                      <i>or an argument contains illegal characters (e.g. a hex</i>
                      <i>or Base-64 string).</i>
  ARG_TOO_LONG        <i>An argument's value is too long.</i>
  ARRAY_FAILURE       <i>Failure to create an array.</i>
  DIVIDE_BY_ZERO      <i>Execution of the function would cause division by zero.</i>
  FLOATING_POINT_OP   <i>Execution error in a floating-point operation.</i>
  FILE_NOT_FOUND      <i>Filename argument names a file that can't be found.</i>
  FILE_NOT_READABLE   <i>Filename argument is not a regular file.</i>
  FILE_NOT_ACCESSIBLE <i>Filename argument names a file that is read-protected.</i>
  FILE_ERROR          <i>Other error with filename argument.</i>
  FILE_NOT_OPEN       <i>A file function was given a channel that is not open.</i>
  FILE_ERROR_-n       <i>A file function got error -<i>n</i> (<a href="#x1.22">Section 1.22</a>).</i>
  LOOKUP_FAILURE      <i>Error looking up function (shouldn't happen).</i>
  MALLOC_FAILURE      <i>Failure to allocate needed memory (shouldn't happen).</i>
  NAME_AMBIGUOUS      <i>The function is not uniquely identified.</i>
  MISSING_ARG         <i>A required argument is missing.</i>
  NO_SUCH_FUNCTION    <i>An argument references a function that is not defined.</i>
  NO_SUCH_MACRO       <i>An argument references a macro that is not defined.</i>
  RESULT_TOO_LONG     <i>The result of a function is too long.</i>
  UNKNOWN_FUNCTION    <i>Internal error locating function (shouldn't happen).</i>
</pre><p>
Examples:
<p><pre>
  assign \%m \fmod()
  ?&#60;ERROR:MISSING_ARG:\fmod()&#62;
  echo "\fcontents(\%m)"
  "&#60;ERROR:MISSING_ARG:\fmod()&#62;"
  echo \fmod(3,x)
  ?&#60;ERROR:ARG_NOT_NUMERIC:\fmod()&#62;
  echo \fmod(3,4-2*2)
  ?&#60;ERROR:DIVIDE_BY_ZERO:\fmod()&#62;
</pre><p>
Notice the use of <tt>\fcontents()</tt> in echoing the value of a variable that
contains a returned error message.  That's because the error message includes
the name of the variable or function that failed, so you must use
<tt>\fcontents()</tt> to prevent it from being evaluated again -- otherwise
the same error will occur.
<p>
The handling of function and variable errors is controlled by:
<p>
<dl>
<dt><b>SET FUNCTION ERROR </b><i>{</i> <b>ON</b>, <b>OFF</b> <i>}</i>
<dd>Tells whether invalid function calls or variable references should cause
  command errors.  FUNCTION ERROR is ON by default.  When ON, and an error is
  diagnosed in a built-in function or variable, the command that includes the
  function call or variable reference fails.  The failing command can be
  handled in the normal way with IF FAILURE / IF SUCCESS, SET TAKE ERROR, or
  SET MACRO ERROR.
</dl>
<p>
When FUNCTION DIAGNOSTICS is OFF, there is no error message.
<p>
SHOW SCRIPTS displays the current FUNCTION DIAGNOSTICS and ERROR settings.

<p>
<hr>
<h3><a name="x7.13">7.13. Return Value of Macros</a></h3>

In C-Kermit 5A and 6.0, there are two ways to return one level from a macro:
RETURN <i>value</i> and END <i>number</i> <i>text</i>.  When RETURN is used,
the <i>value</i>, which can be a number or a text string, is assigned to
\v(return).  When END was used, however, \v(return) was not set.
SUCCESS/FAILURE was set according to whether the <i>number</i> was zero, and
the <i>text</i> was printed, but the actual value of the <i>number</i> was
lost.  <p> In C-Kermit 7.0, the END <i>number</i> is available in the
\v(return) variable.

<p>
<hr>
<h3><a name="x7.14">7.14. The ASSERT, FAIL, and SUCCEED Commands.</a></h3>

The ASSERT command is just like the IF command, but without a command to
execute.  It simply succeeds or fails, and this can be tested by a subsequent
IF SUCCESS or IF FAILURE command.  Example:
<p><pre>
  ASSERT = 1 1
  IF SUCCESS echo 1 = 1.
</pre><p>
The FAIL command does nothing, but always fails.
The SUCCEED command does nothing, but always succeeds.
<p>
These commands are handy in debugging scripts when you want to induce a
failure (or success) that normally would not occur, e.g. for testing blocks
of code that normally are not executed.

<p>
<hr>
<h3><a name="x7.15">7.15. Using Alarms</a></h3>

Alarms may be set in two ways:
<p><dl>
<dt><b>SET ALARM</b> <i>number</i>
<dd>Sets an alarm for the given number of seconds "from now", i.e. in the
future, relative to when the SET ALARM command was given.  Examples:
<pre>
  set alarm 60        ; 60 seconds from now
  set alarm +60       ; The same as "60"
  set alarm -60       ; Not legal - you can't set an alarm in the past.
  set alarm 60*60     ; 60 minutes from now.
  set alarm \%a+10    ; You can use variables, etc.
</pre>
<p>
<dt><b>SET ALARM</b> <i>hh:mm:ss</i>
<dd>Sets an alarm for the specified time.  If the given time is earlier than
the current time, the alarm is set for the given time in the next day.
You may give the time in various formats:
<pre>
  set alarm 15:00:00  ; 3:00:00pm
  set alarm 3:00:00pm ; 3:00:00pm
  set alarm 3:00pm    ; 3:00:00pm
  set alarm 3pm       ; 3:00:00pm
</pre>
<p>
<dt><b>SHOW ALARM</b>
<dd>Displays the current alarm, if any, in standard date-time format
(see 
<a href="#x1.6">Section 1.6</a>): yyyymmdd hh:mm:ss.
<p>
<dt><b>IF ALARM</b> <i>command</i>
<dd>Executes the <i>command</i> if an alarm has been set and the alarm time
has passed.
<p>
<dt><b>IF ALARM { </b><i>command-list</i> <b>}</b> <i>[</i> <b>ELSE {</b> <i>command-list</i> <b>}</b> <i>]</i>
<dd>Executes the <i>command-list</i> if an alarm has been set and the alarm
time has passed.  Otherwise, if an ELSE part is given, its <i>command-list</i>
is executed.
<p>
<dt><b>CLEAR ALARM</b>
<dd>Clears the alarm.
</dl>
<p>
Only one alarm may be set at a time.
<p>
Example: Suppose you have a script that is always running, and that transfers
files periodically, and that keeps a transaction log.  Suppose you want to
start a new transaction log each day:
<p><pre>
  log transactions \v(date).log
  set alarm 00:00:00                     ; Set an alarm for midnight
  while true {                           ; Main script loop
      xif alarm {                        ; If the alarm time is past...
          close transactions             ; Close current log
          log transactions \v(date).log  ; Start new one
          pause 1                        ; To make sure 00:00:00 is past
          set alarm 00:00:00             ; Set a new alarm
      }
      ; put the rest of the script here...
  }
</pre><p>

Note that IF ALARM -- no matter whether it succeeds or fails -- does NOT
clear an expired alarm.  Thus, once an alarm has expired, every IF ALARM will
succeed until the alarm is cleared (with the CLEAR ALARM command) or reset
with a new SET ALARM command.

<p>
<hr>
<h3><a name="x7.16">7.16. Passing Arguments to Command Files</a></h3>

Beginning in version 7.0, C-Kermit accepts arguments on the TAKE command line,
for example:
<p><pre>
  C-Kermit&#62; <u>take oofa.ksc one two {this is three} four</u>
</pre><p>
This automatically sets the variables <tt>\%1</tt> through <tt>\%9</tt> to the
arguments, and <tt>\%0</tt> to the name of the file, in this case:
<p><pre>
  \%0 = /usr/olga/oofa.ksc
  \%1 = one
  \%2 = two
  \%3 = this is three
  \%4 = four
</pre><p>
and <tt>\%5..\%9</tt> are undefined (empty).  Arguments past the ninth are
available in the <tt>\&#38;_[]</tt> argument-vector array (
<a href="#x7.5">Section 7.5</a>).
<p>
The variables are those at the current macro level.  Thus, if the TAKE command
is executed from within a macro, the macro's arguments are replaced by those
given on the TAKE command line (but only if at least one argument is given).
The command shown above is exactly equivalent to:
<p><pre>
  assign \%0 /usr/olga/oofa.ksc
  assign \%1 one
  assign \%2 two
  assign \%3 this is three
  assign \%4 four
  assign \%5
  assign \%6
  assign \%7
  assign \%8
  assign \%9
  take oofa.ksc
</pre><p>
Remember, the variables <tt>\%0..\%9</tt> are on the macro call stack, and
command files are independent of the macro stack.  Thus, if a command file
TAKEs another command file and passes arguments to it, the variables are
changed from that point on for both files, and so forth for all levels of
nested command files without intervening macro invocations.
<p>
It would have been possible to change C-Kermit to use the overall command
stack, rather than the macro stack, for arguments -- this would have made
TAKE work exactly like DO, which is "nicer", but it would also have broken
countless existing scripts.  However, the new SHIFT command
(<a href="#x7.5">Section 7.5</a>)
makes it possible to create an alternative TAKE command that does indeed
save and restore the argument variables at its own level around execution
of a command file:
<p><pre>
  define mtake {
     local \%f
     assign \%f \fcontents(\%1)
     shift
     take \%f
  }
</pre><p>
C-Kermit 7.0 also supports a new, easier way to pass arguments to scripts
from the system command line:
<p><pre>
  kermit filename <i>arg1 arg2 arg3 ...</i>
</pre><p>
in which <i>arg1, arg2, arg3</i> (etc) are arguments for the script (whose
filename is given), and are assigned to <tt>\%1, \%2, ... \%9</tt>.  The
filename is assigned to <tt>\%0</tt>.  This applies equally to "Kerbang"
scripts in UNIX
(<a href="#x7.19">Section 7.19</a>).  For example, suppose you have a file
called "showargs" containing the following lines:
<p><pre>
  #!/usr/local/bin/kermit +
  echo Hello from \%0
  show args
  exit
</pre><p>
(except not indented, since the "#!" line must be on the left margin).  If
you give this file execute permission:
<p><pre>
  chmod +x showargs
</pre><p>
then you can run it exactly as you would run a UNIX shell script, e.g.:
<p><pre>
  $ showargs one two three
  Hello from /usr/olga/showargs
  Top-level arguments (\v(argc) = 4):
   \&#38;_[0] = /usr/olga/showargs
   \&#38;_[1] = one
   \&#38;_[2] = two
   \&#38;_[3] = three
</pre><p>
Furthermore, the <tt>\&#38;_[]</tt> array now contains the filename, if one
was given as the first command line argument, or it is a "Kerbang" script, in
element 0.
<p>
Otherwise element 0 is program name, and elements 1 through \v(argc)-1 contain
the command-line arguments, if any, that appear after "--" or "=", if any.
This array is saved and restored around macro calls; recall that inside macros
it contains the macro argument vector (allowing you to access arguments
programmatically, and to have more than 9 of them).
<p>
At top level, notice the difference between the <tt>\&#38;@[]</tt> and
<tt>\&#38;_[]</tt> arrays.  The former includes C-Kermit options; the latter
omits them.

<p>
<hr>
<h3><a name="x7.17">7.17. Dialogs with Timed Responses</a></h3>

The ASK, ASKQ, GETOK, and GETC commands (let's call them the "ASK-class
commands") let you write scripts that carry on dialogs with the user, asking
them for text, a Yes/No answer, or a character, respectively.  Prior to
C-Kermit 7.0, these questions would always wait forever for an answer.  In
C-Kermit 7.0, you may specify a time limit for them with the new command:
<p><dl>
<dt><b>SET ASK-TIMER</b> <i>number</i>
<dd>Sets a time-limit on ASK-CLASS commands to the given number of seconds.
If the number is 0 or less, there is no time limit and these commands wait
forever for a response.  Any timer that is established by this command
remains in effect for all future ASK-class commands until another SET
ASK-TIMER command is given (e.g. with a value of 0 to disable ASK timeouts).
<p>
<dt><b>IF ASKTIMEOUT</b> <i>command</i>
<dd>An ASK-class command that times out returns a failure status.  You can test
explicitly for a timeout with:
</dl>

<p>
<hr>
<h3><a name="x7.18">7.18. Increased Flexibility of SWITCH Case Labels</a></h3>

Prior to C-Kermit 7.0 / K95 1.1.19, the case labels in SWITCH statements
were string constants.
<p>
Now case labels can be variables, function calls, or any mixture of these
with each other and/or with regular characters.
<p>
Furthermore, after the case label is evaluated, it is treated not as a string
constant, but as a pattern against which the SWITCH variable is matched
(<a href="#x4.9.1">Section 4.9.1</a>).
<p>
This introduces a possible incompatibility with previous releases, since
the following characters in case labels are no longer taken literally:
<p><pre>
  \ * ? [ {
</pre><p>
Any scripts that previously included any of these characters in case labels
must now quote them with backslash (\).

<p>
<hr>
<h3><a name="x7.19">7.19. "Kerbang" Scripts</a></h3>

In UNIX only, Kermit scripts can be stored in files and run "directly",
without starting Kermit first (as noted on page 467 of the manual), just as a
shell script can be "run" as if it were a program.  This section amplifies on
that idea a bit, and presents some new aspects of version 7.0 that make it
easier to write and run Kermit scripts directly.
<p><blockquote>
NOTE: On non-UNIX platforms, such as VMS or Windows, Kerbang scripts can
be run as "kermit + scriptfilename arg1 arg2 arg3 ...".  Windows 95/98/NT
file associations do not allow for the passing of parameters.  In VMS,
however, you can achieve the Kerbang effect by defining a symbol, as
in this example:
<p><pre>
  $ autotelnet :== "$SYS$TOOLS:KERMIT.EXE + AUTOTELNET.KSC"
</pre><p>
and then running the script like any other command:
<p><pre>
  $ autotelnet xyzcorp.com myuserid
</pre><p>
See <a href="#x9.3">Section 9.3</a> for an explanation of the "+" symbol.
</blockquote>
<p>
UNIX shell scripts can specify which shell should run them by including a
"shebang" line at the top, e.g.:
<p><pre>
  #!/bin/sh
</pre><p>
(but not indented; the shebang line must be on the left margin).  The term
"shebang" is a contraction of "shell" and "bang".  "Bang" is a slang word for
the exclamation mark ("!"); "shebang" itself is an American slang word used in
in the phrase "the whole shebang".
<p>
We can run Kermit scripts directly too, by including a "shebang" line that
names Kermit as the "shell"; thus we call these "Kerbang" scripts.  This
mechanism has been considerably simplified in C-Kermit 7.0 to facilitate
C-Kermit's use a scripting tool just like any of the UNIX shells or scripting
languages.  The rules are the same as for shell scripts:
<p><ol>
<li>The first line of the Kermit script must begin with "#!" immediately
followed by the full pathname of the program that will execute the
script (in this case, C-Kermit rather than a UNIX shell), followed by
any Kermit command-line options.  To suppress execution of the C-Kermit
initialization file and to make command line arguments available to the
script, the final option should be "+":
<p><pre>
  #!/usr/local/bin/kermit +
</pre><p>
Some users have reported that in some circumstances a space might be
necessary after the plus sign; this depends on your shell -- it has
nothing to do with Kermit.  In most cases, no space is needed.
<p>
<li>The file must have execute permission (granted via "chmod +x
<i>filename</i>").
</ol>
<p>

When C-Kermit is invoked from a Kerbang script (or from the system prompt
with a "+" command-line argument, which amounts to the same thing), the
following special rules apply:
<p><ol>
<li>The C-Kermit initialization file is NOT executed automatically.  If you
want it to be executed, include a TAKE command for it in the script,
e.g.  "take \v(home).kermrc".  (In previous releases, the initialization
file was always executed, with no way to prevent it except for the user
to include Kermit-specific command line options which had nothing to do
with the script).  Many scripts have no need for the standard Kermit
initialization file, which is quite lengthy and not only delays startup
of the script, but also spews forth numerous messages that are most
likely unrelated to the script.
<p>
<li>If the initialization file is not executed, neither is your customization
file, since the initialization file is the command file from which the
customization file is TAKEn.  Again, you can include a TAKE command for
the initialization file if desired, or for the customization file by
itself, or for any other file.
<p>
<li>C-Kermit does not process command-line arguments at all.  Instead, it
passes all words on the command line after the "+" to the script as
<tt>\%0</tt> (the script name), <tt>\%1..\%9</tt> (the first nine arguments),
as well as in the argument vector array <tt>\&#38;_[]</tt>.  The variable
<tt>\v(argc)</tt> is set to the total number of "words" (as passed by the
shell to Kermit) including the script name.  Quoting and grouping rules are
those of the shell.
<p>
<li>At any point where the script terminates, it must include an EXIT
command if you want it to exit back to the shell; otherwise C-Kermit
enters interactive prompting mode when the script terminates.  The EXIT
command can include a numeric status to be returned to the shell (0, 1,
etc), plus an optional message.
</ol>
<p>

Here is a simple Kerbang script that prints its arguments:
<p><pre>
  #/usr/local/bin/kermit +
  echo Hello from \%0
  for \%i 0 \v(argc)-1 1 {
      echo \%i. "\&#38;_[\%i]"
  }
  exit 0
</pre><p>

Save this file as (say) "showargs", then give it execute permission and
run it (the \&#38;_[] array is the same as \%0..\%9, but allows you to refer
to argument variables programmatically; see 
<a href="#x7.5">Section 7.5</a>).  (Yes, you could
substitute SHOW ARGUMENTS for the loop.)
<p><pre>
  $ <u>chmod +x showargs</u>
  $ <u>./showargs one "this is two" three</u>
</pre><p>
The script displays its arguments:
<p><pre>
  Hello from /usr/olga/showargs
  0. "/usr/olga/showargs"
  1. "one"
  2. "this is two"
  3. "three"
  $
</pre><p>
Notice that no banners or greetings are printed and that startup is
instantaneous, just like a shell script.  Also notice that grouping of
arguments is determined by *shell* quoting rules, not Kermit ones, since
the command line is parsed by the shell before Kermit ever sees it.
<p>
Of course you can put any commands at all into a Kerbang script.  It can
read and write files, make connections, transfer files, anything that Kermit
can do -- because it *is* Kermit.  And of course, Kerbang scripts can also
be executed from the Kermit prompt (or from another script) with a TAKE
command; the Kerbang line is ignored since it starts with "#", which is a
comment introducer to Kermit just as it is to the UNIX shell.  In VMS and
other non-UNIX platforms, the Kerbang line has no effect and can be omitted.
<p>
It might be desireable for a script to know whether it has been invoked
directly from the shell (as a Kerbang script) or by a TAKE command given to
the Kermit prompt or in a Kermit command file or macro.  This can be done
as in this example:
<p><pre>
  #!/usr/local/bin/kermit +
  assign \%m \fbasename(\%0)
  define usage { exit 1 {usage: \%m <i>phonenumber</i> <i>message</i>} }
  define apage { (definition of APAGE...) } ; (See <a href="ckb2.html"><cite>book</cite></a> pp.454-456)
  xif equal "\%0" "\v(cmdfil)" {
      if not def \%1 usage
      if not def \%2 usage
      apage {\%1} {\%2}
      exit \v(status)
  }
</pre><p>

In a Kerbang script, <tt>\%0</tt> and <tt>\v(cmdfile)</tt> are the same; both
of them are the name of the script.  When a script is invoked by a Kermit TAKE
command, <tt>\%0</tt> is the name of the Kermit program, but
<tt>\v(cmdfile)</tt> is the name of the script.  In the example above, a macro
called APAGE is defined.  If the script was invoked directly, the APAGE macro
is also executed.  Otherwise, it is available for subsequent and perhaps
repeated use later in the Kermit session.

<p>
An especially handy use for Kerbang scripts is to have the initialization file
itself be one.  Since the standard initialization file is rather long and
time-consuming to execute, it is often overkill if you want to start Kermit
just to transfer a file.  Of course there are command-line switches to
suppress initialization-file execution, etc, but another approach is to "run"
the initialization file when you want its features (notably the services
directory), and run C-Kermit directly when you don't.  A setup like this
requires that (a) the C-Kermit initialization file is configured as a Kerbang
script (has <tt>#!/<i>path...</i>/kermit</tt> as first line), has execute
permission, and is in your PATH; and (b) that you don't have a
<tt>.kermrc</tt> file in your login
directory.

<p>
<hr>
<h3><a name="x7.20">7.20. IF and XIF Statement Syntax</a></h3>

The IF command has been improved in two significant ways in C-Kermit 7.0,
described in the following subsections.  All changes are backwards compatible.

<h4><a name="x7.20.1">7.20.1. The IF/XIF Distinction</a></h4>

The distinction between IF and XIF is no longer important as of C-Kermit 7.0.
You should be able to use IF in all cases (and of course, also XIF for
backwards compatibility).  In the past, IF was used for single-command THEN
parts, followed optionally by a separate ELSE command:
<p><pre>
  IF <i>condition command1</i>    ; THEN part
  ELSE <i>command2</i>            ; ELSE part
</pre><p>
whereas XIF was required if either part had multiple commands:
<p><pre>
  XIF <i>condition</i> { <i>command, command,</i> ... } ELSE { <i>command, command,</i> ... }
</pre><p>

The syntactic differences were primarily that IF / ELSE was two commands on
two separate lines, whereas XIF was one command on one line, and that XIF
allowed (and in fact required) braces around its command lists, whereas IF
did not allow them.
<p>
Furthermore, the chaining or nesting of parts and conditions was inconsistent.
For example, the IF command could be used like this:
<p><pre>
  IF <i>condition</i> <i>command</i>
  ELSE IF <i>condition</i> <i>command</i>
  ELSE IF <i>condition</i> <i>command</i>
  ELSE IF <i>condition</i> <i>command</i>
  ...
</pre><p>
but XIF could not.  C-Kermit 7.0 accepts the old syntax and executes it the
same as previous versions, but also accepts a new unified and more convenient
syntax:
<p>
<b>IF</b> <i>condition command-list [</i> <b>ELSE</b> <i>command-list ]</i>
<p>
or:
<p><pre>
<b>IF</b> <i>condition command-list</i>
<b>ELSE</b> <i>command-list</i>
</pre><p>
in which the ELSE part is optional, and where <i>command-list</i> can be a
single command (with or without braces around it) or a list of commands
enclosed in braces.  Examples:
<p>
Example 1:
<p><pre>
  IF <i>condition</i> { <i>command1, command2</i> } ELSE { <i>command3, command4</i> }
</pre><p>
Example 2 (same as Example 1):
<p><pre>
  IF <i>condition</i> {
     <i>command1</i>
     <i>command2</i>
  } ELSE {
     <i>command3</i>
     <i>command4</i>
  }
</pre><p>
Example 3 (same as 1 and 2):
<p><pre>
  IF <i>condition</i> {
     <i>command1</i>
     <i>command2</i>
  }
  ELSE { <i>command3</i>, command4 }
</pre><p>
Example 4 (same as 1-3):
<p><pre>
  IF <i>condition</i> {
     <i>command1</i>
     <i>command2</i>
  }
  ELSE {
     <i>command3</i>
     <i>command4</i>
  }
</pre><p>
Example 5 (ELSE can be followed by another command):
<p><pre>
  IF <i>condition</i> {
     <i>command1</i>
     <i>command2</i>
  } ELSE IF <i>condition</i> {
     <i>command3</i>
     <i>command4</i>
  } ELSE {
     <i>command5</i>
     <i>command6</i>
  }
</pre><p>
Example 5 suggests other possibilities:
<p><pre>
  IF <i>condition</i> {
     <i>command1</i>
     <i>command2</i>
  } ELSE FOR <i>variable</i> <i>initial</i> <i>final</i> <i>increment</i> {
     <i>command3</i>
     <i>command4</i>
  }
</pre><p>
And this too is possible, except for some non-obvious quoting considerations:
<p><pre>
  dcl \&#38;a[6] = one two three four five six

  IF &#60; \%n 3 {
      echo \\%n is too small: \%n
  } ELSE FOR \\%i 1 \\%n 1 {
      echo \\%i. \\&#38;a[\\%i]
  }
</pre><p>
(The loop variable must be quoted in this context to prevent premature
evaluation.)

<p>
<hr>
<h4><a name="x7.20.2">7.20.2. Boolean Expressions (The IF/WHILE Condition)</a></h4>

Prior to C-Kermit 7.0, the IF and WHILE commands accepted only a single
Boolean ("true or false") assertion, e.g. "if &#62; \%m 0 <i>command</i>" or "if exist
<i>filename</i> <i>command</i>".  There was no way to form Boolean expressions and, in
particular, nothing that approached a Boolean OR function (AND could be
simulated by concatenating IF statements: "if <i>condition1</i> if <i>condition2</i>..").
<p>
C-Kermit 7.0 (and K95 1.1.19) allow grouping of Boolean assertions using
parentheses and combining them using AND (or &#38;&#38;) and OR (or ||).  Each of
these operators -- including the parentheses -- is a field and must be set off
by spaces.  AND has higher precedence than OR, NOT has higher precedence than
AND, but parentheses can be used to force any desired order of evaluation.
The old syntax is still accepted.
<p>
Here are some examples:
<p><pre>
  define \%z 0                          ; Define some variables
  define \%n 1                          ; for use in the examples.

  if &#62; \%n \%z echo \%n is greater.     ; Original format - still accepted.
  if ( &#62; \%n \%z ) echo \%n is greater. ; Parentheses may be used in 7.0.
  if ( &#62; \%n \%z &#38;&#38; not = \%z 0 ) ...   ; Two assertions combined with AND.
  if ( &#62; \%n \%z and not = \%z 0 ) ...  ; Same as previous ("and" = "&#38;&#38;").
  if ( &#62; \%n \%z || not = \%z 0 ) ...   ; Two assertions combined with OR.
  if ( &#62; \%n \%z or not = \%z 0 ) ...   ; Same as previous ("or" = "||").
  if ( &#62; \%n \%z || != \%z 0 ) ...      ; Ditto ("!=" = "not =").
  while ( 1 ) { ... }                   ; Just like C.
</pre><p>

Notice the spaces around all operators including the parentheses -- these
are required.  The following examples show how parentheses can be used to
alter the precedence of the AND and OR operators:
<p><pre>
  if ( false || false &#38;&#38; false || true ) ,..         ; True
  if ( false || ( false &#38;&#38; false ) || true ) ...     ; Same as previous
  if ( ( false || false ) &#38;&#38; ( false || true ) ) ... ; False
</pre><p>
Similarly for NOT:
<p><pre>
  if ( not true &#38;&#38; false ) ...          ; False (NOT binds to TRUE only)
  if ( ( not true ) &#38;&#38; false ) ...      ; Same as previous
  if ( not ( true &#38;&#38; false ) ) ...      ; True (NOT binds to (TRUE &#38;&#38; FALSE))
</pre><p>
Notes:
<p><ol>
<li>The syntax of the Boolean expression itself has not changed; each
expression begins with a keyword or token such as "EXIST", "&#62;", or "=",
etc; operators such as "&#60;", "=", and "&#62;" do not go between their
operands but precede them as before; this might be called "reverse reverse
Polish notation"; it allows deterministic on-the-fly parsing of these
expressions at the C-Kermit&#62; prompt as well as in scripts, and allows
?-help to be given for each item when IF or WHILE commands are typed at the
prompt.
<p>
<li>Parentheses are required when there is more than one Boolean assertion.
<p>
<li>Parentheses are not required, but are allowed, when there is only one
Boolean assertion.
<p>
<li>Evaluation of Boolean assertions occurs left to right, but the resulting
Boolean expression is evaluated afterwards according to the rules of
precedence.  All Boolean assertions are always evaluated; there is no
"early stopping" property and therefore no question about when or if
side effects will occur -- if any Boolean assertion has side effects,
they will always occur.
</ol>
<p>
Constructions of arbitrary complexity are possible, within reason.
<p>
Also see 
<a href="#x7.4">Section 7.4</a> for new IF / WHILE conditions.

<p>
<hr>
<h3><a name="x7.21">7.21. Screen Formatting and Cursor Control</a></h3>

C-Kermit 7.0 adds a simple way to create formatted screens, the SCREEN
command:
<p><dl>
<dt><b>SCREEN <i>{</i> CLEAR, CLEOL, MOVE-TO</b> <i>row [ column ]</i> <i>}</i>
<dd>Performs screen-formatting actions.  Correct operation of these commands
  depends on proper terminal setup on both ends of the connection -- mainly
  that the host terminal type is set to agree with the kind of terminal or
  the emulation you are viewing C-Kermit through.  The UNIX version uses
  terminfo or termcap (not curses); the VMS version uses SMG; K-95 uses its
  built in screen manager.
<p>
<dt><b>SCREEN CLEAR</b>
<dd>Moves the cursor to home position and clears the entire screen.
  Synonyms: CLEAR COMMAND-SCREEN ALL (K-95 only), CLS, CLEAR SCREEN.
<p>
<dt><b>SCREEN CLEOL</b>
<dd>Clears from the current cursor position to the end of the line.
  Synonym: <b>CLEAR COMMAND-SCREEN EOL</b> (K-95 only)
<p>
<dt><b>SCREEN MOVE-TO</b> <i>row column</i>
<dd>Moves the cursor to the indicated row and column.  The row and column
  numbers are 1-based, so on a 24x80 screen the home position is 1 1 and
  the lower right corner is 24 80.  If a row or column number is given that
  too large for what Kermit or the operating system thinks is your screen
  size, the appropriate number is substituted.
</dl><p>

These escape sequences used by these commands depends on the platform.
In UNIX, your TERM environment variable is used to query the terminfo/termcap
database; if the query fails, ANSI/VT100 sequences are used.  In VMS, the
SMG library is used, which sends sequences based on your VMS terminal type.
K95 does its own screen control.  On other platforms (such as AOS/VS, VOS,
etc), screen formatting is not supported, and the SCREEN command does nothing.
<p>
The three SCREEN actions can be used in scripts to produce menus, formatted
screens, dynamic displays, etc.  Related variables include:
<p><pre>
  \v(terminal)     <i>The type terminal C-Kermit thinks you have.</i>
  \v(rows)         <i>The number of rows C-Kermit thinks your terminal has.</i>
  \v(columns)      <i>The number of columns C-Kermit thinks your terminal has.</i>
</pre><p>
And functions:
<p><pre>
  \fscrncurx()     <i>The current X coordinate of the cursor (K-95 only).</i>
  \fscrncury()     <i>The current Y coordinate of the cursor (K-95 only).</i>
  \fscrnstr(x,y,n) <i>The string of length <i>n</i>at position (x,y) (K-95 only).</i>
</pre><p>
And commands:
<p><pre>
  ECHO string      <i>Writes string + CRLF at the current cursor position.</i>
  XECHO string     <i>Writes string at current cursor position; CRLF not supplied.</i>
  GETC v prompt    <i>Issues prompt, reads one character into variable v, no echo.</i>
</pre><p>
And special characters:
<p><pre>
  Ctrl-L           <i>At the C-Kermit&#62; command prompt, or in a C-Kermit command,</i>
                   <i>works like Return or Enter, but also clears the screen</i>
</pre><p>
Example 1: A macro that prints a message \%1 at cursor position (\%2,\%3):
<p><pre>
  define MSG {
      if not def \%3 def \%3 0             ; Default column to 0
      if &#62; \v(argc) 2 screen move \%2 \%3  ; Move to given row/col (if any)
      screen cleol                         ; Clear to end of line
      if def \%1 xecho \fcontents(\%1)     ; Print message (if any)
  }
</pre><p>
Example 2: A macro put the cursor on the bottom screen line, left margin:
<p><pre>
  define BOT {
      screen move \v(rows) 0
  }
</pre><p>
Example 3: A macro to center message \%1 on line \%2.
<p><pre>
  define CENTER {
      if not def \%2 def \%2 1
      .\%x ::= (\v(cols)-\flen(\%1))/2
      msg {\%1} {\%2} {\%x}
  }
</pre><p>
Example 4: A simple menu (building on Examples 1-3):
<p><pre>
  def \%c 0                             ; Menu choice variable
  screen clear                          ; Clear the screen
  center {Welcome to This Menu} 2       ; Display the menu
  msg {Choices:} 4
  msg { 1. File} 6
  msg { 2. Edit} 7
  msg { 3. Exit} 8
  while ( != \%c 3 ) {                  ; Read and verify choice
      while true {                      ; Keep trying till we get a good one
	  screen move 10                ; Move to line 10
	  screen cleol                  ; Clear this line
	  getc \%c {Your choice: }      ; Prompt and get and echo 1 character
	  xecho \%c
	  if ( not numeric \%c ) { msg {Not numeric - "\%c"} 12, continue }
	  if ( &#62;= \%c 1 &#38;&#38; &#60;= \%c 3 ) break
	  msg {Out of range - "\%c"} 12
      }
      switch \%c {                      ; Valid choice - execute it.
	:1, msg {Filing... } 12, break
	:2, msg {Editing...} 12, break
	:3, msg {Exiting...} 12, break
      }
  }
  echo Bye                              ; Exit chosen - say goodbye.
  bot                                   ; Leave cursor at screen bottom.
  exit                                  ; And exit.
</pre><p>
Similar scripts can work over the communication connection; substitute
INPUT and OUTPUT for GETC and ECHO/XECHO.

<p>
<hr>
<h3><a name="x7.22">7.22. Evaluating Arithmetic Expressions</a></h3>
<p>
A new arithmetic operator was added to the list recognized by the EVALUATE
command, the <tt>\feval()</tt> function, and which can also be used anywhere
else arithmetic expressions are accepted (numeric command fields, array
subscripts, etc):
<p><dl>
<dt><b>Prefix "!"</b>
<dd>This operator inverts the "truth value" of the number or arithmetic
expression that follows.  If the value of the operand is 0, the result is 1.
If the value is nonzero, the result is 0.
</dl><p>
Examples:
<p><pre>
  set eval old
  evaluate 0
  0

  evaluate !0
  1

  evaluate !3
  0

  evaluate !(-3)
  0

  .\%a = 1
  .\%b = 0
  evaluate !(\%a|\%b)
  0

  evaluate !(\%a&#38;\%b)
  1

  evaluate !(!(\%a&#38;\%b))
  0
</pre>
<p>

Note the distinction between Prefix <tt>!</tt> (invert truth value) and Suffix
<tt>!</tt> (factorial).  Also the distinction between Prefix <tt>!</tt> and
Prefix <tt>~</tt> (which inverts all the bits in its operand).  Also note that
prefix operators (<tt>!</tt>, <tt>-</tt>, and <tt>~</tt>) can not be adjacent
unless you use parentheses to separate them, as shown in the final example
above.

<p>
<hr>
<h3><a name="x7.23">7.23. Floating-Point Arithmetic</a></h3>

C-Kermit 7.0 adds limited support for floating-point numbers (numbers that
have fractional parts, like 3.141592653).  This support is provided through a
small repertoire of functions and in Boolean expressions that compare numbers,
but does not apply to number parsing in general, or to expression evaluation,
array subscripts, the INCREMENT and DECREMENT commands, or in any context
other than those listed in this section.
<p>
A floating point number has an optional sign (+ or -), followed by a series of
decimal digits containing either zero or one period (.) character, which is
the decimal point.  The use of comma or any other character besides period as
a decimal point is not supported.  Scientific notation is not supported
either.  Examples of legal floating-point numbers:
<p><pre>
  0                <i>Integers can be used</i>
  1                <i>Ditto</i>
  2.               <i>A decimal point without decimal digits</i>
  3.0              <i>A decimal point with decimal digits</i>
  3.141592653      <i>Ditto</i>
 -4.0              <i>A negative sign can be included</i>
 +5.0              <i>A positive sign can be included</i>
</pre><p>
Examples of notations that are not accepted:
<p><pre>
  1,000,000        <i>Separators can not be used</i>
  1.000.000        <i>Ditto (or multiple decimal points)</i>
  6.022137E23      <i>No scientific notation</i>
  6.62606868e-34   <i>Ditto</i>
  12.5+6.25        <i>No "bare" expressions</i>
</pre><p>
You can use IF FLOAT test a string or variable to see if it's in acceptable
floating-point format.  Example:
<p><pre>
  ask \%f { Type a number: }
  if not def \%f .\%f = 0.0
  if not float \%f stop 1 Invalid floating-point number: "\%f"
</pre><p>

C-Kermit's floating-point support, like its support for whole numbers
(integers), relies on the capabilities of the underlying computer.  Your
computer has only a limited amount of precision for numbers, depending on its
architecture.  Thus floating-point numbers that have too many digits will not
be accurate; adding a very small number to a very large one might have no
effect at all; and so on.  For details, read a text on numerical analysis.
Example:
<p><pre>
  .\%a = 11111111111111111111  ; A long number
  .\%b = 22222222222222222222  ; Another one
  echo \ffpadd(\%a,\%b)        ; Add them - the result should be all 3's
  33333333333333330000.0       ; See the result
</pre><p>

In this example, the computer has 16 digits of precision; after that, the
(low-order) digits are set to 0, since the computer doesn't know what they
really are.  In fact, the computer returns random digits, but Kermit sets
all digits beyond the computer's precision to 0.
<p>

C-Kermit's floating-point functions have names of the form
"<tt>\ffp<i>xxx</i>(<i>args</i>)</tt>" ("<tt>\f</tt>" for function,
"<tt>fp</tt>" for floating-point), where "<tt><i>xxx</i></tt>" is replaced by
the name of the function, such as "<tt>sqrt</tt>", and "<tt><i>args</i></tt>"
is the argument list, consisting of one or two floating-point numbers
(depending on the function), and an optional "d" argument that says now many
decimal places should be shown in the result.  Example:
<p><pre>
  \ffpdiv(10,3,1) returns "3.3"
  \ffpdiv(10,3,2) returns "3.33"
  \ffpdiv(10,3,3) returns "3.333"
</pre><p>
and so on, up to the precision of the computer.  If the decimal-places
argument is less than zero, the fractional part of the result is truncated:
<p><pre>
  \ffpdiv(10,3,-1) returns "3".
</pre><p>
If the decimal-places argument is 0, or is omitted, C-Kermit returns as many
decimal places as are meaningful in the computer's floating-point precision,
truncating any extraneous trailing 0's:
<p><pre>
  \ffpdiv(10,8) returns "1.25".
  \ffpdiv(10,4) returns "2.5".
  \ffpdiv(10,2) returns "5.0".
  \ffpdiv(10,3) returns "3.333333333333333" (for 16-digit precision).
</pre><p>
There is no way to request that a floating-point function return a decimal
point but no decimal places.  However, this is easy enough to accomplish in
other ways, for example by supplying it outside the function call:
<p><pre>
  echo \ffpadd(\%a,\%b,-1).
</pre><p>
Kermit's floating-point functions always round the result for the requested
number of decimal places when the "d" argument is given and has a value
greater than 0 (see the description of <tt>\ffpround()</tt> just below).
<p>
Floating-point arguments can be constants in floating-point format or
variables whose values are floating-point numbers.  If a floating-point
argument is omitted, or is a variable with no value, 0.0 is supplied
automatically.  Example:
<p><pre>
  def \%x 999.999
  undef \%y
  echo \ffpmin(\%x,\%y)
  0.0
</pre><p>
Or equivalently:
<p><pre>
  echo \ffpmin(999.999)
  0.0
</pre><p>
The floating-point functions are:
<p><dl>
<dt><tt><b>\ffpround(</b><i>f1,d</i><b>)</b></tt>
<dd>Returns f1 rounded to d decimal places.  For this function only, d = 0
(or d omitted) has a special meaning: return the integer part of f1
rounded according to the fractional part.  Examples:
<pre>
  \ffpround(2.74653,-1) <i>returns</i> "2" (fraction truncated, no rounding).
  \ffpround(2.74653,0)  <i>returns</i> "3" (integer part is rounded).
  \ffpround(2.74653)    <i>returns</i> "3" (d omitted same as d = 0).
  \ffpround(2.74653,1)  <i>returns</i> "2.7".
  \ffpround(2.74653,2)  <i>returns</i> "2.75".
  \ffpround(2.74653,3)  <i>returns</i> "2.747".
  \ffpround(2.74653,4)  <i>returns</i> "2.7465", etc.
</pre><p>
<dt><tt><b>\ffpadd(</b><i>f1,f2,d</i><b>)</b></tt>
<dd>Returns the sum of f1 and f2.
<p>
<dt><tt><b>\ffpsubtract(</b><i>f1,f2,d</i><b>)</b></tt>
<dd>Subtracts f2 from f1 and returns the result.
<p>
<dt><tt><b>\ffpmultiply(</b><i>f1,f2,d</i><b>)</b></tt>
<dd>Returns the product of f1 and f2.
<p>
<dt><tt><b>\ffpdivide(</b><i>f1,f2,d</i><b>)</b></tt>
<dd>If f2 is not 0, divides f1 by f2 and returns the quotient.<br>
If f2 is 0, a DIVIDE_BY_ZERO error occurs.
<p>
<dt><tt><b>\ffpraise(</b><i>f1,f2,d</i><b>)</b></tt>
<dd>If f1 = 0 and f2 &#60;= 0, or if f1 &#60; 0 and f2 has a fractional part,
an ARG_OUT_OF_RANGE error occurs; otherwise f1 raised to the f2 power
is returned.
<p>
<dt><tt><b>\ffpsqrt(</b><i>f1,d</i><b>)</b></tt>
<dd>If f1 &#62;= 0, returns the square root of f1; otherwise ARG_OUT_OF_RANGE.
<p>
<dt><tt><b>\ffpabsolute(</b><i>f1,d</i><b>)</b></tt>
<dd>Returns the absolute value of f1 (i.e. f1 without a sign).
This is the floating-point analog of \fabsolute(n1).
<p>
<dt><tt><b>\ffpint(</b><i>f1</i><b>)</b></tt>
<dd>Returns the integer part of f1.  Equivalent to \ffpround(f1,-1).
<p>
<dt><tt><b>\ffpexp(</b><i>f1,d</i><b>)</b></tt>
<dd>The base of natural logarithms, e (2.718282...), raised to the f1 power.
<p>
<dt><tt><b>\ffplogn(</b><i>f1,d</i><b>)</b></tt>
<dd>The natural logarithm of f1 (the power to which e must be raised to
obtain f1).
<p>
<dt><tt><b>\ffplog10(</b><i>f1,d</i><b>)</b></tt>
<dd>The base-10 logarithm of f1 (the power to which 10 must be raised to
obtain f1).
<p>
<dt><tt><b>\ffpmodulus(</b><i>f1,f2,d</i><b>)</b></tt>
<dd>If f2 is not 0, the remainder after dividing f1 by f2.<br>
If f2 is 0, a DIVIDE_BY_ZERO error occurs.<br>
This is the floating-point analog of <tt>\fmod(<i>n1,n2</i>)</tt>.
<p>
<dt><tt><b>\ffpmaximum(</b><i>f1,f2,d</i><b>)</b></tt>
<dd>Returns the maximum of f1 and f2.
This is the floating-point analog of <tt>\fmax(<i>n1,n2</i>)</tt>.
<p>
<dt><tt><b>\ffpminimum(</b><i>f1,f2,d</i><b>)</b></tt>
<dd>Returns the minimum of f1 and f2.
This is the floating-point analog of <tt>\fmin(<i>n1,n2</i>)</tt>.
<p>
<dt><tt><b>\ffpsine(</b><i>f1,d</i><b>)</b></tt>
<dd>Returns the sine of f1 radians.
<p>
<dt><tt><b>\ffpcosine(</b><i>f1,d</i><b>)</b></tt>
<dd>Returns the cosine of f1 radians.
<p>
<dt><tt><b>\ffptangent(</b><i>f1,d</i><b>)</b></tt>
<dd>Returns the tangent of f1 radians.
</dl>
<p>

Note that all of these functions can be used with integer arguments.  If you
want an integer result, specify d = -1 (to truncate) or feed the result to
\ffpround(xxx,0) (to round).
<p>
Floating-point numbers (or variables or functions that return them) can be
used in Boolean expressions (see 
<a href="#x7.20.2">Section 7.20.2</a>) that compare numbers:
<p><pre>
  = x y
  != x y
  &#60; x y
  &#62; x y
  &#60;= x y
  &#62;= x y
</pre><p>

In these examples, x and y can be either integers or floating-point numbers
in any combination.  In an arithmetic comparison of an integer and a
floating-point number, the integer is converted to floating-point before the
comparison is made.  Examples:
<p><pre>
  .\%t = 3.000000000
  .\%f = 3.141592653
  .\%i = 3

  if &#62; \%f \%i echo Pi is greater.
  if = \%t \%i echo "\%i" = "\%t".
</pre><p>
A floating-point number can also be used in:
<p><pre>
  IF <i>number</i> <i>command</i>
</pre><p>
where the <i>command</i> is executed if the <i>number</i> is nonzero.  If the
number is floating-point, the <i>command</i> is not executed if the number is
0.0, and is executed otherwise.
<p>
Floating-point numbers can be sorted using ARRAY SORT /NUMERIC (see
<a href="#x7.10.5">Section 7.10.5</a> ).
<p>
Two floating-point constants are provided:
<p><pre>
  \v(math_pi) = Pi (3.141592653...)
  \v(math_e)  = e, the base of natural logarithms (2.71828...)
</pre><p>
These are given to the computer's precision, e.g. 16 digits.  This number
itself is available in a variable:
<p><dl>
<dt><b><tt>\v(math_precision)</tt></b>
<dd>How many significant digits in a floating-point number.
</dl>

<p>
<hr>
<h3><a name="x7.24">7.24. Tracing Script Execution</a></h3>

The TRACE command is handy for debugging scripts.
<p><dl>
<dt><b>TRACE <i>[ {</i> /ON, /OFF <i>} ] [ {</i> ASSIGNMENTS, COMMAND-LEVEL, ALL <i>} ]</i></b>
<dd>Selects tracing of the given object.
</dl><p>

Optional switches are /ON and /OFF.  If no switch is given, /ON is implied.
The trace objects are ASSIGNMENTS, COMMAND-LEVEL, and ALL.  The default object
is ALL, meaning to select all trace objects (besides ALL).  Thus TRACE
by itself selects tracing of everything, as does TRACE /ON, and TRACE /OFF
turns off all tracing.

<p>

When tracing of ASSIGNMENTS is on, every time the value of any user-defined
variable or macro changes, C-Kermit prints one of the following:
<p><dl>
<dt><b><tt>&#62;&#62;&#62; name: "value"</tt></b>
<dd>The name of the variable or macro followed by the new value in quotes.
  This includes implicit macro-parameter assignments during macro invocation.
<p>
<dt><b><tt>&#62;&#62;&#62; name: (undef)</tt></b>
<dd>This indicates that the variable or macro has been undefined.
<p>
<dt><b><tt>&#60;&#60;&#60; name: "value"</tt></b>
<dd>For RETURN statements: the name of the macro and the return value.
<p>
<dt><b><tt>&#60;&#60;&#60; name: (null)</tt></b>
<dd>For RETURN statements that include no value or an empty value.
</dl>
<p>
When tracing of COMMAND-LEVEL is on, C-Kermit prints:
<p><dl>
<dt><b><tt>[n] +F: "name"</tt></b>
<dd>Whenever a command file is entered, where "n" is the command level
(0 = top); the name of the command file is shown in quotes.
<p>
<dt><b><tt>[n] +M: "name"</tt></b>
<dd>Whenever a macro is entered; "n" is the command level.  The name of
the macro is shown in quotes.
<p>
<dt><b><tt>[n] -F: "name"</tt></b>
<dd>Whenever a command file is reentered from below, when a macro or
command file that it has invoked has returned.
<p>
<dt><b><tt>[n] -M: "name"</tt></b>
<dd>Whenever a macro is reentered from below.
</dl><p>
For other debugging tools, see SHOW ARGS, SHOW STACK, SET TAKE, SET MACRO, and
of course, ECHO.

<p>
<hr>
<h3><a name="x7.25">7.25. Compact Substring Notation</a></h3>

It is often desirable to extract a substring from a string which is stored
in a variable, and for this we have the <tt>\fsubstring()</tt> function, which
is used like this:
<p><pre>
  define \%a 1234567890
  echo \fsubstring(\%a,3,4) ; substring from 3rd character length 4
  3456
</pre><p>
or like this with macro-named variables:
<p><pre>
  define string 1234567890
  echo \fsubstring(\m(string),3,4)
  3456
</pre><p>
C-Kermit 7.0 adds a pair of alternative compact notations:
<p><pre>
<b>\:(</b><i>variablename</i><b>[</b><i>start</i><b>:</b><i>length</i><b>])</b>  &#60;-- Substring of variable's value
<b>\s(</b><i>macroname</i><b>[</b><i>start</i><b>:</b><i>length</i><b>])</b>     &#60;-- Substring of macro's definition
</pre><p>
These are exactly equivalent to using <tt>\fsubstring()</tt>, except more
compact to write and also faster since evaluation is in one step instead of
two.
<p>
The "<tt>\:()</tt>" notation can be used with any Kermit variable, that is,
almost anything that starts with a backslash:
<p><pre>
  \:(\%a[2:6])      &#60;-- equivalent to \fsubstring(\%a,2,6)
  \:(\&#38;x[1][2:6])   &#60;-- equivalent to \fsubstring(\&#38;x[1],2,6)
  \:(\m(foo)[2:6])  &#60;-- equivalent to \fsubstring(\m(foo),2,6)
  \:(\v(time)[2:6]) &#60;-- equivalent to \fsubstring(\v(time),2,6)
  \:(\$(TERM)[2:6]) &#60;-- equivalent to \fsubstring(\$(TERM),2,6)
  \:(ABCDEFGH[2:6]) &#60;-- equivalent to \fsubstring(ABCDEFGH,2,6)
</pre><p>
Whatever appears between the left parenthesis and the left bracket is
evaluated and then the indicated substring of the result is returned.
<p>
The "<tt>\s()</tt>" notation is the same, except after evaluating the variable,
the result is treated as a macro name and is looked up in the macro table.
Then the indicated substring of the macro definition is returned.  Example:
<p><pre>
  define testing abcdefghijklmnopqrstuvwxyz
  define \%a testing

  \s(testing[2:6])  --&#62;  bcdefg
  \:(testing[2:6])  --&#62;  esting
  \:(\%a[2:6])      --&#62;  esting
  \s(\%a[2:6])      --&#62;  bcdefg
</pre><p>
Note that the following two examples are equivalent:
<p><pre>
  \:(\m(foo)[2:6])
  \s(foo[2:6])
</pre><p>
The first number in the brackets is the 1-based starting position.  If it is
omitted, or less than 1, it is treated as 1.  If it is greater than the length
of the string, an empty string is returned.
<p>
The second number is the length of the desired substring.  If the second
number is omitted, is less than 0, or would be past the end of the string,
then "through the end of the string" is assumed.  If it is 0, the empty string
is returned.
<p>
If the brackets are empty or omitted, the original string is returned.
<p>
The starting position and length need not be literal numbers; they can also
be variables, functions, arithmetic expressions, or even other <tt>\s()</tt>
or <tt>\:()</tt> quantities; anything that evaluates to a number, for example:
<p><pre>
  \s(block[1025:\fhex2n(\s(block[\%b:\%n+4]))/2])
</pre><p>

Syntactically, <tt>\m(<i>name</i>)</tt> and <tt>\s(<i>name</i>)</tt> differ
only in that the sequence <tt>[*]</tt> at the end of the name (where
<tt>*</tt> is any sequence of 0 or more characters) is treated as substring
notation in <tt>\s(<i>name</i>)</tt>, but is considered part of the name in
<tt>\m(<i>name</i>)</tt> (to see why, see 
<a href="#x7.10.9">Section 7.10.9</a>).

<p>
<hr>
<h3><a name="x7.26">7.26. New WAIT Command Options</a></h3>

The WAIT command has been extended to allow waiting for different kinds of
things (formerly it only waited for modem signals).  Now it also can wait
for file events.

<h4><a name="x7.26.1">7.26.1. Waiting for Modem Signals</a></h4>

The previous syntax:
<p><pre>
  WAIT <i>time</i> { CD, DSR, RTS, RI, ... }
</pre><p>
has changed to:
<p><pre>
  WAIT <i>time</i> MODEM-SIGNALS { CD, DSR, RTS, RI, ... }
</pre><p>
However, the previous syntax is still accepted.  The behavior is the same
in either case.

<p>
<hr>
<h4><a name="x7.26.2">7.26.2. Waiting for File Events</a></h4>

The new WAIT option:
<p><pre>
  WAIT <i>time</i> FILE { CREATION, DELETION, MODIFICATION } <i>filename</i>
</pre><p>
lets you tell Kermit to wait the given amount of time (or until the given time
of day) for a file whose name is <i>filename</i> to be created, deleted, or
modified, respectively.  The <i>filename</i> may not contain wildcards.  If the
specified event does not occur within the time limit, or if WAIT CANCELLATION
is ON and you interrupt from the keyboard before the time is up, the WAIT
command fails.  If the event is MODIFICATION and the file does not exist, the
command fails.  Otherwise, if the given event occurs within the time limit,
the command succeeds.  Examples:
<p><dl>
<dt><tt>WAIT 600 FILE DELETION oofa.tmp</tt>
<dd>Wait up to 10 minutes for file oofa.tmp to disappear.
<p>
<dt><tt>WAIT 23:59:59 FILE MOD orders.db</tt>
<dd>Wait until just before midnight for the orders.db file to be changed.
</dl><p>
Example: Suppose you want to have the current copy of /etc/motd on your
screen at all times, and you want to hear a bell whenever it changes:
<p><pre>
  def \%f /etc/motd                      ; The file of interest.
  while 1 {                              ; Loop forever...
      cls                                ; Clear the screen.
      echo \%f: \v(date) \v(time)...     ; Print 2-line heading...
      echo
      if ( not exist \%f ) {             ; If file doesn't exist,
          echo \%f does not exist...     ; print message,
          wait 600 file creat \%f        ; and wait for it to appear.
          continue
      }
      beep                               ; Something new - beep.
      type /head:\v(rows-2) \%f          ; Display the file
      if fail exit 1 \%f: \ferrstring()  ; (checking for errors).
      wait 999 file mod \%f              ; Wait for it to change.
  }
</pre><p>
This notices when the file is created, deleted, or modified, and acts only
then (or when you interrupt it with); the time shown in the heading is the
time of the most recent event (including when the program started).
<p>
See 
<a href="#x1.10">Section 1.10</a>,
where the <tt>\v(kbchar)</tt> variable is explained.  This lets
you modify a loop like the one above to also accept single-character commands,
which interrupt the WAIT, and dispatch accordingly.  For example:
<p><pre>
  wait 999 file mod \%f              ; Wait for the file to change.
  if defined \v(kbchar) {            ; Interrupted from keyboard?
      switch \v(kbchar) {            ; Handle the keystroke...
	:q, exit                     ; Q to Quit
	:h, echo blah blah, break    ; H for Help
	:default, beep, continue     ; Anything else beep and ignore
      }
  }
</pre><p>
This lets you write event-driven applications that wait for up to three
events at once: a file or modem event, a timeout, and a keystroke.

<p>
<hr>
<h3><a name="x7.27">7.27. Relaxed FOR and SWITCH Syntax</a></h3>

For consistency with the extended IF and WHILE syntax, the FOR and SWITCH
control lists may (but need not be) enclosed in parentheses:
<p><pre>
  FOR ( \%i 1 \%n 1 ) { <i>command-list...</i> }
  SWITCH ( \%c ) { <i>command-list...</i> }
</pre><p>
In the FOR command, the increment item can be omitted if the control list is
enclosed in parentheses, in which case the increment defaults appropriately to
1 or -1, depending on the values of the first two variables.
<p>
As with IF, the parentheses around the FOR-command control list must be set
off by spaces (in the SWITCH command, the spaces are not required since the
SWITCH expression is a single arithmetic expression).
<p>
Also, outer braces around the command list are supplied automatically if
you omit them, e.g.:
<p><pre>
  FOR ( \%i 1 %n 1 ) echo \%i
</pre>

<p>
<hr>
<h3><a name="x8">8. USING OTHER FILE TRANSFER PROTOCOLS</a></h3>

In C-Kermit 7.0, alternative protocols can be selected using switches.
Switches are described in 
<a href="#x1.5">Section 1.5</a>; the use of protocol-selection switches
is described in 
<a href="#x4.7.1">Section 4.7.1</a>.  Example:
<p><pre>
  send /binary /protocol:zmodem x.tar.gz
</pre><p>
Note that file transfer recovery works only with Kermit and Zmodem protocols.
With Zmodem, recovery can be initiated only by the sender.
<p>
Only pre-1988 versions of the publicly-distributed sz/rz programs use
Standard I/O; those released later than that do not use Standard I/O and
therefore do not work with REDIRECT.  However, Omen Technology does offer
an up-to-date redirectable version called crzsz, which must be licensed
for use:
<p>
<blockquote>
"Unix Crz and Csz support XMODEM, YMODEM, and ZMODEM transfers
when called by dial-out programs such as Kermit and certain
versions of cu(1).  They are clients designed for this use.
<p>
"Crz and Csz are Copyrighted shareware programs.  Use of these
programs beyond a brief evaluation period requires registration.
Please print the "mailer.rz" file, fill out the form and return
same with your registration."
</blockquote>
<p>

To use the crzsz programs as your external XYZMODEM programs in C-Kermit,
follow the instructions in the book, but put a "c" before each command,
e.g.:
<p><pre>
  set protocol zmodem {csz %s} {csz -a %s} crz crz crz crz
</pre><p>
To use Zmodem protocol over Telnet or other non-transparent connections,
you might need to add the -e (Escape) option:
<p><pre>
  set protocol zmodem {csz -e %s} {csz -e -a %s} crz crz crz crz
</pre>

<p>
<hr>
<h3><a name="x9">9. COMMAND-LINE OPTIONS</a></h3>
<h3><a name="x9.0">9.0. Extended-Format Command-Line Options</a></h3>

Standard UNIX command line options are a single letter.  C-Kermit has run
out of letters, so new options are in a new extended format:
<p><pre>
 --<i>word[</i>:<i>arg]</i>
</pre><p>
where a keyword (rather than a single letter) specifies the function, and if
an argument is to be included, it is separated by a colon (or equal sign).
Most of the new extended-format command-line options are only for use with the
Internet Kermit Service Daemon; see the
<a href="http://www.columbia.edu/kermit/iksd.html">IKSD Administration Guide</a> for details.
However, several
of them are also general in nature:
<p><dl>
<dt><b><tt>--nointerrupts</tt></b>
<dd>Disables keyboard interrupts that are normally enabled, which are usually
Ctrl-C (to interrupt a command) and Ctrl-Z (UNIX only, to suspend C-Kermit).
<p>
<dt><b><tt>--help</tt></b>
<dd>Lists the extended command-line options that are available in your version
of C-Kermit.  If any options seem to be missing, that is because your
copy of C-Kermit was built with compile-time options to deselect them.
<p>
<dt><tt><b>--helpfile:</b><i>filename</i></tt>
<dd>Specifies the name of a file to be displayed if the user types HELP
(not followed by a specific command or topic), in place of the built-in
top-level help text.  The file need not fit on one screen; more-prompting
is used if the file is more than one screen long if COMMAND MORE-PROMPTING
is ON, as it is by default.
<p>
<dt><tt><b>--bannerfile:</b><i>filename</i></tt>
<dd>The name of a file containing a message to be printed after the user logs
in, in place of the normal message (Copyright notice, "Type HELP or ? for
help", "Default transfer mode is...", etc).
<p>
<dt><tt><b>--cdmessage:</b><i>{</i><b>on,off,0,1,2</b><i>}</i></tt>
<dd>For use in the Server-Side Server configuration; whenever the client
tells the server to change directory, the server sends the contents of a
"read me" file to the client's screen.  This feature is On by default,
and operates only in client/server mode when ON or 1.  If set to 2 or
higher, it also operates when the CD command is given at the IKSD&#62; prompt.
Synonym: <b><tt>--cdmsg</tt></b>.
<p>
<dt><tt><b>--cdfile:</b><i>filename</i></tt>
<dd>When cdmessage is on, this is the name of the "read me" file to be sent.
Normally you would specify a relative (not absolute) name, since the file
is opened using the literal name you specified, after changing to the new
directory.  Example:
<p><pre>
  --cdfile:READ.ME
</pre><p>
You can also give a list of up to 8 filenames by (a) enclosing each
filename in braces, and (b) enclosing the entire list in braces.  Example:
<tt>--cdfile:{{./.readme}{READ.ME}{aaareadme.txt}{README}{read-this-first}}</tt>
When a list is given, it is searched from left to right and the first
file found is displayed.  The default list for UNIX is:
<p><pre>
  {{./.readme}{README.TXT}{READ.ME}}
</pre></dl>

<p>
<hr>
<h3><a name="x9.1">9.1. Command Line Personalities</a></h3>

Beginning in version 7.0, if the C-Kermit binary is renamed to "telnet"
(or TELNET.EXE, telnet.pr, etc, depending on the platform), it accepts the
Telnet command line:
<p><pre>
  telnet <i>[ host [ port ] ]</i>
</pre><p>
In Unix, you can achieve the same effect with a symlink:
<p><pre>
  cd /usr/bin
  mv telnet oldtelnet
  ln -ls /usr/local/bin/kermit telnet
</pre><p>
When installed in this manner, C-Kermit always reads its initialization file.
If no host (and therefore no port) is given, C-Kermit starts in interactive
prompting mode.  If a host is given as the first command-line argument,
C-Kermit makes a connection to it.  The host argument can be an IP host name
or address, or the name of a TCP/IP entry in your C-Kermit network directory.
<p>
If a port is given, it is used.  If a port is not given, then if the hostname
was found in your network directory and port was also listed there, then that
port is used.  Otherwise port 23 (the Telnet port) is used.
<p>
When C-Kermit is called "telnet" and it is invoked with a hostname on the
command line, it exits automatically when the connection is closed.  While
the connection is open, however, you may escape back and forth as many times
as you like, transfer files, etc.
<p>
An rlogin personality is also available, but it is less useful, at least
in UNIX and VMS, where the Rlogin TCP port is privileged.
<p>
The new variable \v(name) indicates the name with which C-Kermit was invoked
("kermit", "wermit", "k95", "telnet", etc).

<p>
<hr>
<h3><a name="x9.2">9.2. Built-in Help for Command Line Options</a></h3>

"kermit -h", given from the system prompt, lists as many command-line options
as will fit on a standard 24x80 screen.  For more comprehensive help, use the
interactive HELP OPTIONS command that was added in C-Kermit 7.0:
<p>
<dt><b>HELP OPTIONS</b>
<dd>Explains how command-line options work, their syntax, etc.
<p>
<dt><b>HELP OPTIONS ALL</b>
<dd>Lists all command-line options and gives brief help about each one.
<p>
<dt><b>HELP OPTION</b> <i>x</i>
<dd>Gives brief help about option "<i>x</i>".
<p>
<dt><b>HELP EXTENDED-OPTIONS</b>
<dd>Lists the available extended-format command-line options.
<p>
<dt><b>HELP EXTENDED-OPTION</b> <i>xxx</i>
<dd>Gives help for the specified extended option.
</dl>

<p>
<hr>
<h3><a name="x9.3">9.3. New Command-Line Options</a></h3>

Command-line options added since C-Kermit 6.0 are:
<p><dl>
<dt><b><tt>+</tt></b>
<dd>(plus sign by itself): The next argument is the name of a script to
execute; all subsequent arguments are ignored by C-Kermit itself, but
passed to the script as top-level copies of <tt>\%1, \%2</tt>, etc; the
<tt>\&#38;_[]</tt> is
also set accordingly.  <tt>\%0</tt> and <tt>\&#38;_[0]</tt> become the name of
the script file,
rather than the pathname of the C-Kermit program, which is its normal
value.  Primarily for use in the top line of "Kerbang" scripts in UNIX
(see <a href="#x7.19">Section 7.19</a>).  Example from UNIX command line:
<p><pre>
  $ kermit [ regular kermit args ] + filename
</pre><p>
Sample first line of Kerbang script:
<p><pre>
  #!/usr/local/bin/kermit +
</pre><p>
<dt><tt><b>--</b></tt>
<dd>(two hyphens surrounded by whitespace)  Equivalent to "=", for
compatibility with UNIX getopt(1,3).
<p>
<dt><tt><b>-G</b></tt>
<dd>GET (like -g), but send the incoming file to standard output.  Example:
    "kermit -G oofa.txt | lpr" retrieves a file from your local computer
    (providing it is running a Kermit program that supports the autodownload
    feature and has it enabled) and prints it.
<p>
<dt><tt><b>-O</b></tt>
<dd>equivalent to -x (start up in server mode), but exits after the first
client command has been executed (mnemonic: O = Only One).  This one is
handy replacing "<tt>kermit -x</tt>" in the "automatically start Kermit on the
other end" string:
<p><pre>
  set protocol kermit {kermit -ir} {kermit -r} {kermit -x}
</pre><p>
since <tt>-x</tt> leaves the remote Kermit in server mode after the transfer,
which can be confusing, whereas -O makes it go away automatically
after the transfer.
<p>
<dt><tt><b>-L</b></tt>
<dd>Recursive, when used in combination with -s (mnemonic: L = Levels).
In UNIX or other environments where the shell expands wildcards itself,
the -s argument, if it contains wildcards, must be quoted to prevent
this, e.g.:
<p><pre>
  kermit -L -s "*.c"
</pre><p>
In UNIX only, "kermit -L -s ." means to send the current directory tree.
See 
<a href="#x4.10">Sections 4.10</a> and <a href="#x4.11">4.11</a> about
recursive file transfer.
<p>
<dt><tt><b>-V</b></tt>
<dd>Equivalent to SET FILE PATTERNS OFF
(<a href="#x4.3">Section 4.3</a>) and SET TRANSFER MODE
MANUAL.  In other words, take the FILE TYPE setting literally.  For
example, "kermit -VT oofa.bin" means send the file in Text mode, no matter
what its name is and no matter whether a kindred spirit is recognized at
the other end of the connection.
<p>
<dt><tt><b>-0</b></tt>
<dd>(digit zero) means "be 100% transparent in CONNECT mode".  This is
equivalent to the following series of commands: SET PARITY NONE, SET
COMMAND BYTESIZE 8, SET TERMINAL BYTESIZE 8, SET FLOW NONE, SET
TERM ESCAPE DISABLED, SET TERM CHAR TRANSPARENT, SET TERM AUTODOWNLOAD
OFF, SET TERM APC OFF, SET TELOPT KERMIT REFUSE REFUSE.
</dl>

<p>
<hr>
<h3><a name="x10">10. C-KERMIT AND G-KERMIT</a></h3>

Every multifunctioned and long-lived software program grows in complexity
and size over time to meet the needs and requests of its users and the demands
of the underlying technology as it changes.
<p>
Eventually users begin to notice how big the application has grown, how much
disk space it occupies, how long it takes to load, and they start to long for
the good old days when it was lean and mean.  Not long after that they begin
asking for a "light" version that only does the basics with no frills.
<p>
And so it is with C-Kermit.  A "light" version of Kermit was released (for
UNIX only) in December 1999 under the GNU General Public License; thus it is
called G-Kermit (for GNU Kermit).  All it does is send and receive files,
period.  You can find it at:
<p><pre>
  <a href="http://www.columbia.edu/kermit/gkermit.html">http://www.columbia.edu/kermit/gkermit.html</a>
</pre><p>
Where the C-Kermit 7.0 binary might be anywhere from 1 to 3 million bytes in
size, the G-Kermit binary ranges from 30K to 100K, depending on the underlying
architecture (RISC vs CISC, etc).
<p>
G-Kermit and C-Kermit may reside side-by-side on the same computer.  G-Kermit
does not make connections; it does not have a script language; it does not
translate character sets.  G-Kermit may be used instead of C-Kermit when:
<p><ul>
<li>It is on the remote end.
<li>Files are to be transferred in binary mode or in text mode without
character-set translation.
<li>File timestamps don't need to be preserved.
</ul><p>
In such cases G-Kermit might be preferred since it generally starts up faster,
and yet transfers files just as fast on most (but not necessarily all) kinds
of connections; for example, it supports streaming (<a href="#x4.20">Section
4.20</a>).
<p>
G-Kermit is also handy for bootstrapping.  It is easier to load on a new
computer than C-Kermit -- it fits on a floppy diskette with plenty of room to
spare.  Thus if you have (say) an old PC running (say) SCO Xenix and no
network connection, you can download the Xenix version of G-Kermit to (say) a
DOS or Windows PC, copy it to diskette, read the diskette on Xenix with
"dosread", and then use G-Kermit to receive C-Kermit (which does not fit on a
diskette).  If diskettes aren't an option, other bootstrapping methods are
possible too -- see the
<a href="http://www.columbia.edu/kermit/gkermit.html">G-Kermit web page</a>
for details.
<p>
<hr>
<h2><a name="xiii">III. APPENDICES</a></h2>
<h3><a name="xiii.1">III.1.  Character Set Tables</a></h3>
<h4><a name="xiii.1.1">III.1.1. The Hewlett Packard Roman8 Character Set</a></h4>
<pre>
<u>dec col/row oct hex  description</u>
160  10/00  240  A0  (Undefined)
161  10/01  241  A1  A grave
162  10/02  242  A2  A circumflex
163  10/03  243  A3  E grave
164  10/04  244  A4  E circumflex
165  10/05  245  A5  E diaeresis
166  10/06  246  A6  I circumflex
167  10/07  247  A7  I diaeresis
168  10/08  250  A8  Acute accent
169  10/09  251  A9  Grave accent
170  10/10  252  AA  Circumflex accent
171  10/11  253  AB  Diaeresis
172  10/12  254  AC  Tilde accent
173  10/13  255  AD  U grave
174  10/14  256  AE  U circumflex
175  10/15  257  AF  Lira symbol
176  11/00  260  B0  Top bar (macron)
177  11/01  261  B1  Y acute
178  11/02  262  B2  y acute
179  11/03  263  B3  Degree Sign
180  11/04  264  B4  C cedilla
181  11/05  265  B5  c cedilla
182  11/06  266  B6  N tilde
183  11/07  267  B7  n tilde
184  11/08  270  B8  Inverted exclamation mark
185  11/09  271  B9  Inverted question mark
186  11/10  272  BA  Currency symbol
187  11/11  273  BB  Pound sterling symbol
188  11/12  274  BC  Yen symbol
189  11/13  275  BD  Paragraph
190  11/14  276  BE  Florin (Guilder) symbol
191  11/15  277  BF  Cent symbol
192  12/00  300  C0  a circumflex
193  12/01  301  C1  e circumflex
194  12/02  302  C2  o circumflex
195  12/03  303  C3  u circumflex
196  12/04  304  C4  a acute
197  12/05  305  C5  e acute
198  12/06  306  C6  o acute
199  12/07  307  C7  u acute
200  12/08  310  C8  a grave
201  12/09  311  C9  e grave
202  12/10  312  CA  o grave
203  12/11  313  CB  u grave
204  12/12  314  CC  a diaeresis
205  12/13  315  CD  e diaeresis
206  12/14  316  CE  o diaeresis
207  12/15  317  CF  u diaeresis
208  13/00  320  D0  A ring
209  13/01  321  D1  i circumflex
210  13/02  322  D2  O with stroke
211  13/03  323  D3  AE digraph
212  13/04  324  D4  a ring
213  13/05  325  D5  i acute
214  13/06  326  D6  o with stroke
215  13/07  327  D7  ae digraph
216  13/08  330  D8  A diaeresis
217  13/09  331  D9  i grave
218  13/10  332  DA  O diaeresis
219  13/11  333  DB  U diaeresis
220  13/12  334  DC  E acute
221  13/13  335  DD  i diaeresis
222  13/14  336  DE  German sharp s
223  13/15  337  DF  O circumflex
224  14/00  340  E0  A acute
225  14/01  341  E1  A tilde
226  14/02  342  E2  a tilde
227  14/03  343  E3  Icelandic Eth
228  14/04  344  E4  Icelandic eth
229  14/05  345  E5  I acute
230  14/06  346  E6  I grave
231  14/07  347  E7  O acute
232  14/08  350  E8  O grave
233  14/09  351  E9  O tilde
234  14/10  352  EA  o tilde
235  14/11  353  EB  S caron
236  14/12  354  EC  s caron
237  14/13  355  ED  U acute
238  14/14  356  EE  Y diaeresis
239  14/15  357  EF  y diaeresis
240  15/00  360  F0  Icelandic Thorn
241  15/01  361  F1  Icelandic thorn
242  15/02  362  F2  Middle dot
243  15/03  363  F3  Greek mu
244  15/04  364  F4  Pilcrow sign
245  15/05  365  F5  Fraction 3/4
246  15/06  366  F6  Long dash, horizontal bar
247  15/07  367  F7  Fraction 1/4
248  15/08  370  F8  Fraction 1/2
249  15/09  371  F9  Feminine ordinal
250  15/10  372  FA  Masculine ordinal
251  15/11  373  FB  Left guillemot
252  15/12  374  FC  Solid box
253  15/13  375  FD  Right guillemot
254  15/14  376  FE  Plus or minus sign
255  15/15  377  FF  (Undefined)
</pre>

<p>
<hr>
<h4><a name="xiii.1.2">III.1.2. Greek Character Sets</a></h4>
<h4><a name="xiii.1.2.1">III.1.2.1. The ISO 8859-7 Latin / Greek Alphabet = ELOT 928</a></h4>
<pre>
<u>dec col/row oct hex  description</u>
160  10/00  240  A0  No-break space
161  10/01  241  A1  Left single quotation mark
162  10/02  242  A2  right single quotation mark
163  10/03  243  A3  Pound sign
164  10/04  244  A4  (UNUSED)
165  10/05  245  A5  (UNUSED)
166  10/06  246  A6  Broken bar
167  10/07  247  A7  Paragraph sign
168  10/08  250  A8  Diaeresis (Dialytika)
169  10/09  251  A9  Copyright sign
170  10/10  252  AA  (UNUSED)
171  10/11  253  AB  Left angle quotation
172  10/12  254  AC  Not sign
173  10/13  255  AD  Soft hyphen
174  10/14  256  AE  (UNUSED)
175  10/15  257  AF  Horizontal bar (Parenthetiki pavla)
176  11/00  260  B0  Degree sign
177  11/01  261  B1  Plus-minus sign
178  11/02  262  B2  Superscript two
179  11/03  263  B3  Superscript three
180  11/04  264  B4  Accent (tonos)
181  11/05  265  B5  Diaeresis and accent (Dialytika and Tonos)
182  11/06  266  B6  Alpha with accent
183  11/07  267  B7  Middle dot (Ano Teleia)
184  11/08  270  B8  Epsilon with accent
185  11/09  271  B9  Eta with accent
186  11/10  272  BA  Iota with accent
187  11/11  273  BB  Right angle quotation
188  11/12  274  BC  Omicron with accent
189  11/13  275  BD  One half
190  11/14  276  BE  Upsilon with accent
191  11/15  277  BF  Omega with accent
192  12/00  300  C0  iota with diaeresis and accent
193  12/01  301  C1  Alpha
194  12/02  302  C2  Beta
195  12/03  303  C3  Gamma
196  12/04  304  C4  Delta
197  12/05  305  C5  Epsilon
198  12/06  306  C6  Zeta
199  12/07  307  C7  Eta
200  12/08  310  C8  Theta
201  12/09  311  C9  Iota
202  12/10  312  CA  Kappa
203  12/11  313  CB  Lamda
204  12/12  314  CC  Mu
205  12/13  315  CD  Nu
206  12/14  316  CE  Ksi
207  12/15  317  CF  Omicron
208  13/00  320  D0  Pi
209  13/01  321  D1  Rho
210  13/02  322  D2  (UNUSED)
211  13/03  323  D3  Sigma
212  13/04  324  D4  Tau
213  13/05  325  D5  Upsilon
214  13/06  326  D6  Phi
215  13/07  327  D7  Khi
216  13/08  330  D8  Psi
217  13/09  331  D9  Omega
218  13/10  332  DA  Iota with diaeresis
219  13/11  333  DB  Upsilon with diaeresis
220  13/12  334  DC  alpha with accent
221  13/13  335  DD  epsilon with accent
222  13/14  336  DE  eta with accent
223  13/15  337  DF  iota with accent
224  14/00  340  E0  upsilon with diaeresis and accent
225  14/01  341  E1  alpha
226  14/02  342  E2  beta
227  14/03  343  E3  gamma
228  14/04  344  E4  delta
229  14/05  345  E5  epsilon
230  14/06  346  E6  zeta
231  14/07  347  E7  eta
232  14/08  350  E8  theta
233  14/09  351  E9  iota
234  14/10  352  EA  kappa
235  14/11  353  EB  lamda
236  14/12  354  EC  mu
237  14/13  355  ED  nu
238  14/14  356  EE  ksi
239  14/15  357  EF  omicron
240  15/00  360  F0  pi
241  15/01  361  F1  rho
242  15/02  362  F2  terminal sigma
243  15/03  363  F3  sigma
244  15/04  364  F4  tau
245  15/05  365  F5  upsilon
246  15/06  366  F6  phi
247  15/07  367  F7  khi
248  15/08  370  F8  psi
249  15/09  371  F9  omega
250  15/10  372  FA  iota with diaeresis
251  15/11  373  FB  upsilon with diaeresis
252  15/12  374  FC  omicron with diaeresis
253  15/13  375  FD  upsilon with accent
254  15/14  376  FE  omega with accent
255  15/15  377  FF  (UNUSED)
</pre>

<p>
<hr>
<h4><a name="iii.1.2.2">III.1.2.2. The ELOT 927 Character Set</a></h4>

<pre>
<u>dec col/row oct hex  description</u>
 32  02/00   40  20  SPACE
 33  02/01   41  21  EXCLAMATION MARK
 34  02/02   42  22  QUOTATION MARK
 35  02/03   43  23  NUMBER SIGN
 36  02/04   44  24  DOLLAR SIGN
 37  02/05   45  25  PERCENT SIGN
 38  02/06   46  26  AMPERSAND
 39  02/07   47  27  APOSTROPHE
 40  02/08   50  28  LEFT PARENTHESIS
 41  02/09   51  29  RIGHT PARENTHESIS
 42  02/10   52  2A  ASTERISK
 43  02/11   53  2B  PLUS SIGN
 44  02/12   54  2C  COMMA
 45  02/13   55  2D  HYPHEN, MINUS SIGN
 46  02/14   56  2E  PERIOD, FULL STOP
 47  02/15   57  2F  SOLIDUS, SLASH
 48  03/00   60  30  DIGIT ZERO
 49  03/01   61  31  DIGIT ONE
 50  03/02   62  32  DIGIT TWO
 51  03/03   63  33  DIGIT THREE
 52  03/04   64  34  DIGIT FOUR
 53  03/05   65  35  DIGIT FIVE
 54  03/06   66  36  DIGIT SIX
 55  03/07   67  37  DIGIT SEVEN
 56  03/08   70  38  DIGIT EIGHT
 57  03/09   71  39  DIGIT NINE
 58  03/10   72  3A  COLON
 59  03/11   73  3B  SEMICOLON
 60  03/12   74  3C  LESS-THAN SIGN, LEFT ANGLE BRACKET
 61  03/13   75  3D  EQUALS SIGN
 62  03/14   76  3E  GREATER-THAN SIGN, RIGHT ANGLE BRACKET
 63  03/15   77  3F  QUESTION MARK
 64  04/00  100  40  COMMERCIAL AT SIGN
 65  04/01  101  41  CAPITAL LETTER A
 66  04/02  102  42  CAPITAL LETTER B
 67  04/03  103  43  CAPITAL LETTER C
 68  04/04  104  44  CAPITAL LETTER D
 69  04/05  105  45  CAPITAL LETTER E
 70  04/06  106  46  CAPITAL LETTER F
 71  04/07  107  47  CAPITAL LETTER G
 72  04/08  110  48  CAPITAL LETTER H
 73  04/09  111  49  CAPITAL LETTER I
 74  04/10  112  4A  CAPITAL LETTER J
 75  04/11  113  4B  CAPITAL LETTER K
 76  04/12  114  4C  CAPITAL LETTER L
 77  04/13  115  4D  CAPITAL LETTER M
 78  04/14  116  4E  CAPITAL LETTER N
 79  04/15  117  4F  CAPITAL LETTER O
 80  05/00  120  50  CAPITAL LETTER P
 81  05/01  121  51  CAPITAL LETTER Q
 82  05/02  122  52  CAPITAL LETTER R
 83  05/03  123  53  CAPITAL LETTER S
 84  05/04  124  54  CAPITAL LETTER T
 85  05/05  125  55  CAPITAL LETTER U
 86  05/06  126  56  CAPITAL LETTER V
 87  05/07  127  57  CAPITAL LETTER W
 88  05/08  130  58  CAPITAL LETTER X
 89  05/09  131  59  CAPITAL LETTER Y
 90  05/10  132  5A  CAPITAL LETTER Z
 91  05/11  133  5B  LEFT SQUARE BRACKET
 92  05/12  134  5C  REVERSE SOLIDUS, BACKSLASH
 93  05/13  135  5D  RIGHT SQUARE BRACKET
 94  05/14  136  5E  CIRCUMFLEX ACCENT
 95  05/15  137  5F  UNDERSCORE
 96  06/00  140  60  ACCENT GRAVE
 97  06/01  141  61  GREEK LETTER ALPHA
 98  06/02  142  62  GREEK LETTER BETA
 99  06/03  143  63  GREEK LETTER GAMMA
100  06/04  144  64  GREEK LETTER DELTA
101  06/05  145  65  GREEK LETTER EPSILON
102  06/06  146  66  GREEK LETTER ZETA
103  06/07  147  67  GREEK LETTER ETA
104  06/08  150  68  GREEK LETTER THETA
105  06/09  151  69  GREEK LETTER IOTA
106  06/10  152  6A  GREEK LETTER KAPPA
107  06/11  153  6B  GREEK LETTER LAMDA
108  06/12  154  6C  GREEK LETTER MU
109  06/13  155  6D  GREEK LETTER NU
110  06/14  156  6E  GREEK LETTER KSI
111  06/15  157  6F  GREEK LETTER OMICRON
112  07/00  160  70  GREEK LETTER PI
113  07/01  161  71  GREEK LETTER RHO
114  07/02  162  72  GREEK LETTER SIGMA
115  07/03  163  73  GREEK LETTER TAU
116  07/04  164  74  GREEK LETTER UPSILON
117  07/05  165  75  GREEK LETTER FI
118  07/06  166  76  GREEK LETTER XI
119  07/07  167  77  GREEK LETTER PSI
120  07/08  170  78  GREEK LETTER OMEGA
121  07/09  171  79  SPACE
122  07/10  172  7A  SPACE
123  07/11  173  7B  LEFT CURLY BRACKET, LEFT BRACE
124  07/12  174  7C  VERTICAL LINE, VERTICAL BAR
125  07/13  175  7D  RIGHT CURLY BRACKET, RIGHT BRACE
126  07/14  176  7E  TILDE
127  07/15  177  7F  RUBOUT, DELETE
</pre>

<p>
<hr>
<h4><a name="iii.1.2.3">III.1.2.3. PC Code Page 869</a></h4>

(to be filled in...)

<p>
<hr>
<h4><a name="iii.2">III.2. Updated Country Codes</a></h4>

Date: Mon, 7 Apr 1997 23:23:49 EDT<br>
From: Dave Leibold &#60;dleibold@else.net&#62;<br>
Newsgroups: comp.dcom.telecom<br>
Subject: Ex-USSR Country Codes Profile<br>
Organization: TELECOM Digest
<p>
Ex-USSR Country Codes Profile<br>
4 April 1997
<p>
Below is a summary of the country codes that have formed in the wake
of the USSR dissolution, along with some updated findings and reports.
Additional or corrected information on any of these nations would be
welcome (c/o dleibold@else.net).
<ul>
<li>Kyrgyz Republic country code 996 will take effect, at least in
  Canada, effective 1 May 1997, according to CRTC Telecom Order 97-464,
  based on Stentor Tariff Notice 433. There is no indication whether
  there will be a permissive dialing period involved or for how long
  such a permissive operation would remain.
<p>
<li>Country code 992 was reported as a recent assignment for Tajikistan,
  which will be moving from country code 7 at some unknown time.
<p>
<li>Uzbekistan has its own country code assignment, but I have no
  information if this is in service yet or what implementation dates
  have been set.
<p>
<li>Kazakstan does not have a known separate country code assignment
  at present. It remains in country code 7 for the time being.
<p>
<li>Russia seems destined to keep country code 7.
<p>
<li>Recent news reports speak of some agreements forming between Russia and
Belarus. While there is no outright reunification yet, there is expected
to be much closer ties between the two nations. Whether this will lead to
a reunification of telephone codes remains to be seen.
</ul>
<p>
In the table, "Effective" means the date at which the country code
began service (which could vary according to the nation). "Mandatory"
means the date at which the country code 7 is invalid for calls to
that nation. There are a number of question marks since exact
dates have not been collected in all cases.
<p><pre>
<u>CC  Nation            Effective     Mandatory    Notes</u>
<p>
370 Lithuania         1993?         ???          Announced Jan 1993
371 Latvia            1993?         ???
372 Estonia           1 Feb 1993?   March 1993?
373 Moldova           1993?         ???          Announced Jan 1993
374 Armenia           1 May 1995    1 July 1995  Announced Jan 1995 (ITU)
375 Belarus           16 Apr 1995   1997?
380 Ukraine           16 Apr 1995   Oct 1995?
7   Kazakstan         (no known changes)
7   Russia            (presumably not changing)
992 Tajikistan        ???           ???          Announced 1996-7?
993 Turkmenistan      3 Jan 1997    3 Apr 1997   Canada as of 29 Nov 1996
994 Azerbaijan        Sept 1994?    ???          Announced 1992
995 Georgia           1994?         ???          ref: Telecom Digest Oct 1994
996 Kyrgyz Republic   1 May 1997    ???          ref: Stentor Canada/CRTC
998 Uzbekistan        ???           ???          Announced 1996? (ITU)
</pre>
<p>
Details courtesy Toby Nixon, ITU, Stentor (Canada), CRTC (Canada),
TELECOM Digest (including information collected for the country code
listings).
<p>
<hr>
<h2><a name="xiv">IV. ERRATA &#38; CORRIGENDA</a></h2>
<p>
The following errors in
<a href="ckb2.html"><cite>Using C-Kermit</cite></a>, Second Edition,
first printing, have been noted.
<p>
First, some missing acknowledgements for C-Kermit 6.0: JE Jones of Microware
for help with OS-9, Nigel Roles for his help with Plan 9, Lucas Hart for help
with VMS and Digital UNIX, Igor Kovalenko for his help with QNX.  And later,
to Susan Kleinmann for her help with Debian Linux packaging; Patrick
Volkerding for his help with Slackware Linux packaging; Jim Knoble for his
help with Red Hat Linux packaging; and to dozens of others for sending
individual C-Kermit binaries for varied and diverse platforms.
<p>
Thanks to James Spath for both binaries and reporting many of the typos
noted below.  Also to Dat Thuc Nguyen for spotting several typos.
<p><pre>
<u>PAGE</u>    <u>REMARKS</u>
COVER   "COS" is a misprint.  There is no COS.  Pretend it says "SCO" or "VOS".
        (This is fixed in the second printing.)
 xxi    Second line: Fred Smith's affiliation should be Computrition.
 83     Change "commands other" to "commands as other" (1st paragraph)
 87     Change "The the" to "The" (2nd paragraph)
 92     "set modem-type user-defined supra" should be "set modem type ..."
 95     Change "VI" to "vi" (1st paragraph)
 96     Change "it it" to "it is" (1st paragraph)
 97     Change "advantage a literal" to "advantage of a literal" (2nd
        paragraph)
102     The call-waiting example would be better as SET DIAL PREFIX *70W
        (rather than "*70,") because the former will not cause an incorrect
        call to be placed with pulse dialing.
123     Third paragraph from bottom: "..otherwise if a your local username.."
        should be "..otherwise your local username..".
160     Delete the "it" between "and" and "to" (2nd paragraph)
185     In "When TRANSFER DISPLAY is OFF, C-Kermit skips the display...",
        "OFF" should be "NONE".
187     The last paragraph says the "A command" is ignored, should be "S".
194     Change "it known" to "it is known" (4th paragraph).
235     In C-Kermit 7.0, the syntax of the GET command changed.  MGET now
        must be used to get a list of files and there is no more multiline
        GET command.
268     Last paragraph: "effect" should be "affect".
275     In the SET PROTOCOL KERMIT description, the following sentence is
        incorrect and should be removed: 'If you omit the commands, the
        default ones are restored: "kermit -ir" and "kermit -r" respectively".
        The correct information is given at the bottom of page 281.
279     9th line.  The decimal value of ST is 156, not 155.
295     In the stepping stones, skip ahead to Chapter 17 on p. 327.
298     Table 16-2, Portuguese entry.  Column 4/00 should show section sign,
        not acute accent.
316     Other languages written in the Hebrew alphabet include Karaim (a Turkic
        language spoken in Lithuania and Poland), Judeo-Kurdish, and Judeo-
        Georgian.
332     UNDEFINE definition, change "This just" to "This is just".
344     It might be necessary to set the modem's pulse generation rate when
        sending numeric pages; most Hayes compatible modems use the S11
        register for this.
350     Delete "is" from between "It" and "ceases" (4th paragraph)
351     Top - both occurrences of "print \%a" should be "echo \%a".
364     \v(input) and \v(query) out of alphabetical order.
378     In the MYSEND macro, "if not \m(rc) goto bad" should be:
        "if \m(rc) goto bad" (remove the "not").
382-383 It should be stated that the loop control variable must be of the \%a
        type, or else an array element; macro names can not be used for this.
383     In line 3, "\%f[\%i]" should be "\&#38;f[\%i]".
383     In the sort example, it should be stated that the array is 1-based.
387     Change "You can list" to "You can get a list" (5th paragraph)
393     \Fverify() description.  The 3rd sentence could be stated more clearly
        as "If all characters in string2 are also in string1, 0 is returned."
398     Copying \ffiles() results to an array before is not required as of
        C-Kermit 7.0 (see <a href="#x7.3">Section 7.3</a>).
403     In "(\%a + 3) * (\%b  5)", a minus sign is missing between b and 5.
407     C-Kermit 7.0 no longer supports multiline GET.  Change
        "get, \%1, \%2" to "get {\%1} {\%2}" or "get /as:{\%2} {\%1}".
409     READ example while loop should be:
        while success { echo \m(line), read line }
409     "WRITE file" should be "WRITE keyword" (you can't put a filename there)
        (The same applies to WRITE-LINE / WRITELN).
414     \Funhexify() missing from Table 18-3.
425     MINPUT definition, change 2nd "text2" to "text3".
436     Several lines are missing from the UNIXLOGIN macro listing.
        After the "xif fail" block, insert:
<p>
	  out \%1\13                    ; Send username, carriage return
	  inp 5 Password:               ; Wait 5 sec for this prompt
	  if fail end 1 No password prompt
	  pause                         ; Wait a sec
	  out \%2\13                    ; Send password
<p>
440     Change "set terminal byteszie" to "set terminal bytesize".
        Change "input Password:" to "input 10 Password".
448     Franchise script: "access line" should be "access \m(line)".
453     There are two incorrectly coded IF statements in the DELIVER macro
        definition.  Replace both occurrences of "if &#62; \%1 \%3 {" with
        "xif &#62; \%i \%3 {" (replace "if" by "xif" and "\%1" with "\%i").
453     "the the" (last paragraph) should be "the".
454     EOT (last paragraph) is End of Transmission, not End of Text.
457     _DEFINE definition: "name constructed" should be "name is constructed".
457     "macro for and" (last paragraph) should be "macro and".
459     Should explain that \v(user) is a legal abbreviation of \v(userid).
480     Figure II-2 is backwards; the least-significant bit is transmitted
        first, then up to the highest, and the parity bit last.
534     The VMS Appendix section on Odd Record Lengths no longer applies;
        C-Kermit 7.0 handles odd record lengths as well as even ones.
559     Table VIII-3, Portuguese entry.  Column 4/00 should show section sign,
        not acute accent.
560-563 HP-Roman8 missing from Table VII-4; there wasn't room to squeeze it in.
        It is listed in section II(6).
565     "d stroke" in Table VII-5 has the wrong appearance; the stem should
        be upright.  The letter shown in the table is actually a lowercase
        Icelandic eth, which has a curved stem.
601-604 BeBox, BeOS, Plan 9, and probably others not listed in trademarks.
604     The words "SCRIBE TEXT FORMATTER" appear at the end of the last
        sentence of the first paragraph of the Colophon.  They should have
        been in the Index.
Index:  Missing entries: SET { SEND, RECEIVE } PATHNAMES, Call waiting, ...
	\F()            Page 605, add also 413-414
	\Fbreak         389
	\Fcapitalize    390
	\Fchecksum      414
	\Fcrc16         414
	\Fexecute       414
	\Fhexify        390
	\Fltrim         391
        \Frepeat        392
	\Fspawn         392
	\Ftod2secs      399
	\v() built_in   Page 606, add also 361-364
	\v(_line)       354, 361
	\v(apcactive)   361
	\v(charset)     362
	\v(cpu)         362
	\v(crc16)       357, 362
	\v(d$xxx)       add page 362
	\v(dialnumber)  362
	\v(dialresult)  362
	\v(errno)       362
	\v(errstring)   362
	\v(exedir)      362
	\v(inidir)      363
	\v(ipaddress)   363
	\v(keyboard)    363
	\v(macro)       363
	\v(minput)      363
	\v(m_xxx)       94, 363
	\v(password)    364
	\v(query)       364
	\v(prompt)      364
	\v(speed)       356, 364
	\v(startup)     364
	\v(status)      364
	\v(sysid)       364
	\v(system)      364
	\v(fsize)       at lower half page 606 should read \v(tfsize)
	\v(xversion)    364
        BEEP Command    40
        SET FLOW        62, 212
</pre>
<p>
Figure II-5 on page 493.  The pin assignments of the Mini Din-8 connector
are not described anywhere.  As noted in the text, these tend to vary from
vendor to vendor.  One common arrangement is:
<p><pre>
  1. HSKout (Handshake out -- definition depends on software)
  2. HSKin  (Handshake in or external clock)
  3. TxD-
  4. Not used
  5. RxD-
  6. TxD+
  7. Not used
  8. RxD+
</pre><p>
Note the "balanced pairs" for Receive Data (RxD) and Transmit Data (TxD), and
the utter lack of modem signals.  These connectors follow the RS-423 standard,
rather than RS-232.  In some arrangements, Pin 1 is used for DTR and Pin 2 for
CD; in others Pin 1 is RTS and Pin 2 is CTS.
<p>
Please send reports of other errors to the authors, as well as suggestions for
improvements, additional index entries, and any other comments:
<p>
  <a href="mailto:kermit@columbia.edu">kermit@columbia.edu</a>
<p>
<hr>
<h2><a name="xv">APPENDIX V. ADDITIONAL COPYRIGHT NOTICES</a></h2>
<p>
The following copyrights cover some of the source code used in the development
of C-Kermit, Kermit 95, or Kermit 95 support libraries.
<p><pre>
/*****************************************************************************/
/*                                                                           */
/*              Copyright (c) 1995 by Oy Online Solutions Ltd.               */
/*                                                                           */
/*   Distribution of this source code is strictly forbbidden. Use of this    */
/*   source code is granted to the University of Columbia C-Kermit project   */
/*   to be distributed in binary format only. Please familiarize yourself    */
/*   with the accompanying LICENSE.P file.                                   */
/*                                                                           */
/*****************************************************************************/
</pre><p>
used for Xmodem, Ymodem, and Zmodem protocol in Kermit 95 (p95.dll, p2.dll)
<p>
<hr>
<p>
Copyright (c) 1997 Stanford University
<p>
The use of this software for revenue-generating purposes may require a
license from the owners of the underlying intellectual property.
Specifically, the SRP-3 protocol may not be used for revenue-generating
purposes without a license.
<p>
Within that constraint, permission to use, copy, modify, and distribute
this software and its documentation for any purpose is hereby granted
without fee, provided that the above copyright notices and this permission
notice appear in all copies of the software and related documentation.
<p>
THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
<p>
IN NO EVENT SHALL STANFORD BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
<p>
Used for Secure Remote Password (TM) protocol (SRP) in C-Kermit,
Kermit 95 (k95.exe, k2.exe, k95crypt.dll, k2crypt.dll)
<p>
<hr>
<p>
Copyright 1990 by the Massachusetts Institute of Technology.
All Rights Reserved.
<p>
Export of this software from the United States of America may
  require a specific license from the United States Government.
  It is the responsibility of any person or organization contemplating
  export to obtain such a license before exporting.
<p>
WITHIN THAT CONSTRAINT, permission to use, copy, modify, and
distribute this software and its documentation for any purpose and
without fee is hereby granted, provided that the above copyright
notice appear in all copies and that both that copyright notice and
this permission notice appear in supporting documentation, and that
the name of M.I.T. not be used in advertising or publicity pertaining
to distribution of the software without specific, written prior
permission.  M.I.T. makes no representations about the suitability of
this software for any purpose.  It is provided "as is" without express
or implied warranty.
<p>

Used for Telnet Authentication Option, Telnet Encryption Option,
and Kerberos (TM) authentication in C-Kermit, Kermit 95 (k95.exe, k2.exe,
k95crypt.dll, k2crypt.dll)
<p>
<hr>
<p>
Copyright (c) 1991, 1993
The Regents of the University of California.  All rights reserved.
<p>
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
<ol>
<li>Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
<li>Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
<li>All advertising materials mentioning features or use of this software
   must display the following acknowledgement:
<blockquote>
This product includes software developed by the University of
California, Berkeley and its contributors.
</blockquote>
<li>Neither the name of the University nor the names of its contributors
   may be used to endorse or promote products derived from this software
   without specific prior written permission.
</ol><p>
THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.
<p>
Used for Telnet Authentication Option, Telnet Encryption Option,
and Kerberos (TM) authentication in C-Kermit, Kermit 95 (k95.exe, k2.exe,
k95crypt.dll, k2crypt.dll)
<p>
<hr>
<p>
Copyright (C) 1995-1997 Eric Young (eay@cryptsoft.com)
All rights reserved.
<p>
This package is an DES implementation written by Eric Young
(eay@cryptsoft.com).  The implementation was written so as to conform with
MIT's libdes.
<p>
This library is free for commercial and non-commercial use as long as
the following conditions are aheared to.  The following conditions
apply to all code found in this distribution.
<p>
Copyright remains Eric Young's, and as such any Copyright notices in
the code are not to be removed.
If this package is used in a product, Eric Young should be given attribution
as the author of that the SSL library.  This can be in the form of a textual
message at program startup or in documentation (online or textual) provided
with the package.
<p>
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
<ol>
<li>Redistributions of source code must retain the copyright
   notice, this list of conditions and the following disclaimer.
<li>Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
<li>All advertising materials mentioning features or use of this software
   must display the following acknowledgement:
   This product includes software developed by Eric Young (eay@cryptsoft.com)
</ol><p>
THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.
<p>
The license and distribution terms for any publically available version or
derivative of this code cannot be changed.  i.e. this code cannot simply be
copied and put under another distrubution license
[including the GNU Public License.]
<p>
The reason behind this being stated in this direct manner is past
experience in code simply being copied and the attribution removed
from it and then being distributed as part of other packages. This
implementation was a non-trivial and unpaid effort.
<p>
Used DES encryption in Kermit 95 (k95crypt.dll, k2crypt.dll)
<p>
<hr>
<p><pre>
 * This is version 1.1 of CryptoLib
 *
 * The authors of this software are Jack Lacy, Don Mitchell and Matt Blaze
 *              Copyright (c) 1991, 1992, 1993, 1994, 1995 by AT&#38;T.
 * Permission to use, copy, and modify this software without fee
 * is hereby granted, provided that this entire notice is included in
 * all copies of any software which is or includes a copy or
 * modification of this software and in all copies of the supporting
 * documentation for such software.
 *
 * NOTE:
 * Some of the algorithms in cryptolib may be covered by patents.
 * It is the responsibility of the user to ensure that any required
 * licenses are obtained.
 *
 *
 * SOME PARTS OF CRYPTOLIB MAY BE RESTRICTED UNDER UNITED STATES EXPORT
 * REGULATIONS.
 *
 *
 * THIS SOFTWARE IS BEING PROVIDED "AS IS", WITHOUT ANY EXPRESS OR IMPLIED
 * WARRANTY.  IN PARTICULAR, NEITHER THE AUTHORS NOR AT&#38;T MAKE ANY
 * REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE MERCHANTABILITY
 * OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR PURPOSE.
</pre><p>
Used for Big Number library in Kermit 95 (k95crypt.dll, k2crypt.dll).
<p>
[ <a href="#top">Top</a> ] [ <a href="http://www.columbia.edu/kermit/ckermit.html">C-Kermit</a> ] [ <a href="index.html">Kermit Home</a> ]
<hr>
CKERMIT70<tt>.</tt>HTM / The Kermit Project / Columbia University / 8 Feb 2000
</body></html>
